0000                       0001 ; Seattle Computer Products 8086 Assembler  version 2.44
0000                       0002 ;   by Tim Paterson
0000                       0003 ; Runs on the 8086 under MS-DOS
0000                       0004 
0000                       0005 ;* * * * * * REVISION HISTORY * * * * * *
0000                       0006 ;
0000                       0007 ; 12/29/80  2.01  General release with 86-DOS version 0.34
0000                       0008 ; 02/22/81  2.10  Increased buffer size from 128 bytes to 1024 bytes
0000                       0009 ; 03/18/81  2.11  General cleanup and more documentation
0000                       0010 ; 03/24/81  2.20  Modify ESC handling for full 8087 operation
0000                       0011 ; 04/01/81  2.21  Fix date in HEX and PRN files; modify buffer handling
0000                       0012 ; 04/03/81  2.22  Fix 2.21 buffer handling
0000                       0013 ; 04/13/81  2.23  Re-open source file for listing to allow assembling CON:
0000                       0014 ; 04/28/81  2.24  Allow nested IFs
0000                       0015 ; 07/30/81  2.25  Add Intel string mnemonics; clean up a little
0000                       0016 ; 08/02/81  2.30  Re-write pass 2:
0000                       0017 ;			Always report errors to console
0000                       0018 ;			Exact byte lengths for HEX and PRN files
0000                       0019 ; 11/08/81  2.40  Add 8087 mnemonics; print full error messages;
0000                       0020 ;		  allow expressions with *, /, and ()
0000                       0021 ; 07/04/82  2.41  Fix Intel's 8087 "reverse-bit" bug; don't copy date
0000                       0022 ; 08/18/82  2.42  Increase stack from 80 to 256 (Damn! Overflowed again!)
0000                       0023 ; 01/05/83  2.43  Correct over-zealous optimization in 2.42
0000                       0024 ; 05/09/83  2.44  Add memory usage report
0000                       0025 ;
0000                       0026 ;* * * * * * * * * * * * * * * * * * * * *
0000                       0027 
0000                       0028 SYMWID:	EQU	5	;5 symbols per line in dump
0000                       0029 FCB:	EQU	5CH
0000                       0030 BUFSIZ:	EQU	1024	;Source code buffer
0000                       0031 LSTBUFSIZ:EQU	BUFSIZ	;List file buffer
0000                       0032 HEXBUFSIZ:EQU	70	;Hex file buffer (26*2 + 5*2 + 3 + EXTRA)
0000                       0033 EOL:	EQU	13	;ASCII carriage return
0000                       0034 OBJECT:	EQU	100H	;UDDEFAULT "PUT" ADDRESS
0000                       0035 
0000                       0036 ;System call function codes
0000                       0037 PRINTMES: EQU	9
0000                       0038 OPEN:	EQU	15
0000                       0039 CLOSE:	EQU	16
0000                       0040 READ:	EQU	20
0000                       0041 SETDMA:	EQU	26
0000                       0042 MAKE:	EQU	22
0000                       0043 BLKWRT:	EQU	40
0000                       0044 
0000                       0045 ;The following equates define some token values returned by GETSYM
0000                       0046 UNDEFID:EQU	0	;Undefined identifier (including no nearby RET)
0000                       0047 CONST:	EQU	1	;Constant (including $)
0000                       0048 REG:	EQU	2	;8-bit register
0000                       0049 XREG:	EQU	3	;16-bit register (except segment registers)
0000                       0050 SREG:	EQU	4	;Segment register
0000                       0051 FREG:	EQU	6	;8087 floating point register
0000                       0052 
0000                       0053 ;Bits to build 8087 opcode table entries
0000                       0054 ONEREG:	EQU	40H	;Single ST register OK as operand
0000                       0055 NEEDOP:	EQU	80H	;Must have an operand
0000                       0056 INTEGER:EQU	20H	;For integer operations
0000                       0057 REAL:	EQU	28H	;For real operations
0000                       0058 EXTENDED EQU	10H	;For Long integers or Temporary real
0000                       0059 MEMORY:	EQU	18H	;For general memory operations
0000                       0060 STACKOP:EQU	10H	;Two register arithmetic with pop
0000                       0061 ARITH:	EQU	8	;Non-pop arithmetic operations
0000                       0062 
0000                       0063 	org	0100H
0100 E9 74 00              0064 	JMP	BEGIN
0103                       0065 
0103 0D 0A 53 65 61 74 74  0066 HEADER:	DB	13,10,'Seattle Computer Products 8086 Assembler Version 2.44'
     6C 65 20 43 6F 6D 70 
     75 74 65 72 20 50 72 
     6F 64 75 63 74 73 20 
     38 30 38 36 20 41 73 
     73 65 6D 62 6C 65 72 
     20 56 65 72 73 69 6F 
     6E 20 32 2E 34 34    
013A 0D 0A 43 6F 70 79 72  0067 	DB	13,10,'Copyright 1979-1983 by Seattle Computer Products, Inc.'
     69 67 68 74 20 31 39 
     37 39 2D 31 39 38 33 
     20 62 79 20 53 65 61 
     74 74 6C 65 20 43 6F 
     6D 70 75 74 65 72 20 
     50 72 6F 64 75 63 74 
     73 2C 20 49 6E 63 2E 
0172 0D 0A 0D 0A 24        0068 	DB	13,10,13,10,'$'
0177                       0069 
0177                       0070 BEGIN:
0177 BC 12 2B              0071 	MOV	SP,STACK
017A BA 03 01              0072 	MOV	DX,HEADER
017D B4 09                 0073 	MOV	AH,PRINTMES
017F CD 21                 0074 	INT	33
0181 A0 6D 00              0075 	MOV	AL,[FCB+17]
0184 A2 A1 21              0076 	MOV	[SYMFLG],AL	;Save symbol table request flag
0187 BE 65 00              0077 	MOV	SI,FCB+9	;Point to file extension
018A AC                    0078 	LODSB			;Get source drive letter
018B E8 14 01              0079 	CALL	CHKDSK		;Valid drive?
018E 0A C0                 0080 	OR	AL,AL
0190 74 03                 0081 	JZ	UDDEFAULT		;If no extension, use existing drive spec
0192 A2 5C 00              0082 	MOV	[FCB],AL
0195                       0083 UDDEFAULT:
0195 AC                    0084 	LODSB			;Get HEX file drive letter
0196 3C 5A                 0085 	CMP	AL,'Z'		;Suppress HEX file?
0198 74 03                 0086 	JZ	L0000
019A E8 05 01              0087 	CALL	CHKDSK
019D                       0088 L0000:	
019D A2 EC 20              0089 	MOV	[HEXFCB],AL
01A0 AC                    0090 	LODSB			;Get PRN file drive letter
01A1 B4 00                 0091 	MOV	AH,0		;Signal no PRN file
01A3 3C 5A                 0092 	CMP	AL,'Z'		;Suppress PRN file?
01A5 74 15                 0093 	JZ	NOPRN
01A7 3C 59                 0094 	CMP	AL,'Y'		;Print errors only on console?
01A9 74 11                 0095 	JZ	NOPRN
01AB B4 02                 0096 	MOV	AH,2
01AD 3C 58                 0097 	CMP	AL,'X'		;PRN file to console?
01AF 74 0B                 0098 	JZ	NOPRN
01B1 B4 04                 0099 	MOV	AH,4
01B3 3C 50                 0100 	CMP	AL,'P'		;PRN file to printer?
01B5 74 05                 0101 	JZ	NOPRN
01B7 E8 E8 00              0102 	CALL	CHKDSK
01BA B4 80                 0103 	MOV	AH,80H
01BC                       0104 NOPRN:
01BC A2 11 21              0105 	MOV	[LSTFCB],AL
01BF 88 26 BE 21           0106 	MOV	[LSTDEV],AH	;Flag device for list ouput
01C3 BE DB 20              0107 	MOV	SI,EXTEND
01C6 BF 65 00              0108 	MOV	DI,FCB+9
01C9 A5                    0109 	MOVSW
01CA A4                    0110 	MOVSB			;Set extension to ASM
01CB A5                    0111 	MOVSW			;Zero extent field
01CC BA 5C 00              0112 	MOV	DX,FCB
01CF B4 0F                 0113 	MOV	AH,OPEN
01D1 CD 21                 0114 	INT	33
01D3 BB 56 20              0115 	MOV	BX,NOFILE
01D6 0A C0                 0116 	OR	AL,AL
01D8 74 03                 0117 	JZ	$+5
01DA E9 9A 00              0118 	JMP	PRERR
01DD BA EC 20              0119 	MOV	DX,HEXFCB
01E0 E8 9C 00              0120 	CALL	MAKFIL
01E3 BA 11 21              0121 	MOV	DX,LSTFCB
01E6 E8 96 00              0122 	CALL	MAKFIL
01E9 33 C0                 0123 	XOR	AX,AX
01EB A3 68 00              0124 	MOV	[FCB+12],AX	;Zero CURRENT BLOCK field
01EE A2 7C 00              0125 	MOV	[FCB+32],AL	;Zero Next Record field
01F1 C7 06 6A 00 00 04     0126 	MOV	[FCB+14],BUFSIZ	;Set record size
01F7 C7 06 10 26 12 26     0127 	MOV	[BUFPT],SRCBUF	;Initialize buffer pointer
01FD C7 06 A3 21 13 2B     0128 	MOV	[CODE],START+1	;POINTER TO NEXT BYTE OF INTERMEDIATE CODE
0203 C7 06 C4 21 12 2B     0129 	MOV	[IY],START	;POINTER TO CURRENT RELOCATION BYTE
0209 33 C0                 0130 	XOR	AX,AX
020B A3 36 21              0131 	MOV	[PC],AX		;UDDEFAULT PROGRAM COUNTER
020E A3 9D 21              0132 	MOV	[BASE],AX	;POINTER TO ROOT OF ID TREE=NIL
0211 A3 BC 21              0133 	MOV	[RETPT],AX	;Pointer to last RET record
0214 A2 B6 21              0134 	MOV	[IFFLG],AL	;NOT WITHIN IF/ENDIF
0217 A2 B7 21              0135 	MOV	[CHKLAB],AL	;LOOKUP ALL LABELS
021A 48                    0136 	DEC	AX
021B A3 BA 21              0137 	MOV	[LSTRET],AX	;Location of last RET
021E A1 06 00              0138 	MOV	AX,[6]		;HL=END OF MEMORY
0221 A3 9F 21              0139 	MOV	[HEAP],AX	;BACK END OF SYMBOL TABLE SPACE
0224 C7 06 A7 21 04 00     0140 	MOV	[BCOUNT],4	;CODE BYTES PER RELOCATION BYTE
022A                       0141 
022A                       0142 ;Assemble each line of code
022A                       0143 
022A                       0144 LOOP:
022A E8 8B 00              0145 	CALL	NEXTCHR		;Get first character on line
022D 3C 1A                 0146 	CMP	AL,1AH
022F 74 1E                 0147 	JZ	ENDJ
0231 B0 FF                 0148 	MOV	AL,-1		;Flag that no tokens have been read yet
0233 A2 9C 21              0149 	MOV	[SYM],AL
0236 E8 22 07              0150 	CALL	ASMLIN		;Assemble the line
0239 A0 9C 21              0151 	MOV	AL,[SYM]
023C 3C FF                 0152 	CMP	AL,-1		;Any tokens found on line?
023E 75 03                 0153 	JNZ	L0002
0240 E8 C1 03              0154 	CALL	GETSYM		;If no tokens read yet, read first one
0243                       0155 L0002:	
0243 3C 3B                 0156 	CMP	AL,';'
0245 74 0B                 0157 	JZ	ENDLN
0247 3C 0D                 0158 	CMP	AL,EOL
0249 74 07                 0159 	JZ	ENDLN
024B B0 14                 0160 	MOV	AL,14H		;Garbage at end of line error
024D EB 05                 0161 	JMPS	ENDLIN
024F E9 16 0F              0162 ENDJ:	JMP	UDEND
0252                       0163 
0252                       0164 ENDLN:
0252 32 C0                 0165 	XOR	AL,AL		;Flag no errors on line
0254                       0166 ENDLIN:
0254                       0167 ;AL = error code for line. Stack depth unknown
0254 BC 12 2B              0168 	MOV	SP,STACK
0257 E8 02 00              0169 	CALL	NEXLIN
025A EB CE                 0170 	JMPS	LOOP
025C                       0171 
025C                       0172 NEXLIN:
025C B5 C0                 0173 	MOV	CH,0C0H		;Put end of line marker and error code (AL)
025E E8 8C 09              0174 	CALL	PUTCD
0261 E8 4F 09              0175 	CALL	GEN1
0264 A0 9B 21              0176 	MOV	AL,[CHR]
0267                       0177 GETEOL:
0267 3C 0A                 0178 	CMP	AL,10
0269 74 36                 0179 	JZ	GETEOLUDRET
026B 3C 1A                 0180 	CMP	AL,1AH
026D 74 E0                 0181 	JZ	ENDJ
026F E8 46 00              0182 	CALL	NEXTCHR		;Scan over comments for linefeed
0272 EB F3                 0183 	JMPS	GETEOL
0274                       0184 ABORT:
0274 BB 3E 20              0185 	MOV	BX,NOMEM
0277                       0186 PRERR:
0277 8B D3                 0187 	MOV	DX,BX
0279 B4 09                 0188 	MOV	AH,PRINTMES
027B CD 21                 0189 	INT	33
027D CD 20                 0190 	INT	32
027F                       0191 
027F                       0192 MAKFIL:
027F 8B F2                 0193 	MOV	SI,DX
0281 AC                    0194 	LODSB			;Get drive select byte
0282 3C 20                 0195 	CMP	AL,20H		;If not valid, don't make file
0284 73 1B                 0196 	JNC	MAKFILUDRET
0286 B9 04 00              0197 	MOV	CX,4
0289 8B FE                 0198 	MOV	DI,SI
028B BE 5D 00              0199 	MOV	SI,FCB+1
028E F3                    0200 	REP
028F A5                    0201 	MOVSW			;Copy source file name
0290 B4 16                 0202 	MOV	AH,MAKE
0292 CD 21                 0203 	INT	33
0294 C7 45 05 01 00        0204 	MOV	[DI-9+14],1	;Set record length to 1 byte
0299 BB 26 20              0205 	MOV	BX,NOSPAC
029C 0A C0                 0206 	OR	AL,AL		;Success?
029E 75 D7                 0207 	JNZ	PRERR
02A0 C3                    0208 	RET
02A1                       0209 GETEOLUDRET:
02A1                       0210 MAKFILUDRET:
02A1                       0211 CHKDSKUDRET:
02A1                       0212 MROPSUDRET:
02A1 C3                    0213 	RET
02A2                       0214 CHKDSK:
02A2 2C 20                 0215 	SUB	AL,' '		;If not present, set zero flag
02A4 74 FB                 0216 	JZ	CHKDSKUDRET
02A6 2C 20                 0217 	SUB	AL,20H
02A8 74 04                 0218 	JZ	DSKERR		;Must be in range A-O
02AA 3C 10                 0219 	CMP	AL,'P'-'@'
02AC 72 F3                 0220 	JC	CHKDSKUDRET
02AE                       0221 DSKERR:
02AE BB 77 20              0222 	MOV	BX,BADDSK
02B1 EB C4                 0223 	JMPS	PRERR
02B3                       0224 ERROR:
02B3 8A C1                 0225 	MOV	AL,CL
02B5 E9 9C FF              0226 	JMP	ENDLIN
02B8                       0227 
02B8                       0228 NEXTCHR:
02B8 8B 36 10 26           0229 	MOV	SI,[BUFPT]
02BC 81 FE 12 26           0230 	CMP	SI,SRCBUF
02C0 75 1A                 0231 	JNZ	GETCH
02C2                       0232 ;Buffer empty so refill it
02C2 52                    0233 	PUSH	DX
02C3 50                    0234 	PUSH	AX		;AH must be saved
02C4 8B D6                 0235 	MOV	DX,SI
02C6 B4 1A                 0236 	MOV	AH,SETDMA
02C8 CD 21                 0237 	INT	33
02CA BA 5C 00              0238 	MOV	DX,FCB
02CD B4 14                 0239 	MOV	AH,READ
02CF CD 21                 0240 	INT	33
02D1 92                    0241 	XCHG	AX,DX		;Put error code in DL
02D2 58                    0242 	POP	AX		;Restore AH
02D3 8A C2                 0243 	MOV	AL,DL		;Error code back in AL
02D5 5A                    0244 	POP	DX
02D6 3C 01                 0245 	CMP	AL,1
02D8 B0 1A                 0246 	MOV	AL,1AH		;Possibly signal End of File
02DA 74 0A                 0247 	JZ	NOMOD		;If nothing read
02DC                       0248 GETCH:
02DC AC                    0249 	LODSB
02DD 81 FE 12 2A           0250 	CMP	SI,SRCBUF+BUFSIZ
02E1 75 03                 0251 	JNZ	NOMOD
02E3 BE 12 26              0252 	MOV	SI,SRCBUF
02E6                       0253 NOMOD:
02E6 89 36 10 26           0254 	MOV	[BUFPT],SI
02EA A2 9B 21              0255 	MOV	[CHR],AL
02ED C3                    0256 	RET
02EE                       0257 
02EE                       0258 
02EE                       0259 MROPS:
02EE                       0260 
02EE                       0261 ; Get two operands and check for certain types, according to flag byte
02EE                       0262 ; in CL. OP code in CH. Returns only if immediate operation.
02EE                       0263 
02EE 51                    0264 	PUSH	CX		;Save type flags
02EF E8 D8 00              0265 	CALL	GETOP
02F2 52                    0266 	PUSH	DX		;Save first operand
02F3 E8 CB 00              0267 	CALL	GETOP2
02F6 5B                    0268 	POP	BX		;First op in BX, second op in DX
02F7 B0 04                 0269 	MOV	AL,SREG		;Check for a segment register
02F9 3A C7                 0270 	CMP	AL,BH
02FB 74 41                 0271 	JZ	SEGCHK
02FD 3A C6                 0272 	CMP	AL,DH
02FF 74 3D                 0273 	JZ	SEGCHK
0301 B0 01                 0274 	MOV	AL,CONST	;Check if the first operand is immediate
0303 B1 1A                 0275 	MOV	CL,26
0305 3A C7                 0276 	CMP	AL,BH
0307 74 AA                 0277 	JZ	ERROR		;Error if so
0309 59                    0278 	POP	CX		;Restore type flags
030A 3A C6                 0279 	CMP	AL,DH		;If second operand is immediate, then done
030C 74 93                 0280 	JZ	MROPSUDRET
030E B0 00                 0281 	MOV	AL,UNDEFID	;Check for memory reference
0310 3A C7                 0282 	CMP	AL,BH
0312 74 4F                 0283 	JZ	STORE		;Is destination memory?
0314 3A C6                 0284 	CMP	AL,DH
0316 74 55                 0285 	JZ	LOAD		;Is source memory?
0318 F6 C1 01              0286 	TEST	CL,1		;Check if register-to-register operation OK
031B B1 1B                 0287 	MOV	CL,27
031D 74 94                 0288 	JZ	ERROR
031F 8A C6                 0289 	MOV	AL,DH
0321 3A C7                 0290 	CMP	AL,BH		;Registers must be of same length
0323                       0291 RR:
0323 B1 16                 0292 	MOV	CL,22
0325 75 8C                 0293 	JNZ	ERROR
0327                       0294 RR1:
0327 24 01                 0295 	AND	AL,1		;Get register length (1=16 bits)
0329 0A C5                 0296 	OR	AL,CH		;Or in to OP code
032B E8 78 08              0297 	CALL	PUT		;And write it
032E 59                    0298 	POP	CX		;Dump return address
032F 8A C3                 0299 	MOV	AL,BL
0331 02 C0                 0300 	ADD	AL,AL		;Rotate register number into middle position
0333 02 C0                 0301 	ADD	AL,AL
0335 02 C0                 0302 	ADD	AL,AL
0337 0C C0                 0303 	OR	AL,0C0H		;Set register-to-register mode
0339 0A C2                 0304 	OR	AL,DL		;Combine with other register number
033B E9 68 08              0305 	JMP	PUT
033E                       0306 SEGCHK:
033E                       0307 ;Come here if at least one operand is a segment register
033E 59                    0308 	POP	CX		;Restore flags
033F F6 C1 08              0309 	TEST	CL,8		;Check if segment register OK
0342 B1 16                 0310 	MOV	CL,22
0344 74 78                 0311 	JZ	ERR1
0346 B9 03 8E              0312 	MOV	CX,8E03H	;Segment register move OP code
0349 B0 00                 0313 	MOV	AL,UNDEFID
034B 3A C6                 0314 	CMP	AL,DH		;Check if source is memory
034D 74 1E                 0315 	JZ	LOAD
034F 3A C7                 0316 	CMP	AL,BH		;Check if destination is memory
0351 74 10                 0317 	JZ	STORE
0353 B0 03                 0318 	MOV	AL,XREG
0355 2A C6                 0319 	SUB	AL,DH		;Check if source is 16-bit register
0357 74 CA                 0320 	JZ	RR		;If so, AL must be zero
0359 B5 8C                 0321 	MOV	CH,8CH		;Change direction
035B 87 DA                 0322 	XCHG	DX,BX		;Flip which operand is first and second
035D B0 03                 0323 	MOV	AL,XREG
035F 2A C6                 0324 	SUB	AL,DH		;Let RR perform finish the test
0361 EB C0                 0325 	JMPS	RR
0363                       0326 
0363                       0327 STORE:
0363 F6 C1 04              0328 	TEST	CL,004H		;Check if storing is OK
0366 75 52                 0329 	JNZ	STERR
0368 87 DA                 0330 	XCHG	DX,BX		;If so, flip operands
036A 80 E5 FD              0331 	AND	CH,0FDH		;   and zero direction bit
036D                       0332 LOAD:
036D B6 19                 0333 	MOV	DH,25
036F 3A C7                 0334 	CMP	AL,BH		;Check if memory-to-memory
0371 74 49                 0335 	JZ	MRERR
0373 8A C7                 0336 	MOV	AL,BH
0375 3C 02                 0337 	CMP	AL,REG		;Check if 8-bit operation
0377 75 07                 0338 	JNZ	XRG
0379 B6 16                 0339 	MOV	DH,22
037B F6 C1 01              0340 	TEST	CL,1		;See if 8-bit operation is OK
037E 74 3C                 0341 	JZ	MRERR
0380                       0342 XRG:
0380 8A C2                 0343 	MOV	AL,DL
0382 2C 06                 0344 	SUB	AL,6		;Check for R/M mode 6 and register 0
0384 0A C3                 0345 	OR	AL,BL		;   meaning direct load/store of accumulator
0386 75 19                 0346 	JNZ	NOTAC
0388 F6 C1 08              0347 	TEST	CL,8		;See if direct load/store of accumulator
038B 74 14                 0348 	JZ	NOTAC		;   means anything in this case
038D                       0349 ; Process direct load/store of accumulator
038D 8A C5                 0350 	MOV	AL,CH
038F 24 02                 0351 	AND	AL,2		;Preserve direction bit only
0391 34 02                 0352 	XOR	AL,2		;   but flip it
0393 0C A0                 0353 	OR	AL,0A0H		;Combine with OP code
0395 8A E8                 0354 	MOV	CH,AL
0397 8A C7                 0355 	MOV	AL,BH		;Check byte/word operation
0399 24 01                 0356 	AND	AL,1
039B 0A C5                 0357 	OR	AL,CH
039D 59                    0358 	POP	CX		;Dump return address
039E E9 C7 08              0359 	JMP	PUTADD		;Write the address
03A1                       0360 
03A1                       0361 NOTAC:
03A1 8A C7                 0362 	MOV	AL,BH
03A3 24 01                 0363 	AND	AL,1		;Get byte/word bit
03A5 22 C1                 0364 	AND	AL,CL		;But don't use it in word-only operations
03A7 0A C5                 0365 	OR	AL,CH		;Combine with OP code
03A9 E8 FA 07              0366 	CALL	PUT
03AC 8A C3                 0367 	MOV	AL,BL
03AE 02 C0                 0368 	ADD	AL,AL		;Rotate to middle position
03B0 02 C0                 0369 	ADD	AL,AL
03B2 02 C0                 0370 	ADD	AL,AL
03B4 0A C2                 0371 	OR	AL,DL		;Combine register field
03B6 59                    0372 	POP	CX		;Dump return address
03B7 E9 AE 08              0373 	JMP	PUTADD		;Write the address
03BA                       0374 
03BA                       0375 STERR:
03BA B6 1D                 0376 	MOV	DH,29
03BC                       0377 MRERR:
03BC 8A CE                 0378 	MOV	CL,DH
03BE                       0379 
03BE E9 F2 FE              0380 ERR1:	JMP	ERROR
03C1                       0381 
03C1                       0382 GETOP2:
03C1                       0383 ;Get the second operand: look for a comma and drop into GETOP
03C1 A0 9C 21              0384 	MOV	AL,[SYM]
03C4 3C 2C                 0385 	CMP	AL,','
03C6 B1 15                 0386 	MOV	CL,21
03C8 75 F4                 0387 	JNZ	ERR1
03CA                       0388 
03CA                       0389 
03CA                       0390 GETOP:
03CA                       0391 
03CA                       0392 ; Get one operand. Operand may be a memory reference in brackets, a register,
03CA                       0393 ; or a constant. If a flag (such as "B" for byte operation) is encountered,
03CA                       0394 ; it is noted and processing continues to find the operand.
03CA                       0395 ;
03CA                       0396 ; On exit, AL (=DH) has the type of operand. Other information depends
03CA                       0397 ; on the actual operand:
03CA                       0398 ;
03CA                       0399 ; AL=DH=0  Memory Reference.  DL has the address mode properly prepared in
03CA                       0400 ; the 8086 R/M format (middle bits zero). The constant part of the address
03CA                       0401 ; is in ADDR. If an undefined label needs to be added to this, a pointer to
03CA                       0402 ; its information fields is in ALABEL, otherwise ALABEL is zero.
03CA                       0403 ;
03CA                       0404 ; AL=DH=1  Value. The constant part is in DATA. If an undefined label needs
03CA                       0405 ; to be added to this, a pointer to its information fields is in DLABEL,
03CA                       0406 ; otherwise DLABEL is zero. "$" and "RET" are in this class.
03CA                       0407 ;
03CA                       0408 ; AL=DH=2  8-bit Register. DL has the register number.
03CA                       0409 ;
03CA                       0410 ; AL=DH=3  16-bit Register. DL has the register number.
03CA                       0411 ;
03CA                       0412 ; AL=DH=4  Segment Register. DL has the register number.
03CA                       0413 
03CA E8 37 02              0414 	CALL	GETSYM
03CD                       0415 GETOP1:
03CD                       0416 ;Enter here if we don't need a GETSYM first
03CD 3C 5B                 0417 	CMP	AL,'['		;Memory reference?
03CF 74 30                 0418 	JZ	MEM
03D1 3C 05                 0419 	CMP	AL,5		;Flag ("B", "W", etc.)?
03D3 74 57                 0420 	JZ	FLG
03D5 3C 02                 0421 	CMP	AL,REG		;8-Bit register?
03D7 74 20                 0422 	JZ	NREG
03D9 3C 03                 0423 	CMP	AL,XREG		;16-Bit register?
03DB 74 1C                 0424 	JZ	NREG
03DD 3C 04                 0425 	CMP	AL,SREG		;Segment register?
03DF 74 18                 0426 	JZ	NREG
03E1                       0427 VAL:				;Must be immediate
03E1 32 C0                 0428 	XOR	AL,AL		;No addressing modes allowed
03E3                       0429 VAL1:
03E3 E8 57 00              0430 	CALL	GETVAL
03E6 A1 46 21              0431 	MOV	AX,[CON]	;Defined part
03E9 A3 42 21              0432 	MOV	[DATA],AX
03EC A1 48 21              0433 	MOV	AX,[UNDEF]	;Undefined part
03EF A3 44 21              0434 	MOV	[DLABEL],AX
03F2 8A D5                 0435 	MOV	DL,CH
03F4 B6 01                 0436 	MOV	DH,CONST
03F6 8A C6                 0437 	MOV	AL,DH
03F8 C3                    0438 	RET
03F9                       0439 NREG:
03F9 52                    0440 	PUSH	DX
03FA E8 07 02              0441 	CALL	GETSYM
03FD 5A                    0442 	POP	DX
03FE 8A C6                 0443 	MOV	AL,DH
0400 C3                    0444 	RET
0401                       0445 MEM:
0401 E8 00 02              0446 	CALL	GETSYM
0404 B0 01                 0447 	MOV	AL,1
0406 E8 34 00              0448 	CALL	GETVAL
0409 A0 9C 21              0449 	MOV	AL,[SYM]
040C 3C 5D                 0450 	CMP	AL,']'
040E B1 18                 0451 	MOV	CL,24
0410 75 AC                 0452 	JNZ	ERR1
0412 E8 EF 01              0453 	CALL	GETSYM
0415 8B 1E 46 21           0454 	MOV	BX,[CON]
0419 89 1E 3E 21           0455 	MOV	[ADDR],BX
041D 8B 1E 48 21           0456 	MOV	BX,[UNDEF]
0421 89 1E 40 21           0457 	MOV	[ALABEL],BX
0425 8A D5                 0458 	MOV	DL,CH
0427 B6 00                 0459 	MOV	DH,UNDEFID
0429 8A C6                 0460 	MOV	AL,DH
042B C3                    0461 	RET
042C                       0462 FLG:
042C 3A 16 3D 21           0463 	CMP	DL,[MAXFLG]	;Invalid flag for this operation?
0430 B1 27                 0464 	MOV	CL,27H
0432 7F 8A                 0465 	JG	ERR1
0434 E8 CD 01              0466 	CALL	GETSYM
0437 3C 2C                 0467 	CMP	AL,','
0439 74 8F                 0468 	JZ	GETOP
043B EB 90                 0469 	JMPS	GETOP1
043D                       0470 
043D                       0471 
043D                       0472 GETVAL:
043D                       0473 
043D                       0474 ; Expression analyzer. On entry, if AL=0 then do not allow base or index
043D                       0475 ; registers. If AL=1, we are analyzing a memory reference, so allow base
043D                       0476 ; and index registers, and compute addressing mode when done. The constant
043D                       0477 ; part of the expression will be found in CON. If an undefined label is to
043D                       0478 ; be added to this, a pointer to its information fields will be found in
043D                       0479 ; UNDEF.
043D                       0480 
043D 8A E0                 0481 	MOV	AH,AL		;Flag is kept in AH
043F C7 06 48 21 00 00     0482 	MOV	[UNDEF],0
0445 A0 9C 21              0483 	MOV	AL,[SYM]
0448 E8 51 00              0484 	CALL	EXPRESSION
044B 89 16 46 21           0485 	MOV	[CON],DX
044F 8A C4                 0486 	MOV	AL,AH
0451 B5 00                 0487 	MOV	CH,0		;Initial mode
0453 A8 10                 0488 	TEST	AL,10H		;Test INDEX bit
0455 D0 D0                 0489 	RCL	AL		;BASE bit (zero flag not affected)
0457 74 37                 0490 	JZ	NOIND		;Jump if not indexed, with BASE bit in carry
0459 F5                    0491 	CMC
045A D0 D5                 0492 	RCL	CH		;Rotate in BASE bit
045C D0 D0                 0493 	RCL	AL		;BP bit
045E D0 D5                 0494 	RCL	CH
0460 D0 D0                 0495 	RCL	AL		;DI bit
0462 D0 D5                 0496 	RCL	CH		;The low 3 bits now have indexing mode
0464                       0497 MODE:
0464 80 CD 80              0498 	OR	CH,080H		;If undefined label, force 16-bit displacement
0467 F7 06 48 21 FF FF     0499 	TEST	[UNDEF],-1
046D 75 20                 0500 	JNZ	MODEUDRET
046F 8B 1E 46 21           0501 	MOV	BX,[CON]
0473 8A C3                 0502 	MOV	AL,BL
0475 98                    0503 	CBW			;Extend sign
0476 3B C3                 0504 	CMP	AX,BX		;Is it a signed 8-bit number?
0478 75 15                 0505 	JNZ	MODEUDRET		;If not, use 16-bit displacement
047A 80 E5 7F              0506 	AND	CH,07FH		;Reset 16-bit displacement
047D 80 CD 40              0507 	OR	CH,040H		;Set 8-bit displacement
0480 0B DB                 0508 	OR	BX,BX
0482 75 0B                 0509 	JNZ	MODEUDRET		;Use it if not zero displacement
0484 80 E5 07              0510 	AND	CH,7		;Specify no displacement
0487 82 FD 06              0511 	CMP	CH,6		;Check for BP+0 addressing mode
048A 75 03                 0512 	JNZ	MODEUDRET
048C 80 CD 40              0513 	OR	CH,040H		;If BP+0, use 8-bit displacement
048F                       0514 MODEUDRET:
048F C3                    0515 	RET
0490                       0516 NOIND:
0490 B5 06                 0517 	MOV	CH,6		;Try direct address mode
0492 73 FB                 0518 	JNC	MODEUDRET		;If no base register, that's right
0494 D0 D0                 0519 	RCL	AL		;Check BP bit
0496 72 CC                 0520 	JC	MODE
0498 FE C5                 0521 	INC	CH		;If not, must be BX
049A EB C8                 0522 	JMPS	MODE
049C                       0523 
049C                       0524 EXPRESSION:
049C                       0525 ;Analyze arbitrary expression. Flag byte in AH.
049C                       0526 ;On exit, AL has type byte: 0=register or undefined label
049C B5 FF                 0527 	MOV	CH,-1		;Initial type
049E 8B FA                 0528 	MOV	DI,DX
04A0 33 D2                 0529 	XOR	DX,DX		;Initial value
04A2 3C 2B                 0530 	CMP	AL,'+'
04A4 74 0C                 0531 	JZ	PLSMNS
04A6 3C 2D                 0532 	CMP	AL,'-'
04A8 74 08                 0533 	JZ	PLSMNS
04AA B1 2B                 0534 	MOV	CL,'+'
04AC 52                    0535 	PUSH	DX
04AD 51                    0536 	PUSH	CX
04AE 8B D7                 0537 	MOV	DX,DI
04B0 EB 0A                 0538 	JMPS	OPERATE
04B2                       0539 PLSMNS:
04B2 8A C8                 0540 	MOV	CL,AL
04B4 52                    0541 	PUSH	DX
04B5 51                    0542 	PUSH	CX
04B6 80 CC 04              0543 	OR	AH,4		;Flag that a sign was found
04B9 E8 48 01              0544 	CALL	GETSYM
04BC                       0545 OPERATE:
04BC E8 2B 00              0546 	CALL	TERM
04BF 59                    0547 	POP	CX		;Recover operator
04C0 5B                    0548 	POP	BX		;Recover current value
04C1 87 DA                 0549 	XCHG	DX,BX
04C3 22 E8                 0550 	AND	CH,AL
04C5 0A C0                 0551 	OR	AL,AL		;Is it register or undefined label?
04C7 74 17                 0552 	JZ	NOCON		;If so, then no constant part
04C9 82 F9 2D              0553 	CMP	CL,"-"		;Subtract it?
04CC 75 02                 0554 	JNZ	ADD
04CE F7 DB                 0555 	NEG	BX
04D0                       0556 ADD:
04D0 03 D3                 0557 	ADD	DX,BX
04D2                       0558 NEXTERM:
04D2 A0 9C 21              0559 	MOV	AL,[SYM]
04D5 3C 2B                 0560 	CMP	AL,'+'
04D7 74 D9                 0561 	JZ	PLSMNS
04D9 3C 2D                 0562 	CMP	AL,'-'
04DB 74 D5                 0563 	JZ	PLSMNS
04DD 8A C5                 0564 	MOV	AL,CH
04DF C3                    0565 	RET
04E0                       0566 NOCON:
04E0 82 F9 2D              0567 	CMP	CL,"-"
04E3 75 ED                 0568 	JNZ	NEXTERM
04E5                       0569 BADOP:
04E5 B1 05                 0570 	MOV	CL,5
04E7 E9 C9 FD              0571 	JMP	ERROR
04EA                       0572 
04EA                       0573 TERM:
04EA E8 40 00              0574 	CALL	FACTOR
04ED                       0575 MULOP:
04ED 52                    0576 	PUSH	DX		;Save value
04EE 50                    0577 	PUSH	AX		;Save type
04EF E8 12 01              0578 	CALL	GETSYM
04F2 59                    0579 	POP	CX
04F3 3C 2A                 0580 	CMP	AL,"*"
04F5 74 04                 0581 	JZ	GETFACT
04F7 3C 2F                 0582 	CMP	AL,"/"
04F9 75 2E                 0583 	JNZ	ENDTERM
04FB                       0584 GETFACT:
04FB 0A C9                 0585 	OR	CL,CL		;Can we operate on this type?
04FD 74 E6                 0586 	JZ	BADOP
04FF 50                    0587 	PUSH	AX		;Save operator
0500 E8 01 01              0588 	CALL	GETSYM		;Get past operator
0503 E8 27 00              0589 	CALL	FACTOR
0506 0A C0                 0590 	OR	AL,AL
0508 74 DB                 0591 	JZ	BADOP
050A 59                    0592 	POP	CX		;Recover operator
050B 5D                    0593 	POP	BP		;And current value
050C 95                    0594 	XCHG	AX,BP		;Save AH in BP
050D 82 F9 2F              0595 	CMP	CL,"/"		;Do we divide?
0510 75 0E                 0596 	JNZ	DOMUL
0512 0B D2                 0597 	OR	DX,DX		;Dividing by zero?
0514 B1 29                 0598 	MOV	CL,29H
0516 74 51                 0599 	JZ	ERR2
0518 8B DA                 0600 	MOV	BX,DX
051A 33 D2                 0601 	XOR	DX,DX		;Make 32-bit dividend
051C F7 F3                 0602 	DIV	AX,BX
051E EB 02                 0603 	JMPS	NEXFACT
0520                       0604 DOMUL:
0520 F7 E2                 0605 	MUL	AX,DX
0522                       0606 NEXFACT:
0522 8B D0                 0607 	MOV	DX,AX		;Result in DX
0524 95                    0608 	XCHG	AX,BP		;Restore flags to AH
0525 B0 FF                 0609 	MOV	AL,-1		;Indicate a number
0527 EB C4                 0610 	JMPS	MULOP
0529                       0611 ENDTERM:
0529 5A                    0612 	POP	DX
052A 8A C1                 0613 	MOV	AL,CL
052C C3                    0614 	RET
052D                       0615 
052D                       0616 FACTOR:
052D A0 9C 21              0617 	MOV	AL,[SYM]
0530 3C 01                 0618 	CMP	AL,CONST
0532 74 43                 0619 	JZ	FACTORUDRET
0534 3C 00                 0620 	CMP	AL,UNDEFID
0536 74 5C                 0621 	JZ	UVAL
0538 3C 28                 0622 	CMP	AL,"("
053A 74 48                 0623 	JZ	PAREN
053C 3C 22                 0624 	CMP	AL,'"'
053E 74 66                 0625 	JZ	STRING
0540 3C 27                 0626 	CMP	AL,"'"
0542 74 62                 0627 	JZ	STRING
0544 3C 03                 0628 	CMP	AL,XREG		;Only 16-bit register may index
0546 B1 14                 0629 	MOV	CL,20
0548 75 1F                 0630 	JNZ	ERR2
054A F6 C4 01              0631 	TEST	AH,1		;Check to see if indexing is OK
054D B1 01                 0632 	MOV	CL,1
054F 74 18                 0633 	JZ	ERR2
0551 8A C2                 0634 	MOV	AL,DL
0553 B1 03                 0635 	MOV	CL,3
0555 2C 03                 0636 	SUB	AL,3		;Check for BX
0557 74 22                 0637 	JZ	BXJ
0559 2C 02                 0638 	SUB	AL,2		;Check for BP
055B 74 1B                 0639 	JZ	BPJ
055D FE C8                 0640 	DEC	AL		;Check for SI
055F B1 04                 0641 	MOV	CL,4
0561 74 0C                 0642 	JZ	SIJ
0563 FE C8                 0643 	DEC	AL		;Check for DI
0565 74 05                 0644 	JZ	DIJ
0567 B1 02                 0645 	MOV	CL,2		;Invalid base/index register
0569 E9 47 FD              0646 ERR2:	JMP	ERROR
056C                       0647 DIJ:
056C 80 CC 20              0648 	OR	AH,20H		;Flag seeing index register DI
056F                       0649 SIJ:
056F F6 C4 10              0650 	TEST	AH,10H		;Check if already seen index register
0572 75 F5                 0651 	JNZ	ERR2
0574 80 CC 10              0652 	OR	AH,10H		;Flag seeing index register
0577                       0653 FACTORUDRET:
0577 C3                    0654 	RET
0578                       0655 
0578                       0656 BPJ:
0578 80 CC 40              0657 	OR	AH,40H		;Flag seeing base register BP
057B                       0658 BXJ:
057B F6 C4 80              0659 	TEST	AH,80H		;Check if already seen base register
057E 75 E9                 0660 	JNZ	ERR2
0580 80 CC 80              0661 	OR	AH,80H		;Flag seeing base register
0583 C3                    0662 	RET
0584                       0663 
0584                       0664 PAREN:
0584 E8 7D 00              0665 	CALL	GETSYM		;Eat the "("
0587 E8 12 FF              0666 	CALL	EXPRESSION
058A 83 3E 9C 21 29        0667 	CMP	[SYM],")"	;Better have closing paren
058F B1 14                 0668 	MOV	CL,20
0591 75 10                 0669 	JNZ	ERR30
0593 C3                    0670 	RET
0594                       0671 
0594                       0672 UVAL:
0594 B1 06                 0673 	MOV	CL,6
0596 F6 C4 08              0674 	TEST	AH,8		;Check if undefined label has been seen
0599 75 08                 0675 	JNZ	ERR30
059B 80 CC 08              0676 	OR	AH,8		;Flag seeing undefined label
059E 89 1E 48 21           0677 	MOV	[UNDEF],BX
05A2 C3                    0678 	RET
05A3                       0679 
05A3 E9 0D FD              0680 ERR30:	JMP	ERROR
05A6                       0681 
05A6                       0682 STRING:
05A6 8A E8                 0683 	MOV	CH,AL
05A8 A0 9B 21              0684 	MOV	AL,[CHR]
05AB 3A C5                 0685 	CMP	AL,CH
05AD B1 23                 0686 	MOV	CL,35
05AF 8A D0                 0687 	MOV	DL,AL
05B1 B6 00                 0688 	MOV	DH,0
05B3 75 03                 0689 	JNZ	L0003
05B5 E8 32 00              0690 	CALL	ZERLEN
05B8                       0691 L0003:
05B8 E8 37 00              0692 	CALL	GETCHR
05BB B1 25                 0693 	MOV	CL,37
05BD F6 C4 02              0694 	TEST	AH,2
05C0 74 E1                 0695 	JZ	ERR30
05C2 F6 C4 04              0696 	TEST	AH,4
05C5 B1 26                 0697 	MOV	CL,38
05C7 75 DA                 0698 	JNZ	ERR30
05C9                       0699 STRGDAT:
05C9 8A C2                 0700 	MOV	AL,DL
05CB 3C 0D                 0701 	CMP	AL,EOL
05CD B1 27                 0702 	MOV	CL,39
05CF 74 D2                 0703 	JZ	ERR30
05D1 E8 D2 05              0704 	CALL	PUT
05D4 A0 A5 21              0705 	MOV	AL,[DATSIZ]
05D7 0A C0                 0706 	OR	AL,AL
05D9 75 05                 0707 	JNZ	BYTSIZ
05DB 8A C6                 0708 	MOV	AL,DH
05DD E8 C6 05              0709 	CALL	PUT
05E0                       0710 BYTSIZ:
05E0 A0 9B 21              0711 	MOV	AL,[CHR]
05E3 8A D0                 0712 	MOV	DL,AL
05E5 E8 0A 00              0713 	CALL	GETCHR
05E8 EB DF                 0714 	JMPS	STRGDAT
05EA                       0715 
05EA                       0716 ZERLEN:
05EA E8 CB FC              0717 	CALL	NEXTCHR
05ED 3A C5                 0718 	CMP	AL,CH
05EF 75 B2                 0719 	JNZ	ERR30
05F1 C3                    0720 	RET
05F2                       0721 
05F2                       0722 GETCHR:
05F2 E8 C3 FC              0723 	CALL	NEXTCHR
05F5 3A C5                 0724 	CMP	AL,CH
05F7 75 0A                 0725 	JNZ	GETCHRUDRET
05F9 E8 BC FC              0726 	CALL	NEXTCHR
05FC 3A C5                 0727 	CMP	AL,CH
05FE 74 03                 0728 	JZ	GETCHRUDRET
0600 5B                    0729 	POP	BX		;Kill return address to STRGDAT loop
0601 B0 FF                 0730 	MOV	AL,-1		;Flag type as constant
0603                       0731 GETCHRUDRET:
0603 C3                    0732 	RET
0604                       0733 
0604                       0734 GETSYM:
0604                       0735 
0604                       0736 ; The lexical scanner. Used only in the operand field. Returns with the token
0604                       0737 ; in SYM and AL, sometimes with additional info in BX or DX.
0604                       0738 ;
0604                       0739 ; AL=SYM=0  Undefined label. BX has pointer to information fields.
0604                       0740 ;
0604                       0741 ; AL=SYM=1  Constant (or defined label). DX has value.
0604                       0742 ;
0604                       0743 ; AL=SYM=2,3,4  8-bit register, 16-bit register, or segment register,
0604                       0744 ; respectively. DL has register number.
0604                       0745 ;
0604                       0746 ; AL=SYM=5  A mode flag (such as "B" for byte operation). Type of flag in DL
0604                       0747 ; and also stored in FLAG: -1=no flags, 0=B, 1=W, 2=S, 3=L, 4=T.
0604                       0748 ;
0604                       0749 ; AL=SYM=6  8087 floating point register, ST(n) or ST. DL has register number.
0604                       0750 ;
0604                       0751 ; All other values are the ASCII code of the character. Note that this may
0604                       0752 ; never be a letter or number.
0604                       0753 
0604 50                    0754 	PUSH	AX		;Save AH
0605 E8 21 00              0755 	CALL	GETSY
0608 58                    0756 	POP	AX
0609 A0 9C 21              0757 	MOV	AL,[SYM]
060C                       0758 SCANBUDRET:
060C C3                    0759 	RET
060D                       0760 
060D                       0761 SCANB:
060D A0 9B 21              0762 	MOV	AL,[CHR]
0610                       0763 SCANT:
0610 3C 20                 0764 	CMP	AL,' '
0612 74 04                 0765 	JZ	NEXB
0614 3C 09                 0766 	CMP	AL,9
0616 75 F4                 0767 	JNZ	SCANBUDRET
0618                       0768 NEXB:
0618 E8 9D FC              0769 	CALL	NEXTCHR
061B EB F3                 0770 	JMPS	SCANT
061D                       0771 DOLLAR:
061D 8B 16 38 21           0772 	MOV	DX,[OLDPC]
0621 B0 01                 0773 	MOV	AL,CONST
0623 A2 9C 21              0774 	MOV	[SYM],AL
0626                       0775 NEXTCHJ:
0626 E9 8F FC              0776 	JMP	NEXTCHR
0629                       0777 
0629                       0778 GETSY:
0629 E8 E1 FF              0779 	CALL	SCANB
062C 3C 24                 0780 	CMP	AL,'$'
062E 74 ED                 0781 	JZ	DOLLAR
0630 A2 9C 21              0782 	MOV	[SYM],AL
0633 0C 20                 0783 	OR	AL,20H
0635 3C 7B                 0784 	CMP	AL,'z'+1
0637 73 ED                 0785 	JNC	NEXTCHJ
0639 3C 61                 0786 	CMP	AL,'a'
063B 72 03                 0787 	JC	$+5
063D E9 C0 00              0788 	JMP	LETTER
0640 3C 3A                 0789 	CMP	AL,'9'+1
0642 73 E2                 0790 	JNC	NEXTCHJ
0644 3C 30                 0791 	CMP	AL,'0'
0646 72 DE                 0792 	JC	NEXTCHJ
0648 BB 9C 21              0793 	MOV	BX,SYM
064B C7 07 01 00           0794 	MOV	[BX],CONST
064F E8 83 00              0795 	CALL	READID
0652 4B                    0796 	DEC	BX
0653 8A 07                 0797 	MOV	AL,[BX]
0655 B1 07                 0798 	MOV	CL,7
0657 BB 00 00              0799 	MOV	BX,0
065A 3C 68                 0800 	CMP	AL,'h'
065C 75 03                 0801 	JNZ	$+5
065E E9 32 00              0802 	JMP	HEX
0661 FE C1                 0803 	INC	CL
0663 C7 06 C2 21 4B 21     0804 	MOV	[IX],ID
0669                       0805 DEC:
0669 8B 36 C2 21           0806 	MOV	SI,[IX]
066D 8A 04                 0807 	MOV	AL,[SI]
066F FF 06 C2 21           0808 	INC	[IX]
0673 3C 3A                 0809 	CMP	AL,'9'+1
0675 72 03                 0810 	JC	$+5
0677 E9 39 FC              0811 	JMP	ERROR
067A 2C 30                 0812 	SUB	AL,'0'
067C 8B D3                 0813 	MOV	DX,BX
067E D1 E3                 0814 	SHL	BX
0680 D1 E3                 0815 	SHL	BX
0682 03 DA                 0816 	ADD	BX,DX
0684 D1 E3                 0817 	SHL	BX
0686 8A D0                 0818 	MOV	DL,AL
0688 B6 00                 0819 	MOV	DH,0
068A 03 DA                 0820 	ADD	BX,DX
068C FE CD                 0821 	DEC	CH
068E 75 D9                 0822 	JNZ	DEC
0690 87 DA                 0823 	XCHG	DX,BX
0692 C3                    0824 	RET
0693                       0825 
0693                       0826 HEX:
0693 BA 4B 21              0827 	MOV	DX,ID
0696 FE CD                 0828 	DEC	CH
0698                       0829 HEX1:
0698 8B F2                 0830 	MOV	SI,DX
069A AC                    0831 	LODSB
069B 42                    0832 	INC	DX
069C 2C 30                 0833 	SUB	AL,'0'
069E 3C 0A                 0834 	CMP	AL,10
06A0 72 06                 0835 	JC	GOTIT
06A2 3C 37                 0836 	CMP	AL,'g'-'0'
06A4 73 13                 0837 	JNC	ERR4
06A6 2C 27                 0838 	SUB	AL,'a'-10-'0'
06A8                       0839 GOTIT:
06A8 D1 E3                 0840 	SHL	BX
06AA D1 E3                 0841 	SHL	BX
06AC D1 E3                 0842 	SHL	BX
06AE D1 E3                 0843 	SHL	BX
06B0 02 D8                 0844 	ADD	BL,AL
06B2 FE CD                 0845 	DEC	CH
06B4 75 E2                 0846 	JNZ	HEX1
06B6 87 DA                 0847 	XCHG	DX,BX
06B8 C3                    0848 	RET
06B9                       0849 
06B9 E9 F7 FB              0850 ERR4:	JMP	ERROR
06BC                       0851 
06BC                       0852 GETLET:
06BC E8 4E FF              0853 	CALL	SCANB
06BF 3C 0D                 0854 	CMP	AL,EOL
06C1 F9                    0855 	STC
06C2 74 3B                 0856 	JZ	GETLETUDRET
06C4 3C 3B                 0857 	CMP	AL,';'
06C6 F9                    0858 	STC
06C7 74 36                 0859 	JZ	GETLETUDRET
06C9 B1 0A                 0860 	MOV	CL,10
06CB 0C 20                 0861 	OR	AL,20H
06CD 3C 61                 0862 	CMP	AL,'a'
06CF 72 E8                 0863 	JC	ERR4
06D1 3C 7B                 0864 	CMP	AL,'z'+1
06D3 73 E4                 0865 	JNC	ERR4
06D5                       0866 READID:
06D5 BB 4B 21              0867 	MOV	BX,ID
06D8 B5 00                 0868 	MOV	CH,0
06DA                       0869 MOREID:
06DA 88 07                 0870 	MOV	[BX],AL
06DC FE C5                 0871 	INC	CH
06DE 43                    0872 	INC	BX
06DF E8 D6 FB              0873 	CALL	NEXTCHR
06E2 3C 30                 0874 	CMP	AL,'0'
06E4 72 0E                 0875 	JC	NOMORE
06E6 0C 20                 0876 	OR	AL,20H
06E8 3C 7B                 0877 	CMP	AL,'z'+1
06EA 73 08                 0878 	JNC	NOMORE
06EC 3C 3A                 0879 	CMP	AL,'9'+1
06EE 72 EA                 0880 	JC	MOREID
06F0 3C 61                 0881 	CMP	AL,'a'
06F2 73 E6                 0882 	JNC	MOREID
06F4                       0883 NOMORE:
06F4 8A C8                 0884 	MOV	CL,AL
06F6 8A C5                 0885 	MOV	AL,CH
06F8 A2 4A 21              0886 	MOV	[LENID],AL
06FB 0A C0                 0887 	OR	AL,AL
06FD 8A C1                 0888 	MOV	AL,CL
06FF                       0889 GETLETUDRET:
06FF C3                    0890 	RET
0700                       0891 LETTER:
0700 E8 D2 FF              0892 	CALL	READID
0703 8A C5                 0893 	MOV	AL,CH
0705 FE C8                 0894 	DEC	AL
0707 75 14                 0895 	JNZ	NOFLG
0709 A0 4B 21              0896 	MOV	AL,[ID]
070C B9 05 00              0897 	MOV	CX,5
070F BF 43 07              0898 	MOV	DI,FLGTAB
0712 FC                    0899 	CLD
0713 F2                    0900 	REPNE
0714 AE                    0901 	SCASB			;See if one of B,W,S,L,T
0715 74 1A                 0902 	JZ	SAVFLG		;Go save flag
0717 32 C0                 0903 	XOR	AL,AL
0719 8A 2E 4A 21           0904 	MOV	CH,[LENID]
071D                       0905 NOFLG:
071D FE C8                 0906 	DEC	AL
071F 53                    0907 	PUSH	BX
0720 75 03                 0908 	JNZ	L0004
0722 E8 5A 00              0909 	CALL	REGCHK
0725                       0910 L0004:	
0725 5B                    0911 	POP	BX
0726 8A C6                 0912 	MOV	AL,DH
0728 74 03                 0913 	JZ	SYMSAV
072A E8 F9 00              0914 	CALL	LOOKRET
072D                       0915 SYMSAV:
072D A2 9C 21              0916 	MOV	[SYM],AL
0730 C3                    0917 	RET
0731                       0918 
0731                       0919 SAVFLG:
0731 8A D1                 0920 	MOV	DL,CL		;Need flag type in DL
0733 86 0E 3C 21           0921 	XCHG	[FLAG],CL
0737 82 F9 FF              0922 	CMP	CL,-1
073A B1 20                 0923 	MOV	CL,32
073C B0 05                 0924 	MOV	AL,5
073E 74 ED                 0925 	JZ	SYMSAV
0740 E9 70 FB              0926 ERRJ3:	JMP	ERROR
0743                       0927 
0743 74 6C 73 77 62        0928 FLGTAB:	DB	"tlswb"
0748                       0929 
0748                       0930 FPREG:
0748                       0931 ;Have detected "ST" for 8087 floating point stack register
0748 B2 00                 0932 	MOV	DL,0		;Default is ST(0)
074A E8 C0 FE              0933 	CALL	SCANB		;Get next character
074D 3C 28                 0934 	CMP	AL,"("		;Specifying register number?
074F 75 29                 0935 	JNZ	HAVREG
0751                       0936 ;Get register number
0751 E8 64 FB              0937 	CALL	NEXTCHR		;Skip over the "("
0754 E8 73 FC              0938 	CALL	GETOP		;A little recursion never hurt anybody
0757 3C 01                 0939 	CMP	AL,CONST	;Better have found a constant
0759 B1 14                 0940 	MOV	CL,20		;Operand error if not
075B 75 E3                 0941 	JNZ	ERRJ3
075D 83 3E 44 21 00        0942 	CMP	[DLABEL],0	;Constant must be defined
0762 B1 1E                 0943 	MOV	CL,30
0764 75 DA                 0944 	JNZ	ERRJ3
0766 8B 16 42 21           0945 	MOV	DX,[DATA]	;Get constant
076A 83 FA 07              0946 	CMP	DX,7		;Constant must be in range 0-7
076D B1 1F                 0947 	MOV	CL,31
076F 77 CF                 0948 	JA	ERRJ3
0771 A0 9C 21              0949 	MOV	AL,[SYM]
0774 3C 29                 0950 	CMP	AL,")"
0776 B1 18                 0951 	MOV	CL,24
0778 75 C6                 0952 	JNZ	ERRJ3
077A                       0953 HAVREG:
077A B6 06                 0954 	MOV	DH,FREG
077C 32 C0                 0955 	XOR	AL,AL		;Zero set means register found
077E C3                    0956 	RET
077F                       0957 
077F                       0958 REGCHK:
077F BB 4B 21              0959 	MOV	BX,ID
0782 81 3F 73 74           0960 	CMP	[BX],"s"+7400H	;"st"
0786 74 C0                 0961 	JZ	FPREG
0788 8A 0F                 0962 	MOV	CL,[BX]
078A 43                    0963 	INC	BX
078B 8A 07                 0964 	MOV	AL,[BX]
078D BB EA 07              0965 	MOV	BX,REGTAB
0790 B6 03                 0966 	MOV	DH,XREG
0792 B2 00                 0967 	MOV	DL,0
0794 3C 78                 0968 	CMP	AL,'x'
0796 74 3B                 0969 	JZ	SCANREG
0798 B6 02                 0970 	MOV	DH,REG
079A 3C 6C                 0971 	CMP	AL,'l'
079C 74 35                 0972 	JZ	SCANREG
079E B2 04                 0973 	MOV	DL,4
07A0 3C 68                 0974 	CMP	AL,'h'
07A2 74 2F                 0975 	JZ	SCANREG
07A4 B6 04                 0976 	MOV	DH,SREG
07A6 B2 00                 0977 	MOV	DL,0
07A8 BB EE 07              0978 	MOV	BX,SEGTAB
07AB 3C 73                 0979 	CMP	AL,'s'
07AD 74 24                 0980 	JZ	SCANREG
07AF B6 03                 0981 	MOV	DH,XREG
07B1 3C 70                 0982 	CMP	AL,'p'
07B3 74 11                 0983 	JZ	PREG
07B5 3C 69                 0984 	CMP	AL,'i'
07B7 75 0C                 0985 	JNZ	REGCHKUDRET
07B9 B2 06                 0986 	MOV	DL,6
07BB 8A C1                 0987 	MOV	AL,CL
07BD 3C 73                 0988 	CMP	AL,'s'
07BF 74 04                 0989 	JZ	REGCHKUDRET
07C1 FE C2                 0990 	INC	DL
07C3 3C 64                 0991 	CMP	AL,'d'
07C5                       0992 REGCHKUDRET:
07C5 C3                    0993 	RET
07C6                       0994 PREG:
07C6 B2 04                 0995 	MOV	DL,4
07C8 8A C1                 0996 	MOV	AL,CL
07CA 3C 73                 0997 	CMP	AL,'s'
07CC 74 04                 0998 	JZ	PREGUDRET
07CE FE C2                 0999 	INC	DL
07D0 3C 62                 1000 	CMP	AL,'b'
07D2                       1001 PREGUDRET:
07D2 C3                    1002 	RET
07D3                       1003 SCANREG:
07D3 8A C1                 1004 	MOV	AL,CL
07D5 B9 04 00              1005 	MOV	CX,4
07D8 FC                    1006 	CLD
07D9 8B FB                 1007 	MOV	DI,BX
07DB F2                    1008 	REPNZ
07DC AE                    1009 	SCASB
07DD 8B DF                 1010 	MOV	BX,DI
07DF 75 08                 1011 	JNZ	SCANREGUDRET
07E1 8A C1                 1012 	MOV	AL,CL
07E3 02 C2                 1013 	ADD	AL,DL
07E5 8A D0                 1014 	MOV	DL,AL
07E7 32 C0                 1015 	XOR	AL,AL
07E9                       1016 SCANREGUDRET:
07E9                       1017 LOOKUDRET:
07E9 C3                    1018 	RET
07EA 62 64 63 61           1019 REGTAB:	DB	'bdca'
07EE                       1020 
07EE 64 73 63 65           1021 SEGTAB:	DB	'dsce'
07F2                       1022 
07F2                       1023 LOOK:
07F2 8A 2F                 1024 	MOV	CH,[BX]
07F4 43                    1025 	INC	BX
07F5 BA 4B 21              1026 	MOV	DX,ID
07F8 E8 FC 00              1027 	CALL	CPSLP
07FB 74 EC                 1028 	JZ	LOOKUDRET
07FD 34 80                 1029 	XOR	AL,80H
07FF D0 C0                 1030 	ROL	AL		;Make end-of-symbol bit least significant
0801 8A C8                 1031 	MOV	CL,AL
0803 4B                    1032 	DEC	BX
0804 8A 07                 1033 	MOV	AL,[BX]
0806 34 80                 1034 	XOR	AL,80H
0808 D0 C0                 1035 	ROL	AL
080A 3A C1                 1036 	CMP	AL,CL
080C 73 04                 1037 	JNC	SMALL
080E FE C5                 1038 	INC	CH
0810 FE C5                 1039 	INC	CH
0812                       1040 SMALL:
0812 8A D5                 1041 	MOV	DL,CH
0814 B6 00                 1042 	MOV	DH,0
0816 03 DA                 1043 	ADD	BX,DX
0818 8B 17                 1044 	MOV	DX,[BX]
081A 43                    1045 	INC	BX
081B 8A C2                 1046 	MOV	AL,DL
081D 0A C6                 1047 	OR	AL,DH
081F F9                    1048 	STC
0820 74 C7                 1049 	JZ	LOOKUDRET
0822 87 DA                 1050 	XCHG	DX,BX
0824 EB CC                 1051 	JMPS	LOOK
0826                       1052 LOOKRET:
0826 8A C5                 1053 	MOV	AL,CH
0828 3C 03                 1054 	CMP	AL,3	;RET has 3 letters
082A 75 50                 1055 	JNZ	LOOKUP
082C 4B                    1056 	DEC	BX
082D 81 0F 80 00           1057 	OR	[BX],080H
0831 BA EB 20              1058 	MOV	DX,RETSTR+2
0834                       1059 CHKRET:
0834 8B F2                 1060 	MOV	SI,DX
0836 AC                    1061 	LODSB
0837 3A 07                 1062 	CMP	AL,[BX]
0839 75 46                 1063 	JNZ	LOOKIT
083B 4B                    1064 	DEC	BX
083C 4A                    1065 	DEC	DX
083D FE CD                 1066 	DEC	CH
083F 75 F3                 1067 	JNZ	CHKRET
0841 8B 16 BA 21           1068 	MOV	DX,[LSTRET]
0845 8A C2                 1069 	MOV	AL,DL
0847 22 C6                 1070 	AND	AL,DH
0849 FE C0                 1071 	INC	AL
084B 74 0F                 1072 	JZ	ALLRET
084D 8B 1E 36 21           1073 	MOV	BX,[PC]
0851 2B DA                 1074 	SUB	BX,DX
0853 8A C3                 1075 	MOV	AL,BL
0855 98                    1076 	CBW
0856 3B C3                 1077 	CMP	AX,BX		;Signed 8-bit number?
0858 B0 01                 1078 	MOV	AL,1
085A 74 1F                 1079 	JZ	CHKRETUDRET
085C                       1080 ALLRET:
085C 8B 1E BC 21           1081 	MOV	BX,[RETPT]
0860 8A C7                 1082 	MOV	AL,BH
0862 0A C3                 1083 	OR	AL,BL
0864 B0 00                 1084 	MOV	AL,0
0866 75 13                 1085 	JNZ	CHKRETUDRET
0868 8B 1E 9F 21           1086 	MOV	BX,[HEAP]
086C 4B                    1087 	DEC	BX
086D 4B                    1088 	DEC	BX
086E 4B                    1089 	DEC	BX
086F 89 1E 9F 21           1090 	MOV	[HEAP],BX
0873 32 C0                 1091 	XOR	AL,AL
0875 88 07                 1092 	MOV	[BX],AL
0877 89 1E BC 21           1093 	MOV	[RETPT],BX
087B                       1094 CHKRETUDRET:
087B C3                    1095 	RET
087C                       1096 LOOKUP:
087C 4B                    1097 	DEC	BX
087D 81 0F 80 00           1098 	OR	[BX],080H
0881                       1099 LOOKIT:
0881 8B 1E 9D 21           1100 	MOV	BX,[BASE]
0885 8A C7                 1101 	MOV	AL,BH
0887 0A C3                 1102 	OR	AL,BL
0889 74 1E                 1103 	JZ	EMPTY
088B E8 64 FF              1104 	CALL	LOOK
088E 72 10                 1105 	JC	ENTER
0890 BA 04 00              1106 	MOV	DX,4
0893 03 DA                 1107 	ADD	BX,DX
0895 8A 07                 1108 	MOV	AL,[BX]
0897 0A C0                 1109 	OR	AL,AL
0899 74 04                 1110 	JZ	LOOKITUDRET
089B 43                    1111 	INC	BX
089C 8B 17                 1112 	MOV	DX,[BX]
089E 43                    1113 	INC	BX
089F                       1114 LOOKITUDRET:
089F C3                    1115 	RET
08A0                       1116 ENTER:
08A0 53                    1117 	PUSH	BX		;Save pointer to link field
08A1 E8 0D 00              1118 	CALL	CREATE		;Add the node
08A4 5E                    1119 	POP	SI
08A5 89 54 FF              1120 	MOV	[SI-1],DX	;Link new node
08A8 C3                    1121 	RET			;Zero was set by CREATE
08A9                       1122 
08A9                       1123 EMPTY:
08A9 E8 05 00              1124 	CALL	CREATE
08AC 89 16 9D 21           1125 	MOV	[BASE],DX
08B0 C3                    1126 	RET
08B1                       1127 
08B1                       1128 
08B1                       1129 CREATE:
08B1                       1130 
08B1                       1131 ; Add a new node to the identifier tree. The identifier is at ID with
08B1                       1132 ; bit 7 of the last character set to one. The length of the identifier is
08B1                       1133 ; in LENID, which is ID-1.
08B1                       1134 ;
08B1                       1135 ; Node format:
08B1                       1136 ;	1. Length of identifier (1 byte)
08B1                       1137 ;	2. Identifier (1-80 bytes)
08B1                       1138 ;	3. Left link (2-byte pointer to alphabetically smaller identifiers)
08B1                       1139 ;	4. Right link (0 if none larger)
08B1                       1140 ;	5. Data field:
08B1                       1141 ;	   a. Defined flag (0=undefined, 1=defined)
08B1                       1142 ;	   b. Value (2 bytes)
08B1                       1143 ;
08B1                       1144 ; This routine returns with AL=zero and zero flag set (which indicates
08B1                       1145 ; on return from LOOKUP that it has not yet been defined), DX points
08B1                       1146 ; to start of new node, and BX points to data field of new node.
08B1                       1147 
08B1 A0 4A 21              1148 	MOV	AL,[LENID]
08B4 04 08                 1149 	ADD	AL,8		;Storage needed for the node
08B6 8B 1E 9F 21           1150 	MOV	BX,[HEAP]
08BA 8A D0                 1151 	MOV	DL,AL
08BC B6 00                 1152 	MOV	DH,0
08BE 2B DA                 1153 	SUB	BX,DX		;Heap grows downward
08C0 89 1E 9F 21           1154 	MOV	[HEAP],BX
08C4 87 DA                 1155 	XCHG	DX,BX
08C6 8B 1E A3 21           1156 	MOV	BX,[CODE]	;Check to make sure there's enough
08CA 3B DA                 1157 	CMP	BX,DX
08CC 72 03                 1158 	JB	$+5
08CE E9 A3 F9              1159 	JMP	ABORT
08D1 52                    1160 	PUSH	DX
08D2 BB 4A 21              1161 	MOV	BX,LENID
08D5 8A 0F                 1162 	MOV	CL,[BX]
08D7 FE C1                 1163 	INC	CL
08D9 B5 00                 1164 	MOV	CH,0
08DB FC                    1165 	CLD
08DC 8B F3                 1166 	MOV	SI,BX
08DE 8B FA                 1167 	MOV	DI,DX
08E0 F3                    1168 	REP
08E1 A4                    1169 	MOVSB			;Move identifier and length into node
08E2 8B D7                 1170 	MOV	DX,DI
08E4 8B DE                 1171 	MOV	BX,SI
08E6 B5 04                 1172 	MOV	CH,4
08E8 87 DA                 1173 	XCHG	DX,BX
08EA                       1174 NILIFY:
08EA 88 0F                 1175 	MOV	[BX],CL		;Zero left and right links
08EC 43                    1176 	INC	BX
08ED FE CD                 1177 	DEC	CH
08EF 75 F9                 1178 	JNZ	NILIFY
08F1 32 C0                 1179 	XOR	AL,AL		;Set zero flag
08F3 88 07                 1180 	MOV	[BX],AL		;Zero defined flag
08F5 5A                    1181 	POP	DX		;Restore pointer to node
08F6 C3                    1182 	RET
08F7                       1183 
08F7                       1184 CPSLP:
08F7 8B F2                 1185 	MOV	SI,DX
08F9 AC                    1186 	LODSB
08FA 3A 07                 1187 	CMP	AL,[BX]
08FC 9F                    1188 	LAHF
08FD 42                    1189 	INC	DX
08FE 43                    1190 	INC	BX
08FF 9E                    1191 	SAHF
0900 75 04                 1192 	JNZ	CPSLPUDRET
0902 FE CD                 1193 	DEC	CH
0904 75 F1                 1194 	JNZ	CPSLP
0906                       1195 CPSLPUDRET:
0906                       1196 GETLABUDRET:
0906 C3                    1197 	RET
0907                       1198 GETLAB:
0907 BB 00 00              1199 	MOV	BX,0
090A 89 1E 3A 21           1200 	MOV	[LABPT],BX
090E C7 06 3C 21 FF FF     1201 	MOV	[FLAG],-1
0914 B6 00                 1202 	MOV	DH,0
0916 A0 9B 21              1203 	MOV	AL,[CHR]
0919 3C 21                 1204 	CMP	AL,' '+1
091B 72 03                 1205 	JC	NOT1
091D 80 CE 01              1206 	OR	DH,001H
0920                       1207 NOT1:
0920 E8 99 FD              1208 	CALL	GETLET
0923 72 E1                 1209 	JC	GETLABUDRET
0925 3C 3A                 1210 	CMP	AL,':'
0927 75 05                 1211 	JNZ	LABCHK
0929 E8 8C F9              1212 	CALL	NEXTCHR
092C EB 07                 1213 	JMPS	LABEL
092E                       1214 LABCHK:
092E 0A C0                 1215 	OR	AL,AL
0930 F6 C6 01              1216 	TEST	DH,001H
0933 74 D1                 1217 	JZ	GETLABUDRET
0935                       1218 LABEL:
0935 A0 B7 21              1219 	MOV	AL,[CHKLAB]
0938 0A C0                 1220 	OR	AL,AL
093A 74 03                 1221 	JZ	$+5
093C E9 7D FD              1222 	JMP	GETLET
093F E8 3A FF              1223 	CALL	LOOKUP
0942 B1 0B                 1224 	MOV	CL,11
0944 75 12                 1225 	JNZ	ERR5
0946 8B 16 36 21           1226 	MOV	DX,[PC]
094A C7 07 01 00           1227 	MOV	[BX],1
094E 43                    1228 	INC	BX
094F 89 17                 1229 	MOV	[BX],DX
0951 89 1E 3A 21           1230 	MOV	[LABPT],BX
0955 E9 64 FD              1231 	JMP	GETLET
0958                       1232 
0958 E9 58 F9              1233 ERR5:	JMP	ERROR
095B                       1234 ASMLIN:
095B C7 06 3D 21 01 00     1235 	MOV	[MAXFLG],1	;Allow only B and W flags normally
0961 8B 1E 36 21           1236 	MOV	BX,[PC]
0965 89 1E 38 21           1237 	MOV	[OLDPC],BX
0969 E8 9B FF              1238 	CALL	GETLAB
096C 73 03                 1239 	JNC	$+5
096E E9 E1 F8              1240 	JMP	ENDLN
0971 BB 4A 21              1241 	MOV	BX,LENID
0974 8A 07                 1242 	MOV	AL,[BX]
0976 B1 0C                 1243 	MOV	CL,12
0978 2C 02                 1244 	SUB	AL,2
097A 8A E8                 1245 	MOV	CH,AL
097C 72 DA                 1246 	JC	ERR5
097E 43                    1247 	INC	BX
097F 83 3F 66              1248 	CMP	[BX],"f"	;See if an 8087 mnemonic
0982 74 4C                 1249 	JZ	NDPOP
0984 3C 05                 1250 	CMP	AL,5
0986 73 D0                 1251 	JNC	ERR5
0988 8A 07                 1252 	MOV	AL,[BX]
098A 2C 61                 1253 	SUB	AL,'a'
098C 8A C8                 1254 	MOV	CL,AL
098E 02 C0                 1255 	ADD	AL,AL
0990 02 C0                 1256 	ADD	AL,AL
0992 02 C1                 1257 	ADD	AL,CL
0994 02 C5                 1258 	ADD	AL,CH
0996 02 C0                 1259 	ADD	AL,AL
0998 BB 11 1B              1260 	MOV	BX,OPTAB
099B 8A D0                 1261 	MOV	DL,AL
099D B6 00                 1262 	MOV	DH,0
099F 03 DA                 1263 	ADD	BX,DX
09A1 8B 1F                 1264 	MOV	BX,[BX]
09A3 FE C5                 1265 	INC	CH
09A5 8A CD                 1266 	MOV	CL,CH
09A7 8A 27                 1267 	MOV	AH,[BX]
09A9 43                    1268 	INC	BX
09AA 0A E4                 1269 	OR	AH,AH
09AC 74 18                 1270 	JZ	OPERR
09AE                       1271 FINDOP:
09AE 8A E9                 1272 	MOV	CH,CL
09B0 BA 4C 21              1273 	MOV	DX,ID+1
09B3 95                    1274 	XCHG	AX,BP		;Save count of opcodes in BP
09B4 E8 40 FF              1275 	CALL	CPSLP
09B7 74 12                 1276 	JZ	HAVOP
09B9 95                    1277 	XCHG	AX,BP
09BA B6 00                 1278 	MOV	DH,0
09BC 8A D5                 1279 	MOV	DL,CH
09BE 42                    1280 	INC	DX
09BF 42                    1281 	INC	DX
09C0 03 DA                 1282 	ADD	BX,DX
09C2 FE CC                 1283 	DEC	AH
09C4 75 E8                 1284 	JNZ	FINDOP
09C6                       1285 OPERR:
09C6 B1 0C                 1286 	MOV	CL,12
09C8 E9 E8 F8              1287 	JMP	ERROR
09CB                       1288 
09CB                       1289 HAVOP:
09CB 8A 47 02              1290 	MOV	AL,[BX+2]	;Get opcode
09CE FF 27                 1291 	JMP	[BX]
09D0                       1292 
09D0                       1293 NDPOP:	;First letter is "F" so must be 8087 opcode ("Numeric Data Processor")
09D0 C7 06 3D 21 04 00     1294 	MOV	[MAXFLG],4	;Allow all type flags
09D6 43                    1295 	INC	BX
09D7 83 3F 6E              1296 	CMP	[BX],"n"	;"No-wait" form?
09DA B4 00                 1297 	MOV	AH,0
09DC 75 05                 1298 	JNZ	SAVNFLG
09DE B4 01                 1299 	MOV	AH,1
09E0 FE C8                 1300 	DEC	AL
09E2 43                    1301 	INC	BX		;Skip over the "N"
09E3                       1302 SAVNFLG:
09E3 88 26 C1 21           1303 	MOV	[NOWAIT],AH	;0 for wait, 1 for no wait
09E7 3C 01                 1304 	CMP	AL,1
09E9 72 DB                 1305 	JB	OPERR		;Not enough char left for valid opcode?
09EB 3C 05                 1306 	CMP	AL,5
09ED 77 D7                 1307 	JA	OPERR		;Too many?
09EF 98                    1308 	CBW
09F0 92                    1309 	XCHG	AX,DX		;Save length in DX
09F1 8B F2                 1310 	MOV	SI,DX
09F3 81 08 80 00           1311 	OR	[SI+BX],80H	;Set high bit of last character
09F7 8A 07                 1312 	MOV	AL,[BX]		;Get first char of opcode
09F9 43                    1313 	INC	BX
09FA 2C 61                 1314 	SUB	AL,"a"
09FC 72 28                 1315 	JB	TRY2XM1		;Go see if opcode starts with "2"
09FE 3C 19                 1316 	CMP	AL,"z"-"a"
0A00 77 C4                 1317 	JA	OPERR
0A02 98                    1318 	CBW
0A03 D1 E0                 1319 	SHL	AX		;Double to index into address table
0A05 96                    1320 	XCHG	AX,SI		;Put in index register
0A06 8B BC 15 1C           1321 	MOV	DI,[SI+NDPTAB]	;Get start of opcode table for this letter
0A0A                       1322 LOOKNDP:
0A0A 8A 25                 1323 	MOV	AH,[DI]		;Number of opcodes starting with this letter
0A0C 0A E4                 1324 	OR	AH,AH
0A0E 74 B6                 1325 	JZ	OPERR		;Any start with this letter?
0A10                       1326 FNDNDP:
0A10 47                    1327 	INC	DI
0A11 8B F3                 1328 	MOV	SI,BX		;Pointer to start of opcode
0A13 8B CA                 1329 	MOV	CX,DX		;Get length of opcode
0A15 F3                    1330 	REPE
0A16 A6                    1331 	CMPSB			;Compare opcode to table entry
0A17 74 38                 1332 	JZ	HAVNDP
0A19 4F                    1333 	DEC	DI		;Back up in case that was last letter
0A1A B0 80                 1334 	MOV	AL,80H		;Look for char with high bit set
0A1C                       1335 ENDOP:
0A1C AE                    1336 	SCASB
0A1D 77 FD                 1337 	JA	ENDOP
0A1F 47                    1338 	INC	DI		;Skip over info about opcode
0A20 FE CC                 1339 	DEC	AH
0A22 75 EC                 1340 	JNZ	FNDNDP
0A24 EB A0                 1341 OPERRJ:	JMPS	OPERR
0A26                       1342 
0A26                       1343 TRY2XM1:
0A26 3C D1                 1344 	CMP	AL,"2"-"a"
0A28 75 9C                 1345 	JNZ	OPERR
0A2A BF 9F 19              1346 	MOV	DI,XM1
0A2D EB DB                 1347 	JMPS	LOOKNDP
0A2F                       1348 
0A2F                       1349 SPECIALOP:
0A2F 24 07                 1350 	AND	AL,7		;Mask to special op number
0A31 74 16                 1351 	JZ	FWAIT		;If zero, go handle FWAIT
0A33                       1352 ;Handle FNOP
0A33 83 3E C1 21 00        1353 	CMP	[NOWAIT],0	;Was "N" present (If not opcode was "FOP")
0A38 74 8C                 1354 	JZ	OPERR
0A3A B0 9B                 1355 	MOV	AL,9BH		;Need Wait opcode after all
0A3C E8 67 01              1356 	CALL	PUT
0A3F B0 D9                 1357 	MOV	AL,0D9H
0A41 E8 62 01              1358 	CALL	PUT
0A44 B0 D0                 1359 	MOV	AL,0D0H
0A46 E9 5D 01              1360 	JMP	PUT
0A49                       1361 
0A49                       1362 FWAIT:
0A49 83 3E C1 21 00        1363 	CMP	[NOWAIT],0	;"FNWAIT" not legal
0A4E 75 D4                 1364 	JNZ	OPERRJ
0A50 C3                    1365 	RET			;Nothing to do - "WAIT" already sent
0A51                       1366 
0A51                       1367 HAVNDP:
0A51 8B F7                 1368 	MOV	SI,DI
0A53 83 3E C1 21 00        1369 	CMP	[NOWAIT],0
0A58 75 05                 1370 	JNZ	NWAIT
0A5A B0 9B                 1371 	MOV	AL,9BH		;Wait opcode
0A5C E8 47 01              1372 	CALL	PUT
0A5F                       1373 NWAIT:
0A5F AD                    1374 	LODSW			;Get opcode info
0A60 A8 F8                 1375 	TEST	AL,0F8H		;Any operand bits set?
0A62 74 66                 1376 	JZ	NOOPS		;If no operands, output code
0A64 A8 78                 1377 	TEST	AL,78H		;Special case?
0A66 74 C7                 1378 	JZ	SPECIALOP
0A68 50                    1379 	PUSH	AX
0A69 E8 98 FB              1380 	CALL	GETSYM		;See if any operands
0A6C 59                    1381 	POP	CX
0A6D 3C 3B                 1382 	CMP	AL,";"
0A6F 74 52                 1383 	JZ	NOOPCHK
0A71 3C 0D                 1384 	CMP	AL,EOL
0A73 74 4E                 1385 	JZ	NOOPCHK
0A75 3C 06                 1386 	CMP	AL,FREG		;Is it 8087 register?
0A77 75 6F                 1387 	JNZ	MEMOP
0A79 91                    1388 	XCHG	AX,CX
0A7A A8 40                 1389 	TEST	AL,ONEREG	;One register OK as operand?
0A7C 75 36                 1390 	JNZ	PUTREG		;Yes - save it
0A7E A8 20                 1391 	TEST	AL,20H		;Memory-only operation?
0A80 B1 14                 1392 	MOV	CL,20
0A82 75 61                 1393 	JNZ	ERRJ4
0A84 A8 18                 1394 	TEST	AL,18H		;Two-register operation?
0A86 7A 5D                 1395 	JPE	ERRJ4		;Must be exactly one bit set
0A88 52                    1396 	PUSH	DX		;Save register number
0A89 50                    1397 	PUSH	AX		;Save opcode
0A8A E8 77 FB              1398 	CALL	GETSYM
0A8D 3C 2C                 1399 	CMP	AL,","
0A8F B1 15                 1400 	MOV	CL,15H
0A91 75 52                 1401 	JNZ	ERRJ4
0A93 E8 6E FB              1402 	CALL	GETSYM
0A96 B1 14                 1403 	MOV	CL,20
0A98 3C 06                 1404 	CMP	AL,FREG
0A9A 75 49                 1405 	JNZ	ERRJ4
0A9C 58                    1406 	POP	AX
0A9D 5B                    1407 	POP	BX
0A9E 34 02                 1408 	XOR	AL,2		;Flip "POP" bit
0AA0 24 FB                 1409 	AND	AL,0FBH		;Reset direction bit to ST(0)
0AA2 0A DB                 1410 	OR	BL,BL		;Is first register ST(0)?
0AA4 74 0A                 1411 	JZ	ST0DEST
0AA6 87 DA                 1412 	XCHG	DX,BX
0AA8 0A DB                 1413 	OR	BL,BL		;One of these must be ST(0)
0AAA 75 39                 1414 	JNZ	ERRJ4
0AAC 34 04                 1415 	XOR	AL,4		;Flip direction
0AAE EB 04                 1416 	JMPS	PUTREG
0AB0                       1417 ST0DEST:
0AB0 A8 02                 1418 	TEST	AL,2		;Is POP bit set?
0AB2 75 31                 1419 	JNZ	ERRJ4		;Don't allow destination ST(0) then pop
0AB4                       1420 PUTREG:
0AB4 80 E4 F8              1421 	AND	AH,0F8H		;Zero out register field
0AB7 0A E2                 1422 	OR	AH,DL
0AB9 80 CC C0              1423 	OR	AH,0C0H
0ABC 50                    1424 	PUSH	AX
0ABD E8 44 FB              1425 	CALL	GETSYM		;Get to next symbol
0AC0 58                    1426 	POP	AX
0AC1 EB 07                 1427 	JMPS	NOOPS
0AC3                       1428 
0AC3                       1429 NOOPCHK:
0AC3 91                    1430 	XCHG	AX,CX
0AC4 A8 80                 1431 	TEST	AL,80H		;Is no operands OK?
0AC6 B1 14                 1432 	MOV	CL,20
0AC8 75 1B                 1433 	JNZ	ERRJ4
0ACA                       1434 NOOPS:
0ACA                       1435 ;First test for FDIV or FSUB and reverse "R" bit if "D" bit is set
0ACA 50                    1436 	PUSH	AX
0ACB 25 05 E0              1437 	AND	AX,0E005H
0ACE 3D 04 E0              1438 	CMP	AX,0E004H
0AD1 58                    1439 	POP	AX
0AD2 75 03                 1440 	JNZ	NOREV
0AD4 80 F4 08              1441 	XOR	AH,8		;Reverse "R" bit
0AD7                       1442 NOREV:
0AD7 24 07                 1443 	AND	AL,7
0AD9 0C D8                 1444 	OR	AL,0D8H		;ESC hook
0ADB E8 C8 00              1445 	CALL	PUT
0ADE 8A C4                 1446 	MOV	AL,AH
0AE0 E9 C3 00              1447 	JMP	PUT
0AE3                       1448 
0AE3                       1449 BADFLAG:
0AE3 B1 20                 1450 	MOV	CL,20H
0AE5 E9 CB F7              1451 ERRJ4:	JMP	ERROR
0AE8                       1452 
0AE8                       1453 MEMOP:
0AE8 51                    1454 	PUSH	CX		;Save opcode
0AE9 E8 E1 F8              1455 	CALL	GETOP1		;Get memory operand
0AEC 3C 00                 1456 	CMP	AL,UNDEFID	;Is it?
0AEE B1 14                 1457 	MOV	CL,20
0AF0 75 F3                 1458 	JNZ	ERRJ4
0AF2 58                    1459 	POP	AX
0AF3 A8 20                 1460 	TEST	AL,20H		;Does it have memory format field?
0AF5 75 08                 1461 	JNZ	GETFORMAT
0AF7 A8 08                 1462 	TEST	AL,8		;Check if any memory operand legal
0AF9 74 EA                 1463 	JZ	ERRJ4
0AFB A8 10                 1464 	TEST	AL,10H		;Check for 2-op arithmetic
0AFD 75 1E                 1465 	JNZ	PUTMEM		;If not, just use as plain memory op
0AFF                       1466 GETFORMAT:
0AFF 24 F9                 1467 	AND	AL,0F9H		;Zero memory format bits
0B01 8A 0E 3C 21           1468 	MOV	CL,[FLAG]
0B05 FE C9                 1469 	DEC	CL		;Must now be in range 0-3
0B07 7C DA                 1470 	JL	BADFLAG
0B09 8A E8                 1471 	MOV	CH,AL		;Save opcode byte
0B0B D0 E8                 1472 	SHR	AL		;Put format bits in bits 2 & 3
0B0D 24 0C                 1473 	AND	AL,0CH
0B0F 0A C1                 1474 	OR	AL,CL		;Combine format bits with flag
0B11 BB 2D 0B              1475 	MOV	BX,FORMATTAB
0B14 D7                    1476 	XLAT
0B15 0A C0                 1477 	OR	AL,AL		;Valid combination?
0B17 78 CA                 1478 	JS	BADFLAG
0B19 0A E0                 1479 	OR	AH,AL		;Possibly set new bits in second byte
0B1B 0A C5                 1480 	OR	AL,CH		;Set memory format bits
0B1D                       1481 PUTMEM:
0B1D 24 07                 1482 	AND	AL,7
0B1F 0C D8                 1483 	OR	AL,0D8H
0B21 E8 82 00              1484 	CALL	PUT
0B24 8A C4                 1485 	MOV	AL,AH
0B26 24 38                 1486 	AND	AL,38H
0B28 0A C2                 1487 	OR	AL,DL		;Combine addressing mode
0B2A E9 3B 01              1488 	JMP	PUTADD
0B2D                       1489 
0B2D                       1490 FORMATTAB:
0B2D                       1491 ;There are 16 entries in this table. The 4-bit index is built like this:
0B2D                       1492 ;	Bit 3		0 for normal memory ops, 1 if extended is OK
0B2D                       1493 ;	Bit 2		0 for integer, 1 for real
0B2D                       1494 ;	Bit 0 & 1	Flag: 00=W, 01=S, 10=L, 11=T
0B2D                       1495 ;
0B2D                       1496 ;The entries in the table are used as two 3-bit fields. Bits 0-2 are ORed
0B2D                       1497 ;into the first byte of the opcode for the Memory Format field. Bits 3-6
0B2D                       1498 ;are ORed into the second byte to modify the opcode for extended operands.
0B2D                       1499 ;If bit 7 is set, then that combination is illegal.
0B2D                       1500 
0B2D 06 02 80 80           1501 	DB	6,2,80H,80H	;Normal integers
0B31 80 00 04 80           1502 	DB	80H,0,4,80H	;Normal reals
0B35 06 02 2E 80           1503 	DB	6,2,2EH,80H	;Extended integers
0B39 80 00 04 2B           1504 	DB	80H,0,4,2BH	;Extended reals
0B3D                       1505 
0B3D                       1506 GRP1:
0B3D B9 09 8A              1507 	MOV	CX,8A09H
0B40 E8 AB F7              1508 	CALL	MROPS
0B43 B9 C6 00              1509 	MOV	CX,0C6H
0B46 8A C7                 1510 	MOV	AL,BH
0B48 3C 00                 1511 	CMP	AL,UNDEFID
0B4A 75 03                 1512 	JNZ	L0006
0B4C E8 3C 00              1513 	CALL	STIMM
0B4F                       1514 L0006:	
0B4F 24 01                 1515 	AND	AL,1
0B51 74 0A                 1516 	JZ	BYTIMM
0B53 B0 B8                 1517 	MOV	AL,0B8H
0B55 0A C3                 1518 	OR	AL,BL
0B57 E8 4C 00              1519 	CALL	PUT
0B5A E9 9A 00              1520 	JMP	PUTWOR
0B5D                       1521 
0B5D                       1522 BYTIMM:
0B5D B0 B0                 1523 	MOV	AL,0B0H
0B5F 0A C3                 1524 	OR	AL,BL
0B61 E8 42 00              1525 	CALL	PUT
0B64 E9 97 00              1526 PUTBJ:	JMP	PUTBYT
0B67                       1527 
0B67                       1528 IMMED:
0B67 8A C7                 1529 	MOV	AL,BH
0B69 3C 00                 1530 	CMP	AL,UNDEFID
0B6B 74 1E                 1531 	JZ	STIMM
0B6D 8A C3                 1532 	MOV	AL,BL
0B6F 0A C0                 1533 	OR	AL,AL
0B71 74 32                 1534 	JZ	IMMEDUDRET
0B73 8A C7                 1535 	MOV	AL,BH
0B75 E8 1E 00              1536 	CALL	IMM
0B78 0C C0                 1537 	OR	AL,0C0H
0B7A E8 29 00              1538 	CALL	PUT
0B7D                       1539 FINIMM:
0B7D 8A C1                 1540 	MOV	AL,CL
0B7F 59                    1541 	POP	CX
0B80 A8 01                 1542 	TEST	AL,1
0B82 74 E0                 1543 	JZ	PUTBJ
0B84 3C 83                 1544 	CMP	AL,83H
0B86 74 DC                 1545 	JZ	PUTBJ
0B88 E9 6C 00              1546 	JMP	PUTWOR
0B8B                       1547 STIMM:
0B8B A0 3C 21              1548 	MOV	AL,[FLAG]
0B8E E8 05 00              1549 	CALL	IMM
0B91 E8 D4 00              1550 	CALL	PUTADD
0B94 EB E7                 1551 	JMPS	FINIMM
0B96                       1552 
0B96                       1553 IMM:
0B96 24 01                 1554 	AND	AL,1
0B98 0A C1                 1555 	OR	AL,CL
0B9A 8A C8                 1556 	MOV	CL,AL
0B9C E8 07 00              1557 	CALL	PUT
0B9F 8A C5                 1558 	MOV	AL,CH
0BA1 24 38                 1559 	AND	AL,38H
0BA3 0A C3                 1560 	OR	AL,BL
0BA5                       1561 IMMEDUDRET:
0BA5 C3                    1562 	RET
0BA6                       1563 
0BA6                       1564 PUT:
0BA6                       1565 ;Save byte in AL as pure code, with intermediate code bits 00. AL and
0BA6                       1566 ;DI destroyed, no other registers affected.
0BA6 53                    1567 	PUSH	BX
0BA7 51                    1568 	PUSH	CX
0BA8 B5 00                 1569 	MOV	CH,0		;Flag as pure code
0BAA E8 03 00              1570 	CALL	GEN
0BAD 59                    1571 	POP	CX
0BAE 5B                    1572 	POP	BX
0BAF C3                    1573 	RET
0BB0                       1574 
0BB0                       1575 GEN:
0BB0                       1576 ;Save byte of code in AL, given intermediate code bits in bits 7&8 of CH.
0BB0 E8 36 00              1577 	CALL	PUTINC		;Save it and bump code pointer
0BB3                       1578 GEN1:
0BB3 A0 A6 21              1579 	MOV	AL,[RELOC]
0BB6 D0 D5                 1580 	RCL	CH
0BB8 D0 D0                 1581 	RCL	AL
0BBA D0 D5                 1582 	RCL	CH
0BBC D0 D0                 1583 	RCL	AL
0BBE A2 A6 21              1584 	MOV	[RELOC],AL
0BC1 BB A7 21              1585 	MOV	BX,BCOUNT
0BC4 FF 0F                 1586 	DEC	[BX]
0BC6 75 20                 1587 	JNZ	GENUDRET
0BC8 C7 07 04 00           1588 	MOV	[BX],4
0BCC BB A6 21              1589 	MOV	BX,RELOC
0BCF 8A 07                 1590 	MOV	AL,[BX]
0BD1 C7 07 00 00           1591 	MOV	[BX],0
0BD5 8B 3E C4 21           1592 	MOV	DI,[IY]
0BD9 88 05                 1593 	MOV	[DI],AL
0BDB 8B 1E A3 21           1594 	MOV	BX,[CODE]
0BDF 89 1E C4 21           1595 	MOV	[IY],BX
0BE3 43                    1596 	INC	BX
0BE4 89 1E A3 21           1597 	MOV	[CODE],BX
0BE8                       1598 GENUDRET:
0BE8 C3                    1599 	RET
0BE9                       1600 PUTINC:
0BE9 FF 06 36 21           1601 	INC	[PC]
0BED                       1602 PUTCD:
0BED 8B 3E A3 21           1603 	MOV	DI,[CODE]
0BF1 AA                    1604 	STOSB
0BF2 89 3E A3 21           1605 	MOV	[CODE],DI
0BF6 C3                    1606 	RET
0BF7                       1607 
0BF7                       1608 PUTWOR:
0BF7                       1609 ;Save the word value described by [DLABEL] and [DATA] as code. If defined,
0BF7                       1610 ;two bytes of pure code will be produced. Otherwise, appropriate intermediate
0BF7                       1611 ;code will be generated.
0BF7 51                    1612 	PUSH	CX
0BF8 B5 80                 1613 	MOV	CH,80H
0BFA 52                    1614 	PUSH	DX
0BFB 53                    1615 	PUSH	BX
0BFC EB 20                 1616 	JMPS	PUTBW
0BFE                       1617 
0BFE                       1618 PUTBYT:
0BFE                       1619 ;Same as PUTWOR, above, but for byte value.
0BFE 51                    1620 	PUSH	CX
0BFF B5 40                 1621 	MOV	CH,40H
0C01 52                    1622 	PUSH	DX
0C02 53                    1623 	PUSH	BX
0C03 8B 1E 44 21           1624 	MOV	BX,[DLABEL]
0C07 8A C7                 1625 	MOV	AL,BH
0C09 0A C3                 1626 	OR	AL,BL
0C0B 75 11                 1627 	JNZ	PUTBW
0C0D 8B 1E 42 21           1628 	MOV	BX,[DATA]
0C11 0A C7                 1629 	OR	AL,BH
0C13 74 09                 1630 	JZ	PUTBW
0C15 FE C7                 1631 	INC	BH
0C17 74 05                 1632 	JZ	PUTBW
0C19 B1 1F                 1633 	MOV	CL,31
0C1B E9 95 F6              1634 	JMP	ERROR
0C1E                       1635 PUTBW:
0C1E 8B 16 44 21           1636 	MOV	DX,[DLABEL]
0C22 8B 1E 42 21           1637 	MOV	BX,[DATA]
0C26                       1638 PUTCHK:
0C26 0B D2                 1639 	OR	DX,DX
0C28 74 25                 1640 	JZ	NOUNDEF
0C2A 8A C2                 1641 	MOV	AL,DL
0C2C E8 BE FF              1642 	CALL	PUTCD
0C2F 8A C6                 1643 	MOV	AL,DH
0C31 E8 B9 FF              1644 	CALL	PUTCD
0C34 8A C3                 1645 	MOV	AL,BL
0C36 E8 B0 FF              1646 	CALL	PUTINC
0C39 8A C7                 1647 	MOV	AL,BH
0C3B F6 C5 80              1648 	TEST	CH,080H
0C3E 74 05                 1649 	JZ	SMPUT
0C40 E8 6D FF              1650 	CALL	GEN
0C43 EB 06                 1651 	JMPS	PRET
0C45                       1652 SMPUT:
0C45 E8 A5 FF              1653 	CALL	PUTCD
0C48 E8 68 FF              1654 	CALL	GEN1
0C4B                       1655 PRET:
0C4B 5B                    1656 	POP	BX
0C4C 5A                    1657 	POP	DX
0C4D 59                    1658 	POP	CX
0C4E C3                    1659 	RET
0C4F                       1660 
0C4F                       1661 NOUNDEF:
0C4F 8A C3                 1662 	MOV	AL,BL
0C51 8A CF                 1663 	MOV	CL,BH
0C53 51                    1664 	PUSH	CX
0C54 B5 00                 1665 	MOV	CH,0
0C56 E8 57 FF              1666 	CALL	GEN
0C59 59                    1667 	POP	CX
0C5A 8A C1                 1668 	MOV	AL,CL
0C5C F6 C5 80              1669 	TEST	CH,080H
0C5F B5 00                 1670 	MOV	CH,0
0C61 74 E8                 1671 	JZ	PRET
0C63 E8 4A FF              1672 	CALL	GEN
0C66 EB E3                 1673 	JMPS	PRET
0C68                       1674 
0C68                       1675 PUTADD:
0C68                       1676 ;Save complete addressing mode. Addressing mode is in AL; if this is a register
0C68                       1677 ;operation (>=C0), then the one byte will be saved as pure code. Otherwise,
0C68                       1678 ;the details of the addressing mode will be investigated and the optional one-
0C68                       1679 ;or two-byte displacement will be added, as described by [ADDR] and [ALABEL].
0C68 51                    1680 	PUSH	CX
0C69 52                    1681 	PUSH	DX
0C6A 53                    1682 	PUSH	BX
0C6B B5 00                 1683 	MOV	CH,0
0C6D 8A C8                 1684 	MOV	CL,AL
0C6F E8 3E FF              1685 	CALL	GEN		;Save the addressing mode as pure code
0C72 8A C1                 1686 	MOV	AL,CL
0C74 B5 80                 1687 	MOV	CH,80H
0C76 24 C7                 1688 	AND	AL,0C7H
0C78 3C 06                 1689 	CMP	AL,6
0C7A 74 0A                 1690 	JZ	TWOBT		;Direct address?
0C7C 24 C0                 1691 	AND	AL,0C0H
0C7E 74 CB                 1692 	JZ	PRET		;Indirect through reg, no displacement?
0C80 3C C0                 1693 	CMP	AL,0C0H
0C82 74 C7                 1694 	JZ	PRET		;Register to register operation?
0C84 8A E8                 1695 	MOV	CH,AL		;Save whether one- or two-byte displacement
0C86                       1696 TWOBT:
0C86 8B 1E 3E 21           1697 	MOV	BX,[ADDR]
0C8A 8B 16 40 21           1698 	MOV	DX,[ALABEL]
0C8E EB 96                 1699 	JMPS	PUTCHK
0C90                       1700 
0C90                       1701 GRP2:
0C90 E8 37 F7              1702 	CALL	GETOP
0C93 B9 30 FF              1703 	MOV	CX,0FF30H
0C96 3C 00                 1704 	CMP	AL,UNDEFID
0C98 74 14                 1705 	JZ	PMEM
0C9A B5 50                 1706 	MOV	CH,50H
0C9C 3C 03                 1707 	CMP	AL,XREG
0C9E 74 1A                 1708 	JZ	PXREG
0CA0 B5 06                 1709 	MOV	CH,6
0CA2 3C 04                 1710 	CMP	AL,SREG
0CA4 75 03                 1711 	JNZ	$+5
0CA6 E9 03 04              1712 	JMP	PACKREG
0CA9 B1 14                 1713 	MOV	CL,20
0CAB E9 05 F6              1714 	JMP	ERROR
0CAE                       1715 
0CAE                       1716 PMEM:
0CAE 8A C5                 1717 	MOV	AL,CH
0CB0 E8 F3 FE              1718 	CALL	PUT
0CB3 8A C1                 1719 	MOV	AL,CL
0CB5 0A C2                 1720 	OR	AL,DL
0CB7 E9 AE FF              1721 	JMP	PUTADD
0CBA                       1722 
0CBA                       1723 PXREG:
0CBA 8A C5                 1724 	MOV	AL,CH
0CBC 0A C2                 1725 	OR	AL,DL
0CBE E9 E5 FE              1726 	JMP	PUT
0CC1                       1727 
0CC1                       1728 GRP3:
0CC1 E8 06 F7              1729 	CALL	GETOP
0CC4 52                    1730 	PUSH	DX
0CC5 E8 F9 F6              1731 	CALL	GETOP2
0CC8 5B                    1732 	POP	BX
0CC9 B9 14 86              1733 	MOV	CX,8614H
0CCC B0 04                 1734 	MOV	AL,SREG
0CCE 3A C7                 1735 	CMP	AL,BH
0CD0 74 4C                 1736 	JZ	ERR6
0CD2 3A C6                 1737 	CMP	AL,DH
0CD4 74 48                 1738 	JZ	ERR6
0CD6 B0 01                 1739 	MOV	AL,CONST
0CD8 3A C7                 1740 	CMP	AL,BH
0CDA 74 42                 1741 	JZ	ERR6
0CDC 3A C6                 1742 	CMP	AL,DH
0CDE 74 3E                 1743 	JZ	ERR6
0CE0 B0 00                 1744 	MOV	AL,UNDEFID
0CE2 3A C7                 1745 	CMP	AL,BH
0CE4 74 2D                 1746 	JZ	EXMEM
0CE6 3A C6                 1747 	CMP	AL,DH
0CE8 74 2B                 1748 	JZ	EXMEM1
0CEA 8A C7                 1749 	MOV	AL,BH
0CEC 3A C6                 1750 	CMP	AL,DH
0CEE B1 16                 1751 	MOV	CL,22
0CF0 75 2C                 1752 	JNZ	ERR6
0CF2 3C 03                 1753 	CMP	AL,XREG
0CF4 74 03                 1754 	JZ	L0008
0CF6 E8 2E F6              1755 	CALL	RR1
0CF9                       1756 L0008:			;RR1 never returns
0CF9 8A C3                 1757 	MOV	AL,BL
0CFB 0A C0                 1758 	OR	AL,AL
0CFD 74 0D                 1759 	JZ	EXACC
0CFF 87 DA                 1760 	XCHG	DX,BX
0D01 8A C3                 1761 	MOV	AL,BL
0D03 0A C0                 1762 	OR	AL,AL
0D05 8A C7                 1763 	MOV	AL,BH
0D07 74 03                 1764 	JZ	EXACC
0D09 E8 1B F6              1765 	CALL	RR1
0D0C                       1766 EXACC:
0D0C B0 90                 1767 	MOV	AL,90H
0D0E 0A C2                 1768 	OR	AL,DL
0D10 E9 93 FE              1769 	JMP	PUT
0D13                       1770 
0D13                       1771 EXMEM:
0D13 87 DA                 1772 	XCHG	DX,BX
0D15                       1773 EXMEM1:
0D15 3A C7                 1774 	CMP	AL,BH
0D17 74 05                 1775 	JZ	ERR6
0D19 B1 01                 1776 	MOV	CL,1	;Flag word as OK
0D1B E8 83 F6              1777 	CALL	NOTAC	;NOTAC never returns
0D1E E9 92 F5              1778 ERR6:	JMP	ERROR
0D21                       1779 
0D21                       1780 GRP4:
0D21 50                    1781 	PUSH	AX
0D22 E8 A5 F6              1782 	CALL	GETOP
0D25 59                    1783 	POP	CX
0D26 86 CD                 1784 	XCHG	CL,CH
0D28 3C 01                 1785 	CMP	AL,CONST
0D2A 74 13                 1786 	JZ	FIXED
0D2C 2C 03                 1787 	SUB	AL,XREG
0D2E FE CA                 1788 	DEC	DL
0D30 FE CA                 1789 	DEC	DL
0D32 0A C2                 1790 	OR	AL,DL
0D34 B1 14                 1791 	MOV	CL,20
0D36 75 E6                 1792 	JNZ	ERR6
0D38 8A C5                 1793 	MOV	AL,CH
0D3A 0C 08                 1794 	OR	AL,8
0D3C E9 67 FE              1795 	JMP	PUT
0D3F                       1796 FIXED:
0D3F 8A C5                 1797 	MOV	AL,CH
0D41 E8 62 FE              1798 	CALL	PUT
0D44 E9 B7 FE              1799 	JMP	PUTBYT
0D47                       1800 
0D47                       1801 GRP5:
0D47 50                    1802 	PUSH	AX
0D48 E8 7F F6              1803 	CALL	GETOP
0D4B B1 14                 1804 	MOV	CL,20
0D4D 3C 01                 1805 	CMP	AL,CONST
0D4F 75 CD                 1806 	JNZ	ERR6
0D51 8B 1E 44 21           1807 	MOV	BX,[DLABEL]
0D55 8A C7                 1808 	MOV	AL,BH
0D57 0A C3                 1809 	OR	AL,BL
0D59 B1 1E                 1810 	MOV	CL,30
0D5B 75 C1                 1811 	JNZ	ERR6
0D5D 8B 1E 42 21           1812 	MOV	BX,[DATA]
0D61 58                    1813 	POP	AX
0D62 0A C0                 1814 	OR	AL,AL
0D64 74 43                 1815 	JZ	UDORG
0D66 FE C8                 1816 	DEC	AL
0D68 74 19                 1817 	JZ	DSJ
0D6A FE C8                 1818 	DEC	AL
0D6C 74 27                 1819 	JZ	EQU
0D6E FE C8                 1820 	DEC	AL
0D70 74 03                 1821 	JZ	$+5
0D72 E9 9A 03              1822 	JMP	UDIF
0D75                       1823 PUTOP:
0D75 B0 FD                 1824 	MOV	AL,-3
0D77 EB 36                 1825 	JMPS	NEWLOC
0D79                       1826 UDALIGN:
0D79 A0 36 21              1827 	MOV	AL,[PC]
0D7C 24 01                 1828 	AND	AL,1
0D7E 74 28                 1829 	JZ	UDALIGNUDRET
0D80 BB 01 00              1830 	MOV	BX,1
0D83                       1831 DSJ:
0D83 87 DA                 1832 	XCHG	DX,BX
0D85 8B 1E 36 21           1833 	MOV	BX,[PC]
0D89 03 DA                 1834 	ADD	BX,DX
0D8B 89 1E 36 21           1835 	MOV	[PC],BX
0D8F 87 DA                 1836 	XCHG	DX,BX
0D91 B0 FC                 1837 	MOV	AL,-4
0D93 EB 1A                 1838 	JMPS	NEWLOC
0D95                       1839 EQU:
0D95 87 DA                 1840 	XCHG	DX,BX
0D97 8B 1E 3A 21           1841 	MOV	BX,[LABPT]
0D9B 8A C7                 1842 	MOV	AL,BH
0D9D 0A C3                 1843 	OR	AL,BL
0D9F B1 22                 1844 	MOV	CL,34
0DA1 74 27                 1845 	JZ	ERR7
0DA3 88 17                 1846 	MOV	[BX],DL
0DA5 43                    1847 	INC	BX
0DA6 88 37                 1848 	MOV	[BX],DH
0DA8                       1849 UDALIGNUDRET:
0DA8 C3                    1850 	RET
0DA9                       1851 UDORG:
0DA9 89 1E 36 21           1852 	MOV	[PC],BX
0DAD B0 FE                 1853 	MOV	AL,-2
0DAF                       1854 NEWLOC:
0DAF E8 3B FE              1855 	CALL	PUTCD
0DB2 8A C3                 1856 	MOV	AL,BL
0DB4 E8 36 FE              1857 	CALL	PUTCD
0DB7 8A C7                 1858 	MOV	AL,BH
0DB9 E8 31 FE              1859 	CALL	PUTCD
0DBC B5 C0                 1860 	MOV	CH,0C0H
0DBE E9 F2 FD              1861 	JMP	GEN1
0DC1                       1862 GRP6:
0DC1 8A E8                 1863 	MOV	CH,AL
0DC3 B1 04                 1864 	MOV	CL,4
0DC5 E8 26 F5              1865 	CALL	MROPS
0DC8 B1 17                 1866 	MOV	CL,23
0DCA E9 E6 F4              1867 ERR7:	JMP	ERROR
0DCD                       1868 GRP7:
0DCD 8A E8                 1869 	MOV	CH,AL
0DCF B1 01                 1870 	MOV	CL,1
0DD1 E8 1A F5              1871 	CALL	MROPS
0DD4 B1 80                 1872 	MOV	CL,80H
0DD6 8B 16 44 21           1873 	MOV	DX,[DLABEL]
0DDA 8A C6                 1874 	MOV	AL,DH
0DDC 0A C2                 1875 	OR	AL,DL
0DDE 75 12                 1876 	JNZ	ACCJ
0DE0 87 DA                 1877 	XCHG	DX,BX
0DE2 8B 1E 42 21           1878 	MOV	BX,[DATA]
0DE6 8A C3                 1879 	MOV	AL,BL
0DE8 98                    1880 	CBW
0DE9 3B C3                 1881 	CMP	AX,BX
0DEB 87 DA                 1882 	XCHG	DX,BX
0DED 75 03                 1883 	JNZ	ACCJ
0DEF 80 C9 02              1884 	OR	CL,002H
0DF2 E9 B7 00              1885 ACCJ:	JMP	ACCIMM
0DF5                       1886 GRP8:
0DF5 8A C8                 1887 	MOV	CL,AL
0DF7 B5 FE                 1888 	MOV	CH,0FEH
0DF9 EB 04                 1889 	JMPS	ONEOP
0DFB                       1890 GRP9:
0DFB 8A C8                 1891 	MOV	CL,AL
0DFD B5 F6                 1892 	MOV	CH,0F6H
0DFF                       1893 ONEOP:
0DFF 51                    1894 	PUSH	CX
0E00 E8 C7 F5              1895 	CALL	GETOP
0E03                       1896 ONE:
0E03 B1 1A                 1897 	MOV	CL,26
0E05 3C 01                 1898 	CMP	AL,CONST
0E07 74 C1                 1899 	JZ	ERR7
0E09 3C 04                 1900 	CMP	AL,SREG
0E0B B1 16                 1901 	MOV	CL,22
0E0D 74 BB                 1902 	JZ	ERR7
0E0F 59                    1903 	POP	CX
0E10 3C 00                 1904 	CMP	AL,UNDEFID
0E12 74 12                 1905 	JZ	MOP
0E14 24 01                 1906 	AND	AL,1
0E16 74 21                 1907 	JZ	ROP
0E18 F6 C1 01              1908 	TEST	CL,001H
0E1B 74 1C                 1909 	JZ	ROP
0E1D 8A C1                 1910 	MOV	AL,CL
0E1F 24 F8                 1911 	AND	AL,0F8H
0E21 0A C2                 1912 	OR	AL,DL
0E23 E9 80 FD              1913 	JMP	PUT
0E26                       1914 MOP:
0E26 A0 3C 21              1915 	MOV	AL,[FLAG]
0E29 24 01                 1916 	AND	AL,1
0E2B 0A C5                 1917 	OR	AL,CH
0E2D E8 76 FD              1918 	CALL	PUT
0E30 8A C1                 1919 	MOV	AL,CL
0E32 24 38                 1920 	AND	AL,38H
0E34 0A C2                 1921 	OR	AL,DL
0E36 E9 2F FE              1922 	JMP	PUTADD
0E39                       1923 ROP:
0E39 0A C5                 1924 	OR	AL,CH
0E3B E8 68 FD              1925 	CALL	PUT
0E3E 8A C1                 1926 	MOV	AL,CL
0E40 24 38                 1927 	AND	AL,38H
0E42 0C C0                 1928 	OR	AL,0C0H
0E44 0A C2                 1929 	OR	AL,DL
0E46 E9 5D FD              1930 	JMP	PUT
0E49                       1931 GRP10:
0E49 8A C8                 1932 	MOV	CL,AL
0E4B B5 F6                 1933 	MOV	CH,0F6H
0E4D 51                    1934 	PUSH	CX
0E4E E8 79 F5              1935 	CALL	GETOP
0E51 B1 14                 1936 	MOV	CL,20
0E53 8A C2                 1937 	MOV	AL,DL
0E55 0A C0                 1938 	OR	AL,AL
0E57 75 08                 1939 	JNZ	ERRJ1
0E59 8A C6                 1940 	MOV	AL,DH
0E5B 3C 03                 1941 	CMP	AL,XREG
0E5D 74 04                 1942 	JZ	G10
0E5F 3C 02                 1943 	CMP	AL,REG
0E61 75 67                 1944 ERRJ1:	JNZ	ERR8
0E63                       1945 G10:
0E63 50                    1946 	PUSH	AX
0E64 E8 63 F5              1947 	CALL	GETOP
0E67 58                    1948 	POP	AX
0E68 24 01                 1949 	AND	AL,1
0E6A A2 3C 21              1950 	MOV	[FLAG],AL
0E6D 8A C6                 1951 	MOV	AL,DH
0E6F EB 92                 1952 ONEJ:	JMPS	ONE
0E71                       1953 GRP11:
0E71 E8 32 FD              1954 	CALL	PUT
0E74 B0 0A                 1955 	MOV	AL,0AH
0E76 E9 2D FD              1956 	JMP	PUT
0E79                       1957 GRP12:
0E79 8A C8                 1958 	MOV	CL,AL
0E7B B5 D0                 1959 	MOV	CH,0D0H
0E7D 51                    1960 	PUSH	CX
0E7E E8 49 F5              1961 	CALL	GETOP
0E81 A0 9C 21              1962 	MOV	AL,[SYM]
0E84 3C 2C                 1963 	CMP	AL,','
0E86 8A C6                 1964 	MOV	AL,DH
0E88 75 E5                 1965 	JNZ	ONEJ
0E8A 52                    1966 	PUSH	DX
0E8B E8 3C F5              1967 	CALL	GETOP
0E8E 2C 02                 1968 	SUB	AL,REG
0E90 B1 14                 1969 	MOV	CL,20
0E92 FE CA                 1970 	DEC	DL
0E94 0A C2                 1971 	OR	AL,DL
0E96 75 32                 1972 	JNZ	ERR8
0E98 5A                    1973 	POP	DX
0E99 8A C6                 1974 	MOV	AL,DH
0E9B 59                    1975 	POP	CX
0E9C 80 CD 02              1976 	OR	CH,002H
0E9F 51                    1977 	PUSH	CX
0EA0 E9 60 FF              1978 	JMP	ONE
0EA3                       1979 GRP13:
0EA3 8A E8                 1980 	MOV	CH,AL
0EA5 B1 01                 1981 	MOV	CL,1
0EA7 E8 44 F4              1982 	CALL	MROPS
0EAA B1 80                 1983 	MOV	CL,80H
0EAC                       1984 ACCIMM:
0EAC E8 B8 FC              1985 	CALL	IMMED
0EAF 80 CD 04              1986 	OR	CH,004H
0EB2 80 E5 FD              1987 	AND	CH,0FDH
0EB5                       1988 AIMM:
0EB5 8A C7                 1989 	MOV	AL,BH
0EB7 24 01                 1990 	AND	AL,1
0EB9 9F                    1991 	LAHF
0EBA 50                    1992 	PUSH	AX
0EBB 0A C5                 1993 	OR	AL,CH
0EBD E8 E6 FC              1994 	CALL	PUT
0EC0 58                    1995 	POP	AX
0EC1 9E                    1996 	SAHF
0EC2 75 03                 1997 	JNZ	$+5
0EC4 E9 37 FD              1998 	JMP	PUTBYT
0EC7 E9 2D FD              1999 	JMP	PUTWOR
0ECA                       2000 
0ECA E9 E6 F3              2001 ERR8:	JMP	ERROR
0ECD                       2002 
0ECD                       2003 GRP14:
0ECD                       2004 ;JMP and CALL mnemonics
0ECD 9F                    2005 	LAHF
0ECE 86 E0                 2006 	XCHG	AH,AL
0ED0 50                    2007 	PUSH	AX
0ED1 86 E0                 2008 	XCHG	AH,AL
0ED3 C7 06 3D 21 03 00     2009 	MOV	[MAXFLG],3	;Allow "L" flag
0ED9 E8 EE F4              2010 	CALL	GETOP
0EDC 3C 01                 2011 	CMP	AL,CONST
0EDE 74 33                 2012 	JZ	DIRECT
0EE0 B1 14                 2013 	MOV	CL,20
0EE2 3C 02                 2014 	CMP	AL,REG
0EE4 74 E4                 2015 	JZ	ERR8
0EE6 3C 04                 2016 	CMP	AL,SREG
0EE8 74 E0                 2017 	JZ	ERR8
0EEA 3C 03                 2018 	CMP	AL,XREG
0EEC 75 03                 2019 	JNZ	NOTRG
0EEE 80 CA C0              2020 	OR	DL,0C0H
0EF1                       2021 NOTRG:
0EF1                       2022 ;Indirect jump. DL has addressing mode.
0EF1 B0 FF                 2023 	MOV	AL,0FFH
0EF3 E8 B0 FC              2024 	CALL	PUT
0EF6 58                    2025 	POP	AX
0EF7 86 E0                 2026 	XCHG	AH,AL
0EF9 9E                    2027 	SAHF
0EFA 24 38                 2028 	AND	AL,38H
0EFC 0A C2                 2029 	OR	AL,DL
0EFE 8A 2E 3C 21           2030 	MOV	CH,[FLAG]
0F02 82 FD 03              2031 	CMP	CH,3		;Flag "L" present?
0F05 74 09                 2032 	JZ	PUTADDJ		;If so, do inter-segment
0F07 B1 27                 2033 	MOV	CL,27H
0F09 82 FD FF              2034 	CMP	CH,-1		;Better not be a flag
0F0C 75 BC                 2035 	JNZ	ERR8
0F0E 24 F7                 2036 	AND	AL,0F7H		;Convert to intra-segment
0F10                       2037 PUTADDJ:
0F10 E9 55 FD              2038 	JMP	PUTADD
0F13                       2039 DIRECT:
0F13 A0 9C 21              2040 	MOV	AL,[SYM]
0F16 3C 2C                 2041 	CMP	AL,','
0F18 74 1C                 2042 	JZ	LONGJ
0F1A 58                    2043 	POP	AX
0F1B 86 E0                 2044 	XCHG	AH,AL
0F1D 9E                    2045 	SAHF
0F1E FE C8                 2046 	DEC	AL
0F20 3C E9                 2047 	CMP	AL,0E9H
0F22 74 02                 2048 	JZ	GOTOP
0F24 B0 E8                 2049 	MOV	AL,0E8H
0F26                       2050 GOTOP:
0F26 E8 7D FC              2051 	CALL	PUT
0F29 8B 16 36 21           2052 	MOV	DX,[PC]
0F2D 42                    2053 	INC	DX
0F2E 42                    2054 	INC	DX
0F2F 29 16 42 21           2055 	SUB	[DATA],DX
0F33 E9 C1 FC              2056 	JMP	PUTWOR
0F36                       2057 LONGJ:
0F36 58                    2058 	POP	AX
0F37 86 E0                 2059 	XCHG	AH,AL
0F39 9E                    2060 	SAHF
0F3A E8 69 FC              2061 	CALL	PUT
0F3D E8 B7 FC              2062 	CALL	PUTWOR
0F40 E8 87 F4              2063 	CALL	GETOP
0F43 B1 14                 2064 	MOV	CL,20
0F45 3C 01                 2065 	CMP	AL,CONST
0F47 75 81                 2066 	JNZ	ERR8
0F49 E9 AB FC              2067 	JMP	PUTWOR
0F4C                       2068 
0F4C                       2069 GRP16:
0F4C                       2070 ;RET mnemonic
0F4C 9F                    2071 	LAHF
0F4D 86 E0                 2072 	XCHG	AH,AL
0F4F 50                    2073 	PUSH	AX
0F50 86 E0                 2074 	XCHG	AH,AL
0F52 E8 AF F6              2075 	CALL	GETSYM
0F55 3C 05                 2076 	CMP	AL,5
0F57 74 1C                 2077 	JZ	LONGR
0F59 3C 0D                 2078 	CMP	AL,EOL
0F5B 74 3F                 2079 	JZ	NODEC
0F5D 3C 3B                 2080 	CMP	AL,';'
0F5F 74 3B                 2081 	JZ	NODEC
0F61                       2082 GETSP:
0F61 E8 69 F4              2083 	CALL	GETOP1
0F64 59                    2084 	POP	CX
0F65 3C 01                 2085 	CMP	AL,CONST
0F67 B1 14                 2086 	MOV	CL,20
0F69 75 64                 2087 	JNZ	ERR9
0F6B 8A C5                 2088 	MOV	AL,CH
0F6D 24 FE                 2089 	AND	AL,0FEH
0F6F E8 34 FC              2090 	CALL	PUT
0F72 E9 82 FC              2091 	JMP	PUTWOR
0F75                       2092 LONGR:
0F75 82 FA 03              2093 	CMP	DL,3		;Is flag "L"?
0F78 B1 27                 2094 	MOV	CL,27H
0F7A 75 7E                 2095 	JNZ	ERR10		;If not, bad flag
0F7C 58                    2096 	POP	AX
0F7D 86 E0                 2097 	XCHG	AH,AL
0F7F 9E                    2098 	SAHF
0F80 0C 08                 2099 	OR	AL,8
0F82 9F                    2100 	LAHF
0F83 86 E0                 2101 	XCHG	AH,AL
0F85 50                    2102 	PUSH	AX
0F86 86 E0                 2103 	XCHG	AH,AL
0F88                       2104 NOTLON:
0F88 E8 79 F6              2105 	CALL	GETSYM
0F8B 3C 0D                 2106 	CMP	AL,EOL
0F8D 74 2F                 2107 	JZ	DORET
0F8F 3C 3B                 2108 	CMP	AL,';'
0F91 74 2B                 2109 	JZ	DORET
0F93 3C 2C                 2110 	CMP	AL,','
0F95 75 03                 2111 	JNZ	L0011
0F97 E8 6A F6              2112 	CALL	GETSYM
0F9A                       2113 L0011:	
0F9A EB C5                 2114 	JMPS	GETSP
0F9C                       2115 NODEC:
0F9C                       2116 ;Return is intra-segment (short) without add to SP. 
0F9C                       2117 ;Record position for RET symbol.
0F9C 8B 1E 36 21           2118 	MOV	BX,[PC]
0FA0 89 1E BA 21           2119 	MOV	[LSTRET],BX
0FA4 87 DA                 2120 	XCHG	DX,BX
0FA6 8B 1E BC 21           2121 	MOV	BX,[RETPT]
0FAA 8A C7                 2122 	MOV	AL,BH
0FAC 0A C3                 2123 	OR	AL,BL
0FAE 74 0E                 2124 	JZ	DORET
0FB0 C7 07 01 00           2125 	MOV	[BX],1
0FB4 43                    2126 	INC	BX
0FB5 89 17                 2127 	MOV	[BX],DX
0FB7 BB 00 00              2128 	MOV	BX,0
0FBA 89 1E BC 21           2129 	MOV	[RETPT],BX
0FBE                       2130 DORET:
0FBE 58                    2131 	POP	AX
0FBF 86 E0                 2132 	XCHG	AH,AL
0FC1 9E                    2133 	SAHF
0FC2 E9 E1 FB              2134 	JMP	PUT
0FC5                       2135 
0FC5                       2136 GRP17:
0FC5 E8 DE FB              2137 	CALL	PUT
0FC8 E8 FF F3              2138 	CALL	GETOP
0FCB 3C 01                 2139 	CMP	AL,CONST
0FCD B1 14                 2140 	MOV	CL,20
0FCF 75 29                 2141 ERR9:	JNZ	ERR10
0FD1 8B 1E 42 21           2142 	MOV	BX,[DATA]
0FD5 8B 16 36 21           2143 	MOV	DX,[PC]
0FD9 42                    2144 	INC	DX
0FDA 2B DA                 2145 	SUB	BX,DX
0FDC 89 1E 42 21           2146 	MOV	[DATA],BX
0FE0 E8 1B FC              2147 	CALL	PUTBYT
0FE3 8B 1E 44 21           2148 	MOV	BX,[DLABEL]
0FE7 8A C7                 2149 	MOV	AL,BH
0FE9 0A C3                 2150 	OR	AL,BL
0FEB 75 10                 2151 	JNZ	GRP17UDRET
0FED 8B 1E 42 21           2152 	MOV	BX,[DATA]
0FF1 8A C3                 2153 	MOV	AL,BL
0FF3 98                    2154 	CBW
0FF4 3B C3                 2155 	CMP	AX,BX		;Signed 8-bit number?
0FF6 74 05                 2156 	JZ	GRP17UDRET
0FF8 B1 1F                 2157 	MOV	CL,31
0FFA E9 B6 F2              2158 ERR10:	JMP	ERROR
0FFD                       2159 GRP17UDRET:
0FFD C3                    2160 	RET
0FFE                       2161 GRP18:
0FFE E8 C9 F3              2162 	CALL	GETOP
1001 3C 01                 2163 	CMP	AL,CONST
1003 B1 14                 2164 	MOV	CL,20
1005 75 F3                 2165 	JNZ	ERR10
1007 8B 1E 44 21           2166 	MOV	BX,[DLABEL]
100B 8A C7                 2167 	MOV	AL,BH
100D 0A C3                 2168 	OR	AL,BL
100F 75 10                 2169 	JNZ	GENINT
1011 8B 1E 42 21           2170 	MOV	BX,[DATA]
1015 BA 03 00              2171 	MOV	DX,3
1018 1B DA                 2172 	SBB	BX,DX
101A 75 05                 2173 	JNZ	GENINT
101C B0 CC                 2174 	MOV	AL,0CCH
101E E9 85 FB              2175 	JMP	PUT
1021                       2176 GENINT:
1021 B0 CD                 2177 	MOV	AL,0CDH
1023 E8 80 FB              2178 	CALL	PUT
1026 E9 D5 FB              2179 	JMP	PUTBYT
1029                       2180 
1029                       2181 GRP19:	;ESC opcode
1029 E8 9E F3              2182 	CALL	GETOP
102C B1 14                 2183 	MOV	CL,20
102E 3C 01                 2184 	CMP	AL,CONST
1030 75 39                 2185 	JNZ	ERRJ		;First operand must be immediate
1032 B1 1E                 2186 	MOV	CL,1EH
1034 F7 06 44 21 FF FF     2187 	TEST	[DLABEL],-1	;See if all labels have been defined
103A 75 2F                 2188 	JNZ	ERRJ
103C A1 42 21              2189 	MOV	AX,[DATA]
103F 3D 40 00              2190 	CMP	AX,64		;Must only be 6 bits
1042 B1 1F                 2191 	MOV	CL,1FH
1044 73 25                 2192 	JNB	ERRJ
1046 8A D8                 2193 	MOV	BL,AL		;Save for second byte
1048 D0 E8                 2194 	SHR	AL
104A D0 E8                 2195 	SHR	AL
104C D0 E8                 2196 	SHR	AL
104E 0C D8                 2197 	OR	AL,0D8H		;ESC opcode
1050 E8 53 FB              2198 	CALL	PUT
1053 53                    2199 	PUSH	BX
1054 E8 6A F3              2200 	CALL	GETOP2
1057 5B                    2201 	POP	BX
1058 80 E3 07              2202 	AND	BL,7		;Low 3 bits of first operand
105B D0 E3                 2203 	SHL	BL
105D D0 E3                 2204 	SHL	BL
105F D0 E3                 2205 	SHL	BL
1061 3C 00                 2206 	CMP	AL,UNDEFID	;Check for memory operand
1063 74 09                 2207 	JZ	ESCMEM
1065 3C 01                 2208 	CMP	AL,CONST	;Check for another immediate
1067 74 0C                 2209 	JZ	ESCIMM
1069 B1 14                 2210 	MOV	CL,20
106B E9 45 F2              2211 ERRJ:	JMP	ERROR
106E                       2212 
106E                       2213 ESCMEM:
106E 0A DA                 2214 	OR	BL,DL		;Combine mode with first operand
1070 8A C3                 2215 	MOV	AL,BL
1072 E9 F3 FB              2216 	JMP	PUTADD
1075                       2217 
1075                       2218 ESCIMM:
1075 B1 1E                 2219 	MOV	CL,1EH
1077 F7 06 44 21 FF FF     2220 	TEST [DLABEL],-1	;See if second operand is fully defined
107D 75 EC                 2221 	JNZ	ERRJ
107F A1 42 21              2222 	MOV	AX,[DATA]
1082 B1 1F                 2223 	MOV	CL,1FH
1084 3D 08 00              2224 	CMP	AX,8		;Must only be 3 bit value
1087 73 E2                 2225 	JNB	ERRJ
1089 0A C3                 2226 	OR	AL,BL		;Combine first and second operands
108B 0C C0                 2227 	OR	AL,0C0H		;Force "register" mode
108D E9 16 FB              2228 	JMP	PUT
1090                       2229 
1090                       2230 GRP20:
1090 8A E8                 2231 	MOV	CH,AL
1092 B1 01                 2232 	MOV	CL,1
1094 E8 57 F2              2233 	CALL	MROPS
1097 B1 F6                 2234 	MOV	CL,0F6H
1099 E8 CB FA              2235 	CALL	IMMED
109C B5 A8                 2236 	MOV	CH,0A8H
109E E9 14 FE              2237 	JMP	AIMM
10A1                       2238 GRP21:
10A1 E8 26 F3              2239 	CALL	GETOP
10A4 3C 04                 2240 	CMP	AL,SREG
10A6 B1 1C                 2241 	MOV	CL,28
10A8 75 C1                 2242 	JNZ	ERRJ
10AA B5 26                 2243 	MOV	CH,26H
10AC                       2244 PACKREG:
10AC 8A C2                 2245 	MOV	AL,DL
10AE 02 C0                 2246 	ADD	AL,AL
10B0 02 C0                 2247 	ADD	AL,AL
10B2 02 C0                 2248 	ADD	AL,AL
10B4 0A C5                 2249 	OR	AL,CH
10B6 E9 ED FA              2250 	JMP	PUT
10B9                       2251 GRP22:
10B9 E8 0E F3              2252 	CALL	GETOP
10BC B9 00 8F              2253 	MOV	CX,8F00H
10BF 3C 00                 2254 	CMP	AL,UNDEFID
10C1 75 03                 2255 	JNZ	$+5
10C3 E9 E8 FB              2256 	JMP	PMEM
10C6 B5 58                 2257 	MOV	CH,58H
10C8 3C 03                 2258 	CMP	AL,XREG
10CA 75 03                 2259 	JNZ	$+5
10CC E9 EB FB              2260 	JMP	PXREG
10CF B5 07                 2261 	MOV	CH,7
10D1 3C 04                 2262 	CMP	AL,SREG
10D3 74 D7                 2263 	JZ	PACKREG
10D5 B1 14                 2264 	MOV	CL,20
10D7 E9 D9 F1              2265 ERR11:	JMP	ERROR
10DA                       2266 GRP23:
10DA A2 A5 21              2267 	MOV	[DATSIZ],AL
10DD                       2268 GETDAT:
10DD E8 24 F5              2269 	CALL	GETSYM
10E0 B0 02                 2270 	MOV	AL,2
10E2 E8 FE F2              2271 	CALL	VAL1
10E5 A0 9C 21              2272 	MOV	AL,[SYM]
10E8 3C 2C                 2273 	CMP	AL,','
10EA A0 A5 21              2274 	MOV	AL,[DATSIZ]
10ED 75 05                 2275 	JNZ	ENDDAT
10EF E8 13 00              2276 	CALL	SAVDAT
10F2 EB E9                 2277 	JMPS	GETDAT
10F4                       2278 ENDDAT:
10F4 3C 02                 2279 	CMP	AL,2
10F6 75 0D                 2280 	JNZ	SAVDAT
10F8 8B 1E 42 21           2281 	MOV	BX,[DATA]
10FC 9F                    2282 	LAHF
10FD 80 CB 80              2283 	OR	BL,080H
1100 9E                    2284 	SAHF
1101 89 1E 42 21           2285 	MOV	[DATA],BX
1105                       2286 SAVDAT:
1105 0A C0                 2287 	OR	AL,AL
1107 74 03                 2288 	JZ	$+5
1109 E9 F2 FA              2289 	JMP	PUTBYT
110C E9 E8 FA              2290 	JMP	PUTWOR
110F                       2291 UDIF:
110F 0B DB                 2292 	OR	BX,BX
1111 74 05                 2293 	JZ	SKIPCD
1113 FF 06 B6 21           2294 	INC	[IFFLG]
1117 C3                    2295 	RET
1118                       2296 
1118                       2297 SKIPCD:
1118 FF 06 B7 21           2298 	INC	[CHKLAB]
111C                       2299 SKIPLP:
111C 32 C0                 2300 	XOR	AL,AL
111E E8 3B F1              2301 	CALL	NEXLIN
1121 E8 94 F1              2302 	CALL	NEXTCHR
1124 3C 1A                 2303 	CMP	AL,1AH
1126 74 40                 2304 	JZ	UDEND
1128 E8 DC F7              2305 	CALL	GETLAB
112B 72 EF                 2306 	JC	SKIPLP
112D BF 4A 21              2307 	MOV	DI,LENID
1130 BE E0 20              2308 	MOV	SI,IFEND
1133 B5 00                 2309 	MOV	CH,0
1135 8A 0D                 2310 	MOV	CL,[DI]
1137 FE C1                 2311 	INC	CL
1139 F3                    2312 	REPE
113A A6                    2313 	CMPSB
113B 74 14                 2314 	JZ	ENDCOND
113D BF 4A 21              2315 	MOV	DI,LENID
1140 BE E6 20              2316 	MOV	SI,IFNEST
1143 8A 0D                 2317 	MOV	CL,[DI]
1145 FE C1                 2318 	INC	CL
1147 F3                    2319 	REPE
1148 A6                    2320 	CMPSB
1149 75 D1                 2321 	JNZ	SKIPLP
114B FF 06 B7 21           2322 	INC	[CHKLAB]
114F EB CB                 2323 	JMPS	SKIPLP
1151                       2324 
1151                       2325 ENDCOND:
1151 FF 0E B7 21           2326 	DEC	[CHKLAB]
1155 75 C5                 2327 	JNZ	SKIPLP
1157 C3                    2328 	RET
1158                       2329 
1158                       2330 UDENDIF:
1158 A0 B6 21              2331 	MOV	AL,[IFFLG]
115B B1 24                 2332 	MOV	CL,36
115D FE C8                 2333 	DEC	AL
115F 78 04                 2334 	JS	ERRJMP
1161 A2 B6 21              2335 	MOV	[IFFLG],AL
1164 C3                    2336 	RET
1165                       2337 
1165 E9 4B F1              2338 ERRJMP:	JMP	ERROR
1168                       2339 
1168                       2340 ;*********************************************************************
1168                       2341 ;
1168                       2342 ;	PASS 2
1168                       2343 ;
1168                       2344 ;*********************************************************************
1168                       2345 
1168                       2346 UDEND:
1168                       2347 	;DB 0CCH
1168 B2 04                 2348 	MOV	DL,4
116A                       2349 WREND:
116A B5 FF                 2350 	MOV	CH,0FFH
116C 8A C5                 2351 	MOV	AL,CH
116E E8 3F FA              2352 	CALL	GEN
1171 FE CA                 2353 	DEC	DL
1173 75 F5                 2354 	JNZ	WREND
1175 C7 06 10 26 12 26     2355 	MOV	[BUFPT],SRCBUF
117B C7 06 B2 21 FB FF     2356 	MOV	[HEXCNT],-5	;FLAG HEX BUFFER AS EMPTY
1181 C7 06 C8 21 10 22     2357 	MOV	[LSTPNT],LSTBUF
1187 C7 06 C6 21 CA 21     2358 	MOV	[HEXPNT],HEXBUF
118D 33 C0                 2359 	XOR	AX,AX
118F A3 B8 21              2360 	MOV	[ERRCNT],AX
1192 A3 36 21              2361 	MOV	[PC],AX
1195 A3 AA 21              2362 	MOV	[LINE],AX	;Current line number
1198 C7 06 AE 21 00 01     2363 	MOV	[HEXADD],OBJECT
119E                       2364 	
119E BA 5C 00              2365 	MOV	DX,FCB
11A1 B4 0F                 2366 	MOV	AH,OPEN
11A3 CD 21                 2367 	INT	33		;Re-open source file
11A5 33 C0                 2368 	XOR	AX,AX
11A7 A3 68 00              2369 	MOV	[FCB+12],AX	;Set CURRENT BLOCK to zero
11AA A2 7C 00              2370 	MOV	[FCB+20H],AL	;Set NEXT RECORD field to zero
11AD C7 06 6A 00 00 04     2371 	MOV	[FCB+14],BUFSIZ
11B3 A2 A8 21              2372 	MOV	[COUNT],AL
11B6 B5 01                 2373 	MOV	CH,1
11B8 BE 12 2B              2374 	MOV	SI,START
11BB                       2375 FIXLINE:
11BB BF 12 2B              2376 	MOV	DI,START	;Store code over used up intermediate code
11BE 32 C0                 2377 	XOR	AL,AL
11C0 A2 C0 21              2378 	MOV	[SPC],AL	;No "special" yet (ORG, PUT, DS)
11C3 A2 A9 21              2379 	MOV	[ERR],AL	;No second pass errors yet
11C6                       2380 NEXBT:
11C6 D0 E1                 2381 	SHL	CL		;Shift out last bit of previous code
11C8 FE CD                 2382 	DEC	CH		;Still have codes left?
11CA 75 05                 2383 	JNZ	TESTTYP
11CC AC                    2384 	LODSB			;Get next flag byte
11CD 8A C8                 2385 	MOV	CL,AL
11CF B5 04                 2386 	MOV	CH,4
11D1                       2387 TESTTYP:
11D1 D0 E1                 2388 	SHL	CL		;Set flags based on two bits
11D3 70 06                 2389 	JO	FIXUP
11D5 AC                    2390 	LODSB
11D6 72 50                 2391 	JC	EMARK
11D8                       2392 OBJBT:
11D8 AA                    2393 	STOSB
11D9 EB EB                 2394 	JMPS	NEXBT
11DB                       2395 
11DB                       2396 FIXUP:
11DB                       2397 ;Either a word or byte fixup is needed from a forward reference
11DB AD                    2398 	LODSW			;Get pointer to symbol
11DC 93                    2399 	XCHG	AX,BX
11DD AD                    2400 	LODSW			;Get constant part
11DE 03 47 01              2401 	ADD	AX,[BX+1]	;Add symbol value to constant part
11E1 83 3F 00              2402 	CMP	[BX],0	;See if symbol got defined
11E4 75 08                 2403 	JNZ	HAVDEF
11E6 C7 06 A9 21 64 00     2404 	MOV	[ERR],100	;Undefined - flag error
11EC 33 C0                 2405 	XOR	AX,AX
11EE                       2406 HAVDEF:
11EE 0A C9                 2407 	OR	CL,CL		;See if word or byte fixup
11F0 78 03                 2408 	JS	DEFBYT
11F2 AB                    2409 	STOSW
11F3 EB D1                 2410 	JMPS	NEXBT
11F5                       2411 
11F5                       2412 DEFBYT:
11F5 8B D0                 2413 	MOV	DX,AX
11F7 98                    2414 	CBW			;Extend sign
11F8 3B C2                 2415 	CMP	AX,DX		;See if in range +127 to -128
11FA 74 DC                 2416 	JZ	OBJBT		;If so, it's always OK
11FC F6 D4                 2417 	NOT	AH		;Check for range +255 to -256
11FE 3A E6                 2418 	CMP	AH,DH
1200 75 1B                 2419 	JNZ	RNGERR		;Must always be in this range
1202                       2420 ;Check for short jump. If so, we're out of range; otherwise we're OK
1202 81 FF 13 2B           2421 	CMP	DI,START+1	;Only one other byte on line?
1206 75 D0                 2422 	JNZ	OBJBT		;Can't be short jump if not
1208 A0 12 2B              2423 	MOV	AL,[START]	;Get the first byte of this line
120B 3C EB                 2424 	CMP	AL,0EBH		;Direct short jump?
120D 74 0E                 2425 	JZ	RNGERR
120F 24 FC                 2426 	AND	AL,0FCH
1211 3C E0                 2427 	CMP	AL,0E0H		;LOOP or JCXZ instruction?
1213 74 08                 2428 	JZ	RNGERR
1215 24 F0                 2429 	AND	AL,0F0H
1217 3C 70                 2430 	CMP	AL,70H		;Conditional jump?
1219 8A C2                 2431 	MOV	AL,DL		;Get code byte in AL
121B 75 BB                 2432 	JNZ	OBJBT		;If not, we're OK
121D                       2433 RNGERR:
121D C7 06 A9 21 65 00     2434 	MOV	[ERR],101	;Value out of range
1223 EB B3                 2435 	JMPS	OBJBT
1225                       2436 
1225 E9 80 01              2437 FINIJ:	JMP	FINI
1228                       2438 
1228                       2439 EMARK:
1228 3C FF                 2440 	CMP	AL,-1		;End of file?
122A 74 F9                 2441 	JZ	FINIJ
122C 3C F6                 2442 	CMP	AL,-10		;Special item?
122E 77 5C                 2443 	JA	SPEND
1230 51                    2444 	PUSH	CX
1231 56                    2445 	PUSH	SI
1232 50                    2446 	PUSH	AX		;Save error code
1233 8A 26 BE 21           2447 	MOV	AH,[LSTDEV]
1237 80 E4 FE              2448 	AND	AH,0FEH		;Reset error indicator
123A 0A 06 A9 21           2449 	OR	AL,[ERR]	;See if any errors on this line
123E 74 03                 2450 	JZ	NOERR
1240 80 CC 01              2451 	OR	AH,1		;Send line to console if error occured
1243                       2452 NOERR:
1243 88 26 BE 21           2453 	MOV	[LSTDEV],AH
1247 8B CF                 2454 	MOV	CX,DI
1249 E8 F0 00              2455 	CALL	STRTLIN		;Print address of line
124C BE 12 2B              2456 	MOV	SI,START
124F 2B CE                 2457 	SUB	CX,SI		;Get count of bytes of code
1251 74 06                 2458 	JZ	SHOLIN
1253                       2459 CODLP:
1253 AC                    2460 	LODSB
1254 E8 7E 02              2461 	CALL	SAVCD		;Ouput code to HEX and PRN files
1257 E2 FA                 2462 	LOOP	CODLP
1259                       2463 SHOLIN:
1259 B0 00                 2464 	MOV	AL,0
125B 86 06 A8 21           2465 	XCHG	AL,[COUNT]
125F B9 07 00              2466 	MOV	CX,7		;Allow 7 bytes of code per line
1262 2A C8                 2467 	SUB	CL,AL
1264 B0 20                 2468 	MOV	AL,' '
1266 74 0B                 2469 	JZ	NOFIL
1268                       2470 BLNK:				;Put in 3 blanks for each byte not present
1268 E8 E7 00              2471 	CALL	LIST
126B E8 E4 00              2472 	CALL	LIST
126E E8 E1 00              2473 	CALL	LIST
1271 E2 F5                 2474 	LOOP	BLNK
1273                       2475 NOFIL:
1273 E8 45 00              2476 	CALL	OUTLIN
1276 58                    2477 	POP	AX		;Restore error code
1277 E8 92 02              2478 	CALL	REPERR
127A A0 A9 21              2479 	MOV	AL,[ERR]
127D E8 8C 02              2480 	CALL	REPERR
1280 5E                    2481 	POP	SI
1281 59                    2482 	POP	CX
1282 A0 C0 21              2483 	MOV	AL,[SPC]	;Any special funtion?
1285 0A C0                 2484 	OR	AL,AL
1287 75 0D                 2485 	JNZ	SPCFUN
1289 E9 2F FF              2486 	JMP	FIXLINE
128C                       2487 
128C                       2488 SPEND:
128C A2 C0 21              2489 	MOV	[SPC],AL	;Record special function
128F AD                    2490 	LODSW			;Get it's data
1290 A3 42 21              2491 	MOV	[DATA],AX
1293 E9 30 FF              2492 	JMP	NEXBT
1296                       2493 
1296                       2494 SPCFUN:
1296 8B 16 42 21           2495 	MOV	DX,[DATA]
129A 3C FE                 2496 	CMP	AL,-2
129C 74 0F                 2497 	JZ	DORG
129E 3C FD                 2498 	CMP	AL,-3
12A0 74 12                 2499 	JZ	DPUT
12A2                       2500 DDS:
12A2                       2501 ;Handle DS pseudo-op
12A2 01 16 36 21           2502 	ADD	[PC],DX
12A6 01 16 AE 21           2503 	ADD	[HEXADD],DX
12AA E9 0E FF              2504 	JMP	FIXLINE
12AD                       2505 
12AD                       2506 DORG:
12AD                       2507 ;Handle ORG pseudo-op
12AD 89 16 36 21           2508 	MOV	[PC],DX
12B1 E9 07 FF              2509 	JMP	FIXLINE
12B4                       2510 
12B4                       2511 DPUT:
12B4                       2512 ;Handle PUT pseudo-op
12B4 89 16 AE 21           2513 	MOV	[HEXADD],DX
12B8 E9 00 FF              2514 	JMP	FIXLINE
12BB                       2515 
12BB                       2516 OUTLIN:
12BB                       2517 ;Copy the source line to the ouput device. Line will be preceded by
12BB                       2518 ;assembler-generated line number. This routine may be called several times
12BB                       2519 ;on one line (once for each line of object code bytes), so it sets a flag
12BB                       2520 ;so the line will only be output on the first call.
12BB B0 FF                 2521 	MOV	AL,-1
12BD 86 06 B4 21           2522 	XCHG	AL,[LINFLG]
12C1 0A C0                 2523 	OR	AL,AL
12C3 75 35                 2524 	JNZ	CRLF		;Output line only if first time
12C5 A1 AA 21              2525 	MOV	AX,[LINE]
12C8 40                    2526 	INC	AX
12C9 A3 AA 21              2527 	MOV	[LINE],AX
12CC B7 00                 2528 	MOV	BH,0		;No leading zero suppression
12CE E8 32 00              2529 	CALL	OUT10
12D1 B0 20                 2530 	MOV	AL," "
12D3 E8 7C 00              2531 	CALL	LIST
12D6 A0 11 21              2532 	MOV	AL,[LSTFCB]
12D9 3C 5A                 2533 	CMP	AL,'Z'
12DB 74 1D                 2534 	JZ	CRLF		;Don't call NEXTCHR if listing suppressed
12DD 56                    2535 	PUSH	SI		;Save the only register destroyed by NEXTCHR
12DE                       2536 OUTLN:
12DE E8 D7 EF              2537 	CALL	NEXTCHR
12E1 E8 6E 00              2538 	CALL	LIST
12E4 3C 0A                 2539 	CMP	AL,10		;Output until linefeed found
12E6 75 F6                 2540 	JNZ	OUTLN
12E8 5E                    2541 	POP	SI
12E9 C3                    2542 	RET
12EA                       2543 
12EA                       2544 PRTCNT:
12EA A1 B8 21              2545 	MOV	AX,[ERRCNT]
12ED BB 8E 20              2546 	MOV	BX,ERCNTM
12F0                       2547 PRNT10:
12F0 50                    2548 	PUSH	AX
12F1 E8 47 02              2549 	CALL	PRINT
12F4 58                    2550 	POP	AX
12F5 B7 10                 2551 	MOV	BH,"0"-" "	;Enable leading zero suppression
12F7 E8 09 00              2552 	CALL	OUT10
12FA                       2553 CRLF:
12FA B0 0D                 2554 	MOV	AL,13
12FC E8 53 00              2555 	CALL	LIST
12FF B0 0A                 2556 	MOV	AL,10
1301 EB 4F                 2557 	JMPS	LIST
1303                       2558 
1303                       2559 OUT10:
1303 33 D2                 2560 	XOR	DX,DX
1305 BF 10 27              2561 	MOV	DI,10000
1308 F7 F7                 2562 	DIV	AX,DI
130A 0A C0                 2563 	OR	AL,AL		;>10,000?
130C 75 02                 2564 	JNZ	LEAD
130E 2C 10                 2565 	SUB	AL,"0"-" "	;Convert leading zero to blank
1310                       2566 LEAD:
1310 04 30                 2567 	ADD	AL,"0"
1312 E8 3D 00              2568 	CALL	LIST
1315 92                    2569 	XCHG	AX,DX
1316 B3 64                 2570 	MOV	BL,100
1318 F6 F3                 2571 	DIV	AL,BL
131A 8A DC                 2572 	MOV	BL,AH
131C E8 0C 00              2573 	CALL	HIDIG		;Convert to decimal and print 1000s digit
131F E8 0E 00              2574 	CALL	DIGIT		;Print 100s digit
1322 8A C3                 2575 	MOV	AL,BL
1324 E8 04 00              2576 	CALL	HIDIG		;Convert to decimal and print 10s digit
1327 B7 00                 2577 	MOV	BH,0		;Ensure leading zero suppression is off
1329 EB 05                 2578 	JMPS	DIGIT
132B                       2579 
132B                       2580 HIDIG:
132B D4 0A                 2581 	AAM			;Convert binary to unpacked BCD
132D 0D 30 30              2582 	OR	AX,3030H	;Add "0" bias
1330                       2583 DIGIT:
1330 86 C4                 2584 	XCHG	AL,AH
1332 3C 30                 2585 	CMP	AL,"0"
1334 74 02                 2586 	JZ	SUPZ
1336 B7 00                 2587 	MOV	BH,0		;Turn off zero suppression if not zero
1338                       2588 SUPZ:
1338 2A C7                 2589 	SUB	AL,BH		;Convert leading zeros to blanks
133A EB 16                 2590 	JMPS	LIST
133C                       2591 
133C                       2592 STRTLIN:
133C C7 06 B4 21 00 00     2593 	MOV	[LINFLG],0
1342 8B 1E 36 21           2594 	MOV	BX,[PC]
1346 8A C7                 2595 	MOV	AL,BH
1348 E8 50 00              2596 	CALL	PHEX
134B 8A C3                 2597 	MOV	AL,BL
134D                       2598 PHEXB:
134D E8 4B 00              2599 	CALL	PHEX
1350 B0 20                 2600 	MOV	AL,' '
1352                       2601 LIST:
1352 50                    2602 	PUSH	AX
1353 52                    2603 	PUSH	DX
1354 24 7F                 2604 	AND	AL,7FH
1356 8A D0                 2605 	MOV	DL,AL
1358 F7 06 BE 21 03 00     2606 	TEST	[LSTDEV],3	;See if output goes to console
135E 74 04                 2607 	JZ	PRNCHK
1360 B4 02                 2608 	MOV	AH,2
1362 CD 21                 2609 	INT	33		;Output to console
1364                       2610 PRNCHK:
1364 F7 06 BE 21 04 00     2611 	TEST	[LSTDEV],4	;See if output goes to printer
136A 74 04                 2612 	JZ	FILCHK
136C B4 05                 2613 	MOV	AH,5
136E CD 21                 2614 	INT	33		;Output to printer
1370                       2615 FILCHK:
1370 8A C2                 2616 	MOV	AL,DL
1372 5A                    2617 	POP	DX
1373 F7 06 BE 21 80 00     2618 	TEST	[LSTDEV],80H	;See if output goes to a file
1379 74 03                 2619 	JZ	LISTRET
137B E8 02 00              2620 	CALL	WRTBUF
137E                       2621 LISTRET:
137E 58                    2622 	POP	AX
137F C3                    2623 	RET
1380                       2624 
1380                       2625 WRTBUF:
1380 57                    2626 	PUSH	DI
1381 8B 3E C8 21           2627 	MOV	DI,[LSTPNT]
1385 AA                    2628 	STOSB
1386 81 FF 10 26           2629 	CMP	DI,LSTBUF+LSTBUFSIZ
138A 75 09                 2630 	JNZ	SAVPT
138C 50                    2631 	PUSH	AX
138D 51                    2632 	PUSH	CX
138E 52                    2633 	PUSH	DX
138F E8 8B 02              2634 	CALL	FLUSHBUF
1392 5A                    2635 	POP	DX
1393 59                    2636 	POP	CX
1394 58                    2637 	POP	AX
1395                       2638 SAVPT:
1395 89 3E C8 21           2639 	MOV	[LSTPNT],DI
1399 5F                    2640 	POP	DI
139A C3                    2641 	RET
139B                       2642 
139B                       2643 PHEX:
139B 50                    2644 	PUSH	AX
139C E8 9E 02              2645 	CALL	UHALF
139F E8 B0 FF              2646 	CALL	LIST
13A2 58                    2647 	POP	AX
13A3 E8 9F 02              2648 	CALL	LHALF
13A6 EB AA                 2649 	JMPS	LIST
13A8                       2650 
13A8                       2651 FINI:
13A8                       2652 
13A8 81 0E BE 21 01 00     2653 	OR	[LSTDEV],1
13AE E8 39 FF              2654 	CALL	PRTCNT
13B1 BB 9F 20              2655 	MOV	BX,SYMSIZE
13B4 A1 06 00              2656 	MOV	AX,[6]
13B7 2B 06 9F 21           2657 	SUB	AX,[HEAP]		;Size of symbol table
13BB E8 32 FF              2658 	CALL	PRNT10
13BE BB B5 20              2659 	MOV	BX,FRESIZE
13C1 A1 9F 21              2660 	MOV	AX,[HEAP]
13C4 2B 06 A3 21           2661 	SUB	AX,[CODE]		;Free space remaining
13C8 E8 25 FF              2662 	CALL	PRNT10
13CB 81 26 BE 21 FE 00     2663 	AND	[LSTDEV],0FEH
13D1 A0 EC 20              2664 	MOV	AL,[HEXFCB]
13D4 3C 5A                 2665 	CMP	AL,'Z'
13D6 74 35                 2666 	JZ	SYMDMP
13D8 A0 B2 21              2667 	MOV	AL,[HEXCNT]
13DB 3C FB                 2668 	CMP	AL,-5
13DD 74 03                 2669 	JZ	L0012
13DF E8 ED 01              2670 	CALL	ENHEXL
13E2                       2671 L0012:	
13E2 B0 3A                 2672 	MOV	AL,':'
13E4 E8 2C 02              2673 	CALL	PUTCHR
13E7 B5 0A                 2674 	MOV	CH,10
13E9                       2675 HEXEND:
13E9 51                    2676 	PUSH	CX
13EA B0 30                 2677 	MOV	AL,'0'
13EC E8 24 02              2678 	CALL	PUTCHR
13EF 59                    2679 	POP	CX
13F0 FE CD                 2680 	DEC	CH
13F2 75 F5                 2681 	JNZ	HEXEND
13F4 B0 0D                 2682 	MOV	AL,13
13F6 E8 1A 02              2683 	CALL	PUTCHR
13F9 B0 0A                 2684 	MOV	AL,10
13FB E8 15 02              2685 	CALL	PUTCHR
13FE B0 1A                 2686 	MOV	AL,1AH
1400 E8 10 02              2687 	CALL	PUTCHR
1403 E8 F2 01              2688 	CALL	WRTHEX		;Flush HEX file buffer
1406 BA EC 20              2689 	MOV	DX,HEXFCB
1409 B4 10                 2690 	MOV	AH,CLOSE
140B CD 21                 2691 	INT	33
140D                       2692 SYMDMP:
140D A0 A1 21              2693 	MOV	AL,[SYMFLG]
1410 3C 53                 2694 	CMP	AL,'S'
1412 75 2B                 2695 	JNZ	ENDSYM
1414 A0 BE 21              2696 	MOV	AL,[LSTDEV]
1417 0A C0                 2697 	OR	AL,AL		;Any output device for symbol table dump?
1419 75 05                 2698 	JNZ	DOSYMTAB
141B 0C 01                 2699 	OR	AL,1		;If not, send it to console
141D A2 BE 21              2700 	MOV	[LSTDEV],AL
1420                       2701 DOSYMTAB:
1420                       2702 
1420 BB C9 20              2703 	MOV	BX,SYMMES
1423 E8 15 01              2704 	CALL	PRINT
1426 8B 16 9D 21           2705 	MOV	DX,[BASE]
142A 8A C6                 2706 	MOV	AL,DH
142C 0A C2                 2707 	OR	AL,DL
142E 74 0F                 2708 	JZ	ENDSYM
1430 C7 06 A2 21 05 00     2709 	MOV	[SYMLIN],SYMWID  ;No symbols on this line yet
1436 8B 1E 9F 21           2710 	MOV	BX,[HEAP]
143A 8B E3                 2711 	MOV	SP,BX		;Need maximum stack for recursive tree walk
143C E8 1B 00              2712 	CALL	NODE
143F                       2713 ENDSYM:
143F F7 06 BE 21 80 00     2714 	TEST	[LSTDEV],80H	;Print listing to file?
1445 74 10                 2715 	JZ	EXIT
1447 B0 1A                 2716 	MOV	AL,1AH
1449 E8 34 FF              2717 	CALL	WRTBUF		;Write end-of-file mark
144C 8B 3E C8 21           2718 	MOV	DI,[LSTPNT]
1450 E8 CA 01              2719 	CALL	FLUSHBUF
1453 B4 10                 2720 	MOV	AH,CLOSE
1455 CD 21                 2721 	INT	33
1457 E9 A6 EB              2722 EXIT:	JMP	0
145A                       2723 
145A                       2724 NODE:
145A 87 DA                 2725 	XCHG	DX,BX
145C 53                    2726 	PUSH	BX
145D 8A 17                 2727 	MOV	DL,[BX]
145F B6 00                 2728 	MOV	DH,0
1461 43                    2729 	INC	BX
1462 03 DA                 2730 	ADD	BX,DX
1464 8B 17                 2731 	MOV	DX,[BX]
1466 0B D2                 2732 	OR	DX,DX
1468 74 03                 2733 	JZ	L0014
146A E8 ED FF              2734 	CALL	NODE
146D                       2735 L0014:	
146D 5B                    2736 	POP	BX
146E 8A 07                 2737 	MOV	AL,[BX]
1470 43                    2738 	INC	BX
1471 8A E8                 2739 	MOV	CH,AL
1473 04 18                 2740 	ADD	AL,24
1475 D0 E8                 2741 	SHR	AL
1477 D0 E8                 2742 	SHR	AL
1479 D0 E8                 2743 	SHR	AL
147B 8A C8                 2744 	MOV	CL,AL
147D FE C1                 2745 	INC	CL		;Invert last bit
147F 80 E1 01              2746 	AND	CL,1		;Number of extra tabs needed (0 or 1)
1482 D0 E8                 2747 	SHR	AL		;Number of positions wide this symbol needs
1484 28 06 A2 21           2748 	SUB	[SYMLIN],AL
1488 73 0A                 2749 	JNC	WRTSYM		;Will it fit?
148A 2C 05                 2750 	SUB	AL,SYMWID
148C F6 D8                 2751 	NEG	AL
148E A2 A2 21              2752 	MOV	[SYMLIN],AL
1491 E8 66 FE              2753 	CALL	CRLF		;Start new line if not
1494                       2754 WRTSYM:
1494 8A 07                 2755 	MOV	AL,[BX]
1496 43                    2756 	INC	BX
1497 E8 B8 FE              2757 	CALL	LIST
149A FE CD                 2758 	DEC	CH
149C 75 F6                 2759 	JNZ	WRTSYM
149E FE C1                 2760 	INC	CL
14A0                       2761 TABVAL:
14A0 B0 09                 2762 	MOV	AL,9
14A2 E8 AD FE              2763 	CALL	LIST
14A5 E2 F9                 2764 	LOOP	TABVAL
14A7 43                    2765 	INC	BX
14A8 43                    2766 	INC	BX
14A9 53                    2767 	PUSH	BX
14AA 8A 47 04              2768 	MOV	AL,[BX+4]
14AD E8 EB FE              2769 	CALL	PHEX
14B0 8A 47 03              2770 	MOV	AL,[BX+3]
14B3 E8 E5 FE              2771 	CALL	PHEX
14B6 83 3E A2 21 00        2772 	CMP	[SYMLIN],0	;Will any more fit on line?
14BB 74 07                 2773 	JZ	NEXSYMLIN
14BD B0 09                 2774 	MOV	AL,9
14BF E8 90 FE              2775 	CALL	LIST
14C2 EB 09                 2776 	JMPS	RIGHTSON
14C4                       2777 NEXSYMLIN:
14C4 E8 33 FE              2778 	CALL	CRLF
14C7 C7 06 A2 21 05 00     2779 	MOV	[SYMLIN],SYMWID
14CD                       2780 RIGHTSON:
14CD 5B                    2781 	POP	BX
14CE 8B 17                 2782 	MOV	DX,[BX]
14D0 0B D2                 2783 	OR	DX,DX
14D2 75 86                 2784 	JNZ	NODE
14D4 C3                    2785 	RET
14D5                       2786 
14D5                       2787 SAVCD:
14D5 A2 B5 21              2788 	MOV	[PREV],AL
14D8 53                    2789 	PUSH	BX
14D9 51                    2790 	PUSH	CX
14DA 50                    2791 	PUSH	AX
14DB 52                    2792 	PUSH	DX
14DC E8 7D 00              2793 	CALL	CODBYT
14DF 5A                    2794 	POP	DX
14E0 BB A8 21              2795 	MOV	BX,COUNT
14E3 FF 07                 2796 	INC	[BX]
14E5 8A 07                 2797 	MOV	AL,[BX]
14E7 3C 08                 2798 	CMP	AL,8
14E9 75 12                 2799 	JNZ	NOEXT
14EB C7 07 01 00           2800 	MOV	[BX],1
14EF E8 C9 FD              2801 	CALL	OUTLIN
14F2 B0 20                 2802 	MOV	AL,' '
14F4 B5 05                 2803 	MOV	CH,5
14F6                       2804 TAB:
14F6 E8 59 FE              2805 	CALL	LIST
14F9 FE CD                 2806 	DEC	CH
14FB 75 F9                 2807 	JNZ	TAB
14FD                       2808 NOEXT:
14FD 58                    2809 	POP	AX
14FE E8 4C FE              2810 	CALL	PHEXB
1501 59                    2811 	POP	CX
1502 FF 06 36 21           2812 	INC	[PC]
1506 FF 06 AE 21           2813 	INC	[HEXADD]
150A 5B                    2814 	POP	BX
150B                       2815 REPERRUDRET:
150B                       2816 PRINTUDRET:
150B C3                    2817 	RET
150C                       2818 
150C                       2819 REPERR:
150C 0A C0                 2820 	OR	AL,AL		;Did an error occur?
150E 74 FB                 2821 	JZ	REPERRUDRET
1510 FF 06 B8 21           2822 	INC	[ERRCNT]
1514 50                    2823 	PUSH	AX
1515 BB 18 20              2824 	MOV	BX,ERRMES	;Print "ERROR"
1518 E8 20 00              2825 	CALL	PRINT
151B 58                    2826 	POP	AX
151C                       2827 ;We have error number in AL. See if there's an error message for it
151C BF 49 1C              2828 	MOV	DI,ERRTAB
151F B3 80                 2829 	MOV	BL,80H
1521                       2830 ERRLOOK:
1521 AE                    2831 	SCASB			;Do we have the error message
1522 76 07                 2832 	JBE	HAVMES		;Quit looking if we have it or passed it
1524 93                    2833 	XCHG	AX,BX		;Put 80H in AL to look for end of this message
1525                       2834 NEXTMES:
1525 AE                    2835 	SCASB			;Look for high bit set in message
1526 77 FD                 2836 	JA	NEXTMES		;   which means we've reached the end
1528 93                    2837 	XCHG	AX,BX		;Restore error number to AL
1529 EB F6                 2838 	JMPS	ERRLOOK		;Keep looking
152B                       2839 
152B                       2840 HAVMES:
152B 8B DF                 2841 	MOV	BX,DI		;Put address of message in BX
152D 74 06                 2842 	JZ	PRNERR		;Do we have a message for this error?
152F E8 69 FE              2843 	CALL	PHEX		;If not, just print error number
1532 E9 C5 FD              2844 	JMP	CRLF
1535                       2845 
1535                       2846 PRNERR:
1535 E8 03 00              2847 	CALL	PRINT
1538 E9 BF FD              2848 	JMP	CRLF
153B                       2849 
153B                       2850 PRINT:
153B 8A 07                 2851 	MOV	AL,[BX]
153D E8 12 FE              2852 	CALL	LIST
1540 0A C0                 2853 	OR	AL,AL
1542 78 C7                 2854 	JS	PRINTUDRET
1544 43                    2855 	INC	BX
1545 EB F4                 2856 	JMPS	PRINT
1547                       2857 OUTA:
1547 8A D0                 2858 	MOV	DL,AL
1549                       2859 OUT:
1549 80 E2 7F              2860 	AND	DL,7FH
154C B1 02                 2861 	MOV	CL,2
154E                       2862 SYSTEM:
154E                       2863 	;CLOSE INPUT FILE
154E BA 5C 00              2864 	MOV	DX,FCB
1551 B4 10                 2865 	MOV	AH,CLOSE
1553 CD 21                 2866 	INT	33
1555 90                    2867 	NOP
1556 B8 00 4C              2868 	MOV AX,4C00H
1559 CD 21                 2869 	INT 21H		;Terminate program
155B                       2870 	;CALL	5
155B                       2871 	;RET
155B                       2872 CODBYTUDRETUP:
155B C3                    2873 	RET
155C                       2874 CODBYT:
155C 83 3E EC 20 5A        2875 	CMP	[HEXFCB],"Z"
1561 74 F8                 2876 	JZ	CODBYTUDRETUP
1563 50                    2877 	PUSH	AX
1564 8B 16 B0 21           2878 	MOV	DX,[LASTAD]
1568 8B 1E AE 21           2879 	MOV	BX,[HEXADD]
156C 89 1E B0 21           2880 	MOV	[LASTAD],BX
1570 42                    2881 	INC	DX
1571 A0 B2 21              2882 	MOV	AL,[HEXCNT]
1574 3C FB                 2883 	CMP	AL,-5
1576 74 07                 2884 	JZ	NEWLIN
1578 3B DA                 2885 	CMP	BX,DX
157A 74 2E                 2886 	JZ	AFHEX
157C E8 50 00              2887 	CALL	ENHEXL
157F                       2888 NEWLIN:
157F B0 3A                 2889 	MOV	AL,':'
1581 E8 8F 00              2890 	CALL	PUTCHR
1584 B0 FC                 2891 	MOV	AL,-4
1586 A2 B2 21              2892 	MOV	[HEXCNT],AL
1589 32 C0                 2893 	XOR	AL,AL
158B A2 B3 21              2894 	MOV	[CHKSUM],AL
158E 8B 1E C6 21           2895 	MOV	BX,[HEXPNT]
1592 89 1E AC 21           2896 	MOV	[HEXLEN],BX
1596 E8 12 00              2897 	CALL	HEXBYT
1599 A0 AF 21              2898 	MOV	AL,[HEXADD+1]
159C E8 0C 00              2899 	CALL	HEXBYT
159F A0 AE 21              2900 	MOV	AL,[HEXADD]
15A2 E8 06 00              2901 	CALL	HEXBYT
15A5 32 C0                 2902 	XOR	AL,AL
15A7 E8 01 00              2903 	CALL	HEXBYT
15AA                       2904 AFHEX:
15AA 58                    2905 	POP	AX
15AB                       2906 HEXBYT:
15AB 8A E8                 2907 	MOV	CH,AL
15AD BB B3 21              2908 	MOV	BX,CHKSUM
15B0 02 07                 2909 	ADD	AL,[BX]
15B2 88 07                 2910 	MOV	[BX],AL
15B4 8A C5                 2911 	MOV	AL,CH
15B6 E8 84 00              2912 	CALL	UHALF
15B9 E8 57 00              2913 	CALL	PUTCHR
15BC 8A C5                 2914 	MOV	AL,CH
15BE E8 84 00              2915 	CALL	LHALF
15C1 E8 4F 00              2916 	CALL	PUTCHR
15C4 BB B2 21              2917 	MOV	BX,HEXCNT
15C7 FF 07                 2918 	INC	[BX]
15C9 8A 07                 2919 	MOV	AL,[BX]
15CB 3C 1A                 2920 	CMP	AL,26
15CD 75 43                 2921 	JNZ	CODBYTUDRET
15CF                       2922 ENHEXL:
15CF 8B 3E AC 21           2923 	MOV	DI,[HEXLEN]
15D3 8A E8                 2924 	MOV	CH,AL
15D5 E8 65 00              2925 	CALL	UHALF
15D8 AA                    2926 	STOSB
15D9 8A C5                 2927 	MOV	AL,CH
15DB E8 67 00              2928 	CALL	LHALF
15DE AA                    2929 	STOSB
15DF B0 FA                 2930 	MOV	AL,-6
15E1 A2 B2 21              2931 	MOV	[HEXCNT],AL
15E4 A0 B3 21              2932 	MOV	AL,[CHKSUM]
15E7 02 C5                 2933 	ADD	AL,CH
15E9 F6 D8                 2934 	NEG	AL
15EB E8 BD FF              2935 	CALL	HEXBYT
15EE B0 0D                 2936 	MOV	AL,13
15F0 E8 20 00              2937 	CALL	PUTCHR
15F3 B0 0A                 2938 	MOV	AL,10
15F5 E8 1B 00              2939 	CALL	PUTCHR
15F8                       2940 WRTHEX:
15F8                       2941 ;Write out the line
15F8 BA CA 21              2942 	MOV	DX,HEXBUF
15FB 89 16 C6 21           2943 	MOV	[HEXPNT],DX
15FF B4 1A                 2944 	MOV	AH,SETDMA
1601 CD 21                 2945 	INT	33
1603 2B FA                 2946 	SUB	DI,DX		;Length of buffer
1605 8B CF                 2947 	MOV	CX,DI
1607 BA EC 20              2948 	MOV	DX,HEXFCB
160A B4 28                 2949 	MOV	AH,BLKWRT
160C CD 21                 2950 	INT	33
160E 0A C0                 2951 	OR	AL,AL
1610 75 25                 2952 	JNZ	DSKFUL
1612                       2953 CODBYTUDRET:
1612                       2954 FLUSHBUFUDRET:
1612 C3                    2955 	RET
1613                       2956 PUTCHR:
1613 8B 3E C6 21           2957 	MOV	DI,[HEXPNT]
1617 AA                    2958 	STOSB
1618 89 3E C6 21           2959 	MOV	[HEXPNT],DI
161C C3                    2960 	RET
161D                       2961 
161D                       2962 FLUSHBUF:
161D 8B CF                 2963 	MOV	CX,DI
161F BA 10 22              2964 	MOV	DX,LSTBUF
1622 8B FA                 2965 	MOV	DI,DX
1624 2B CA                 2966 	SUB	CX,DX
1626 74 EA                 2967 	JZ	FLUSHBUFUDRET		;Buffer empty?
1628 B4 1A                 2968 	MOV	AH,SETDMA
162A CD 21                 2969 	INT	33
162C BA 11 21              2970 	MOV	DX,LSTFCB
162F B4 28                 2971 	MOV	AH,BLKWRT
1631 CD 21                 2972 	INT	33
1633 0A C0                 2973 	OR	AL,AL
1635 74 DB                 2974 	JZ	FLUSHBUFUDRET
1637                       2975 DSKFUL:
1637 BB 69 20              2976 	MOV	BX,WRTERR
163A E9 3A EC              2977 	JMP	PRERR
163D                       2978 UHALF:
163D D0 D8                 2979 	RCR	AL
163F D0 D8                 2980 	RCR	AL
1641 D0 D8                 2981 	RCR	AL
1643 D0 D8                 2982 	RCR	AL
1645                       2983 LHALF:
1645 24 0F                 2984 	AND	AL,0FH
1647 0C 30                 2985 	OR	AL,30H
1649 3C 3A                 2986 	CMP	AL,'9'+1
164B 72 02                 2987 	JC	LHALFUDRET
164D 04 07                 2988 	ADD	AL,7
164F                       2989 LHALFUDRET:
164F C3                    2990 	RET
1650                       2991 
1650 00                    2992 NONE:	DB	0
1651                       2993 
1651                       2994 ; 8086 MNEMONIC TABLE
1651                       2995 
1651                       2996 ; This table is actually a sequence of subtables, each starting with a label.
1651                       2997 ; The label signifies which mnemonics the subtable applies to--A3, for example,
1651                       2998 ; means all 3-letter mnemonics beginning with A.
1651                       2999 
1651                       3000 A3:
1651 07                    3001 	DB	7
1652 64 64                 3002 	DB	'dd'
1654 CD 0D                 3003 	DW	GRP7
1656 02                    3004 	DB	2
1657 6E 64                 3005 	DB	'nd'
1659 A3 0E                 3006 	DW	GRP13
165B 22                    3007 	DB	22H
165C 64 63                 3008 	DB	'dc'
165E CD 0D                 3009 	DW	GRP7
1660 12                    3010 	DB	12H
1661 61 61                 3011 	DB	'aa'
1663 A6 0B                 3012 	DW	PUT
1665 37                    3013 	DB	37H
1666 61 73                 3014 	DB	'as'
1668 A6 0B                 3015 	DW	PUT
166A 3F                    3016 	DB	3FH
166B 61 6D                 3017 	DB	'am'
166D 71 0E                 3018 	DW	GRP11
166F D4                    3019 	DB	0D4H
1670 61 64                 3020 	DB	'ad'
1672 71 0E                 3021 	DW	GRP11
1674 D5                    3022 	DB	0D5H
1675                       3023 A5:
1675 01                    3024 	DB	1
1676 6C 69 67 6E           3025 	DB	'lign'
167A 79 0D                 3026 	DW	UDALIGN
167C 00                    3027 	DB	0
167D                       3028 C3:
167D 07                    3029 	DB	7
167E 6D 70                 3030 	DB	'mp'
1680 CD 0D                 3031 	DW	GRP7
1682 3A                    3032 	DB	3AH
1683 6C 63                 3033 	DB	'lc'
1685 A6 0B                 3034 	DW	PUT
1687 F8                    3035 	DB	0F8H
1688 6C 64                 3036 	DB	'ld'
168A A6 0B                 3037 	DW	PUT
168C FC                    3038 	DB	0FCH
168D 6C 69                 3039 	DB	'li'
168F A6 0B                 3040 	DW	PUT
1691 FA                    3041 	DB	0FAH
1692 6D 63                 3042 	DB	'mc'
1694 A6 0B                 3043 	DW	PUT
1696 F5                    3044 	DB	0F5H
1697 62 77                 3045 	DB	'bw'
1699 A6 0B                 3046 	DW	PUT
169B 98                    3047 	DB	98H
169C 77 64                 3048 	DB	'wd'
169E A6 0B                 3049 	DW	PUT
16A0 99                    3050 	DB	99H
16A1                       3051 C4:
16A1 03                    3052 	DB	3
16A2 61 6C 6C              3053 	DB	'all'
16A5 CD 0E                 3054 	DW	GRP14
16A7 9A                    3055 	DB	9AH
16A8 6D 70 62              3056 	DB	'mpb'
16AB A6 0B                 3057 	DW	PUT
16AD A6                    3058 	DB	0A6H
16AE 6D 70 77              3059 	DB	'mpw'
16B1 A6 0B                 3060 	DW	PUT
16B3 A7                    3061 	DB	0A7H
16B4                       3062 C5:
16B4 02                    3063 	DB	2
16B5 6D 70 73 62           3064 	DB	'mpsb'
16B9 A6 0B                 3065 	DW	PUT
16BB A6                    3066 	DB	0A6H
16BC 6D 70 73 77           3067 	DB	'mpsw'
16C0 A6 0B                 3068 	DW	PUT
16C2 A7                    3069 	DB	0A7H
16C3                       3070 D2:
16C3 05                    3071 	DB	5
16C4 62                    3072 	DB	'b'
16C5 DA 10                 3073 	DW	GRP23
16C7 01                    3074 	DB	1
16C8 77                    3075 	DB	'w'
16C9 DA 10                 3076 	DW	GRP23
16CB 00                    3077 	DB	0
16CC 6D                    3078 	DB	'm'
16CD DA 10                 3079 	DW	GRP23
16CF 02                    3080 	DB	2
16D0 73                    3081 	DB	's'
16D1 47 0D                 3082 	DW	GRP5
16D3 01                    3083 	DB	1
16D4 69                    3084 	DB	'i'
16D5 A6 0B                 3085 	DW	PUT
16D7 FA                    3086 	DB	0FAH
16D8                       3087 D3:
16D8 04                    3088 	DB	4
16D9 65 63                 3089 	DB	'ec'
16DB F5 0D                 3090 	DW	GRP8
16DD 49                    3091 	DB	49H
16DE 69 76                 3092 	DB	'iv'
16E0 49 0E                 3093 	DW	GRP10
16E2 30                    3094 	DB	30H
16E3 61 61                 3095 	DB	'aa'
16E5 A6 0B                 3096 	DW	PUT
16E7 27                    3097 	DB	27H
16E8 61 73                 3098 	DB	'as'
16EA A6 0B                 3099 	DW	PUT
16EC 2F                    3100 	DB	2FH
16ED                       3101 D4:
16ED 01                    3102 	DB	1
16EE 6F 77 6E              3103 	DB	'own'
16F1 A6 0B                 3104 	DW	PUT
16F3 FD                    3105 	DB	0FDH
16F4                       3106 E2:
16F4 01                    3107 	DB	1
16F5 69                    3108 	DB	'i'
16F6 A6 0B                 3109 	DW	PUT
16F8 FB                    3110 	DB	0FBH
16F9                       3111 E3:
16F9 03                    3112 	DB	3
16FA 71 75                 3113 	DB	'qu'
16FC 47 0D                 3114 	DW	GRP5
16FE 02                    3115 	DB	2
16FF 73 63                 3116 	DB	'sc'
1701 29 10                 3117 	DW	GRP19
1703 D8                    3118 	DB	0D8H
1704 6E 64                 3119 	DB	'nd'
1706 68 11                 3120 	DW	UDEND
1708 00                    3121 	DB	0
1709                       3122 E5:
1709 01                    3123 	DB	1
170A 6E 64 69 66           3124 	DB	'ndif'
170E 58 11                 3125 	DW	UDENDIF
1710 00                    3126 	DB	0
1711                       3127 H3:
1711 01                    3128 	DB	1
1712 6C 74                 3129 	DB	'lt'
1714 A6 0B                 3130 	DW	PUT
1716 F4                    3131 	DB	0F4H
1717                       3132 H4:
1717 01                    3133 	DB	1
1718 61 6C 74              3134 	DB	'alt'
171B A6 0B                 3135 	DW	PUT
171D F4                    3136 	DB	0F4H
171E                       3137 I2:
171E 02                    3138 	DB	2
171F 6E                    3139 	DB	'n'
1720 21 0D                 3140 	DW	GRP4
1722 E4                    3141 	DB	0E4H
1723 66                    3142 	DB	'f'
1724 47 0D                 3143 	DW	GRP5
1726 04                    3144 	DB	4
1727                       3145 I3:
1727 04                    3146 	DB	4
1728 6E 63                 3147 	DB	'nc'
172A F5 0D                 3148 	DW	GRP8
172C 41                    3149 	DB	41H
172D 6E 62                 3150 	DB	'nb'
172F 21 0D                 3151 	DW	GRP4
1731 E4                    3152 	DB	0E4H
1732 6E 77                 3153 	DB	'nw'
1734 21 0D                 3154 	DW	GRP4
1736 E5                    3155 	DB	0E5H
1737 6E 74                 3156 	DB	'nt'
1739 FE 0F                 3157 	DW	GRP18
173B CC                    3158 	DB	0CCH
173C                       3159 I4:
173C 04                    3160 	DB	4
173D 6D 75 6C              3161 	DB	'mul'
1740 49 0E                 3162 	DW	GRP10
1742 28                    3163 	DB	28H
1743 64 69 76              3164 	DB	'div'
1746 49 0E                 3165 	DW	GRP10
1748 38                    3166 	DB	38H
1749 72 65 74              3167 	DB	'ret'
174C A6 0B                 3168 	DW	PUT
174E CF                    3169 	DB	0CFH
174F 6E 74 6F              3170 	DB	'nto'
1752 A6 0B                 3171 	DW	PUT
1754 CE                    3172 	DB	0CEH
1755                       3173 J2:
1755 0A                    3174 	DB	10
1756 70                    3175 	DB	'p'
1757 C5 0F                 3176 	DW	GRP17
1759 EB                    3177 	DB	0EBH
175A 7A                    3178 	DB	'z'
175B C5 0F                 3179 	DW	GRP17
175D 74                    3180 	DB	74H
175E 65                    3181 	DB	'e'
175F C5 0F                 3182 	DW	GRP17
1761 74                    3183 	DB	74H
1762 6C                    3184 	DB	'l'
1763 C5 0F                 3185 	DW	GRP17
1765 7C                    3186 	DB	7CH
1766 62                    3187 	DB	'b'
1767 C5 0F                 3188 	DW	GRP17
1769 72                    3189 	DB	72H
176A 61                    3190 	DB	'a'
176B C5 0F                 3191 	DW	GRP17
176D 77                    3192 	DB	77H
176E 67                    3193 	DB	'g'
176F C5 0F                 3194 	DW	GRP17
1771 7F                    3195 	DB	7FH
1772 6F                    3196 	DB	'o'
1773 C5 0F                 3197 	DW	GRP17
1775 70                    3198 	DB	70H
1776 73                    3199 	DB	's'
1777 C5 0F                 3200 	DW	GRP17
1779 78                    3201 	DB	78H
177A 63                    3202 	DB	'c'
177B C5 0F                 3203 	DW	GRP17
177D 72                    3204 	DB	72H
177E                       3205 J3:
177E 11                    3206 	DB	17
177F 6D 70                 3207 	DB	'mp'
1781 CD 0E                 3208 	DW	GRP14
1783 EA                    3209 	DB	0EAH
1784 6E 7A                 3210 	DB	'nz'
1786 C5 0F                 3211 	DW	GRP17
1788 75                    3212 	DB	75H
1789 6E 65                 3213 	DB	'ne'
178B C5 0F                 3214 	DW	GRP17
178D 75                    3215 	DB	75H
178E 6E 6C                 3216 	DB	'nl'
1790 C5 0F                 3217 	DW	GRP17
1792 7D                    3218 	DB	7DH
1793 67 65                 3219 	DB	'ge'
1795 C5 0F                 3220 	DW	GRP17
1797 7D                    3221 	DB	7DH
1798 6E 62                 3222 	DB	'nb'
179A C5 0F                 3223 	DW	GRP17
179C 73                    3224 	DB	73H
179D 61 65                 3225 	DB	'ae'
179F C5 0F                 3226 	DW	GRP17
17A1 73                    3227 	DB	73H
17A2 6E 63                 3228 	DB	'nc'
17A4 C5 0F                 3229 	DW	GRP17
17A6 73                    3230 	DB	73H
17A7 6E 67                 3231 	DB	'ng'
17A9 C5 0F                 3232 	DW	GRP17
17AB 7E                    3233 	DB	7EH
17AC 6C 65                 3234 	DB	'le'
17AE C5 0F                 3235 	DW	GRP17
17B0 7E                    3236 	DB	7EH
17B1 6E 61                 3237 	DB	'na'
17B3 C5 0F                 3238 	DW	GRP17
17B5 76                    3239 	DB	76H
17B6 62 65                 3240 	DB	'be'
17B8 C5 0F                 3241 	DW	GRP17
17BA 76                    3242 	DB	76H
17BB 70 65                 3243 	DB	'pe'
17BD C5 0F                 3244 	DW	GRP17
17BF 7A                    3245 	DB	7AH
17C0 6E 70                 3246 	DB	'np'
17C2 C5 0F                 3247 	DW	GRP17
17C4 7B                    3248 	DB	7BH
17C5 70 6F                 3249 	DB	'po'
17C7 C5 0F                 3250 	DW	GRP17
17C9 7B                    3251 	DB	7BH
17CA 6E 6F                 3252 	DB	'no'
17CC C5 0F                 3253 	DW	GRP17
17CE 71                    3254 	DB	71H
17CF 6E 73                 3255 	DB	'ns'
17D1 C5 0F                 3256 	DW	GRP17
17D3 79                    3257 	DB	79H
17D4                       3258 J4:
17D4 06                    3259 	DB	6
17D5 6D 70 73              3260 	DB	'mps'
17D8 C5 0F                 3261 	DW	GRP17
17DA EB                    3262 	DB	0EBH
17DB 63 78 7A              3263 	DB	'cxz'
17DE C5 0F                 3264 	DW	GRP17
17E0 E3                    3265 	DB	0E3H
17E1 6E 67 65              3266 	DB	'nge'
17E4 C5 0F                 3267 	DW	GRP17
17E6 7C                    3268 	DB	7CH
17E7 6E 61 65              3269 	DB	'nae'
17EA C5 0F                 3270 	DW	GRP17
17EC 72                    3271 	DB	72H
17ED 6E 62 65              3272 	DB	'nbe'
17F0 C5 0F                 3273 	DW	GRP17
17F2 77                    3274 	DB	77H
17F3 6E 6C 65              3275 	DB	'nle'
17F6 C5 0F                 3276 	DW	GRP17
17F8 7F                    3277 	DB	7FH
17F9                       3278 L3:
17F9 03                    3279 	DB	3
17FA 65 61                 3280 	DB	'ea'
17FC C1 0D                 3281 	DW	GRP6
17FE 8D                    3282 	DB	8DH
17FF 64 73                 3283 	DB	'ds'
1801 C1 0D                 3284 	DW	GRP6
1803 C5                    3285 	DB	0C5H
1804 65 73                 3286 	DB	'es'
1806 C1 0D                 3287 	DW	GRP6
1808 C4                    3288 	DB	0C4H
1809                       3289 L4:
1809 05                    3290 	DB	5
180A 6F 6F 70              3291 	DB	'oop'
180D C5 0F                 3292 	DW	GRP17
180F E2                    3293 	DB	0E2H
1810 6F 64 62              3294 	DB	'odb'
1813 A6 0B                 3295 	DW	PUT
1815 AC                    3296 	DB	0ACH
1816 6F 64 77              3297 	DB	'odw'
1819 A6 0B                 3298 	DW	PUT
181B AD                    3299 	DB	0ADH
181C 61 68 66              3300 	DB	'ahf'
181F A6 0B                 3301 	DW	PUT
1821 9F                    3302 	DB	9FH
1822 6F 63 6B              3303 	DB	'ock'
1825 A6 0B                 3304 	DW	PUT
1827 F0                    3305 	DB	0F0H
1828                       3306 L5:
1828 04                    3307 	DB	4
1829 6F 6F 70 65           3308 	DB	'oope'
182D C5 0F                 3309 	DW	GRP17
182F E1                    3310 	DB	0E1H
1830 6F 6F 70 7A           3311 	DB	'oopz'
1834 C5 0F                 3312 	DW	GRP17
1836 E1                    3313 	DB	0E1H
1837 6F 64 73 62           3314 	DB	'odsb'
183B A6 0B                 3315 	DW	PUT
183D AC                    3316 	DB	0ACH
183E 6F 64 73 77           3317 	DB	'odsw'
1842 A6 0B                 3318 	DW	PUT
1844 AD                    3319 	DB	0ADH
1845                       3320 L6:
1845 02                    3321 	DB	2
1846 6F 6F 70 6E 65        3322 	DB	'oopne'
184B C5 0F                 3323 	DW	GRP17
184D E0                    3324 	DB	0E0H
184E 6F 6F 70 6E 7A        3325 	DB	'oopnz'
1853 C5 0F                 3326 	DW	GRP17
1855 E0                    3327 	DB	0E0H
1856                       3328 M3:
1856 02                    3329 	DB	2
1857 6F 76                 3330 	DB	'ov'
1859 3D 0B                 3331 	DW	GRP1
185B 88                    3332 	DB	88H
185C 75 6C                 3333 	DB	'ul'
185E 49 0E                 3334 	DW	GRP10
1860 20                    3335 	DB	20H
1861                       3336 M4:
1861 02                    3337 	DB	2
1862 6F 76 62              3338 	DB	'ovb'
1865 A6 0B                 3339 	DW	PUT
1867 A4                    3340 	DB	0A4H
1868 6F 76 77              3341 	DB	'ovw'
186B A6 0B                 3342 	DW	PUT
186D A5                    3343 	DB	0A5H
186E                       3344 M5:
186E 02                    3345 	DB	2
186F 6F 76 73 62           3346 	DB	'ovsb'
1873 A6 0B                 3347 	DW	PUT
1875 A4                    3348 	DB	0A4H
1876 6F 76 73 77           3349 	DB	'ovsw'
187A A6 0B                 3350 	DW	PUT
187C A5                    3351 	DB	0A5H
187D                       3352 N3:
187D 03                    3353 	DB	3
187E 6F 74                 3354 	DB	'ot'
1880 FB 0D                 3355 	DW	GRP9
1882 10                    3356 	DB	10H
1883 65 67                 3357 	DB	'eg'
1885 FB 0D                 3358 	DW	GRP9
1887 18                    3359 	DB	18H
1888 6F 70                 3360 	DB	'op'
188A A6 0B                 3361 	DW	PUT
188C 90                    3362 	DB	90H
188D                       3363 O2:
188D 01                    3364 	DB	1
188E 72                    3365 	DB	'r'
188F A3 0E                 3366 	DW	GRP13
1891 0A                    3367 	DB	0AH
1892                       3368 O3:
1892 02                    3369 	DB	2
1893 75 74                 3370 	DB	'ut'
1895 21 0D                 3371 	DW	GRP4
1897 E6                    3372 	DB	0E6H
1898 72 67                 3373 	DB	'rg'
189A 47 0D                 3374 	DW	GRP5
189C 00                    3375 	DB	0
189D                       3376 O4:
189D 02                    3377 	DB	2
189E 75 74 62              3378 	DB	'utb'
18A1 21 0D                 3379 	DW	GRP4
18A3 E6                    3380 	DB	0E6H
18A4 75 74 77              3381 	DB	'utw'
18A7 21 0D                 3382 	DW	GRP4
18A9 E7                    3383 	DB	0E7H
18AA                       3384 P3:
18AA 02                    3385 	DB	2
18AB 6F 70                 3386 	DB	'op'
18AD B9 10                 3387 	DW	GRP22
18AF 8F                    3388 	DB	8FH
18B0 75 74                 3389 	DB	'ut'
18B2 47 0D                 3390 	DW	GRP5
18B4 03                    3391 	DB	3
18B5                       3392 P4:
18B5 02                    3393 	DB	2
18B6 75 73 68              3394 	DB	'ush'
18B9 90 0C                 3395 	DW	GRP2
18BB FF                    3396 	DB	0FFH
18BC 6F 70 66              3397 	DB	'opf'
18BF A6 0B                 3398 	DW	PUT
18C1 9D                    3399 	DB	9DH
18C2                       3400 P5:
18C2 01                    3401 	DB	1
18C3 75 73 68 66           3402 	DB	'ushf'
18C7 A6 0B                 3403 	DW	PUT
18C9 9C                    3404 	DB	9CH
18CA                       3405 R3:
18CA 06                    3406 	DB	6
18CB 65 74                 3407 	DB	'et'
18CD 4C 0F                 3408 	DW	GRP16
18CF C3                    3409 	DB	0C3H
18D0 65 70                 3410 	DB	'ep'
18D2 A6 0B                 3411 	DW	PUT
18D4 F3                    3412 	DB	0F3H
18D5 6F 6C                 3413 	DB	'ol'
18D7 79 0E                 3414 	DW	GRP12
18D9 00                    3415 	DB	0
18DA 6F 72                 3416 	DB	'or'
18DC 79 0E                 3417 	DW	GRP12
18DE 08                    3418 	DB	8
18DF 63 6C                 3419 	DB	'cl'
18E1 79 0E                 3420 	DW	GRP12
18E3 10                    3421 	DB	10H
18E4 63 72                 3422 	DB	'cr'
18E6 79 0E                 3423 	DW	GRP12
18E8 18                    3424 	DB	18H
18E9                       3425 R4:
18E9 02                    3426 	DB	2
18EA 65 70 7A              3427 	DB	'epz'
18ED A6 0B                 3428 	DW	PUT
18EF F3                    3429 	DB	0F3H
18F0 65 70 65              3430 	DB	'epe'
18F3 A6 0B                 3431 	DW	PUT
18F5 F3                    3432 	DB	0F3H
18F6                       3433 R5:
18F6 02                    3434 	DB	2
18F7 65 70 6E 7A           3435 	DB	'epnz'
18FB A6 0B                 3436 	DW	PUT
18FD F2                    3437 	DB	0F2H
18FE 65 70 6E 65           3438 	DB	'epne'
1902 A6 0B                 3439 	DW	PUT
1904 F2                    3440 	DB	0F2H
1905                       3441 S3:
1905 0B                    3442 	DB	11
1906 75 62                 3443 	DB	'ub'
1908 CD 0D                 3444 	DW	GRP7
190A 2A                    3445 	DB	2AH
190B 62 62                 3446 	DB	'bb'
190D CD 0D                 3447 	DW	GRP7
190F 1A                    3448 	DB	1AH
1910 62 63                 3449 	DB	'bc'
1912 CD 0D                 3450 	DW	GRP7
1914 1A                    3451 	DB	1AH
1915 74 63                 3452 	DB	'tc'
1917 A6 0B                 3453 	DW	PUT
1919 F9                    3454 	DB	0F9H
191A 74 64                 3455 	DB	'td'
191C A6 0B                 3456 	DW	PUT
191E FD                    3457 	DB	0FDH
191F 74 69                 3458 	DB	'ti'
1921 A6 0B                 3459 	DW	PUT
1923 FB                    3460 	DB	0FBH
1924 68 6C                 3461 	DB	'hl'
1926 79 0E                 3462 	DW	GRP12
1928 20                    3463 	DB	20H
1929 68 72                 3464 	DB	'hr'
192B 79 0E                 3465 	DW	GRP12
192D 28                    3466 	DB	28H
192E 61 6C                 3467 	DB	'al'
1930 79 0E                 3468 	DW	GRP12
1932 20                    3469 	DB	20H
1933 61 72                 3470 	DB	'ar'
1935 79 0E                 3471 	DW	GRP12
1937 38                    3472 	DB	38H
1938 65 67                 3473 	DB	'eg'
193A A1 10                 3474 	DW	GRP21
193C 26                    3475 	DB	26H
193D                       3476 S4:
193D 05                    3477 	DB	5
193E 63 61 62              3478 	DB	'cab'
1941 A6 0B                 3479 	DW	PUT
1943 AE                    3480 	DB	0AEH
1944 63 61 77              3481 	DB	'caw'
1947 A6 0B                 3482 	DW	PUT
1949 AF                    3483 	DB	0AFH
194A 74 6F 62              3484 	DB	'tob'
194D A6 0B                 3485 	DW	PUT
194F AA                    3486 	DB	0AAH
1950 74 6F 77              3487 	DB	'tow'
1953 A6 0B                 3488 	DW	PUT
1955 AB                    3489 	DB	0ABH
1956 61 68 66              3490 	DB	'ahf'
1959 A6 0B                 3491 	DW	PUT
195B 9E                    3492 	DB	9EH
195C                       3493 S5:
195C 04                    3494 	DB	4
195D 63 61 73 62           3495 	DB	'casb'
1961 A6 0B                 3496 	DW	PUT
1963 AE                    3497 	DB	0AEH
1964 63 61 73 77           3498 	DB	'casw'
1968 A6 0B                 3499 	DW	PUT
196A AF                    3500 	DB	0AFH
196B 74 6F 73 62           3501 	DB	'tosb'
196F A6 0B                 3502 	DW	PUT
1971 AA                    3503 	DB	0AAH
1972 74 6F 73 77           3504 	DB	'tosw'
1976 A6 0B                 3505 	DW	PUT
1978 AB                    3506 	DB	0ABH
1979                       3507 T4:
1979 01                    3508 	DB	1
197A 65 73 74              3509 	DB	'est'
197D 90 10                 3510 	DW	GRP20
197F 84                    3511 	DB	84H
1980                       3512 U2:
1980 01                    3513 	DB	1
1981 70                    3514 	DB	'p'
1982 A6 0B                 3515 	DW	PUT
1984 FC                    3516 	DB	0FCH
1985                       3517 W4:
1985 01                    3518 	DB	1
1986 61 69 74              3519 	DB	'ait'
1989 A6 0B                 3520 	DW	PUT
198B 9B                    3521 	DB	9BH
198C                       3522 X3:
198C 01                    3523 	DB	1
198D 6F 72                 3524 	DB	'or'
198F A3 0E                 3525 	DW	GRP13
1991 32                    3526 	DB	32H
1992                       3527 X4:
1992 02                    3528 	DB	2
1993 63 68 67              3529 	DB	'chg'
1996 C1 0C                 3530 	DW	GRP3
1998 86                    3531 	DB	86H
1999 6C 61 74              3532 	DB	'lat'
199C A6 0B                 3533 	DW	PUT
199E D7                    3534 	DB	0D7H
199F                       3535 
199F                       3536 
199F                       3537 ; 8087 MNEMONIC TABLE
199F                       3538 ; Similar to 8086 table above, except NOT distinguished by opcode length
199F                       3539 
199F                       3540 XM1:	;F2XM1
199F 01                    3541 	DB	1		;One opcode
19A0 78 6D B1              3542 	DB	"xm", '1'+ 080H
19A3 01 F0                 3543 	DB	1,0F0H
19A5                       3544 
19A5                       3545 NDPA:
19A5 03                    3546 	DB	3
19A6 64 E4                 3547 	DB	"d", 'd'+ 080H
19A8 0E C1                 3548 	DB	6+ARITH,0C1H
19AA 64 64 F0              3549 	DB	"dd", 'p'+ 080H
19AD 90 00                 3550 	DB	NEEDOP+STACKOP,0
19AF 62 F3                 3551 	DB	"b", 's'+ 080H
19B1 01 E1                 3552 	DB	1,0E1H
19B3                       3553 
19B3                       3554 NDPB:
19B3 02                    3555 	DB	2
19B4 6C E4                 3556 	DB	"l", 'd'+ 080H
19B6 9F 20                 3557 	DB	7+NEEDOP+MEMORY,20H
19B8 73 74 F0              3558 	DB	"st", 'p'+ 080H
19BB 9F 30                 3559 	DB	7+NEEDOP+MEMORY,30H
19BD                       3560 
19BD                       3561 NDPC:
19BD 05                    3562 	DB	5
19BE 6F ED                 3563 	DB	"o", 'm'+ 080H
19C0 68 D1                 3564 	DB	0+ONEREG+REAL,0D1H
19C2 6F 6D F0              3565 	DB	"om", 'p'+ 080H
19C5 68 D9                 3566 	DB	0+ONEREG+REAL,0D9H
19C7 68 F3                 3567 	DB	"h", 's'+ 080H
19C9 01 E0                 3568 	DB	1,0E0H
19CB 6F 6D 70 F0           3569 	DB	"omp", 'p'+ 080H
19CF 06 D9                 3570 	DB	6,0D9H
19D1 6C 65 F8              3571 	DB	"le", 'x'+ 080H
19D4 03 E2                 3572 	DB	3,0E2H
19D6                       3573 
19D6                       3574 NDPD:
19D6 06                    3575 	DB	6
19D7 69 F6                 3576 	DB	"i", 'v'+ 080H
19D9 0E F1                 3577 	DB	6+ARITH,0F1H
19DB 69 76 F0              3578 	DB	"iv", 'p'+ 080H
19DE 90 30                 3579 	DB	NEEDOP+STACKOP,30H
19E0 69 76 F2              3580 	DB	"iv", 'r'+ 080H
19E3 0E F9                 3581 	DB	6+ARITH,0F9H
19E5 69 76 72 F0           3582 	DB	"ivr", 'p'+ 080H
19E9 90 38                 3583 	DB	NEEDOP+STACKOP,38H
19EB 65 63 73 74 F0        3584 	DB	"ecst", 'p'+ 080H
19F0 01 F6                 3585 	DB	1,0F6H
19F2 69 73 E9              3586 	DB	"is", 'i'+ 080H
19F5 03 E1                 3587 	DB	3,0E1H
19F7                       3588 
19F7                       3589 NDPE:
19F7 01                    3590 	DB	1
19F8 6E E9                 3591 	DB	"n", 'i'+ 080H
19FA 03 E0                 3592 	DB	3,0E0H
19FC                       3593 
19FC                       3594 NDPF:
19FC 01                    3595 	DB	1
19FD 72 65 E5              3596 	DB	"re", 'e'+ 080H
1A00 C5 00                 3597 	DB	5+NEEDOP+ONEREG,0
1A02                       3598 
1A02                       3599 NDPI:
1A02 0D                    3600 	DB	13
1A03 61 64 E4              3601 	DB	"ad", 'd'+ 080H
1A06 A2 00                 3602 	DB	2+NEEDOP+INTEGER,0
1A08 6C E4                 3603 	DB	"l", 'd'+ 080H
1A0A B3 00                 3604 	DB	3+NEEDOP+INTEGER+EXTENDED,0
1A0C 73 75 E2              3605 	DB	"su", 'b'+ 080H
1A0F A2 20                 3606 	DB	2+NEEDOP+INTEGER,20H
1A11 73 74 F0              3607 	DB	"st", 'p'+ 080H
1A14 B3 18                 3608 	DB	3+NEEDOP+INTEGER+EXTENDED,18H
1A16 73 F4                 3609 	DB	"s", 't'+ 080H
1A18 A3 10                 3610 	DB	3+NEEDOP+INTEGER,10H
1A1A 6D 75 EC              3611 	DB	"mu", 'l'+ 080H
1A1D A2 08                 3612 	DB	2+NEEDOP+INTEGER,8
1A1F 64 69 F6              3613 	DB	"di", 'v'+ 080H
1A22 A2 30                 3614 	DB	2+NEEDOP+INTEGER,30H
1A24 73 75 62 F2           3615 	DB	"sub", 'r'+ 080H
1A28 A2 28                 3616 	DB	2+NEEDOP+INTEGER,28H
1A2A 64 69 76 F2           3617 	DB	"div", 'r'+ 080H
1A2E A2 38                 3618 	DB	2+NEEDOP+INTEGER,38H
1A30 63 6F ED              3619 	DB	"co", 'm'+ 080H
1A33 A2 10                 3620 	DB	2+NEEDOP+INTEGER,10H
1A35 63 6F 6D F0           3621 	DB	"com", 'p'+ 080H
1A39 A2 18                 3622 	DB	2+NEEDOP+INTEGER,18H
1A3B 6E 63 73 74 F0        3623 	DB	"ncst", 'p'+ 080H
1A40 01 F7                 3624 	DB	1,0F7H
1A42 6E 69 F4              3625 	DB	"ni", 't'+ 080H
1A45 03 E3                 3626 	DB	3,0E3H
1A47                       3627 
1A47                       3628 NDPL:
1A47 0A                    3629 	DB	10
1A48 E4                    3630 	DB	'd' + 080H
1A49 F9 00                 3631 	DB	1+NEEDOP+ONEREG+REAL+EXTENDED,0
1A4B 64 FA                 3632 	DB	"d", 'z'+ 080H
1A4D 01 EE                 3633 	DB	1,0EEH
1A4F 64 B1                 3634 	DB	"d", '1'+ 080H
1A51 01 E8                 3635 	DB	1,0E8H
1A53 64 70 E9              3636 	DB	"dp", 'i'+ 080H
1A56 01 EB                 3637 	DB	1,0EBH
1A58 64 6C 32 F4           3638 	DB	"dl2", 't'+ 080H
1A5C 01 E9                 3639 	DB	1,0E9H
1A5E 64 6C 32 E5           3640 	DB	"dl2", 'e'+ 080H
1A62 01 EA                 3641 	DB	1,0EAH
1A64 64 6C 67 B2           3642 	DB	"dlg", '2'+ 080H
1A68 01 EC                 3643 	DB	1,0ECH
1A6A 64 6C 6E B2           3644 	DB	"dln", '2'+ 080H
1A6E 01 ED                 3645 	DB	1,0EDH
1A70 64 63 F7              3646 	DB	"dc", 'w'+ 080H
1A73 99 28                 3647 	DB	1+NEEDOP+MEMORY,28H
1A75 64 65 6E F6           3648 	DB	"den", 'v'+ 080H
1A79 99 20                 3649 	DB	1+NEEDOP+MEMORY,20H
1A7B                       3650 
1A7B                       3651 NDPM:
1A7B 02                    3652 	DB	2
1A7C 75 EC                 3653 	DB	"u", 'l'+ 080H
1A7E 0E C9                 3654 	DB	6+ARITH,0C9H
1A80 75 6C F0              3655 	DB	"ul", 'p'+ 080H
1A83 90 08                 3656 	DB	NEEDOP+STACKOP,8
1A85                       3657 
1A85                       3658 NDPO:
1A85 01                    3659 	DB	1
1A86 F0                    3660 	DB	'p' + 080H
1A87 81 00                 3661 	DB	NEEDOP+1,0	;Flag special handling
1A89                       3662 
1A89                       3663 NDPN:
1A89 01                    3664 	DB	1
1A8A 6F F0                 3665 	DB	"o", 'p'+ 080H
1A8C 01 D0                 3666 	DB	1,0D0H
1A8E                       3667 
1A8E                       3668 NDPP:
1A8E 03                    3669 	DB	3
1A8F 72 65 ED              3670 	DB	"re", 'm'+ 080H
1A92 01 F8                 3671 	DB	1,0F8H
1A94 74 61 EE              3672 	DB	"ta", 'n'+ 080H
1A97 01 F2                 3673 	DB	1,0F2H
1A99 61 74 61 EE           3674 	DB	"ata", 'n'+ 080H
1A9D 01 F3                 3675 	DB	1,0F3H
1A9F                       3676 
1A9F                       3677 NDPR:
1A9F 02                    3678 	DB	2
1AA0 6E 64 69 6E F4        3679 	DB	"ndin", 't'+ 080H
1AA5 01 FC                 3680 	DB	1,0FCH
1AA7 73 74 6F F2           3681 	DB	"sto", 'r'+ 080H
1AAB 9D 20                 3682 	DB	5+NEEDOP+MEMORY,20H
1AAD                       3683 
1AAD                       3684 NDPS:
1AAD 0C                    3685 	DB	12
1AAE F4                    3686 	DB	't' + 080H
1AAF ED D0                 3687 	DB	5+NEEDOP+ONEREG+REAL,0D0H
1AB1 74 F0                 3688 	DB	"t", 'p'+ 080H
1AB3 FF D8                 3689 	DB	7+NEEDOP+ONEREG+REAL+EXTENDED,0D8H
1AB5 75 E2                 3690 	DB	"u", 'b'+ 080H
1AB7 0E E1                 3691 	DB	6+ARITH,0E1H
1AB9 75 62 F0              3692 	DB	"ub", 'p'+ 080H
1ABC 90 E0                 3693 	DB	NEEDOP+STACKOP,0E0H
1ABE 75 62 F2              3694 	DB	"ub", 'r'+ 080H
1AC1 0E E9                 3695 	DB	6+ARITH,0E9H
1AC3 75 62 72 F0           3696 	DB	"ubr", 'p'+ 080H
1AC7 90 E8                 3697 	DB	NEEDOP+STACKOP,0E8H
1AC9 71 72 F4              3698 	DB	"qr", 't'+ 080H
1ACC 01 FA                 3699 	DB	1,0FAH
1ACE 63 61 6C E5           3700 	DB	"cal", 'e'+ 080H
1AD2 01 FD                 3701 	DB	1,0FDH
1AD4 61 76 E5              3702 	DB	"av", 'e'+ 080H
1AD7 9D 30                 3703 	DB	5+NEEDOP+MEMORY,30H
1AD9 74 63 F7              3704 	DB	"tc", 'w'+ 080H
1ADC 99 38                 3705 	DB	1+NEEDOP+MEMORY,38H
1ADE 74 65 6E F6           3706 	DB	"ten", 'v'+ 080H
1AE2 99 30                 3707 	DB	1+NEEDOP+MEMORY,30H
1AE4 74 73 F7              3708 	DB	"ts", 'w'+ 080H
1AE7 9D 38                 3709 	DB	5+NEEDOP+MEMORY,38H
1AE9                       3710 
1AE9                       3711 NDPT:
1AE9 01                    3712 	DB	1
1AEA 73 F4                 3713 	DB	"s", 't'+ 080H
1AEC 01 E4                 3714 	DB	1,0E4H
1AEE                       3715 
1AEE                       3716 NDPW:
1AEE 01                    3717 	DB	1
1AEF 61 69 F4              3718 	DB	"ai", 't'+ 080H
1AF2 80 00                 3719 	DB	NEEDOP,0	;Flag special handling
1AF4                       3720 
1AF4                       3721 NDPX:
1AF4 03                    3722 	DB	3
1AF5 63 E8                 3723 	DB	"c", 'h'+ 080H
1AF7 41 C9                 3724 	DB	1+ONEREG,0C9H
1AF9 61 ED                 3725 	DB	"a", 'm'+ 080H
1AFB 01 E5                 3726 	DB	1,0E5H
1AFD 74 72 61 63 F4        3727 	DB	"trac", 't'+ 080H
1B02 01 F4                 3728 	DB	1,0F4H
1B04                       3729 
1B04                       3730 NDPY:
1B04 02                    3731 	DB	2
1B05 6C 32 F8              3732 	DB	"l2", 'x'+ 080H
1B08 01 F1                 3733 	DB	1,0F1H
1B0A 6C 32 78 70 B1        3734 	DB	"l2xp", '1'+ 080H
1B0F 01 F9                 3735 	DB	1,0F9H
1B11                       3736 
1B11                       3737 
1B11                       3738 OPTAB:
1B11                       3739 ; Table of pointers  to mnemonics. For each letter of the alphabet (the
1B11                       3740 ; starting letter of the mnemonic), there are 5 entries. Each entry
1B11                       3741 ; corresponds to a mnemonic whose length is 2, 3, 4, 5, and 6 characters
1B11                       3742 ; long, respectively. If there are no mnemonics for a given combination
1B11                       3743 ; of first letter and length (such as A-2), then the corresponding entry
1B11                       3744 ; points to NONE. Otherwise, it points to a place in the mnemonic table
1B11                       3745 ; for that type.
1B11                       3746 
1B11                       3747 ; This table only needs to be modified if a mnemonic is added to a group
1B11                       3748 ; previously marked NONE. Change the NONE to a label made up of the first
1B11                       3749 ; letter of the mnemonic and its length, then add a new subsection to
1B11                       3750 ; the mnemonic table in alphabetical order.
1B11                       3751 
1B11 50 16                 3752 	DW	NONE
1B13 51 16                 3753 	DW	A3
1B15 50 16                 3754 	DW	NONE
1B17 75 16                 3755 	DW	A5
1B19 50 16                 3756 	DW	NONE
1B1B 50 16                 3757 	DW	NONE	;B
1B1D 50 16                 3758 	DW	NONE
1B1F 50 16                 3759 	DW	NONE
1B21 50 16                 3760 	DW	NONE
1B23 50 16                 3761 	DW	NONE
1B25 50 16                 3762 	DW	NONE	;C
1B27 7D 16                 3763 	DW	C3
1B29 A1 16                 3764 	DW	C4
1B2B B4 16                 3765 	DW	C5
1B2D 50 16                 3766 	DW	NONE
1B2F C3 16                 3767 	DW	D2	;D
1B31 D8 16                 3768 	DW	D3
1B33 ED 16                 3769 	DW	D4
1B35 50 16                 3770 	DW	NONE
1B37 50 16                 3771 	DW	NONE
1B39 F4 16                 3772 	DW	E2	;E
1B3B F9 16                 3773 	DW	E3
1B3D 50 16                 3774 	DW	NONE
1B3F 09 17                 3775 	DW	E5
1B41 50 16                 3776 	DW	NONE
1B43 50 16                 3777 	DW	NONE	;F
1B45 50 16                 3778 	DW	NONE
1B47 50 16                 3779 	DW	NONE
1B49 50 16                 3780 	DW	NONE
1B4B 50 16                 3781 	DW	NONE
1B4D 50 16                 3782 	DW	NONE	;G
1B4F 50 16                 3783 	DW	NONE
1B51 50 16                 3784 	DW	NONE
1B53 50 16                 3785 	DW	NONE
1B55 50 16                 3786 	DW	NONE
1B57 50 16                 3787 	DW	NONE	;H
1B59 11 17                 3788 	DW	H3
1B5B 17 17                 3789 	DW	H4
1B5D 50 16                 3790 	DW	NONE
1B5F 50 16                 3791 	DW	NONE
1B61 1E 17                 3792 	DW	I2	;I
1B63 27 17                 3793 	DW	I3
1B65 3C 17                 3794 	DW	I4
1B67 50 16                 3795 	DW	NONE
1B69 50 16                 3796 	DW	NONE
1B6B 55 17                 3797 	DW	J2	;J
1B6D 7E 17                 3798 	DW	J3
1B6F D4 17                 3799 	DW	J4
1B71 50 16                 3800 	DW	NONE
1B73 50 16                 3801 	DW	NONE
1B75 50 16                 3802 	DW	NONE	;K
1B77 50 16                 3803 	DW	NONE
1B79 50 16                 3804 	DW	NONE
1B7B 50 16                 3805 	DW	NONE
1B7D 50 16                 3806 	DW	NONE
1B7F 50 16                 3807 	DW	NONE	;L
1B81 F9 17                 3808 	DW	L3
1B83 09 18                 3809 	DW	L4
1B85 28 18                 3810 	DW	L5
1B87 45 18                 3811 	DW	L6
1B89 50 16                 3812 	DW	NONE	;M
1B8B 56 18                 3813 	DW	M3
1B8D 61 18                 3814 	DW	M4
1B8F 6E 18                 3815 	DW	M5
1B91 50 16                 3816 	DW	NONE
1B93 50 16                 3817 	DW	NONE	;N
1B95 7D 18                 3818 	DW	N3
1B97 50 16                 3819 	DW	NONE
1B99 50 16                 3820 	DW	NONE
1B9B 50 16                 3821 	DW	NONE
1B9D 8D 18                 3822 	DW	O2	;O
1B9F 92 18                 3823 	DW	O3
1BA1 9D 18                 3824 	DW	O4
1BA3 50 16                 3825 	DW	NONE
1BA5 50 16                 3826 	DW	NONE
1BA7 50 16                 3827 	DW	NONE	;P
1BA9 AA 18                 3828 	DW	P3
1BAB B5 18                 3829 	DW	P4
1BAD C2 18                 3830 	DW	P5
1BAF 50 16                 3831 	DW	NONE
1BB1 50 16                 3832 	DW	NONE	;Q
1BB3 50 16                 3833 	DW	NONE
1BB5 50 16                 3834 	DW	NONE
1BB7 50 16                 3835 	DW	NONE
1BB9 50 16                 3836 	DW	NONE
1BBB 50 16                 3837 	DW	NONE	;R
1BBD CA 18                 3838 	DW	R3
1BBF E9 18                 3839 	DW	R4
1BC1 F6 18                 3840 	DW	R5
1BC3 50 16                 3841 	DW	NONE
1BC5 50 16                 3842 	DW	NONE	;S
1BC7 05 19                 3843 	DW	S3
1BC9 3D 19                 3844 	DW	S4
1BCB 5C 19                 3845 	DW	S5
1BCD 50 16                 3846 	DW	NONE
1BCF 50 16                 3847 	DW	NONE	;T
1BD1 50 16                 3848 	DW	NONE
1BD3 79 19                 3849 	DW	T4
1BD5 50 16                 3850 	DW	NONE
1BD7 50 16                 3851 	DW	NONE
1BD9 80 19                 3852 	DW	U2	;U
1BDB 50 16                 3853 	DW	NONE
1BDD 50 16                 3854 	DW	NONE
1BDF 50 16                 3855 	DW	NONE
1BE1 50 16                 3856 	DW	NONE
1BE3 50 16                 3857 	DW	NONE	;V
1BE5 50 16                 3858 	DW	NONE
1BE7 50 16                 3859 	DW	NONE
1BE9 50 16                 3860 	DW	NONE
1BEB 50 16                 3861 	DW	NONE
1BED 50 16                 3862 	DW	NONE	;W
1BEF 50 16                 3863 	DW	NONE
1BF1 85 19                 3864 	DW	W4
1BF3 50 16                 3865 	DW	NONE
1BF5 50 16                 3866 	DW	NONE
1BF7 50 16                 3867 	DW	NONE	;X
1BF9 8C 19                 3868 	DW	X3
1BFB 92 19                 3869 	DW	X4
1BFD 50 16                 3870 	DW	NONE
1BFF 50 16                 3871 	DW	NONE
1C01 50 16                 3872 	DW	NONE	;Y
1C03 50 16                 3873 	DW	NONE
1C05 50 16                 3874 	DW	NONE
1C07 50 16                 3875 	DW	NONE
1C09 50 16                 3876 	DW	NONE
1C0B 50 16                 3877 	DW	NONE	;Z
1C0D 50 16                 3878 	DW	NONE
1C0F 50 16                 3879 	DW	NONE
1C11 50 16                 3880 	DW	NONE
1C13 50 16                 3881 	DW	NONE
1C15                       3882 
1C15                       3883 NDPTAB:
1C15                       3884 ;Lookup table for 8087 mnemonics. There is one entry for each letter of the
1C15                       3885 ;alphabet
1C15 A5 19                 3886 	DW	NDPA
1C17 B3 19                 3887 	DW	NDPB
1C19 BD 19                 3888 	DW	NDPC
1C1B D6 19                 3889 	DW	NDPD
1C1D F7 19                 3890 	DW	NDPE
1C1F FC 19                 3891 	DW	NDPF
1C21 50 16                 3892 	DW	NONE	;G
1C23 50 16                 3893 	DW	NONE	;H
1C25 02 1A                 3894 	DW	NDPI
1C27 50 16                 3895 	DW	NONE	;J
1C29 50 16                 3896 	DW	NONE	;K
1C2B 47 1A                 3897 	DW	NDPL
1C2D 7B 1A                 3898 	DW	NDPM
1C2F 89 1A                 3899 	DW	NDPN
1C31 85 1A                 3900 	DW	NDPO
1C33 8E 1A                 3901 	DW	NDPP
1C35 50 16                 3902 	DW	NONE	;Q
1C37 9F 1A                 3903 	DW	NDPR
1C39 AD 1A                 3904 	DW	NDPS
1C3B E9 1A                 3905 	DW	NDPT
1C3D 50 16                 3906 	DW	NONE	;U
1C3F 50 16                 3907 	DW	NONE	;V
1C41 EE 1A                 3908 	DW	NDPW
1C43 F4 1A                 3909 	DW	NDPX
1C45 04 1B                 3910 	DW	NDPY
1C47 50 16                 3911 	DW	NONE	;Z
1C49                       3912 
1C49                       3913 ;Error message table
1C49                       3914 
1C49                       3915 ERRTAB:
1C49 01 52 65 67 69 73 74  3916 	DB	1, "Register not allowed in immediate valu", 'e'+ 080H
     65 72 20 6E 6F 74 20 
     61 6C 6C 6F 77 65 64 
     20 69 6E 20 69 6D 6D 
     65 64 69 61 74 65 20 
     76 61 6C 75 E5       
1C71 02 49 6E 64 65 78 20  3917 	DB	2, "Index or base register must be BP, BX, SI, or D", 'I'+ 080H
     6F 72 20 62 61 73 65 
     20 72 65 67 69 73 74 
     65 72 20 6D 75 73 74 
     20 62 65 20 42 50 2C 
     20 42 58 2C 20 53 49 
     2C 20 6F 72 20 44 C9 
1CA2 03 4F 6E 6C 79 20 6F  3918 	DB	3, "Only one base register (BX, BP) allowe", 'd'+ 080H
     6E 65 20 62 61 73 65 
     20 72 65 67 69 73 74 
     65 72 20 28 42 58 2C 
     20 42 50 29 20 61 6C 
     6C 6F 77 65 E4       
1CCA 04 4F 6E 6C 79 20 6F  3919 	DB	4, "Only one index register (SI or DI) allowe", 'd'+ 080H
     6E 65 20 69 6E 64 65 
     78 20 72 65 67 69 73 
     74 65 72 20 28 53 49 
     20 6F 72 20 44 49 29 
     20 61 6C 6C 6F 77 65 
     E4                   
1CF5 05 4F 6E 6C 79 20 61  3920 	DB	5, "Only addition allowed on register or undefined labe", 'l'+ 080H
     64 64 69 74 69 6F 6E 
     20 61 6C 6C 6F 77 65 
     64 20 6F 6E 20 72 65 
     67 69 73 74 65 72 20 
     6F 72 20 75 6E 64 65 
     66 69 6E 65 64 20 6C 
     61 62 65 EC          
1D2A 06 4F 6E 6C 79 20 6F  3921 	DB	6, "Only one undefined label per expression allowe", 'd'+ 080H
     6E 65 20 75 6E 64 65 
     66 69 6E 65 64 20 6C 
     61 62 65 6C 20 70 65 
     72 20 65 78 70 72 65 
     73 73 69 6F 6E 20 61 
     6C 6C 6F 77 65 E4    
1D5A 07 49 6C 6C 65 67 61  3922 	DB	7, "Illegal digit in hexadecimal numbe", 'r'+ 080H
     6C 20 64 69 67 69 74 
     20 69 6E 20 68 65 78 
     61 64 65 63 69 6D 61 
     6C 20 6E 75 6D 62 65 
     F2                   
1D7E 08 49 6C 6C 65 67 61  3923 	DB	8, "Illegal digit in decimal numbe", 'r'+ 080H
     6C 20 64 69 67 69 74 
     20 69 6E 20 64 65 63 
     69 6D 61 6C 20 6E 75 
     6D 62 65 F2          
1D9E 0A 49 6C 6C 65 67 61  3924 	DB	10, "Illegal character in label or opcod", 'e'+ 080H
     6C 20 63 68 61 72 61 
     63 74 65 72 20 69 6E 
     20 6C 61 62 65 6C 20 
     6F 72 20 6F 70 63 6F 
     64 E5                
1DC3 0B 4C 61 62 65 6C 20  3925 	DB	11, "Label defined twic", 'e'+ 080H
     64 65 66 69 6E 65 64 
     20 74 77 69 63 E5    
1DD7 0C 4F 70 63 6F 64 65  3926 	DB	12, "Opcode not recognize", 'd'+ 080H
     20 6E 6F 74 20 72 65 
     63 6F 67 6E 69 7A 65 
     E4                   
1DED 14 49 6E 76 61 6C 69  3927 	DB	20, "Invalid operan", 'd'+ 080H
     64 20 6F 70 65 72 61 
     6E E4                
1DFD 15 22 2C 20 22 20 61  3928 	DB	21, '", " and second operand expected'
     6E 64 20 73 65 63 6F 
     6E 64 20 6F 70 65 72 
     61 6E 64 20 65 78 70 
     65 63 74 65 64       
1E1E 16 52 65 67 69 73 74  3929 	DB	22, "Register mismatc", 'h'+ 080H
     65 72 20 6D 69 73 6D 
     61 74 63 E8          
1E30 17 49 6D 6D 65 64 69  3930 	DB	23, "Immediate operand not allowe", 'd'+ 080H
     61 74 65 20 6F 70 65 
     72 61 6E 64 20 6E 6F 
     74 20 61 6C 6C 6F 77 
     65 E4                
1E4E 18 22 5D 22 20 65 78  3931 	DB	24, '"]" expecte', 'd'+ 080H
     70 65 63 74 65 E4    
1E5B 19 54 77 6F 20 6D 65  3932 	DB	25, "Two memory operands not allowe", 'd'+ 080H
     6D 6F 72 79 20 6F 70 
     65 72 61 6E 64 73 20 
     6E 6F 74 20 61 6C 6C 
     6F 77 65 E4          
1E7B 1A 44 65 73 74 69 6E  3933 	DB	26, "Destination must not be immediate valu", 'e'+ 080H
     61 74 69 6F 6E 20 6D 
     75 73 74 20 6E 6F 74 
     20 62 65 20 69 6D 6D 
     65 64 69 61 74 65 20 
     76 61 6C 75 E5       
1EA3 1B 42 6F 74 68 20 6F  3934 	DB	27, "Both operands must not be register", 's'+ 080H
     70 65 72 61 6E 64 73 
     20 6D 75 73 74 20 6E 
     6F 74 20 62 65 20 72 
     65 67 69 73 74 65 72 
     F3                   
1EC7 1C 4F 70 65 72 61 6E  3935 	DB	28, "Operand must be segment registe", 'r'+ 080H
     64 20 6D 75 73 74 20 
     62 65 20 73 65 67 6D 
     65 6E 74 20 72 65 67 
     69 73 74 65 F2       
1EE8 1D 46 69 72 73 74 20  3936 	DB	29, "First operand must be registe", 'r'+ 080H
     6F 70 65 72 61 6E 64 
     20 6D 75 73 74 20 62 
     65 20 72 65 67 69 73 
     74 65 F2             
1F07 1E 55 6E 64 65 66 69  3937 	DB	30, "Undefined label not allowe", 'd'+ 080H
     6E 65 64 20 6C 61 62 
     65 6C 20 6E 6F 74 20 
     61 6C 6C 6F 77 65 E4 
1F23 1F 56 61 6C 75 65 20  3938 	DB	31, "Value out of rang", 'e'+ 080H
     6F 75 74 20 6F 66 20 
     72 61 6E 67 E5       
1F36 20 4D 69 73 73 69 6E  3939 	DB	32, "Missing or illegal operand size fla", 'g'+ 080H
     67 20 6F 72 20 69 6C 
     6C 65 67 61 6C 20 6F 
     70 65 72 61 6E 64 20 
     73 69 7A 65 20 66 6C 
     61 E7                
1F5B 21 4D 75 73 74 20 68  3940 	DB	33, "Must have label on same lin", 'e'+ 080H
     61 76 65 20 6C 61 62 
     65 6C 20 6F 6E 20 73 
     61 6D 65 20 6C 69 6E 
     E5                   
1F78 23 5A 65 72 6F 2D 6C  3941 	DB	35, "Zero-length string illega", 'l'+ 080H
     65 6E 67 74 68 20 73 
     74 72 69 6E 67 20 69 
     6C 6C 65 67 61 EC    
1F93 24 45 4E 44 49 46 20  3942 	DB	36, "ENDIF without I", 'F'+ 080H
     77 69 74 68 6F 75 74 
     20 49 C6             
1FA4 25 4F 6E 65 2D 63 68  3943 	DB	37, "One-character strings onl", 'y'+ 080H
     61 72 61 63 74 65 72 
     20 73 74 72 69 6E 67 
     73 20 6F 6E 6C F9    
1FBF 26 49 6C 6C 65 67 61  3944 	DB	38, "Illegal expressio", 'n'+ 080H
     6C 20 65 78 70 72 65 
     73 73 69 6F EE       
1FD2 27 45 6E 64 20 6F 66  3945 	DB	39, "End of string not foun", 'd'+ 080H
     20 73 74 72 69 6E 67 
     20 6E 6F 74 20 66 6F 
     75 6E E4             
1FEA 64 55 6E 64 65 66 69  3946 	DB	100, "Undefined labe", 'l'+ 080H
     6E 65 64 20 6C 61 62 
     65 EC                
1FFA 65 56 61 6C 75 65 20  3947 	DB	101, "Value out of range (forward", ')'+ 080H
     6F 75 74 20 6F 66 20 
     72 61 6E 67 65 20 28 
     66 6F 72 77 61 72 64 
     A9                   
2017 FF                    3948 	DB	255
2018                       3949 
2018 2A 2A 2A 2A 2A 20 45  3950 ERRMES:	DB	'***** ERROR: ', ' '+ 080H
     52 52 4F 52 3A 20 A0 
2026 0D 0A 46 69 6C 65 20  3951 NOSPAC:	DB	13,10,'File creation error',13,10,"$"
     63 72 65 61 74 69 6F 
     6E 20 65 72 72 6F 72 
     0D 0A 24             
203E 0D 0A 49 6E 73 75 66  3952 NOMEM:	DB	13,10,'Insufficient memory',13,10,'$'
     66 69 63 69 65 6E 74 
     20 6D 65 6D 6F 72 79 
     0D 0A 24             
2056 0D 0A 46 69 6C 65 20  3953 NOFILE:	DB	13,10,'File not found',13,10,'$'
     6E 6F 74 20 66 6F 75 
     6E 64 0D 0A 24       
2069 0D 0A 44 69 73 6B 20  3954 WRTERR:	DB	13,10,'Disk full',13,10,'$'
     66 75 6C 6C 0D 0A 24 
2077 0D 0A 42 61 64 20 64  3955 BADDSK:	DB	13,10,'Bad disk specifier',13,10,'$'
     69 73 6B 20 73 70 65 
     63 69 66 69 65 72 0D 
     0A 24                
208E 0D 0A 0D 0A 45 72 72  3956 ERCNTM:	DB	13, 10, 13, 10, 'Error Count ', '='+ 080H
     6F 72 20 43 6F 75 6E 
     74 20 BD             
209F 0D 0A 53 79 6D 62 6F  3957 SYMSIZE	DB	13, 10, 'Symbol Table size =', ' '+ 080H
     6C 20 54 61 62 6C 65 
     20 73 69 7A 65 20 3D 
     A0                   
20B5 46 72 65 65 20 73 70  3958 FRESIZE	DB	'Free space =       ', ' '+ 080H
     61 63 65 20 3D 20 20 
     20 20 20 20 20 A0    
20C9 0D 0A 53 79 6D 62 6F  3959 SYMMES:	DB	13, 10, 'Symbol Tabl', 'e'+ 080H, 13, 10, 13, 10
     6C 20 54 61 62 6C E5 
     0D 0A 0D 0A          
20DB 41 53 4D 00 00        3960 EXTEND:	DB	'ASM',0,0
20E0 05 65 6E 64 69 66     3961 IFEND:	DB	5,'endif'
20E6 02 69 66              3962 IFNEST:	DB	2,'if'
20E9 72 65 F4              3963 RETSTR:	DB	're', 't'+ 080H
20EC 00 20 20 20 20 20 20  3964 HEXFCB:	DB	0,'        HEX',0,0,0,0
     20 20 48 45 58 00 00 
     00 00                
20FC                       3965 	DS	16
210C 00 00 00 00 00        3966 	DB	0,0,0,0,0
2111 00 20 20 20 20 20 20  3967 LSTFCB:	DB	0,'        PRN',0,0,0,0
     20 20 50 52 4E 00 00 
     00 00                
2121                       3968 	DS	16 
2131 00 00 00 00 00        3969 	DB	0,0,0,0,0
2136                       3970 PC	DS 2
2138                       3971 OLDPC	DS 2
213A                       3972 LABPT	DS 2
213C                       3973 FLAG	DS 1
213D                       3974 MAXFLG	DS 1
213E                       3975 ADDR	DS 2
2140                       3976 ALABEL	DS 2
2142                       3977 DATA	DS 2
2144                       3978 DLABEL	DS 2
2146                       3979 CON		DS 2
2148                       3980 UNDEF	DS 2
214A                       3981 LENID	DS 1
214B                       3982 ID	DS 80
219B                       3983 CHR	DS 1
219C                       3984 SYM	DS 1
219D                       3985 BASE	DS 2
219F                       3986 HEAP	DS 2
21A1                       3987 SYMFLG	DS 1
21A2                       3988 SYMLIN	DS 1
21A3                       3989 CODE	DS 2
21A5                       3990 DATSIZ	DS 1
21A6                       3991 RELOC	DS 1
21A7                       3992 BCOUNT	DS 1
21A8                       3993 COUNT	DS 1
21A9                       3994 ERR	DS 1
21AA                       3995 LINE	DS 2
21AC                       3996 HEXLEN	DS 2
21AE                       3997 HEXADD	DS 2
21B0                       3998 LASTAD	DS 2
21B2                       3999 HEXCNT	DS 1
21B3                       4000 CHKSUM	DS 1
21B4                       4001 LINFLG	DS 1
21B5                       4002 PREV	DS 1
21B6                       4003 IFFLG	DS 1
21B7                       4004 CHKLAB	DS 1
21B8                       4005 ERRCNT	DS 2
21BA                       4006 LSTRET	DS 2
21BC                       4007 RETPT	DS 2
21BE                       4008 LSTDEV	DS 2
21C0                       4009 SPC	DS 1
21C1                       4010 NOWAIT	DS 1
21C2                       4011 IX	DS 2
21C4                       4012 IY	DS 2
21C6                       4013 HEXPNT	DS 2
21C8                       4014 LSTPNT	DS 2
21CA                       4015 HEXBUF	DS HEXBUFSIZ
2210                       4016 LSTBUF	DS LSTBUFSIZ
2610                       4017 BUFPT	DS 2
2612                       4018 SRCBUF	DS BUFSIZ
2A12                       4019 	DS	100H
2B12                       4020 	ALIGN 
2B12                       4021 STACK	EQU	$
2B12                       4022 START	EQU	$


Error Count =    0

Symbol Table size =  6699
Free space =        3 634
