0000                       0001 ; Seattle Computer Products 8086 Assembler  version 2.44
0000                       0002 ;   by Tim Paterson
0000                       0003 ; Runs on the 8086 under MS-DOS
0000                       0004 
0000                       0005 ;* * * * * * REVISION HISTORY * * * * * *
0000                       0006 ;
0000                       0007 ; 12/29/80  2.01  General release with 86-DOS version 0.34
0000                       0008 ; 02/22/81  2.10  Increased buffer size from 128 bytes to 1024 bytes
0000                       0009 ; 03/18/81  2.11  General cleanup and more documentation
0000                       0010 ; 03/24/81  2.20  Modify ESC handling for full 8087 operation
0000                       0011 ; 04/01/81  2.21  Fix date in HEX and PRN files; modify buffer handling
0000                       0012 ; 04/03/81  2.22  Fix 2.21 buffer handling
0000                       0013 ; 04/13/81  2.23  Re-open source file for listing to allow assembling CON:
0000                       0014 ; 04/28/81  2.24  Allow nested IFs
0000                       0015 ; 07/30/81  2.25  Add Intel string mnemonics; clean up a little
0000                       0016 ; 08/02/81  2.30  Re-write pass 2:
0000                       0017 ;			Always report errors to console
0000                       0018 ;			Exact byte lengths for HEX and PRN files
0000                       0019 ; 11/08/81  2.40  Add 8087 mnemonics; print full error messages;
0000                       0020 ;		  allow expressions with *, /, and ()
0000                       0021 ; 07/04/82  2.41  Fix Intel's 8087 "reverse-bit" bug; don't copy date
0000                       0022 ; 08/18/82  2.42  Increase stack from 80 to 256 (Damn! Overflowed again!)
0000                       0023 ; 01/05/83  2.43  Correct over-zealous optimization in 2.42
0000                       0024 ; 05/09/83  2.44  Add memory usage report
0000                       0025 ;
0000                       0026 ;* * * * * * * * * * * * * * * * * * * * *
0000                       0027 
0000                       0028 SYMWID:	EQU	5	;5 symbols per line in dump
0000                       0029 FCB:	EQU	5CH
0000                       0030 BUFSIZ:	EQU	1024	;Source code buffer
0000                       0031 LSTBUFSIZ:EQU	BUFSIZ	;List file buffer
0000                       0032 HEXBUFSIZ:EQU	70	;Hex file buffer (26*2 + 5*2 + 3 + EXTRA)
0000                       0033 EOL:	EQU	13	;ASCII carriage return
0000                       0034 OBJECT:	EQU	100H	;DEFAULT "PUT" ADDRESS
0000                       0035 
0000                       0036 ;System call function codes
0000                       0037 PRINTMES: EQU	9
0000                       0038 OPEN:	EQU	15
0000                       0039 CLOSE:	EQU	16
0000                       0040 READ:	EQU	20
0000                       0041 SETDMA:	EQU	26
0000                       0042 MAKE:	EQU	22
0000                       0043 BLKWRT:	EQU	40
0000                       0044 
0000                       0045 ;The following equates define some token values returned by GETSYM
0000                       0046 UNDEFID:EQU	0	;Undefined identifier (including no nearby RET)
0000                       0047 CONST:	EQU	1	;Constant (including $)
0000                       0048 REG:	EQU	2	;8-bit register
0000                       0049 XREG:	EQU	3	;16-bit register (except segment registers)
0000                       0050 SREG:	EQU	4	;Segment register
0000                       0051 FREG:	EQU	6	;8087 floating point register
0000                       0052 
0000                       0053 ;Bits to build 8087 opcode table entries
0000                       0054 ONEREG:	EQU	40H	;Single ST register OK as operand
0000                       0055 NEEDOP:	EQU	80H	;Must have an operand
0000                       0056 INTEGER:EQU	20H	;For integer operations
0000                       0057 REAL:	EQU	28H	;For real operations
0000                       0058 EXTENDED EQU	10H	;For Long integers or Temporary real
0000                       0059 MEMORY:	EQU	18H	;For general memory operations
0000                       0060 STACKOP:EQU	10H	;Two register arithmetic with pop
0000                       0061 ARITH:	EQU	8	;Non-pop arithmetic operations
0000                       0062 
0000                       0063 	ORG	100H
0100                       0064 	
0100                       0065 
0100 E9 00 00              0066 	JMP 	BEGIN
0103                       0067 
0103                       0068 HEADER:	DB	13,10,'Seattle Computer Products 8086 Assembler Version 2.44'
0103                       0069 	DB	13,10,'Copyright 1979-1983 by Seattle Computer Products, Inc.'
0103                       0070 	DB	13,10,13,10,'$'
0103                       0071 
0103                       0072 BEGIN:
0103 BC C2 19              0073 	MOV	SP,STACK
0106 BA 03 01              0074 	MOV	DX,HEADER
0109 B4 00                 0075 	MOV	AH,PRINTMES
010B                       0076 	INT	33
010B                       0077 	MOV	AL,[FCB+17]
010B A2 B4 19              0078 	MOV	[SYMFLG],AL	;Save symbol table request flag
010E                       0079 	MOV	SI,FCB+9	;Point to file extension
010E AC                    0080 	LODSB			;Get source drive letter
010F E8 D3 00              0081 	CALL	CHKDSK		;Valid drive?
0112 0A C0                 0082 	OR	AL,AL
0114 74                    0083 	JZ	_DEFAULT		;If no extension, use existing drive spec
0115 A2 5C 00              0084 	MOV	[FCB],AL
0118                       0085 _DEFAULT:
0118 AC                    0086 	LODSB			;Get HEX file drive letter
0119 3C 5A                 0087 	CMP	AL,'Z'		;Suppress HEX file?
011B 74 03                 0088 	JZ	L0000
011D E8 C5 00              0089 	CALL	CHKDSK
0120                       0090 L0000:	
0120 A2 9C 19              0091 	MOV	[HEXFCB],AL
0123 AC                    0092 	LODSB			;Get PRN file drive letter
0124                       0093 	MOV	AH,0		;Signal no PRN file
0124 3C 5A                 0094 	CMP	AL,'Z'		;Suppress PRN file?
0126 74 11                 0095 	JZ	NOPRN
0128 3C 59                 0096 	CMP	AL,'Y'		;Print errors only on console?
012A 74 0D                 0097 	JZ	NOPRN
012C                       0098 	MOV	AH,2
012C 3C 58                 0099 	CMP	AL,'X'		;PRN file to console?
012E 74 09                 0100 	JZ	NOPRN
0130                       0101 	MOV	AH,4
0130 3C 50                 0102 	CMP	AL,'P'		;PRN file to printer?
0132 74 05                 0103 	JZ	NOPRN
0134 E8 AE 00              0104 	CALL	CHKDSK
0137 B4 80                 0105 	MOV	AH,80H
0139                       0106 NOPRN:
0139 A2 9C 19              0107 	MOV	[LSTFCB],AL
013C 88 26 BB 19           0108 	MOV	[LSTDEV],AH	;Flag device for list ouput
0140 BE 96 19              0109 	MOV	SI,EXTEND
0143                       0110 	MOV	DI,FCB+9
0143 A5                    0111 	MOVSW
0144 A4                    0112 	MOVSB			;Set extension to ASM
0145 A5                    0113 	MOVSW			;Zero extent field
0146 BA 5C 00              0114 	MOV	DX,FCB
0149 B4 00                 0115 	MOV	AH,OPEN
014B                       0116 	INT	33
014B BB 82 19              0117 	MOV	BX,NOFILE
014E 0A C0                 0118 	OR	AL,AL
0150 74                    0119 	JZ	$+5
0151 E9 70 00              0120 	JMP	PRERR
0154 BA 9C 19              0121 	MOV	DX,HEXFCB
0157 E8 6E 00              0122 	CALL	MAKFIL
015A BA 9C 19              0123 	MOV	DX,LSTFCB
015D E8 68 00              0124 	CALL	MAKFIL
0160 33 C0                 0125 	XOR	AX,AX
0162                       0126 	MOV	[FCB+12],AX	;Zero CURRENT BLOCK field
0162                       0127 	MOV	[FCB+32],AL	;Zero Next Record field
0162                       0128 	MOV	WORD[FCB+14],BUFSIZ	;Set record size
0162                       0129 	MOV	WORD[BUFPT],SRCBUF	;Initialize buffer pointer
0162                       0130 	MOV	WORD[CODE],START+1	;POINTER TO NEXT BYTE OF INTERMEDIATE CODE
0162                       0131 	MOV	WORD[IY],START	;POINTER TO CURRENT RELOCATION BYTE
0162 33 C0                 0132 	XOR	AX,AX
0164 A3 A9 19              0133 	MOV	[PC],AX		;DEFAULT PROGRAM COUNTER
0167 A3 B0 19              0134 	MOV	[BASE],AX	;POINTER TO ROOT OF ID TREE=NIL
016A A3 BB 19              0135 	MOV	[RETPT],AX	;Pointer to last RET record
016D A2 B8 19              0136 	MOV	[IFFLG],AL	;NOT WITHIN IF/ENDIF
0170 A2 B8 19              0137 	MOV	[CHKLAB],AL	;LOOKUP ALL LABELS
0173 48                    0138 	DEC	AX
0174 A3 BB 19              0139 	MOV	[LSTRET],AX	;Location of last RET
0177                       0140 	MOV	AX,[6]		;HL=END OF MEMORY
0177 A3 B2 19              0141 	MOV	[HEAP],AX	;BACK END OF SYMBOL TABLE SPACE
017A                       0142 	MOV	BYTE[BCOUNT],4	;CODE BYTES PER RELOCATION BYTE
017A                       0143 
017A                       0144 ;Assemble each line of code
017A                       0145 
017A                       0146 LOOP:
017A E8 80 00              0147 	CALL	NEXTCHR		;Get first character on line
017D 3C 1A                 0148 	CMP	AL,1AH
017F 74 1B                 0149 	JZ	ENDJ
0181                       0150 	MOV	AL,-1		;Flag that no tokens have been read yet
0181 A2 B0 19              0151 	MOV	[SYM],AL
0184 E8 93 06              0152 	CALL	ASMLIN		;Assemble the line
0187 A0 B0 19              0153 	MOV	AL,[SYM]
018A                       0154 	CMP	AL,-1		;Any tokens found on line?
018A 75 03                 0155 	JNZ	L0002
018C E8 75 03              0156 	CALL	GETSYM		;If no tokens read yet, read first one
018F                       0157 L0002:	
018F 3C 3B                 0158 	CMP	AL,';'
0191 74 0C                 0159 	JZ	ENDLN
0193 3C 00                 0160 	CMP	AL,EOL
0195 74 08                 0161 	JZ	ENDLN
0197 B0 14                 0162 	MOV	AL,14H		;Garbage at end of line error
0199 E9 05 00              0163 	JMP	ENDLIN
019C E9 CF 0D              0164 ENDJ:	JMP	END
019F                       0165 
019F                       0166 ENDLN:
019F 32 C0                 0167 	XOR	AL,AL		;Flag no errors on line
01A1                       0168 ENDLIN:
01A1                       0169 ;AL = error code for line. Stack depth unknown
01A1 BC C2 19              0170 	MOV	SP,STACK
01A4 E8 03 00              0171 	CALL	NEXLIN
01A7 E9 D0 FF              0172 	JMP	LOOP
01AA                       0173 
01AA                       0174 NEXLIN:
01AA B5 C0                 0175 	MOV	CH,0C0H		;Put end of line marker and error code (AL)
01AC E8 C0 08              0176 	CALL	PUTCD
01AF E8 98 08              0177 	CALL	GEN1
01B2 A0 B0 19              0178 	MOV	AL,[CHR]
01B5                       0179 GETEOL:
01B5                       0180 	CMP	AL,10
01B5 74 11                 0181 	JZ	MAKFIL_RET
01B7 3C 1A                 0182 	CMP	AL,1AH
01B9 74 E1                 0183 	JZ	ENDJ
01BB E8 3F 00              0184 	CALL	NEXTCHR		;Scan over comments for linefeed
01BE E9 F4 FF              0185 	JMP	GETEOL
01C1                       0186 
01C1                       0187 ABORT:
01C1 BB 82 19              0188 	MOV	BX,NOMEM
01C4                       0189 PRERR:
01C4 8B D3                 0190 	MOV	DX,BX
01C6 B4 00                 0191 	MOV	AH,PRINTMES
01C8                       0192 	INT	33
01C8                       0193 	INT	32 ;RET TO DOS
01C8                       0194 
01C8                       0195 MAKFIL_RET:
01C8 C3                    0196 	RET
01C9                       0197 MAKFIL:
01C9 8B F2                 0198 	MOV	SI,DX
01CB AC                    0199 	LODSB			;Get drive select byte
01CC 3C 20                 0200 	CMP	AL,20H		;If not valid, don't make file
01CE 73 F8                 0201 	JNC	MAKFIL_RET
01D0 B9 FA 00              0202 	MOV	CX,4
01D3 8B FE                 0203 	MOV	DI,SI
01D5 BE 40 01              0204 	MOV	SI,FCB+1
01D8 F3                    0205 	REP
01D9 A5                    0206 	MOVSW			;Copy source file name
01DA B4 00                 0207 	MOV	AH,MAKE
01DC CD                    0208 	INT	33
01DD                       0209 	MOV	WORD[DI-9+14],1	;Set record length to 1 byte
01DD BB 82 19              0210 	MOV	BX,NOSPAC
01E0 0A C0                 0211 	OR	AL,AL		;Success?
01E2 75 E0                 0212 	JNZ	PRERR
01E4 C3                    0213 	RET
01E5                       0214 CHKDSK_RET:
01E5 C3                    0215 	RET
01E6                       0216 CHKDSK:
01E6 2C 20                 0217 	SUB	AL,' '		;If not present, set zero flag
01E8 74 FB                 0218 	JZ	CHKDSK_RET
01EA 2C 20                 0219 	SUB	AL,20H
01EC 74 04                 0220 	JZ	DSKERR		;Must be in range A-O
01EE 3C 10                 0221 	CMP	AL,'P'-'@'
01F0 72 F3                 0222 	JC	CHKDSK_RET
01F2                       0223 DSKERR:
01F2 BB 82 19              0224 	MOV	BX,BADDSK
01F5 E9 CC FF              0225 	JMP	PRERR
01F8                       0226 
01F8                       0227 ERROR:
01F8 8A C1                 0228 	MOV	AL,CL
01FA E9 A4 FF              0229 	JMP	ENDLIN
01FD                       0230 
01FD                       0231 NEXTCHR:
01FD 8B 36 C0 19           0232 	MOV	SI,[BUFPT]
0201 81 FE C0 19           0233 	CMP	SI,SRCBUF
0205 75 18                 0234 	JNZ	GETCH
0207                       0235 ;Buffer empty so refill it
0207 52                    0236 	PUSH	DX
0208 50                    0237 	PUSH	AX		;AH must be saved
0209 8B D6                 0238 	MOV	DX,SI
020B B4 00                 0239 	MOV	AH,SETDMA
020D CD                    0240 	INT	33
020E BA 5C 00              0241 	MOV	DX,FCB
0211 B4 00                 0242 	MOV	AH,READ
0213 CD                    0243 	INT	33
0214 92                    0244 	XCHG	AX,DX		;Put error code in DL
0215 58                    0245 	POP	AX		;Restore AH
0216 8A C2                 0246 	MOV	AL,DL		;Error code back in AL
0218 5A                    0247 	POP	DX
0219 3C D8                 0248 	CMP	AL,1
021B B0 1A                 0249 	MOV	AL,1AH		;Possibly signal End of File
021D 74 0A                 0250 	JZ	NOMOD		;If nothing read
021F                       0251 GETCH:
021F AC                    0252 	LODSB
0220 81 FE C0 19           0253 	CMP	SI,SRCBUF+BUFSIZ
0224 75 03                 0254 	JNZ	NOMOD
0226 BE C0 19              0255 	MOV	SI,SRCBUF
0229                       0256 NOMOD:
0229 89 36 C0 19           0257 	MOV	[BUFPT],SI
022D A2 B0 19              0258 	MOV	[CHR],AL
0230 C3                    0259 	RET
0231                       0260 MROPS_RET:
0231 C3                    0261 	RET
0232                       0262 
0232                       0263 MROPS:
0232                       0264 
0232                       0265 ; Get two operands and check for certain types, according to flag byte
0232                       0266 ; in CL. OP code in CH. Returns only if immediate operation.
0232                       0267 
0232 51                    0268 	PUSH	CX		;Save type flags
0233 E8 CB 00              0269 	CALL	GETOP
0236 52                    0270 	PUSH	DX		;Save first operand
0237 E8 BF 00              0271 	CALL	GETOP2
023A 5B                    0272 	POP	BX		;First op in BX, second op in DX
023B B0 FF                 0273 	MOV	AL,SREG		;Check for a segment register
023D 3A C7                 0274 	CMP	AL,BH
023F 74 38                 0275 	JZ	SEGCHK
0241 3A C6                 0276 	CMP	AL,DH
0243 74 34                 0277 	JZ	SEGCHK
0245 B0 D7                 0278 	MOV	AL,CONST	;Check if the first operand is immediate
0247                       0279 	MOV	CL,26
0247 3A C7                 0280 	CMP	AL,BH
0249 74 AD                 0281 	JZ	ERROR		;Error if so
024B 59                    0282 	POP	CX		;Restore type flags
024C 3A C6                 0283 	CMP	AL,DH		;If second operand is immediate, then done
024E 74 E1                 0284 	JZ	MROPS_RET
0250 B0 FF                 0285 	MOV	AL,UNDEFID	;Check for memory reference
0252 3A C7                 0286 	CMP	AL,BH
0254 74 48                 0287 	JZ	STORE		;Is destination memory?
0256 3A C6                 0288 	CMP	AL,DH
0258 74 4E                 0289 	JZ	LOAD		;Is source memory?
025A                       0290 	TEST	CL,1		;Check if register-to-register operation OK
025A                       0291 	MOV	CL,27
025A 74 9C                 0292 	JZ	ERROR
025C 8A C6                 0293 	MOV	AL,DH
025E 3A C7                 0294 	CMP	AL,BH		;Registers must be of same length
0260                       0295 RR:
0260                       0296 	MOV	CL,22
0260 75 96                 0297 	JNZ	ERROR
0262                       0298 RR1:
0262 24 D0                 0299 	AND	AL,1		;Get register length (1=16 bits)
0264 0A C5                 0300 	OR	AL,CH		;Or in to OP code
0266 E8 D4 07              0301 	CALL	PUT		;And write it
0269 59                    0302 	POP	CX		;Dump return address
026A 8A C3                 0303 	MOV	AL,BL
026C 02 C0                 0304 	ADD	AL,AL		;Rotate register number into middle position
026E 02 C0                 0305 	ADD	AL,AL
0270 02 C0                 0306 	ADD	AL,AL
0272 0C C0                 0307 	OR	AL,0C0H		;Set register-to-register mode
0274 0A C2                 0308 	OR	AL,DL		;Combine with other register number
0276 E9 C4 07              0309 	JMP	PUT
0279                       0310 
0279                       0311 SEGCHK:
0279                       0312 ;Come here if at least one operand is a segment register
0279 59                    0313 	POP	CX		;Restore flags
027A F6 C1 D0              0314 	TEST	CL,8		;Check if segment register OK
027D B1                    0315 	MOV	CL,22
027E 74 76                 0316 	JZ	ERR1
0280 B9 03 8E              0317 	MOV	CX,8E03H	;Segment register move OP code
0283 B0 FF                 0318 	MOV	AL,UNDEFID
0285 3A C6                 0319 	CMP	AL,DH		;Check if source is memory
0287 74 1F                 0320 	JZ	LOAD
0289 3A C7                 0321 	CMP	AL,BH		;Check if destination is memory
028B 74 11                 0322 	JZ	STORE
028D B0 D1                 0323 	MOV	AL,XREG
028F 2A C6                 0324 	SUB	AL,DH		;Check if source is 16-bit register
0291 74 CD                 0325 	JZ	RR		;If so, AL must be zero
0293 B5 8C                 0326 	MOV	CH,8CH		;Change direction
0295 87 DA                 0327 	XCHG	DX,BX		;Flip which operand is first and second
0297 B0 D1                 0328 	MOV	AL,XREG
0299 2A C6                 0329 	SUB	AL,DH		;Let RR perform finish the test
029B E9 C2 FF              0330 	JMP	RR
029E                       0331 
029E                       0332 STORE:
029E F6 C1 04              0333 	TEST	CL,004H		;Check if storing is OK
02A1 75 50                 0334 	JNZ	STERR
02A3 87 DA                 0335 	XCHG	DX,BX		;If so, flip operands
02A5 80 E5 FD              0336 	AND	CH,0FDH		;   and zero direction bit
02A8                       0337 LOAD:
02A8 B6                    0338 	MOV	DH,25
02A9 3A C7                 0339 	CMP	AL,BH		;Check if memory-to-memory
02AB 74 47                 0340 	JZ	MRERR
02AD 8A C7                 0341 	MOV	AL,BH
02AF 3C E0                 0342 	CMP	AL,REG		;Check if 8-bit operation
02B1 75 06                 0343 	JNZ	XRG
02B3 B6                    0344 	MOV	DH,22
02B4 F6 C1 D0              0345 	TEST	CL,1		;See if 8-bit operation is OK
02B7 74 3B                 0346 	JZ	MRERR
02B9                       0347 XRG:
02B9 8A C2                 0348 	MOV	AL,DL
02BB 2C D0                 0349 	SUB	AL,6		;Check for R/M mode 6 and register 0
02BD 0A C3                 0350 	OR	AL,BL		;   meaning direct load/store of accumulator
02BF 75 19                 0351 	JNZ	NOTAC
02C1 F6 C1 D0              0352 	TEST	CL,8		;See if direct load/store of accumulator
02C4 74 14                 0353 	JZ	NOTAC		;   means anything in this case
02C6                       0354 ; Process direct load/store of accumulator
02C6 8A C5                 0355 	MOV	AL,CH
02C8 24 D0                 0356 	AND	AL,2		;Preserve direction bit only
02CA 34 D0                 0357 	XOR	AL,2		;   but flip it
02CC 0C A0                 0358 	OR	AL,0A0H		;Combine with OP code
02CE 8A E8                 0359 	MOV	CH,AL
02D0 8A C7                 0360 	MOV	AL,BH		;Check byte/word operation
02D2 24 D0                 0361 	AND	AL,1
02D4 0A C5                 0362 	OR	AL,CH
02D6 59                    0363 	POP	CX		;Dump return address
02D7 E9 12 08              0364 	JMP	PUTADD		;Write the address
02DA                       0365 
02DA                       0366 NOTAC:
02DA 8A C7                 0367 	MOV	AL,BH
02DC 24 D0                 0368 	AND	AL,1		;Get byte/word bit
02DE 22 C1                 0369 	AND	AL,CL		;But don't use it in word-only operations
02E0 0A C5                 0370 	OR	AL,CH		;Combine with OP code
02E2 E8 58 07              0371 	CALL	PUT
02E5 8A C3                 0372 	MOV	AL,BL
02E7 02 C0                 0373 	ADD	AL,AL		;Rotate to middle position
02E9 02 C0                 0374 	ADD	AL,AL
02EB 02 C0                 0375 	ADD	AL,AL
02ED 0A C2                 0376 	OR	AL,DL		;Combine register field
02EF 59                    0377 	POP	CX		;Dump return address
02F0 E9 F9 07              0378 	JMP	PUTADD		;Write the address
02F3                       0379 
02F3                       0380 STERR:
02F3 B6                    0381 	MOV	DH,29
02F4                       0382 MRERR:
02F4 8A CE                 0383 	MOV	CL,DH
02F6                       0384 
02F6 E9 FF FE              0385 ERR1:	JMP	ERROR
02F9                       0386 
02F9                       0387 GETOP2:
02F9                       0388 ;Get the second operand: look for a comma and drop into GETOP
02F9 A0 B0 19              0389 	MOV	AL,[SYM]
02FC 3C 2C                 0390 	CMP	AL,','
02FE B1                    0391 	MOV	CL,21
02FF 75 F5                 0392 	JNZ	ERR1
0301                       0393 
0301                       0394 
0301                       0395 GETOP:
0301                       0396 
0301                       0397 ; Get one operand. Operand may be a memory reference in brackets, a register,
0301                       0398 ; or a constant. If a flag (such as "B" for byte operation) is encountered,
0301                       0399 ; it is noted and processing continues to find the operand.
0301                       0400 ;
0301                       0401 ; On exit, AL (=DH) has the type of operand. Other information depends
0301                       0402 ; on the actual operand:
0301                       0403 ;
0301                       0404 ; AL=DH=0  Memory Reference.  DL has the address mode properly prepared in
0301                       0405 ; the 8086 R/M format (middle bits zero). The constant part of the address
0301                       0406 ; is in ADDR. If an undefined label needs to be added to this, a pointer to
0301                       0407 ; its information fields is in ALABEL, otherwise ALABEL is zero.
0301                       0408 ;
0301                       0409 ; AL=DH=1  Value. The constant part is in DATA. If an undefined label needs
0301                       0410 ; to be added to this, a pointer to its information fields is in DLABEL,
0301                       0411 ; otherwise DLABEL is zero. "$" and "RET" are in this class.
0301                       0412 ;
0301                       0413 ; AL=DH=2  8-bit Register. DL has the register number.
0301                       0414 ;
0301                       0415 ; AL=DH=3  16-bit Register. DL has the register number.
0301                       0416 ;
0301                       0417 ; AL=DH=4  Segment Register. DL has the register number.
0301                       0418 
0301 E8 00 02              0419 	CALL	GETSYM
0304                       0420 GETOP1:
0304                       0421 ;Enter here if we don't need a GETSYM first
0304 3C 5B                 0422 	CMP	AL,'['		;Memory reference?
0306 74 30                 0423 	JZ	MEM
0308 3C D0                 0424 	CMP	AL,5		;Flag ("B", "W", etc.)?
030A 74 53                 0425 	JZ	FLG
030C 3C E0                 0426 	CMP	AL,REG		;8-Bit register?
030E 74 20                 0427 	JZ	NREG
0310 3C D1                 0428 	CMP	AL,XREG		;16-Bit register?
0312 74 1C                 0429 	JZ	NREG
0314 3C FF                 0430 	CMP	AL,SREG		;Segment register?
0316 74 18                 0431 	JZ	NREG
0318                       0432 VAL:				;Must be immediate
0318 32 C0                 0433 	XOR	AL,AL		;No addressing modes allowed
031A                       0434 VAL1:
031A E8 54 00              0435 	CALL	GETVAL
031D A1 B0 19              0436 	MOV	AX,[CON]	;Defined part
0320 A3 AE 19              0437 	MOV	[DATA],AX
0323 A1 B0 19              0438 	MOV	AX,[UNDEF]	;Undefined part
0326 A3 B0 19              0439 	MOV	[DLABEL],AX
0329 8A D5                 0440 	MOV	DL,CH
032B B6 D7                 0441 	MOV	DH,CONST
032D 8A C6                 0442 	MOV	AL,DH
032F C3                    0443 	RET
0330                       0444 NREG:
0330 52                    0445 	PUSH	DX
0331 E8 D0 01              0446 	CALL	GETSYM
0334 5A                    0447 	POP	DX
0335 8A C6                 0448 	MOV	AL,DH
0337 C3                    0449 	RET
0338                       0450 MEM:
0338 E8 C9 01              0451 	CALL	GETSYM
033B                       0452 	MOV	AL,1
033B E8 33 00              0453 	CALL	GETVAL
033E A0 B0 19              0454 	MOV	AL,[SYM]
0341 3C 5D                 0455 	CMP	AL,']'
0343                       0456 	MOV	CL,24
0343 75 B1                 0457 	JNZ	ERR1
0345 E8 BC 01              0458 	CALL	GETSYM
0348 8B 1E B0 19           0459 	MOV	BX,[CON]
034C 89 1E AC 19           0460 	MOV	[ADDR],BX
0350 8B 1E B0 19           0461 	MOV	BX,[UNDEF]
0354 89 1E AE 19           0462 	MOV	[ALABEL],BX
0358 8A D5                 0463 	MOV	DL,CH
035A B6 FF                 0464 	MOV	DH,UNDEFID
035C 8A C6                 0465 	MOV	AL,DH
035E C3                    0466 	RET
035F                       0467 FLG:
035F 3A 16 AC 19           0468 	CMP	DL,[MAXFLG]	;Invalid flag for this operation?
0363 B1 27                 0469 	MOV	CL,27H
0365 7F 8F                 0470 	JG	ERR1
0367 E8 9A 01              0471 	CALL	GETSYM
036A 3C 2C                 0472 	CMP	AL,','
036C 74 93                 0473 	JZ	GETOP
036E E9 93 FF              0474 	JMP	GETOP1
0371                       0475 
0371                       0476 
0371                       0477 GETVAL:
0371                       0478 
0371                       0479 ; Expression analyzer. On entry, if AL=0 then do not allow base or index
0371                       0480 ; registers. If AL=1, we are analyzing a memory reference, so allow base
0371                       0481 ; and index registers, and compute addressing mode when done. The constant
0371                       0482 ; part of the expression will be found in CON. If an undefined label is to
0371                       0483 ; be added to this, a pointer to its information fields will be found in
0371                       0484 ; UNDEF.
0371                       0485 
0371 8A E0                 0486 	MOV	AH,AL		;Flag is kept in AH
0373                       0487 	MOV	WORD[UNDEF],0
0373 A0 B0 19              0488 	MOV	AL,[SYM]
0376 E8 3F 00              0489 	CALL	EXPRESSION
0379 89 16 B0 19           0490 	MOV	[CON],DX
037D 8A C4                 0491 	MOV	AL,AH
037F B5 D0                 0492 	MOV	CH,0		;Initial mode
0381 A8 10                 0493 	TEST	AL,10H		;Test INDEX bit
0383                       0494 	RCL	AL,1		;BASE bit (zero flag not affected)
0383 74 28                 0495 	JZ	NOIND		;Jump if not indexed, with BASE bit in carry
0385 F5                    0496 	CMC
0386                       0497 	RCL	CH,1		;Rotate in BASE bit
0386                       0498 	RCL	AL,1		;BP bit
0386                       0499 	RCL	CH,1
0386                       0500 	RCL	AL,1		;DI bit
0386                       0501 	RCL	CH,1		;The low 3 bits now have indexing mode
0386                       0502 MODE:
0386 80 CD 80              0503 	OR	CH,080H		;If undefined label, force 16-bit displacement
0389                       0504 	TEST	WORD[UNDEF],-1
0389 75 E6                 0505 	JNZ	GETVAL_RET
038B 8B 1E B0 19           0506 	MOV	BX,[CON]
038F 8A C3                 0507 	MOV	AL,BL
0391 98                    0508 	CBW			;Extend sign
0392 3B C3                 0509 	CMP	AX,BX		;Is it a signed 8-bit number?
0394 75 DB                 0510 	JNZ	GETVAL_RET		;If not, use 16-bit displacement
0396 80 E5 7F              0511 	AND	CH,07FH		;Reset 16-bit displacement
0399 80 CD 40              0512 	OR	CH,040H		;Set 8-bit displacement
039C 0B DB                 0513 	OR	BX,BX
039E 75 D1                 0514 	JNZ	GETVAL_RET		;Use it if not zero displacement
03A0 80 E5 D0              0515 	AND	CH,7		;Specify no displacement
03A3 80 FD D0              0516 	CMP	CH,6		;Check for BP+0 addressing mode
03A6 75 C9                 0517 	JNZ	GETVAL_RET
03A8 80 CD 40              0518 	OR	CH,040H		;If BP+0, use 8-bit displacement
03AB C3                    0519 	RET
03AC                       0520 GETVAL_RET:
03AC C3                    0521 	RET
03AD                       0522 NOIND:
03AD B5 D4                 0523 	MOV	CH,6		;Try direct address mode
03AF 73 C0                 0524 	JNC	GETVAL_RET		;If no base register, that's right
03B1                       0525 	RCL	AL,1		;Check BP bit
03B1 72 D3                 0526 	JC	MODE
03B3 FE C5                 0527 	INC	CH		;If not, must be BX
03B5 E9 CE FF              0528 	JMP	MODE
03B8                       0529 
03B8                       0530 EXPRESSION:
03B8                       0531 ;Analyze arbitrary expression. Flag byte in AH.
03B8                       0532 ;On exit, AL has type byte: 0=register or undefined label
03B8                       0533 	MOV	CH,-1		;Initial type
03B8 8B FA                 0534 	MOV	DI,DX
03BA 33 D2                 0535 	XOR	DX,DX		;Initial value
03BC 3C 2B                 0536 	CMP	AL,'+'
03BE 74 0D                 0537 	JZ	PLSMNS
03C0 3C 2D                 0538 	CMP	AL,'-'
03C2 74 09                 0539 	JZ	PLSMNS
03C4 B1 2B                 0540 	MOV	CL,'+'
03C6 52                    0541 	PUSH	DX
03C7 51                    0542 	PUSH	CX
03C8 8B D7                 0543 	MOV	DX,DI
03CA E9 07 00              0544 	JMP	OPERATE
03CD                       0545 PLSMNS:
03CD 8A C8                 0546 	MOV	CL,AL
03CF 52                    0547 	PUSH	DX
03D0 51                    0548 	PUSH	CX
03D1                       0549 	OR	AH,4		;Flag that a sign was found
03D1 E8 30 01              0550 	CALL	GETSYM
03D4                       0551 OPERATE:
03D4 E8 2B 00              0552 	CALL	TERM
03D7 59                    0553 	POP	CX		;Recover operator
03D8 5B                    0554 	POP	BX		;Recover current value
03D9 87 DA                 0555 	XCHG	DX,BX
03DB 22 E8                 0556 	AND	CH,AL
03DD 0A C0                 0557 	OR	AL,AL		;Is it register or undefined label?
03DF 74 17                 0558 	JZ	NOCON		;If so, then no constant part
03E1 82 F9 2D              0559 	CMP	CL,"-"		;Subtract it?
03E4 75 02                 0560 	JNZ	ADD
03E6 F7 DB                 0561 	NEG	BX
03E8                       0562 ADD:
03E8 03 D3                 0563 	ADD	DX,BX
03EA                       0564 NEXTERM:
03EA A0 B0 19              0565 	MOV	AL,[SYM]
03ED 3C 2B                 0566 	CMP	AL,'+'
03EF 74 DC                 0567 	JZ	PLSMNS
03F1 3C 2D                 0568 	CMP	AL,'-'
03F3 74 D8                 0569 	JZ	PLSMNS
03F5 8A C5                 0570 	MOV	AL,CH
03F7 C3                    0571 	RET
03F8                       0572 NOCON:
03F8 82 F9 2D              0573 	CMP	CL,"-"
03FB 75 ED                 0574 	JNZ	NEXTERM
03FD                       0575 BADOP:
03FD B1 02                 0576 	MOV	CL,5
03FF E9 F6 FD              0577 	JMP	ERROR
0402                       0578 
0402                       0579 TERM:
0402 E8 3E 00              0580 	CALL	FACTOR
0405                       0581 MULOP:
0405 52                    0582 	PUSH	DX		;Save value
0406 50                    0583 	PUSH	AX		;Save type
0407 E8 FA 00              0584 	CALL	GETSYM
040A 59                    0585 	POP	CX
040B 3C 2A                 0586 	CMP	AL,"*"
040D 74 04                 0587 	JZ	GETFACT
040F 3C 2F                 0588 	CMP	AL,"/"
0411 75 2C                 0589 	JNZ	ENDTERM
0413                       0590 GETFACT:
0413 0A C9                 0591 	OR	CL,CL		;Can we operate on this type?
0415 74 E6                 0592 	JZ	BADOP
0417 50                    0593 	PUSH	AX		;Save operator
0418 E8 E9 00              0594 	CALL	GETSYM		;Get past operator
041B E8 25 00              0595 	CALL	FACTOR
041E 0A C0                 0596 	OR	AL,AL
0420 74 DB                 0597 	JZ	BADOP
0422 59                    0598 	POP	CX		;Recover operator
0423 5D                    0599 	POP	BP		;And current value
0424 95                    0600 	XCHG	AX,BP		;Save AH in BP
0425 82 F9 2F              0601 	CMP	CL,"/"		;Do we divide?
0428 75 0D                 0602 	JNZ	DOMUL
042A 0B D2                 0603 	OR	DX,DX		;Dividing by zero?
042C B1 29                 0604 	MOV	CL,29H
042E 74 44                 0605 	JZ	ERR2
0430 8B DA                 0606 	MOV	BX,DX
0432 33 D2                 0607 	XOR	DX,DX		;Make 32-bit dividend
0434                       0608 	DIV	BX
0434 E9 00 00              0609 	JMP 	NEXFACT
0437                       0610 DOMUL:
0437                       0611 	MUL	DX
0437                       0612 NEXFACT:
0437 8B D0                 0613 	MOV	DX,AX		;Result in DX
0439 95                    0614 	XCHG	AX,BP		;Restore flags to AH
043A B0 FC                 0615 	MOV	AL,-1		;Indicate a number
043C E9 C6 FF              0616 	JMP 	MULOP
043F                       0617 ENDTERM:
043F 5A                    0618 	POP	DX
0440 8A C1                 0619 	MOV	AL,CL
0442 C3                    0620 	RET
0443                       0621 
0443                       0622 FACTOR:
0443 A0 B0 19              0623 	MOV	AL,[SYM]
0446 3C D7                 0624 	CMP	AL,CONST
0448 74 F9                 0625 	JZ	FACTOR_RET
044A 3C FF                 0626 	CMP	AL,UNDEFID
044C 74 4C                 0627 	JZ	UVAL
044E 3C 28                 0628 	CMP	AL,"("
0450 74 3E                 0629 	JZ	PAREN
0452 3C 22                 0630 	CMP	AL,'"'
0454 74 56                 0631 	JZ	STRING
0456 3C 27                 0632 	CMP	AL,"'"
0458 74 52                 0633 	JZ	STRING
045A 3C D1                 0634 	CMP	AL,XREG		;Only 16-bit register may index
045C                       0635 	MOV	CL,20
045C 75 16                 0636 	JNZ	ERR2
045E                       0637 	TEST	AH,1		;Check to see if indexing is OK
045E                       0638 	MOV	CL,1
045E 74 14                 0639 	JZ	ERR2
0460 8A C2                 0640 	MOV	AL,DL
0462                       0641 	MOV	CL,3
0462                       0642 	SUB	AL,3		;Check for BX
0462 74 23                 0643 	JZ	BXJ
0464 2C D0                 0644 	SUB	AL,2		;Check for BP
0466 74 1C                 0645 	JZ	BPJ
0468 FE C8                 0646 	DEC	AL		;Check for SI
046A B1 D0                 0647 	MOV	CL,4
046C 74 0D                 0648 	JZ	SIJ
046E FE C8                 0649 	DEC	AL		;Check for DI
0470 74 06                 0650 	JZ	DIJ
0472 B1 D0                 0651 	MOV	CL,2		;Invalid base/index register
0474 E9 81 FD              0652 ERR2:	JMP	ERROR
0477                       0653 FACTOR_RET:
0477 C3                    0654 	RET
0478                       0655 DIJ:
0478 80 CC 20              0656 	OR	AH,20H		;Flag seeing index register DI
047B                       0657 SIJ:
047B F6 C4 10              0658 	TEST	AH,10H		;Check if already seen index register
047E 75 F4                 0659 	JNZ	ERR2
0480 80 CC 10              0660 	OR	AH,10H		;Flag seeing index register
0483 C3                    0661 	RET
0484                       0662 
0484                       0663 BPJ:
0484 80 CC 40              0664 	OR	AH,40H		;Flag seeing base register BP
0487                       0665 BXJ:
0487 F6 C4 80              0666 	TEST	AH,80H		;Check if already seen base register
048A 75 E8                 0667 	JNZ	ERR2
048C 80 CC 80              0668 	OR	AH,80H		;Flag seeing base register
048F C3                    0669 	RET
0490                       0670 
0490                       0671 PAREN:
0490 E8 71 00              0672 	CALL	GETSYM		;Eat the "("
0493 E8 22 FF              0673 	CALL	EXPRESSION
0496                       0674 	CMP	BYTE [SYM],")"	;Better have closing paren
0496 B1                    0675 	MOV	CL,20
0497 75 10                 0676 	JNZ	ERR30
0499 C3                    0677 	RET
049A                       0678 
049A                       0679 UVAL:
049A B1 D7                 0680 	MOV	CL,6
049C F6 C4 D1              0681 	TEST	AH,8		;Check if undefined label has been seen
049F 75 08                 0682 	JNZ	ERR30
04A1 80 CC D0              0683 	OR	AH,8		;Flag seeing undefined label
04A4 89 1E B0 19           0684 	MOV	[UNDEF],BX
04A8 C3                    0685 	RET
04A9                       0686 
04A9 E9 4C FD              0687 ERR30:	JMP	ERROR
04AC                       0688 
04AC                       0689 STRING:
04AC 8A E8                 0690 	MOV	CH,AL
04AE A0 B0 19              0691 	MOV	AL,[CHR]
04B1 3A C5                 0692 	CMP	AL,CH
04B3                       0693 	MOV	CL,35
04B3 8A D0                 0694 	MOV	DL,AL
04B5                       0695 	MOV	DH,0
04B5 75 03                 0696 	JNZ	L0003
04B7 E8 2F 00              0697 	CALL	ZERLEN
04BA                       0698 L0003:
04BA E8 34 00              0699 	CALL	GETCHR
04BD                       0700 	MOV	CL,37
04BD F6 C4 F0              0701 	TEST	AH,2
04C0 74 E7                 0702 	JZ	ERR30
04C2 F6 C4 F0              0703 	TEST	AH,4
04C5 B1                    0704 	MOV	CL,38
04C6 75 E1                 0705 	JNZ	ERR30
04C8                       0706 STRGDAT:
04C8 8A C2                 0707 	MOV	AL,DL
04CA 3C 00                 0708 	CMP	AL,EOL
04CC B1                    0709 	MOV	CL,39
04CD 74 DA                 0710 	JZ	ERR30
04CF E8 6B 05              0711 	CALL	PUT
04D2 A0 B4 19              0712 	MOV	AL,[DATSIZ]
04D5 0A C0                 0713 	OR	AL,AL
04D7 75 05                 0714 	JNZ	BYTSIZ
04D9 8A C6                 0715 	MOV	AL,DH
04DB E8 5F 05              0716 	CALL	PUT
04DE                       0717 BYTSIZ:
04DE A0 B0 19              0718 	MOV	AL,[CHR]
04E1 8A D0                 0719 	MOV	DL,AL
04E3 E8 0B 00              0720 	CALL	GETCHR
04E6 E9 DF FF              0721 	JMP	STRGDAT
04E9                       0722 
04E9                       0723 ZERLEN:
04E9 E8 11 FD              0724 	CALL	NEXTCHR
04EC 3A C5                 0725 	CMP	AL,CH
04EE 75 B9                 0726 	JNZ	ERR30
04F0 C3                    0727 	RET
04F1                       0728 
04F1                       0729 GETCHR:
04F1 E8 09 FD              0730 	CALL	NEXTCHR
04F4 3A C5                 0731 	CMP	AL,CH
04F6 75 F9                 0732 	JNZ	GETCHR_RET
04F8 E8 02 FD              0733 	CALL	NEXTCHR
04FB 3A C5                 0734 	CMP	AL,CH
04FD 74 F2                 0735 	JZ	GETCHR_RET
04FF 5B                    0736 	POP	BX		;Kill return address to STRGDAT loop
0500 B0 30                 0737 	MOV	AL,-1		;Flag type as constant
0502 C3                    0738 	RET
0503                       0739 GETCHR_RET:
0503 C3                    0740 	RET
0504                       0741 
0504                       0742 GETSYM:
0504                       0743 
0504                       0744 ; The lexical scanner. Used only in the operand field. Returns with the token
0504                       0745 ; in SYM and AL, sometimes with additional info in BX or DX.
0504                       0746 ;
0504                       0747 ; AL=SYM=0  Undefined label. BX has pointer to information fields.
0504                       0748 ;
0504                       0749 ; AL=SYM=1  Constant (or defined label). DX has value.
0504                       0750 ;
0504                       0751 ; AL=SYM=2,3,4  8-bit register, 16-bit register, or segment register,
0504                       0752 ; respectively. DL has register number.
0504                       0753 ;
0504                       0754 ; AL=SYM=5  A mode flag (such as "B" for byte operation). Type of flag in DL
0504                       0755 ; and also stored in FLAG: -1=no flags, 0=B, 1=W, 2=S, 3=L, 4=T.
0504                       0756 ;
0504                       0757 ; AL=SYM=6  8087 floating point register, ST(n) or ST. DL has register number.
0504                       0758 ;
0504                       0759 ; All other values are the ASCII code of the character. Note that this may
0504                       0760 ; never be a letter or number.
0504                       0761 
0504 50                    0762 	PUSH	AX		;Save AH
0505 E8 23 00              0763 	CALL	GETSY
0508 58                    0764 	POP	AX
0509 A0 B0 19              0765 	MOV	AL,[SYM]
050C C3                    0766 	RET
050D                       0767 
050D                       0768 SCANB:
050D A0 B0 19              0769 	MOV	AL,[CHR]
0510                       0770 SCANT:
0510 3C 20                 0771 	CMP	AL,' '
0512 74 04                 0772 	JZ	NEXB
0514 3C D0                 0773 	CMP	AL,9
0516 75 F8                 0774 	JNZ	SCANT_RET
0518                       0775 NEXB:
0518 E8 E2 FC              0776 	CALL	NEXTCHR
051B E9 F2 FF              0777 	JMP	SCANT
051E                       0778 SCANT_RET:
051E C3                    0779 	RET
051F                       0780 
051F                       0781 DOLLAR:
051F 8B 16 A9 19           0782 	MOV	DX,[OLDPC]
0523 B0 D7                 0783 	MOV	AL,CONST
0525 A2 B0 19              0784 	MOV	[SYM],AL
0528                       0785 NEXTCHJ:
0528 E9 D2 FC              0786 	JMP	NEXTCHR
052B                       0787 
052B                       0788 GETSY:
052B E8 DF FF              0789 	CALL	SCANB
052E 3C 24                 0790 	CMP	AL,'$'
0530 74 ED                 0791 	JZ	DOLLAR
0532 A2 B0 19              0792 	MOV	[SYM],AL
0535 0C 20                 0793 	OR	AL,20H
0537 3C                    0794 	CMP	AL,'z'+1
0538 73 EE                 0795 	JNC	NEXTCHJ
053A 3C 61                 0796 	CMP	AL,'a'
053C 72 CE                 0797 	JC	$+5
053E E9 99 00              0798 	JMP	LETTER
0541 3C                    0799 	CMP	AL,'9'+1
0542 73 E4                 0800 	JNC	NEXTCHJ
0544 3C 30                 0801 	CMP	AL,'0'
0546 72 E0                 0802 	JC	NEXTCHJ
0548 BB B0 19              0803 	MOV	BX,SYM
054B                       0804 	MOV	BYTE [BX],CONST
054B E8 62 00              0805 	CALL	READID
054E 4B                    0806 	DEC	BX
054F 8A 07                 0807 	MOV	AL,[BX]
0551 B1 D0                 0808 	MOV	CL,7
0553 BB D9 00              0809 	MOV	BX,0
0556 3C 68                 0810 	CMP	AL,'h'
0558 75 EE                 0811 	JNZ	$+5
055A E9 1F 00              0812 	JMP	HEX
055D FE C1                 0813 	INC	CL
055F                       0814 	MOV	WORD[IX],IDTEXT
055F                       0815 DEC:
055F 8B 36 BC 19           0816 	MOV	SI,[IX]
0563 8A 04                 0817 	MOV	AL,[SI]
0565                       0818 	INC	WORD[IX]
0565                       0819 	CMP	AL,'9'+1
0565 72                    0820 	JC	$+5
0566 E9 8F FC              0821 	JMP	ERROR
0569 2C 30                 0822 	SUB	AL,'0'
056B 8B D3                 0823 	MOV	DX,BX
056D                       0824 	SHL	BX,1
056D                       0825 	SHL	BX,1
056D 03 DA                 0826 	ADD	BX,DX
056F                       0827 	SHL	BX,1
056F 8A D0                 0828 	MOV	DL,AL
0571 B6 04                 0829 	MOV	DH,0
0573 03 DA                 0830 	ADD	BX,DX
0575 FE CD                 0831 	DEC	CH
0577 75 E6                 0832 	JNZ	DEC
0579 87 DA                 0833 	XCHG	DX,BX
057B C3                    0834 	RET
057C                       0835 
057C                       0836 HEX:
057C BA B0 19              0837 	MOV	DX,IDTEXT
057F FE CD                 0838 	DEC	CH
0581                       0839 HEX1:
0581 8B F2                 0840 	MOV	SI,DX
0583 AC                    0841 	LODSB
0584 42                    0842 	INC	DX
0585 2C 30                 0843 	SUB	AL,'0'
0587                       0844 	CMP	AL,10
0587 72 04                 0845 	JC	GOTIT
0589 3C 37                 0846 	CMP	AL,'g'-'0'
058B 73 09                 0847 	JNC	ERR4
058D                       0848 	SUB	AL,'a'-10-'0'
058D                       0849 GOTIT:
058D                       0850 	SHL	BX,1
058D                       0851 	SHL	BX,1
058D                       0852 	SHL	BX,1
058D                       0853 	SHL	BX,1
058D 02 D8                 0854 	ADD	BL,AL
058F FE CD                 0855 	DEC	CH
0591 75 EE                 0856 	JNZ	HEX1
0593 87 DA                 0857 	XCHG	DX,BX
0595 C3                    0858 	RET
0596                       0859 
0596 E9 5F FC              0860 ERR4:	JMP	ERROR
0599                       0861 
0599                       0862 GETLET:
0599 E8 71 FF              0863 	CALL	SCANB
059C 3C 00                 0864 	CMP	AL,EOL
059E F9                    0865 	STC
059F 74 F8                 0866 	JZ	GETLET_RET
05A1 3C 3B                 0867 	CMP	AL,';'
05A3 F9                    0868 	STC
05A4 74 F3                 0869 	JZ	GETLET_RET
05A6 B1                    0870 	MOV	CL,10
05A7 0C 20                 0871 	OR	AL,20H
05A9 3C 61                 0872 	CMP	AL,'a'
05AB 72 E9                 0873 	JC	ERR4
05AD 3C                    0874 	CMP	AL,'z'+1
05AE 73 E6                 0875 	JNC	ERR4
05B0                       0876 READID:
05B0 BB B0 19              0877 	MOV	BX,IDTEXT
05B3 B5 D0                 0878 	MOV	CH,0
05B5                       0879 MOREID:
05B5 88 07                 0880 	MOV	[BX],AL	;WRITE AL TO IDTEXT
05B7 FE C5                 0881 	INC	CH
05B9 43                    0882 	INC	BX
05BA E8 40 FC              0883 	CALL	NEXTCHR
05BD 3C 30                 0884 	CMP	AL,'0'
05BF 72 0C                 0885 	JC	NOMORE
05C1 0C 20                 0886 	OR	AL,20H
05C3 3C                    0887 	CMP	AL,'z'+1
05C4 73 07                 0888 	JNC	NOMORE
05C6 3C                    0889 	CMP	AL,'9'+1
05C7 72 EC                 0890 	JC	MOREID
05C9 3C 61                 0891 	CMP	AL,'a'
05CB 73 E8                 0892 	JNC	MOREID
05CD                       0893 NOMORE:
05CD 8A C8                 0894 	MOV	CL,AL
05CF 8A C5                 0895 	MOV	AL,CH
05D1 A2 B0 19              0896 	MOV	[LENID],AL
05D4 0A C0                 0897 	OR	AL,AL
05D6 8A C1                 0898 	MOV	AL,CL
05D8 C3                    0899 	RET
05D9                       0900 GETLET_RET:
05D9 C3                    0901 	RET
05DA                       0902 
05DA                       0903 LETTER:
05DA E8 D3 FF              0904 	CALL	READID	;BX=IDTEXT, CH=length
05DD 8A C5                 0905 	MOV	AL,CH
05DF FE C8                 0906 	DEC	AL
05E1 75 14                 0907 	JNZ	NOFLG
05E3 A0 B0 19              0908 	MOV	AL,[IDTEXT]
05E6 B9 D0 00              0909 	MOV	CX,5
05E9 BF 1C 06              0910 	MOV	DI,FLGTAB
05EC FC                    0911 	CLD
05ED F2                    0912 	REPNE
05EE AE                    0913 	SCASB			;See if one of B,W,S,L,T
05EF 74 1A                 0914 	JZ	SAVFLG		;Go save flag
05F1 32 C0                 0915 	XOR	AL,AL
05F3 8A 2E B0 19           0916 	MOV	CH,[LENID]
05F7                       0917 NOFLG:
05F7 FE C8                 0918 	DEC	AL
05F9 53                    0919 	PUSH	BX
05FA 75 03                 0920 	JNZ	L0004
05FC E8 51 00              0921 	CALL	REGCHK
05FF                       0922 L0004:	
05FF 5B                    0923 	POP	BX
0600 8A C6                 0924 	MOV	AL,DH
0602 74 03                 0925 	JZ	SYMSAV
0604 E8 EC 00              0926 	CALL	LOOKRET
0607                       0927 SYMSAV:
0607 A2 B0 19              0928 	MOV	[SYM],AL
060A C3                    0929 	RET
060B                       0930 
060B                       0931 SAVFLG:
060B 8A D1                 0932 	MOV	DL,CL		;Need flag type in DL
060D 86 0E AB 19           0933 	XCHG	[FLAG],CL
0611 80 F9 30              0934 	CMP	CL,-1
0614 B1                    0935 	MOV	CL,32
0615 B0 D0                 0936 	MOV	AL,5
0617 74 EE                 0937 	JZ	SYMSAV
0619 E9 DC FB              0938 ERRJ3:	JMP	ERROR
061C                       0939 
061C 74 6C 73 77 62        0940 FLGTAB:	DB	"tlswb"
0621                       0941 
0621                       0942 FPREG:
0621                       0943 ;Have detected "ST" for 8087 floating point stack register
0621 B2 D0                 0944 	MOV	DL,0		;Default is ST(0)
0623 E8 E7 FE              0945 	CALL	SCANB		;Get next character
0626 3C 28                 0946 	CMP	AL,"("		;Specifying register number?
0628 75 21                 0947 	JNZ	HAVREG
062A                       0948 ;Get register number
062A E8 D0 FB              0949 	CALL	NEXTCHR		;Skip over the "("
062D E8 D1 FC              0950 	CALL	GETOP		;A little recursion never hurt anybody
0630 3C D7                 0951 	CMP	AL,CONST	;Better have found a constant
0632 B1                    0952 	MOV	CL,20		;Operand error if not
0633 75 E4                 0953 	JNZ	ERRJ3
0635                       0954 	CMP	WORD[DLABEL],0	;Constant must be defined
0635 B1                    0955 	MOV	CL,30
0636 75 E1                 0956 	JNZ	ERRJ3
0638 8B 16 AE 19           0957 	MOV	DX,[DATA]	;Get constant
063C 81 FA D0 00           0958 	CMP	DX,7		;Constant must be in range 0-7
0640 B1                    0959 	MOV	CL,31
0641 77 D6                 0960 	JA	ERRJ3
0643 A0 B0 19              0961 	MOV	AL,[SYM]
0646 3C 29                 0962 	CMP	AL,")"
0648 B1                    0963 	MOV	CL,24
0649 75 CE                 0964 	JNZ	ERRJ3
064B                       0965 HAVREG:
064B B6 D7                 0966 	MOV	DH,FREG
064D 32 C0                 0967 	XOR	AL,AL		;Zero set means register found
064F C3                    0968 	RET
0650                       0969 
0650                       0970 REGCHK:
0650 BB B0 19              0971 	MOV	BX,IDTEXT
0653                       0972 	CMP	WORD[BX],"s"+7400H	;"st"
0653 74 CC                 0973 	JZ	FPREG
0655 8A 0F                 0974 	MOV	CL,[BX]
0657 43                    0975 	INC	BX
0658 8A 07                 0976 	MOV	AL,[BX]
065A BB B9 06              0977 	MOV	BX,REGTAB
065D B6 D1                 0978 	MOV	DH,XREG
065F B2 D0                 0979 	MOV	DL,0
0661 3C 78                 0980 	CMP	AL,'x'
0663 74 3C                 0981 	JZ	SCANREG
0665 B6 E0                 0982 	MOV	DH,REG
0667 3C 6C                 0983 	CMP	AL,'l'
0669 74 36                 0984 	JZ	SCANREG
066B B2 D0                 0985 	MOV	DL,4
066D 3C 68                 0986 	CMP	AL,'h'
066F 74 30                 0987 	JZ	SCANREG
0671 B6 FF                 0988 	MOV	DH,SREG
0673 B2 D0                 0989 	MOV	DL,0
0675 BB BD 06              0990 	MOV	BX,SEGTAB
0678 3C 73                 0991 	CMP	AL,'s'
067A 74 25                 0992 	JZ	SCANREG
067C B6 D1                 0993 	MOV	DH,XREG
067E 3C 70                 0994 	CMP	AL,'p'
0680 74 11                 0995 	JZ	PREG
0682 3C 69                 0996 	CMP	AL,'i'
0684 75 CA                 0997 	JNZ	REGCHK_RET
0686 B2 D0                 0998 	MOV	DL,6
0688 8A C1                 0999 	MOV	AL,CL
068A 3C 73                 1000 	CMP	AL,'s'
068C 74 C2                 1001 	JZ	REGCHK_RET
068E FE C2                 1002 	INC	DL
0690 3C 64                 1003 	CMP	AL,'d'
0692 C3                    1004 	RET
0693                       1005 PREG:
0693 B2 D0                 1006 	MOV	DL,4
0695 8A C1                 1007 	MOV	AL,CL
0697 3C 73                 1008 	CMP	AL,'s'
0699 74 F8                 1009 	JZ	PREG_RET
069B FE C2                 1010 	INC	DL
069D 3C 62                 1011 	CMP	AL,'b'
069F C3                    1012 	RET
06A0                       1013 PREG_RET:
06A0 C3                    1014 	RET
06A1                       1015 SCANREG:
06A1 8A C1                 1016 	MOV	AL,CL
06A3 B9 D0 00              1017 	MOV	CX,4
06A6 FC                    1018 	CLD
06A7 8B FB                 1019 	MOV	DI,BX
06A9 F2                    1020 	REPNZ
06AA AE                    1021 	SCASB
06AB 8B DF                 1022 	MOV	BX,DI
06AD 75 A1                 1023 	JNZ	REGCHK_RET
06AF 8A C1                 1024 	MOV	AL,CL
06B1 02 C2                 1025 	ADD	AL,DL
06B3 8A D0                 1026 	MOV	DL,AL
06B5 32 C0                 1027 	XOR	AL,AL
06B7 C3                    1028 	RET
06B8                       1029 REGCHK_RET:
06B8 C3                    1030 	RET
06B9                       1031 
06B9 62 64 63 61           1032 REGTAB:	DB	'bdca'
06BD                       1033 
06BD 64 73 63 65           1034 SEGTAB:	DB	'dsce'
06C1                       1035 
06C1                       1036 LOOK:
06C1 8A 2F                 1037 	MOV	CH,[BX]		;BX=HEAP,CH=LENGTH
06C3 43                    1038 	INC	BX			;BX=POINTS TO FIRST CHARACTER
06C4 BA B0 19              1039 	MOV	DX,IDTEXT	;DX=IDTEXT
06C7 E8 F5 00              1040 	CALL	CPSLP 	;DX=SOURCE, CH=LENGTH
06CA 74 F5                 1041 	JZ	LOOK_RET	;FOUND LENGTH MATCH
06CC                       1042 	;FIX
06CC 34 80                 1043 	XOR	AL,80H
06CE                       1044 	ROL	AL,1		;Make end-of-symbol bit least significant
06CE 8A C8                 1045 	MOV	CL,AL
06D0 4B                    1046 	DEC	BX
06D1 8A 07                 1047 	MOV	AL,[BX]
06D3                       1048 	;FIX
06D3 34 80                 1049 	XOR	AL,80H
06D5                       1050 	ROL	AL,1
06D5 3A C1                 1051 	CMP	AL,CL
06D7 73 04                 1052 	JNC	SMALL
06D9 FE C5                 1053 	INC	CH
06DB FE C5                 1054 	INC	CH
06DD                       1055 SMALL:
06DD 8A D5                 1056 	MOV	DL,CH
06DF B6 D0                 1057 	MOV	DH,0
06E1 03 DA                 1058 	ADD	BX,DX
06E3 8B 17                 1059 	MOV	DX,[BX]
06E5 43                    1060 	INC	BX
06E6 8A C2                 1061 	MOV	AL,DL
06E8 0A C6                 1062 	OR	AL,DH
06EA F9                    1063 	STC
06EB 74 D4                 1064 	JZ	LOOK_RET
06ED 87 DA                 1065 	XCHG	DX,BX
06EF E9 CF FF              1066 	JMP	LOOK
06F2                       1067 
06F2                       1068 LOOK_RET:
06F2 C3                    1069 	RET
06F3                       1070 LOOKRET:		;BX=IDTEXT, CH=length
06F3 8A C5                 1071 	MOV	AL,CH	;CH=[LENID]
06F5 3C D0                 1072 	CMP	AL,3	;RET has 3 letters
06F7 75 4D                 1073 	JNZ	LOOKUP
06F9 4B                    1074 	DEC	BX
06FA                       1075 	;FIX: REMOVE THIS END OF SYMBOL BIT SETTING
06FA                       1076 	OR	BYTE [BX],080H	;Set end-of-symbol bit
06FA BA 69 1A              1077 	MOV	DX,RETSTR+2
06FD                       1078 CHKRET:
06FD 8B F2                 1079 	MOV	SI,DX
06FF AC                    1080 	LODSB
0700 3A 07                 1081 	CMP	AL,[BX]
0702 75 43                 1082 	JNZ	LOOKIT
0704 4B                    1083 	DEC	BX
0705 4A                    1084 	DEC	DX
0706 FE CD                 1085 	DEC	CH
0708 75 F3                 1086 	JNZ	CHKRET
070A 8B 16 BB 19           1087 	MOV	DX,[LSTRET]
070E 8A C2                 1088 	MOV	AL,DL
0710 22 C6                 1089 	AND	AL,DH
0712 FE C0                 1090 	INC	AL
0714 74 0F                 1091 	JZ	ALLRET
0716 8B 1E A9 19           1092 	MOV	BX,[PC]
071A 2B DA                 1093 	SUB	BX,DX
071C 8A C3                 1094 	MOV	AL,BL
071E 98                    1095 	CBW
071F 3B C3                 1096 	CMP	AX,BX		;Signed 8-bit number?
0721 B0 D0                 1097 	MOV	AL,1
0723 74 00                 1098 	JZ	ALLRET_RET
0725                       1099 ALLRET:
0725 8B 1E BB 19           1100 	MOV	BX,[RETPT]
0729 8A C7                 1101 	MOV	AL,BH
072B 0A C3                 1102 	OR	AL,BL
072D B0 D0                 1103 	MOV	AL,0
072F 75 F4                 1104 	JNZ	ALLRET_RET
0731 8B 1E B2 19           1105 	MOV	BX,[HEAP]
0735 4B                    1106 	DEC	BX
0736 4B                    1107 	DEC	BX
0737 4B                    1108 	DEC	BX
0738 89 1E B2 19           1109 	MOV	[HEAP],BX
073C 32 C0                 1110 	XOR	AL,AL
073E 88 07                 1111 	MOV	[BX],AL
0740 89 1E BB 19           1112 	MOV	[RETPT],BX
0744 C3                    1113 	RET
0745                       1114 ALLRET_RET:
0745 C3                    1115 	RET
0746                       1116 LOOKUP:	;BX=IDTEXT, CH=length
0746 4B                    1117 	DEC	BX
0747                       1118 	;FIX: REMOVE THIS END OF SYMBOL BIT SETTING
0747                       1119 	OR	BYTE [BX],080H
0747                       1120 LOOKIT:
0747 8B 1E B0 19           1121 	MOV	BX,[BASE]	;BX points to root of ID tree
074B 8A C7                 1122 	MOV	AL,BH
074D 0A C3                 1123 	OR	AL,BL
074F 74 20                 1124 	JZ	EMPTY
0751 E8 6D FF              1125 	CALL	LOOK
0754 72 11                 1126 	JC	ENTER	;Not found, enter new node
0756 BA D0 00              1127 	MOV	DX,4	;Offset to right link
0759 03 DA                 1128 	ADD	BX,DX
075B 8A 07                 1129 	MOV	AL,[BX]	;Get right link
075D 0A C0                 1130 	OR	AL,AL	;AL==0
075F 74 E6                 1131 	JZ	LOOKIT_RET ;If zero, then not found
0761 43                    1132 	INC	BX
0762 8B 17                 1133 	MOV	DX,[BX] ;Get pointer to right link
0764 43                    1134 	INC	BX	;Point to defined flag
0765 C3                    1135 	RET
0766                       1136 LOOKIT_RET:
0766 C3                    1137 	RET
0767                       1138 ENTER:
0767 53                    1139 	PUSH	BX		;Save pointer to link field
0768 E8 0E 00              1140 	CALL	CREATE		;Add the node
076B 5E                    1141 	POP	SI
076C 89 94 30 FF           1142 	MOV	[SI-1],DX	;Link new node
0770 C3                    1143 	RET			;Zero was set by CREATE
0771                       1144 
0771                       1145 EMPTY:
0771 E8 05 00              1146 	CALL	CREATE
0774 89 16 B0 19           1147 	MOV	[BASE],DX
0778 C3                    1148 	RET
0779                       1149 
0779                       1150 
0779                       1151 CREATE:
0779                       1152 
0779                       1153 ; Add a new node to the identifier tree. The identifier is at IDTEXT with
0779                       1154 ; bit 7 of the last character set to one. The length of the identifier is
0779                       1155 ; in LENID, which is IDTEXT-1.
0779                       1156 ;
0779                       1157 ; Node format:
0779                       1158 ;	1. Length of identifier (1 byte)
0779                       1159 ;	2. Identifier (1-80 bytes)
0779                       1160 ;	3. Left link (2-byte pointer to alphabetically smaller identifiers)
0779                       1161 ;	4. Right link (2-byte pointer, 0 if none larger)
0779                       1162 ;	5. Data field:
0779                       1163 ;	   a. Defined flag (0=undefined, 1=defined) (1 byte)
0779                       1164 ;	   b. Value (2 bytes)
0779                       1165 ;
0779                       1166 ; This routine returns with AL=zero and zero flag set (which indicates
0779                       1167 ; on return from LOOKUP that it has not yet been defined), DX points
0779                       1168 ; to start of new node, and BX points to data field of new node.
0779                       1169 
0779 A0 B0 19              1170 	MOV	AL,[LENID]
077C 04 D0                 1171 	ADD	AL,8		;Storage needed for the node
077E 8B 1E B2 19           1172 	MOV	BX,[HEAP]
0782 8A D0                 1173 	MOV	DL,AL
0784 B6 D0                 1174 	MOV	DH,0
0786 2B DA                 1175 	SUB	BX,DX		;Heap grows downward
0788 89 1E B2 19           1176 	MOV	[HEAP],BX	;Adjust heap pointer
078C 87 DA                 1177 	XCHG	DX,BX	;DX=pointer to new node,BX=bytes needed
078E 8B 1E B4 19           1178 	MOV	BX,[CODE]	;Check to make sure there's enough
0792 3B DA                 1179 	CMP	BX,DX		;DX=pointer to new node
0794 72 03                 1180 	JB	SKIP_ABORT
0796 E9 28 FA              1181 	JMP	ABORT
0799                       1182 SKIP_ABORT:
0799 52                    1183 	PUSH	DX
079A BB B0 19              1184 	MOV	BX,LENID
079D 8A 0F                 1185 	MOV	CL,[BX]
079F FE C1                 1186 	INC	CL
07A1 B5 D0                 1187 	MOV	CH,0
07A3 FC                    1188 	CLD
07A4 8B F3                 1189 	MOV	SI,BX
07A6 8B FA                 1190 	MOV	DI,DX
07A8 F3                    1191 	REP
07A9 A4                    1192 	MOVSB			;Move identifier and length into node
07AA 8B D7                 1193 	MOV	DX,DI
07AC 8B DE                 1194 	MOV	BX,SI
07AE B5 D0                 1195 	MOV	CH,4
07B0 87 DA                 1196 	XCHG	DX,BX
07B2                       1197 NILIFY:				;ZERO 4 bytes of left/right links and defined flag
07B2 88 0F                 1198 	MOV	[BX],CL		;Zero left and right links
07B4 43                    1199 	INC	BX
07B5 FE CD                 1200 	DEC	CH
07B7 75 F9                 1201 	JNZ	NILIFY
07B9 32 C0                 1202 	XOR	AL,AL		;Set zero flag
07BB 88 07                 1203 	MOV	[BX],AL		;Zero defined flag
07BD 5A                    1204 	POP	DX		;Restore pointer to node
07BE C3                    1205 	RET
07BF                       1206 
07BF                       1207 CPSLP:	;DX=SOURCE, CH=LENGTH
07BF 8B F2                 1208 	MOV	SI,DX
07C1 AC                    1209 	LODSB
07C2 3A 07                 1210 	CMP	AL,[BX]
07C4 9F                    1211 	LAHF
07C5 42                    1212 	INC	DX
07C6 43                    1213 	INC	BX
07C7 9E                    1214 	SAHF
07C8 75 F5                 1215 	JNZ	CPSLP_RET
07CA FE CD                 1216 	DEC	CH
07CC 75 F1                 1217 	JNZ	CPSLP
07CE C3                    1218 	RET
07CF                       1219 CPSLP_RET:
07CF C3                    1220 	RET
07D0                       1221 GETLAB:
07D0 BB D0 00              1222 	MOV	BX,0
07D3 89 1E AB 19           1223 	MOV	[LABPT],BX
07D7                       1224 	MOV	BYTE [FLAG],-1
07D7 B6 D0                 1225 	MOV	DH,0
07D9 A0 B0 19              1226 	MOV	AL,[CHR]
07DC 3C F0                 1227 	CMP	AL,' '+1
07DE 72 03                 1228 	JC	NOT1
07E0 80 CE 01              1229 	OR	DH,001H
07E3                       1230 NOT1:
07E3 E8 B3 FD              1231 	CALL	GETLET
07E6 72 D7                 1232 	JC	CPSLP_RET
07E8 3C 3A                 1233 	CMP	AL,':'
07EA 75 06                 1234 	JNZ	LABCHK
07EC E8 0E FA              1235 	CALL	NEXTCHR
07EF E9 07 00              1236 	JMP	LABEL
07F2                       1237 LABCHK:
07F2 0A C0                 1238 	OR	AL,AL
07F4 F6 C6 01              1239 	TEST	DH,001H
07F7 74 C6                 1240 	JZ	CPSLP_RET
07F9                       1241 LABEL:
07F9 A0 B8 19              1242 	MOV	AL,[CHKLAB]	;ALL LABELS COUNT
07FC 0A C0                 1243 	OR	AL,AL
07FE 74 CE                 1244 	JZ	$+5
0800 E9 96 FD              1245 	JMP	GETLET
0803 E8 40 FF              1246 	CALL	LOOKUP
0806 B1                    1247 	MOV	CL,11
0807 75 0E                 1248 	JNZ	ERR5
0809 8B 16 A9 19           1249 	MOV	DX,[PC]
080D                       1250 	MOV	BYTE [BX],1	;SET DEFINED FLAG
080D 43                    1251 	INC	BX		;POINT TO VALUE FIELD
080E 89 17                 1252 	MOV	[BX],DX ;SET VALUE
0810 89 1E AB 19           1253 	MOV	[LABPT],BX ;POINT TO DATA FIELD
0814 E9 82 FD              1254 	JMP	GETLET
0817                       1255 
0817 E9 DE F9              1256 ERR5:	JMP	ERROR
081A                       1257 
081A                       1258 ASMLIN:
081A                       1259 	MOV	BYTE [MAXFLG],1	;Allow only B and W flags normally
081A 8B 1E A9 19           1260 	MOV	BX,[PC]
081E 89 1E A9 19           1261 	MOV	[OLDPC],BX
0822 E8 AB FF              1262 	CALL	GETLAB
0825 73 CE                 1263 	JNC	$+5
0827 E9 75 F9              1264 	JMP	ENDLN
082A BB B0 19              1265 	MOV	BX,LENID
082D 8A 07                 1266 	MOV	AL,[BX]	;AL=length of label
082F B1                    1267 	MOV	CL,12
0830 2C D0                 1268 	SUB	AL,2	;At least 2 chars for opcode
0832 8A E8                 1269 	MOV	CH,AL	;CH=length of opcode
0834 72 E1                 1270 	JC	ERR5
0836 43                    1271 	INC	BX
0837                       1272 	CMP	BYTE [BX],"f"	;See if an 8087 mnemonic
0837 74 4C                 1273 	JZ	NDPOP
0839 3C D0                 1274 	CMP	AL,5
083B 73 DA                 1275 	JNC	ERR5
083D 8A 07                 1276 	MOV	AL,[BX]
083F 2C 61                 1277 	SUB	AL,'a'
0841 8A C8                 1278 	MOV	CL,AL
0843 02 C0                 1279 	ADD	AL,AL
0845 02 C0                 1280 	ADD	AL,AL
0847 02 C1                 1281 	ADD	AL,CL
0849 02 C5                 1282 	ADD	AL,CH
084B 02 C0                 1283 	ADD	AL,AL
084D BB 93 17              1284 	MOV	BX,OPTAB ;Base of opcode table
0850 8A D0                 1285 	MOV	DL,AL
0852 B6 D0                 1286 	MOV	DH,0
0854 03 DA                 1287 	ADD	BX,DX	;Point to opcode info
0856 8B 1F                 1288 	MOV	BX,[BX] ;BX points to start of opcode info
0858 FE C5                 1289 	INC	CH		;length of opcode + 1
085A 8A CD                 1290 	MOV	CL,CH	;CL=CH
085C 8A 27                 1291 	MOV	AH,[BX] ;AH=COuNT OF OPERANDS
085E 43                    1292 	INC	BX		;Point to first opcode entry
085F 0A E4                 1293 	OR	AH,AH	;Test if any opcodes with this length
0861 74 18                 1294 	JZ	OPERR
0863                       1295 FINDOP:
0863 8A E9                 1296 	MOV	CH,CL	;CH=CL
0865 BA 80 1A              1297 	MOV	DX,IDTEXT+1
0868 95                    1298 	XCHG	AX,BP		;Save count of opcodes in BP
0869 E8 53 FF              1299 	CALL	CPSLP		;DX=SOURCE, CH=LENGTH 
086C 74 11                 1300 	JZ	HAVOP
086E 95                    1301 	XCHG	AX,BP
086F B6 D0                 1302 	MOV	DH,0
0871 8A D5                 1303 	MOV	DL,CH
0873 42                    1304 	INC	DX
0874 42                    1305 	INC	DX
0875 03 DA                 1306 	ADD	BX,DX			;Point to next opcode entry
0877 FE CC                 1307 	DEC	AH
0879 75 E8                 1308 	JNZ	FINDOP
087B                       1309 OPERR:
087B B1                    1310 	MOV	CL,12
087C E9 79 F9              1311 	JMP	ERROR
087F                       1312 
087F                       1313 HAVOP:
087F 8A 87 D0 00           1314 	MOV	AL,[BX+2]	;Get opcode
0883 FF 27                 1315 	JMP	[BX]		;Jump to opcode handler
0885                       1316 
0885                       1317 NDPOP:	;First letter is "F" so must be 8087 opcode ("Numeric Data Processor")
0885                       1318 	MOV	BYTE [MAXFLG],4	;Allow all type flags
0885 43                    1319 	INC	BX
0886                       1320 	CMP	BYTE [BX],"n"	;"No-wait" form?
0886 B4 D0                 1321 	MOV	AH,0
0888 75 05                 1322 	JNZ	SAVNFLG
088A B4 D0                 1323 	MOV	AH,1
088C FE C8                 1324 	DEC	AL
088E 43                    1325 	INC	BX		;Skip over the "N"
088F                       1326 SAVNFLG:
088F 88 26 BB 19           1327 	MOV	[NOWAIT],AH	;0 for wait, 1 for no wait
0893 3C D0                 1328 	CMP	AL,1
0895 72 E4                 1329 	JB	OPERR		;Not enough char left for valid opcode?
0897 3C D0                 1330 	CMP	AL,5
0899 77 E0                 1331 	JA	OPERR		;Too many?
089B 98                    1332 	CBW
089C 92                    1333 	XCHG	AX,DX		;Save length in DX
089D 8B F2                 1334 	MOV	SI,DX
089F                       1335 	OR	BYTE [SI+BX],80H	;Set high bit of last character
089F 8A 07                 1336 	MOV	AL,[BX]		;Get first char of opcode
08A1 43                    1337 	INC	BX
08A2 2C 61                 1338 	SUB	AL,"a"
08A4 72 27                 1339 	JB	TRY2XM1		;Go see if opcode starts with "2"
08A6 3C 19                 1340 	CMP	AL,"z"-"a"
08A8 77 D1                 1341 	JA	OPERR
08AA 98                    1342 	CBW
08AB                       1343 	SHL	AX,1		;Double to index into address table
08AB 96                    1344 	XCHG	AX,SI		;Put in index register
08AC 8B BC 97 18           1345 	MOV	DI,[SI+NDPTAB]	;Get start of opcode table for this letter
08B0                       1346 LOOKNDP:
08B0 8A 25                 1347 	MOV	AH,[DI]		;Number of opcodes starting with this letter
08B2 0A E4                 1348 	OR	AH,AH
08B4 74 C5                 1349 	JZ	OPERR		;Any start with this letter?
08B6                       1350 FNDNDP:
08B6 47                    1351 	INC	DI
08B7 8B F3                 1352 	MOV	SI,BX		;Pointer to start of opcode
08B9 8B CA                 1353 	MOV	CX,DX		;Get length of opcode
08BB F3                    1354 	REPE
08BC A6                    1355 	CMPSB			;Compare opcode to table entry
08BD 74 30                 1356 	JZ	HAVNDP
08BF 4F                    1357 	DEC	DI		;Back up in case that was last letter
08C0 B0 80                 1358 	MOV	AL,80H		;Look for char with high bit set
08C2                       1359 ENDOP:
08C2 AE                    1360 	SCASB
08C3 77 FD                 1361 	JA	ENDOP
08C5 47                    1362 	INC	DI		;Skip over info about opcode
08C6 FE CC                 1363 	DEC	AH
08C8 75 EC                 1364 	JNZ	FNDNDP
08CA E9 AE FF              1365 OPERRJ:	JMP	OPERR
08CD                       1366 
08CD                       1367 TRY2XM1:
08CD 3C D1                 1368 	CMP	AL,"2"-"a"
08CF 75 AA                 1369 	JNZ	OPERR
08D1 BF 8C 16              1370 	MOV	DI,XM1
08D4 E9 D9 FF              1371 	JMP	LOOKNDP
08D7                       1372 
08D7                       1373 SPECIALOP:
08D7 24 D0                 1374 	AND	AL,7		;Mask to special op number
08D9 74 11                 1375 	JZ	FWAIT		;If zero, go handle FWAIT
08DB                       1376 ;Handle FNOP
08DB                       1377 	CMP	BYTE [NOWAIT],0	;Was "N" present (If not opcode was "FOP")
08DB 74 9E                 1378 	JZ	OPERR
08DD B0 9B                 1379 	MOV	AL,9BH		;Need Wait opcode after all
08DF E8 5B 01              1380 	CALL	PUT
08E2 B0 D9                 1381 	MOV	AL,0D9H
08E4 E8 56 01              1382 	CALL	PUT
08E7 B0 D0                 1383 	MOV	AL,0D0H
08E9 E9 51 01              1384 	JMP	PUT
08EC                       1385 
08EC                       1386 FWAIT:
08EC                       1387 	CMP	BYTE [NOWAIT],0	;"FNWAIT" not legal
08EC 75 DC                 1388 	JNZ	OPERRJ
08EE C3                    1389 	RET			;Nothing to do - "WAIT" already sent
08EF                       1390 
08EF                       1391 HAVNDP:
08EF 8B F7                 1392 	MOV	SI,DI
08F1                       1393 	CMP	BYTE [NOWAIT],0
08F1 75 05                 1394 	JNZ	NWAIT
08F3 B0 9B                 1395 	MOV	AL,9BH		;Wait opcode
08F5 E8 45 01              1396 	CALL	PUT
08F8                       1397 NWAIT:
08F8 AD                    1398 	LODSW			;Get opcode info
08F9 A8 F8                 1399 	TEST	AL,0F8H		;Any operand bits set?
08FB 74 65                 1400 	JZ	NOOPS		;If no operands, output code
08FD A8 78                 1401 	TEST	AL,78H		;Special case?
08FF 74 D6                 1402 	JZ	SPECIALOP
0901 50                    1403 	PUSH	AX
0902 E8 FF FB              1404 	CALL	GETSYM		;See if any operands
0905 59                    1405 	POP	CX
0906 3C 3B                 1406 	CMP	AL,";"
0908 74 52                 1407 	JZ	NOOPCHK
090A 3C 00                 1408 	CMP	AL,EOL
090C 74 4E                 1409 	JZ	NOOPCHK
090E 3C D7                 1410 	CMP	AL,FREG		;Is it 8087 register?
0910 75 6E                 1411 	JNZ	MEMOP
0912 91                    1412 	XCHG	AX,CX
0913 A8 40                 1413 	TEST	AL,ONEREG	;One register OK as operand?
0915 75 35                 1414 	JNZ	PUTREG		;Yes - save it
0917 A8 20                 1415 	TEST	AL,20H		;Memory-only operation?
0919 B1                    1416 	MOV	CL,20
091A 75 61                 1417 	JNZ	ERRJ4
091C A8 18                 1418 	TEST	AL,18H		;Two-register operation?
091E 7A 5D                 1419 	JPE	ERRJ4		;Must be exactly one bit set
0920 52                    1420 	PUSH	DX		;Save register number
0921 50                    1421 	PUSH	AX		;Save opcode
0922 E8 DF FB              1422 	CALL	GETSYM
0925 3C 2C                 1423 	CMP	AL,","
0927 B1 15                 1424 	MOV	CL,15H
0929 75 52                 1425 	JNZ	ERRJ4
092B E8 D6 FB              1426 	CALL	GETSYM
092E B1                    1427 	MOV	CL,20
092F 3C D7                 1428 	CMP	AL,FREG
0931 75 4A                 1429 	JNZ	ERRJ4
0933 58                    1430 	POP	AX
0934 5B                    1431 	POP	BX
0935 34 D0                 1432 	XOR	AL,2		;Flip "POP" bit
0937 24 FB                 1433 	AND	AL,0FBH		;Reset direction bit to ST(0)
0939 0A DB                 1434 	OR	BL,BL		;Is first register ST(0)?
093B 74 0B                 1435 	JZ	ST0DEST
093D 87 DA                 1436 	XCHG	DX,BX
093F 0A DB                 1437 	OR	BL,BL		;One of these must be ST(0)
0941 75 3A                 1438 	JNZ	ERRJ4
0943 34 D0                 1439 	XOR	AL,4		;Flip direction
0945 E9 04 00              1440 	JMP 	PUTREG
0948                       1441 ST0DEST:
0948 A8 D0                 1442 	TEST	AL,2		;Is POP bit set?
094A 75 31                 1443 	JNZ	ERRJ4		;Don't allow destination ST(0) then pop
094C                       1444 PUTREG:
094C 80 E4 F8              1445 	AND	AH,0F8H		;Zero out register field
094F 0A E2                 1446 	OR	AH,DL
0951 80 CC C0              1447 	OR	AH,0C0H
0954 50                    1448 	PUSH	AX
0955 E8 AC FB              1449 	CALL	GETSYM		;Get to next symbol
0958 58                    1450 	POP	AX
0959 E9 06 00              1451 	JMP 	NOOPS
095C                       1452 
095C                       1453 NOOPCHK:
095C 91                    1454 	XCHG	AX,CX
095D A8 80                 1455 	TEST	AL,80H		;Is no operands OK?
095F B1                    1456 	MOV	CL,20
0960 75 1B                 1457 	JNZ	ERRJ4
0962                       1458 NOOPS:
0962                       1459 ;First test for FDIV or FSUB and reverse "R" bit if "D" bit is set
0962 50                    1460 	PUSH	AX
0963 25 05 E0              1461 	AND	AX,0E005H
0966 3D 04 E0              1462 	CMP	AX,0E004H
0969 58                    1463 	POP	AX
096A 75 03                 1464 	JNZ	NOREV
096C 80 F4 D0              1465 	XOR	AH,8		;Reverse "R" bit
096F                       1466 NOREV:
096F 24 D0                 1467 	AND	AL,7
0971 0C D8                 1468 	OR	AL,0D8H		;ESC hook
0973 E8 C7 00              1469 	CALL	PUT
0976 8A C4                 1470 	MOV	AL,AH
0978 E9 C2 00              1471 	JMP	PUT
097B                       1472 
097B                       1473 BADFLAG:
097B B1 20                 1474 	MOV	CL,20H
097D E9 78 F8              1475 ERRJ4:	JMP	ERROR
0980                       1476 
0980                       1477 MEMOP:
0980 51                    1478 	PUSH	CX		;Save opcode
0981 E8 80 F9              1479 	CALL	GETOP1		;Get memory operand
0984 3C FF                 1480 	CMP	AL,UNDEFID	;Is it?
0986 B1                    1481 	MOV	CL,20
0987 75 F4                 1482 	JNZ	ERRJ4
0989 58                    1483 	POP	AX
098A A8 20                 1484 	TEST	AL,20H		;Does it have memory format field?
098C 75 08                 1485 	JNZ	GETFORMAT
098E A8 D0                 1486 	TEST	AL,8		;Check if any memory operand legal
0990 74 EB                 1487 	JZ	ERRJ4
0992 A8 10                 1488 	TEST	AL,10H		;Check for 2-op arithmetic
0994 75 1C                 1489 	JNZ	PUTMEM		;If not, just use as plain memory op
0996                       1490 GETFORMAT:
0996 24 F9                 1491 	AND	AL,0F9H		;Zero memory format bits
0998 8A 0E AB 19           1492 	MOV	CL,[FLAG]
099C FE C9                 1493 	DEC	CL		;Must now be in range 0-3
099E 7C DB                 1494 	JL	BADFLAG
09A0 8A E8                 1495 	MOV	CH,AL		;Save opcode byte
09A2                       1496 	SHR	AL,1		;Put format bits in bits 2 & 3
09A2 24 0C                 1497 	AND	AL,0CH
09A4 0A C1                 1498 	OR	AL,CL		;Combine format bits with flag
09A6 BB C2 09              1499 	MOV	BX,FORMATTAB
09A9 D7                    1500 	XLAT
09AA 0A C0                 1501 	OR	AL,AL		;Valid combination?
09AC 78 CD                 1502 	JS	BADFLAG
09AE 0A E0                 1503 	OR	AH,AL		;Possibly set new bits in second byte
09B0 0A C5                 1504 	OR	AL,CH		;Set memory format bits
09B2                       1505 PUTMEM:
09B2 24 D0                 1506 	AND	AL,7
09B4 0C D8                 1507 	OR	AL,0D8H
09B6 E8 84 00              1508 	CALL	PUT
09B9 8A C4                 1509 	MOV	AL,AH
09BB 24 38                 1510 	AND	AL,38H
09BD 0A C2                 1511 	OR	AL,DL		;Combine addressing mode
09BF E9 2A 01              1512 	JMP	PUTADD
09C2                       1513 
09C2                       1514 FORMATTAB:
09C2                       1515 ;There are 16 entries in this table. The 4-bit index is built like this:
09C2                       1516 ;	Bit 3		0 for normal memory ops, 1 if extended is OK
09C2                       1517 ;	Bit 2		0 for integer, 1 for real
09C2                       1518 ;	Bit 0 & 1	Flag: 00=W, 01=S, 10=L, 11=T
09C2                       1519 ;
09C2                       1520 ;The entries in the table are used as two 3-bit fields. Bits 0-2 are ORed
09C2                       1521 ;into the first byte of the opcode for the Memory Format field. Bits 3-6
09C2                       1522 ;are ORed into the second byte to modify the opcode for extended operands.
09C2                       1523 ;If bit 7 is set, then that combination is illegal.
09C2                       1524 
09C2 D0 D0 80 80           1525 	DB	6,2,80H,80H	;Normal integers
09C6 80 D0 D0 80           1526 	DB	80H,0,4,80H	;Normal reals
09CA D0 D0 2E 80           1527 	DB	6,2,2EH,80H	;Extended integers
09CE 80 D0 D0 2B           1528 	DB	80H,0,4,2BH	;Extended reals
09D2                       1529 
09D2                       1530 GRP1:
09D2 B9 09 8A              1531 	MOV	CX,8A09H
09D5 E8 59 F8              1532 	CALL	MROPS
09D8 B9 C6 00              1533 	MOV	CX,0C6H
09DB 8A C7                 1534 	MOV	AL,BH
09DD 3C FF                 1535 	CMP	AL,UNDEFID
09DF 75 03                 1536 	JNZ	L0006
09E1 E8 3C 00              1537 	CALL	STIMM
09E4                       1538 L0006:	
09E4 24 D0                 1539 	AND	AL,1
09E6 74 0A                 1540 	JZ	BYTIMM
09E8 B0 B8                 1541 	MOV	AL,0B8H
09EA 0A C3                 1542 	OR	AL,BL
09EC E8 4E 00              1543 	CALL	PUT
09EF E9 87 00              1544 	JMP	PUTWOR
09F2                       1545 
09F2                       1546 BYTIMM:
09F2 B0 B0                 1547 	MOV	AL,0B0H
09F4 0A C3                 1548 	OR	AL,BL
09F6 E8 44 00              1549 	CALL	PUT
09F9 E9 85 00              1550 PUTBJ:	JMP	PUTBYT
09FC                       1551 
09FC                       1552 IMMED:
09FC 8A C7                 1553 	MOV	AL,BH
09FE 3C FF                 1554 	CMP	AL,UNDEFID
0A00 74 1E                 1555 	JZ	STIMM
0A02 8A C3                 1556 	MOV	AL,BL
0A04 0A C0                 1557 	OR	AL,AL
0A06 74 F4                 1558 	JZ	IMMED_RET
0A08 8A C7                 1559 	MOV	AL,BH
0A0A E8 1F 00              1560 	CALL	IMM
0A0D 0C C0                 1561 	OR	AL,0C0H
0A0F E8 2B 00              1562 	CALL	PUT
0A12                       1563 FINIMM:
0A12 8A C1                 1564 	MOV	AL,CL
0A14 59                    1565 	POP	CX
0A15 A8 D0                 1566 	TEST	AL,1
0A17 74 E0                 1567 	JZ	PUTBJ
0A19 3C 83                 1568 	CMP	AL,83H
0A1B 74 DC                 1569 	JZ	PUTBJ
0A1D E9 59 00              1570 	JMP	PUTWOR
0A20                       1571 
0A20                       1572 STIMM:
0A20 A0 AB 19              1573 	MOV	AL,[FLAG]
0A23 E8 06 00              1574 	CALL	IMM
0A26 E8 C3 00              1575 	CALL	PUTADD
0A29 E9 E6 FF              1576 	JMP	FINIMM
0A2C                       1577 
0A2C                       1578 IMM:
0A2C 24 D0                 1579 	AND	AL,1
0A2E 0A C1                 1580 	OR	AL,CL
0A30 8A C8                 1581 	MOV	CL,AL
0A32 E8 08 00              1582 	CALL	PUT
0A35 8A C5                 1583 	MOV	AL,CH
0A37 24 38                 1584 	AND	AL,38H
0A39 0A C3                 1585 	OR	AL,BL
0A3B C3                    1586 	RET
0A3C                       1587 IMMED_RET:
0A3C C3                    1588 	RET
0A3D                       1589 
0A3D                       1590 PUT:
0A3D                       1591 ;Save byte in AL as pure code, with intermediate code bits 00. AL and
0A3D                       1592 ;DI destroyed, no other registers affected.
0A3D 53                    1593 	PUSH	BX
0A3E 51                    1594 	PUSH	CX
0A3F B5 D0                 1595 	MOV	CH,0		;Flag as pure code
0A41 E8 03 00              1596 	CALL	GEN
0A44 59                    1597 	POP	CX
0A45 5B                    1598 	POP	BX
0A46 C3                    1599 	RET
0A47                       1600 
0A47                       1601 GEN:
0A47                       1602 ;Save byte of code in AL, given intermediate code bits in bits 7&8 of CH.
0A47 E8 25 00              1603 	CALL	PUTINC		;Save it and bump code pointer
0A4A                       1604 GEN1:
0A4A A0 B5 19              1605 	MOV	AL,[RELOC]
0A4D                       1606 	RCL	CH,1
0A4D                       1607 	RCL	AL,1
0A4D                       1608 	RCL	CH,1
0A4D                       1609 	RCL	AL,1
0A4D A2 B5 19              1610 	MOV	[RELOC],AL
0A50 BB B5 19              1611 	MOV	BX,BCOUNT
0A53                       1612 	DEC	BYTE [BX]
0A53 75 F5                 1613 	JNZ	GEN1_RET
0A55                       1614 	MOV	BYTE [BX],4
0A55 BB B5 19              1615 	MOV	BX,RELOC
0A58 8A 07                 1616 	MOV	AL,[BX]
0A5A                       1617 	MOV	BYTE [BX],0
0A5A 8B 3E BC 19           1618 	MOV	DI,[IY]
0A5E 88 05                 1619 	MOV	[DI],AL
0A60 8B 1E B4 19           1620 	MOV	BX,[CODE]
0A64 89 1E BC 19           1621 	MOV	[IY],BX
0A68 43                    1622 	INC	BX
0A69 89 1E B4 19           1623 	MOV	[CODE],BX
0A6D C3                    1624 	RET
0A6E                       1625 GEN1_RET:
0A6E C3                    1626 	RET
0A6F                       1627 PUTINC:
0A6F                       1628 	INC	WORD[PC]
0A6F                       1629 PUTCD:
0A6F 8B 3E B4 19           1630 	MOV	DI,[CODE]
0A73 AA                    1631 	STOSB
0A74 89 3E B4 19           1632 	MOV	[CODE],DI
0A78 C3                    1633 	RET
0A79                       1634 
0A79                       1635 PUTWOR:
0A79                       1636 ;Save the word value described by [DLABEL] and [DATA] as code. If defined,
0A79                       1637 ;two bytes of pure code will be produced. Otherwise, appropriate intermediate
0A79                       1638 ;code will be generated.
0A79 51                    1639 	PUSH	CX
0A7A B5 80                 1640 	MOV	CH,80H
0A7C 52                    1641 	PUSH	DX
0A7D 53                    1642 	PUSH	BX
0A7E E9 1F 00              1643 	JMP	PUTBW
0A81                       1644 
0A81                       1645 PUTBYT:
0A81                       1646 ;Same as PUTWOR, above, but for byte value.
0A81 51                    1647 	PUSH	CX
0A82 B5 40                 1648 	MOV	CH,40H
0A84 52                    1649 	PUSH	DX
0A85 53                    1650 	PUSH	BX
0A86 8B 1E B0 19           1651 	MOV	BX,[DLABEL]
0A8A 8A C7                 1652 	MOV	AL,BH
0A8C 0A C3                 1653 	OR	AL,BL
0A8E 75 10                 1654 	JNZ	PUTBW
0A90 8B 1E AE 19           1655 	MOV	BX,[DATA]
0A94 0A C7                 1656 	OR	AL,BH
0A96 74 08                 1657 	JZ	PUTBW
0A98 FE C7                 1658 	INC	BH
0A9A 74 04                 1659 	JZ	PUTBW
0A9C B1                    1660 	MOV	CL,31
0A9D E9 58 F7              1661 	JMP	ERROR
0AA0                       1662 PUTBW:
0AA0 8B 16 B0 19           1663 	MOV	DX,[DLABEL]
0AA4 8B 1E AE 19           1664 	MOV	BX,[DATA]
0AA8                       1665 PUTCHK:
0AA8 0B D2                 1666 	OR	DX,DX
0AAA 74 26                 1667 	JZ	NOUNDEF
0AAC 8A C2                 1668 	MOV	AL,DL
0AAE E8 BE FF              1669 	CALL	PUTCD
0AB1 8A C6                 1670 	MOV	AL,DH
0AB3 E8 B9 FF              1671 	CALL	PUTCD
0AB6 8A C3                 1672 	MOV	AL,BL
0AB8 E8 B4 FF              1673 	CALL	PUTINC
0ABB 8A C7                 1674 	MOV	AL,BH
0ABD F6 C5 80              1675 	TEST	CH,080H
0AC0 74 06                 1676 	JZ	SMPUT
0AC2 E8 82 FF              1677 	CALL	GEN
0AC5 E9 06 00              1678 	JMP	PRET
0AC8                       1679 SMPUT:
0AC8 E8 A4 FF              1680 	CALL	PUTCD
0ACB E8 7C FF              1681 	CALL	GEN1
0ACE                       1682 PRET:
0ACE 5B                    1683 	POP	BX
0ACF 5A                    1684 	POP	DX
0AD0 59                    1685 	POP	CX
0AD1 C3                    1686 	RET
0AD2                       1687 
0AD2                       1688 NOUNDEF:
0AD2 8A C3                 1689 	MOV	AL,BL
0AD4 8A CF                 1690 	MOV	CL,BH
0AD6 51                    1691 	PUSH	CX
0AD7 B5 D0                 1692 	MOV	CH,0
0AD9 E8 6B FF              1693 	CALL	GEN
0ADC 59                    1694 	POP	CX
0ADD 8A C1                 1695 	MOV	AL,CL
0ADF F6 C5 80              1696 	TEST	CH,080H
0AE2 B5 D0                 1697 	MOV	CH,0
0AE4 74 E8                 1698 	JZ	PRET
0AE6 E8 5E FF              1699 	CALL	GEN
0AE9 E9 E2 FF              1700 	JMP	PRET
0AEC                       1701 
0AEC                       1702 PUTADD:
0AEC                       1703 ;Save complete addressing mode. Addressing mode is in AL; if this is a register
0AEC                       1704 ;operation (>=C0), then the one byte will be saved as pure code. Otherwise,
0AEC                       1705 ;the details of the addressing mode will be investigated and the optional one-
0AEC                       1706 ;or two-byte displacement will be added, as described by [ADDR] and [ALABEL].
0AEC 51                    1707 	PUSH	CX
0AED 52                    1708 	PUSH	DX
0AEE 53                    1709 	PUSH	BX
0AEF B5 D0                 1710 	MOV	CH,0
0AF1 8A C8                 1711 	MOV	CL,AL
0AF3 E8 51 FF              1712 	CALL	GEN		;Save the addressing mode as pure code
0AF6 8A C1                 1713 	MOV	AL,CL
0AF8 B5 80                 1714 	MOV	CH,80H
0AFA 24 C7                 1715 	AND	AL,0C7H
0AFC 3C D0                 1716 	CMP	AL,6
0AFE 74 0A                 1717 	JZ	TWOBT		;Direct address?
0B00 24 C0                 1718 	AND	AL,0C0H
0B02 74 CA                 1719 	JZ	PRET		;Indirect through reg, no displacement?
0B04 3C C0                 1720 	CMP	AL,0C0H
0B06 74 C6                 1721 	JZ	PRET		;Register to register operation?
0B08 8A E8                 1722 	MOV	CH,AL		;Save whether one- or two-byte displacement
0B0A                       1723 TWOBT:
0B0A 8B 1E AC 19           1724 	MOV	BX,[ADDR]
0B0E 8B 16 AE 19           1725 	MOV	DX,[ALABEL]
0B12 E9 93 FF              1726 	JMP	PUTCHK
0B15                       1727 
0B15                       1728 GRP2:
0B15 E8 E9 F7              1729 	CALL	GETOP
0B18 B9 30 FF              1730 	MOV	CX,0FF30H
0B1B 3C FF                 1731 	CMP	AL,UNDEFID
0B1D 74 13                 1732 	JZ	PMEM
0B1F B5 50                 1733 	MOV	CH,50H
0B21 3C D1                 1734 	CMP	AL,XREG
0B23 74 19                 1735 	JZ	PXREG
0B25 B5 D0                 1736 	MOV	CH,6
0B27 3C FF                 1737 	CMP	AL,SREG
0B29 75 CE                 1738 	JNZ	$+5
0B2B E9 97 03              1739 	JMP	PACKREG
0B2E B1                    1740 	MOV	CL,20
0B2F E9 C6 F6              1741 	JMP	ERROR
0B32                       1742 
0B32                       1743 PMEM:
0B32 8A C5                 1744 	MOV	AL,CH
0B34 E8 06 FF              1745 	CALL	PUT
0B37 8A C1                 1746 	MOV	AL,CL
0B39 0A C2                 1747 	OR	AL,DL
0B3B E9 AE FF              1748 	JMP	PUTADD
0B3E                       1749 
0B3E                       1750 PXREG:
0B3E 8A C5                 1751 	MOV	AL,CH
0B40 0A C2                 1752 	OR	AL,DL
0B42 E9 F8 FE              1753 	JMP	PUT
0B45                       1754 
0B45                       1755 GRP3:
0B45 E8 B9 F7              1756 	CALL	GETOP
0B48 52                    1757 	PUSH	DX
0B49 E8 AD F7              1758 	CALL	GETOP2
0B4C 5B                    1759 	POP	BX
0B4D B9 14 86              1760 	MOV	CX,8614H
0B50 B0 FF                 1761 	MOV	AL,SREG
0B52 3A C7                 1762 	CMP	AL,BH
0B54 74 4B                 1763 	JZ	ERR6
0B56 3A C6                 1764 	CMP	AL,DH
0B58 74 47                 1765 	JZ	ERR6
0B5A B0 D7                 1766 	MOV	AL,CONST
0B5C 3A C7                 1767 	CMP	AL,BH
0B5E 74 41                 1768 	JZ	ERR6
0B60 3A C6                 1769 	CMP	AL,DH
0B62 74 3D                 1770 	JZ	ERR6
0B64 B0 FF                 1771 	MOV	AL,UNDEFID
0B66 3A C7                 1772 	CMP	AL,BH
0B68 74 2C                 1773 	JZ	EXMEM
0B6A 3A C6                 1774 	CMP	AL,DH
0B6C 74 2A                 1775 	JZ	EXMEM1
0B6E 8A C7                 1776 	MOV	AL,BH
0B70 3A C6                 1777 	CMP	AL,DH
0B72 B1                    1778 	MOV	CL,22
0B73 75 2C                 1779 	JNZ	ERR6
0B75 3C D1                 1780 	CMP	AL,XREG
0B77 74 03                 1781 	JZ	L0008
0B79 E8 E6 F6              1782 	CALL	RR1
0B7C                       1783 L0008:			;RR1 never returns
0B7C 8A C3                 1784 	MOV	AL,BL
0B7E 0A C0                 1785 	OR	AL,AL
0B80 74 0D                 1786 	JZ	EXACC
0B82 87 DA                 1787 	XCHG	DX,BX
0B84 8A C3                 1788 	MOV	AL,BL
0B86 0A C0                 1789 	OR	AL,AL
0B88 8A C7                 1790 	MOV	AL,BH
0B8A 74 03                 1791 	JZ	EXACC
0B8C E8 D3 F6              1792 	CALL	RR1
0B8F                       1793 EXACC:
0B8F B0 90                 1794 	MOV	AL,90H
0B91 0A C2                 1795 	OR	AL,DL
0B93 E9 A7 FE              1796 	JMP	PUT
0B96                       1797 
0B96                       1798 EXMEM:
0B96 87 DA                 1799 	XCHG	DX,BX
0B98                       1800 EXMEM1:
0B98 3A C7                 1801 	CMP	AL,BH
0B9A 74 05                 1802 	JZ	ERR6
0B9C B1 D0                 1803 	MOV	CL,1	;Flag word as OK
0B9E E8 39 F7              1804 	CALL	NOTAC	;NOTAC never returns
0BA1 E9 54 F6              1805 ERR6:	JMP	ERROR
0BA4                       1806 
0BA4                       1807 GRP4:
0BA4 50                    1808 	PUSH	AX
0BA5 E8 59 F7              1809 	CALL	GETOP
0BA8 59                    1810 	POP	CX
0BA9 86 CD                 1811 	XCHG	CL,CH
0BAB 3C D7                 1812 	CMP	AL,CONST
0BAD 74 12                 1813 	JZ	FIXED
0BAF 2C D1                 1814 	SUB	AL,XREG
0BB1 FE CA                 1815 	DEC	DL
0BB3 FE CA                 1816 	DEC	DL
0BB5 0A C2                 1817 	OR	AL,DL
0BB7 B1                    1818 	MOV	CL,20
0BB8 75 E7                 1819 	JNZ	ERR6
0BBA 8A C5                 1820 	MOV	AL,CH
0BBC 0C D0                 1821 	OR	AL,8
0BBE E9 7C FE              1822 	JMP	PUT
0BC1                       1823 FIXED:
0BC1 8A C5                 1824 	MOV	AL,CH
0BC3 E8 77 FE              1825 	CALL	PUT
0BC6 E9 B8 FE              1826 	JMP	PUTBYT
0BC9                       1827 
0BC9                       1828 GRP5:
0BC9 50                    1829 	PUSH	AX
0BCA E8 34 F7              1830 	CALL	GETOP
0BCD B1                    1831 	MOV	CL,20
0BCE 3C D7                 1832 	CMP	AL,CONST
0BD0 75 CF                 1833 	JNZ	ERR6
0BD2 8B 1E B0 19           1834 	MOV	BX,[DLABEL]
0BD6 8A C7                 1835 	MOV	AL,BH
0BD8 0A C3                 1836 	OR	AL,BL
0BDA                       1837 	MOV	CL,30
0BDA 75 C5                 1838 	JNZ	ERR6
0BDC 8B 1E AE 19           1839 	MOV	BX,[DATA]
0BE0 58                    1840 	POP	AX
0BE1 0A C0                 1841 	OR	AL,AL
0BE3 74                    1842 	JZ	_ORG
0BE4 FE C8                 1843 	DEC	AL
0BE6 74 15                 1844 	JZ	DSJ
0BE8 FE C8                 1845 	DEC	AL
0BEA 74 22                 1846 	JZ	EQU
0BEC FE C8                 1847 	DEC	AL
0BEE 74                    1848 	JZ	$+5
0BEF E9 34 03              1849 	JMP	IF
0BF2                       1850 PUTOP:
0BF2 B0 23                 1851 	MOV	AL,-3
0BF4 E9 2E 00              1852 	JMP	NEWLOC
0BF7                       1853 _ALIGN:
0BF7 A0 A9 19              1854 	MOV	AL,[PC]
0BFA 24 DA                 1855 	AND	AL,1
0BFC 74                    1856 	JZ	_ALIGN_RET
0BFD                       1857 	MOV	BX,1
0BFD                       1858 DSJ:
0BFD 87 DA                 1859 	XCHG	DX,BX
0BFF 8B 1E A9 19           1860 	MOV	BX,[PC]
0C03 03 DA                 1861 	ADD	BX,DX
0C05 89 1E A9 19           1862 	MOV	[PC],BX
0C09 87 DA                 1863 	XCHG	DX,BX
0C0B                       1864 	MOV	AL,-4
0C0B E9 17 00              1865 	JMP	NEWLOC
0C0E                       1866 EQU:
0C0E 87 DA                 1867 	XCHG	DX,BX
0C10 8B 1E AB 19           1868 	MOV	BX,[LABPT]
0C14 8A C7                 1869 	MOV	AL,BH
0C16 0A C3                 1870 	OR	AL,BL
0C18                       1871 	MOV	CL,34
0C18 74 22                 1872 	JZ	ERR7
0C1A 88 17                 1873 	MOV	[BX],DL
0C1C 43                    1874 	INC	BX
0C1D 88 37                 1875 	MOV	[BX],DH
0C1F C3                    1876 	RET
0C20                       1877 _ALIGN_RET:
0C20 C3                    1878 	RET
0C21                       1879 _ORG:
0C21 89 1E A9 19           1880 	MOV	[PC],BX
0C25                       1881 	MOV	AL,-2
0C25                       1882 NEWLOC:
0C25 E8 47 FE              1883 	CALL	PUTCD
0C28 8A C3                 1884 	MOV	AL,BL
0C2A E8 42 FE              1885 	CALL	PUTCD
0C2D 8A C7                 1886 	MOV	AL,BH
0C2F E8 3D FE              1887 	CALL	PUTCD
0C32 B5 C0                 1888 	MOV	CH,0C0H
0C34 E9 13 FE              1889 	JMP	GEN1
0C37                       1890 GRP6:
0C37 8A E8                 1891 	MOV	CH,AL
0C39                       1892 	MOV	CL,4
0C39 E8 F5 F5              1893 	CALL	MROPS
0C3C                       1894 	MOV	CL,23
0C3C E9 B9 F5              1895 ERR7:	JMP	ERROR
0C3F                       1896 GRP7:
0C3F 8A E8                 1897 	MOV	CH,AL
0C41                       1898 	MOV	CL,1
0C41 E8 ED F5              1899 	CALL	MROPS
0C44 B1 80                 1900 	MOV	CL,80H
0C46 8B 16 B0 19           1901 	MOV	DX,[DLABEL]
0C4A 8A C6                 1902 	MOV	AL,DH
0C4C 0A C2                 1903 	OR	AL,DL
0C4E 75 12                 1904 	JNZ	ACCJ
0C50 87 DA                 1905 	XCHG	DX,BX
0C52 8B 1E AE 19           1906 	MOV	BX,[DATA]
0C56 8A C3                 1907 	MOV	AL,BL
0C58 98                    1908 	CBW
0C59 3B C3                 1909 	CMP	AX,BX
0C5B 87 DA                 1910 	XCHG	DX,BX
0C5D 75 03                 1911 	JNZ	ACCJ
0C5F 80 C9 02              1912 	OR	CL,002H
0C62 E9 A9 00              1913 ACCJ:	JMP	ACCIMM
0C65                       1914 GRP8:
0C65 8A C8                 1915 	MOV	CL,AL
0C67 B5 FE                 1916 	MOV	CH,0FEH
0C69 E9 04 00              1917 	JMP	ONEOP
0C6C                       1918 GRP9:
0C6C 8A C8                 1919 	MOV	CL,AL
0C6E B5 F6                 1920 	MOV	CH,0F6H
0C70                       1921 ONEOP:
0C70 51                    1922 	PUSH	CX
0C71 E8 8D F6              1923 	CALL	GETOP
0C74                       1924 ONE:
0C74                       1925 	MOV	CL,26
0C74 3C D7                 1926 	CMP	AL,CONST
0C76 74 C4                 1927 	JZ	ERR7
0C78 3C FF                 1928 	CMP	AL,SREG
0C7A                       1929 	MOV	CL,22
0C7A 74 C0                 1930 	JZ	ERR7
0C7C 59                    1931 	POP	CX
0C7D 3C FF                 1932 	CMP	AL,UNDEFID
0C7F 74 10                 1933 	JZ	MOP
0C81                       1934 	AND	AL,1
0C81 74 1F                 1935 	JZ	ROP
0C83 F6 C1 01              1936 	TEST	CL,001H
0C86 74 1A                 1937 	JZ	ROP
0C88 8A C1                 1938 	MOV	AL,CL
0C8A 24 F8                 1939 	AND	AL,0F8H
0C8C 0A C2                 1940 	OR	AL,DL
0C8E E9 AC FD              1941 	JMP	PUT
0C91                       1942 MOP:
0C91 A0 AB 19              1943 	MOV	AL,[FLAG]
0C94                       1944 	AND	AL,1
0C94 0A C5                 1945 	OR	AL,CH
0C96 E8 A4 FD              1946 	CALL	PUT
0C99 8A C1                 1947 	MOV	AL,CL
0C9B 24 38                 1948 	AND	AL,38H
0C9D 0A C2                 1949 	OR	AL,DL
0C9F E9 4A FE              1950 	JMP	PUTADD
0CA2                       1951 ROP:
0CA2 0A C5                 1952 	OR	AL,CH
0CA4 E8 96 FD              1953 	CALL	PUT
0CA7 8A C1                 1954 	MOV	AL,CL
0CA9 24 38                 1955 	AND	AL,38H
0CAB 0C C0                 1956 	OR	AL,0C0H
0CAD 0A C2                 1957 	OR	AL,DL
0CAF E9 8B FD              1958 	JMP	PUT
0CB2                       1959 GRP10:
0CB2 8A C8                 1960 	MOV	CL,AL
0CB4 B5 F6                 1961 	MOV	CH,0F6H
0CB6 51                    1962 	PUSH	CX
0CB7 E8 47 F6              1963 	CALL	GETOP
0CBA                       1964 	MOV	CL,20
0CBA 8A C2                 1965 	MOV	AL,DL
0CBC 0A C0                 1966 	OR	AL,AL
0CBE 75 08                 1967 	JNZ	ERRJ1
0CC0 8A C6                 1968 	MOV	AL,DH
0CC2 3C D1                 1969 	CMP	AL,XREG
0CC4 74 04                 1970 	JZ	G10
0CC6 3C E0                 1971 	CMP	AL,REG
0CC8 75 61                 1972 ERRJ1:	JNZ	ERR8
0CCA                       1973 G10:
0CCA 50                    1974 	PUSH	AX
0CCB E8 33 F6              1975 	CALL	GETOP
0CCE 58                    1976 	POP	AX
0CCF                       1977 	AND	AL,1
0CCF A2 AB 19              1978 	MOV	[FLAG],AL
0CD2 8A C6                 1979 	MOV	AL,DH
0CD4 E9 9D FF              1980 ONEJ:	JMP	ONE
0CD7                       1981 GRP11:
0CD7 E8 63 FD              1982 	CALL	PUT
0CDA B0 0A                 1983 	MOV	AL,0AH
0CDC E9 5E FD              1984 	JMP	PUT
0CDF                       1985 GRP12:
0CDF 8A C8                 1986 	MOV	CL,AL
0CE1 B5 D0                 1987 	MOV	CH,0D0H
0CE3 51                    1988 	PUSH	CX
0CE4 E8 1A F6              1989 	CALL	GETOP
0CE7 A0 B0 19              1990 	MOV	AL,[SYM]
0CEA 3C 2C                 1991 	CMP	AL,','
0CEC 8A C6                 1992 	MOV	AL,DH
0CEE 75 E4                 1993 	JNZ	ONEJ
0CF0 52                    1994 	PUSH	DX
0CF1 E8 0D F6              1995 	CALL	GETOP
0CF4 2C E0                 1996 	SUB	AL,REG
0CF6                       1997 	MOV	CL,20
0CF6 FE CA                 1998 	DEC	DL
0CF8 0A C2                 1999 	OR	AL,DL
0CFA 75 2F                 2000 	JNZ	ERR8
0CFC 5A                    2001 	POP	DX
0CFD 8A C6                 2002 	MOV	AL,DH
0CFF 59                    2003 	POP	CX
0D00 80 CD 02              2004 	OR	CH,002H
0D03 51                    2005 	PUSH	CX
0D04 E9 6D FF              2006 	JMP	ONE
0D07                       2007 GRP13:
0D07 8A E8                 2008 	MOV	CH,AL
0D09                       2009 	MOV	CL,1
0D09 E8 25 F5              2010 	CALL	MROPS
0D0C B1 80                 2011 	MOV	CL,80H
0D0E                       2012 ACCIMM:
0D0E E8 EB FC              2013 	CALL	IMMED
0D11 80 CD 04              2014 	OR	CH,004H
0D14 80 E5 FD              2015 	AND	CH,0FDH
0D17                       2016 AIMM:
0D17 8A C7                 2017 	MOV	AL,BH
0D19 24 F0                 2018 	AND	AL,1
0D1B 9F                    2019 	LAHF
0D1C 50                    2020 	PUSH	AX
0D1D 0A C5                 2021 	OR	AL,CH
0D1F E8 1B FD              2022 	CALL	PUT
0D22 58                    2023 	POP	AX
0D23 9E                    2024 	SAHF
0D24 75                    2025 	JNZ	$+5
0D25 E9 59 FD              2026 	JMP	PUTBYT
0D28 E9 4E FD              2027 	JMP	PUTWOR
0D2B                       2028 
0D2B E9 CA F4              2029 ERR8:	JMP	ERROR
0D2E                       2030 
0D2E                       2031 GRP14:
0D2E                       2032 ;JMP and CALL mnemonics
0D2E 9F                    2033 	LAHF
0D2F 86 E0                 2034 	XCHG	AH,AL
0D31 50                    2035 	PUSH	AX
0D32 86 E0                 2036 	XCHG	AH,AL
0D34                       2037 	MOV	BYTE [MAXFLG],3	;Allow "L" flag
0D34 E8 CA F5              2038 	CALL	GETOP
0D37 3C D7                 2039 	CMP	AL,CONST
0D39 74 2B                 2040 	JZ	DIRECT
0D3B                       2041 	MOV	CL,20
0D3B 3C E0                 2042 	CMP	AL,REG
0D3D 74 EC                 2043 	JZ	ERR8
0D3F 3C FF                 2044 	CMP	AL,SREG
0D41 74 E8                 2045 	JZ	ERR8
0D43 3C D1                 2046 	CMP	AL,XREG
0D45 75 03                 2047 	JNZ	NOTRG
0D47 80 CA C0              2048 	OR	DL,0C0H
0D4A                       2049 NOTRG:
0D4A                       2050 ;Indirect jump. DL has addressing mode.
0D4A B0 FF                 2051 	MOV	AL,0FFH
0D4C E8 EE FC              2052 	CALL	PUT
0D4F 58                    2053 	POP	AX
0D50 86 E0                 2054 	XCHG	AH,AL
0D52 9E                    2055 	SAHF
0D53 24 38                 2056 	AND	AL,38H
0D55 0A C2                 2057 	OR	AL,DL
0D57 8A 2E AB 19           2058 	MOV	CH,[FLAG]
0D5B                       2059 	CMP	CH,3		;Flag "L" present?
0D5B 74 06                 2060 	JZ	PUTADDJ		;If so, do inter-segment
0D5D B1 27                 2061 	MOV	CL,27H
0D5F                       2062 	CMP	CH,-1		;Better not be a flag
0D5F 75 CA                 2063 	JNZ	ERR8
0D61 24 F7                 2064 	AND	AL,0F7H		;Convert to intra-segment
0D63                       2065 PUTADDJ:
0D63 E9 86 FD              2066 	JMP	PUTADD
0D66                       2067 DIRECT:
0D66 A0 B0 19              2068 	MOV	AL,[SYM]
0D69 3C 2C                 2069 	CMP	AL,','
0D6B 74 1C                 2070 	JZ	LONGJ
0D6D 58                    2071 	POP	AX
0D6E 86 E0                 2072 	XCHG	AH,AL
0D70 9E                    2073 	SAHF
0D71 FE C8                 2074 	DEC	AL
0D73 3C E9                 2075 	CMP	AL,0E9H
0D75 74 02                 2076 	JZ	GOTOP
0D77 B0 E8                 2077 	MOV	AL,0E8H
0D79                       2078 GOTOP:
0D79 E8 C1 FC              2079 	CALL	PUT
0D7C 8B 16 A9 19           2080 	MOV	DX,[PC]
0D80 42                    2081 	INC	DX
0D81 42                    2082 	INC	DX
0D82 29 16 AE 19           2083 	SUB	[DATA],DX
0D86 E9 F0 FC              2084 	JMP	PUTWOR
0D89                       2085 LONGJ:
0D89 58                    2086 	POP	AX
0D8A 86 E0                 2087 	XCHG	AH,AL
0D8C 9E                    2088 	SAHF
0D8D E8 AD FC              2089 	CALL	PUT
0D90 E8 E6 FC              2090 	CALL	PUTWOR
0D93 E8 6B F5              2091 	CALL	GETOP
0D96                       2092 	MOV	CL,20
0D96 3C D7                 2093 	CMP	AL,CONST
0D98 75 91                 2094 	JNZ	ERR8
0D9A E9 DC FC              2095 	JMP	PUTWOR
0D9D                       2096 
0D9D                       2097 GRP16:
0D9D                       2098 ;RET mnemonic
0D9D 9F                    2099 	LAHF
0D9E 86 E0                 2100 	XCHG	AH,AL
0DA0 50                    2101 	PUSH	AX
0DA1 86 E0                 2102 	XCHG	AH,AL
0DA3 E8 5E F7              2103 	CALL	GETSYM
0DA6                       2104 	CMP	AL,5
0DA6 74 1A                 2105 	JZ	LONGR
0DA8 3C 00                 2106 	CMP	AL,EOL
0DAA 74 3B                 2107 	JZ	NODEC
0DAC 3C 3B                 2108 	CMP	AL,';'
0DAE 74 37                 2109 	JZ	NODEC
0DB0                       2110 GETSP:
0DB0 E8 51 F5              2111 	CALL	GETOP1
0DB3 59                    2112 	POP	CX
0DB4 3C D7                 2113 	CMP	AL,CONST
0DB6                       2114 	MOV	CL,20
0DB6 75 5E                 2115 	JNZ	ERR9
0DB8 8A C5                 2116 	MOV	AL,CH
0DBA 24 FE                 2117 	AND	AL,0FEH
0DBC E8 7E FC              2118 	CALL	PUT
0DBF E9 B7 FC              2119 	JMP	PUTWOR
0DC2                       2120 LONGR:
0DC2                       2121 	CMP	DL,3		;Is flag "L"?
0DC2 B1 27                 2122 	MOV	CL,27H
0DC4 75 7A                 2123 	JNZ	ERR10		;If not, bad flag
0DC6 58                    2124 	POP	AX
0DC7 86 E0                 2125 	XCHG	AH,AL
0DC9 9E                    2126 	SAHF
0DCA 0C F0                 2127 	OR	AL,8
0DCC 9F                    2128 	LAHF
0DCD 86 E0                 2129 	XCHG	AH,AL
0DCF 50                    2130 	PUSH	AX
0DD0 86 E0                 2131 	XCHG	AH,AL
0DD2                       2132 NOTLON:
0DD2 E8 2F F7              2133 	CALL	GETSYM
0DD5 3C 00                 2134 	CMP	AL,EOL
0DD7 74 2C                 2135 	JZ	DORET
0DD9 3C 3B                 2136 	CMP	AL,';'
0DDB 74 28                 2137 	JZ	DORET
0DDD 3C 2C                 2138 	CMP	AL,','
0DDF 75 03                 2139 	JNZ	L0011
0DE1 E8 20 F7              2140 	CALL	GETSYM
0DE4                       2141 L0011:	
0DE4 E9 C9 FF              2142 	JMP	GETSP
0DE7                       2143 NODEC:
0DE7                       2144 ;Return is intra-segment (short) without add to SP. 
0DE7                       2145 ;Record position for RET symbol.
0DE7 8B 1E A9 19           2146 	MOV	BX,[PC]
0DEB 89 1E BB 19           2147 	MOV	[LSTRET],BX
0DEF 87 DA                 2148 	XCHG	DX,BX
0DF1 8B 1E BB 19           2149 	MOV	BX,[RETPT]
0DF5 8A C7                 2150 	MOV	AL,BH
0DF7 0A C3                 2151 	OR	AL,BL
0DF9 74 0A                 2152 	JZ	DORET
0DFB                       2153 	MOV	BYTE [BX],1
0DFB 43                    2154 	INC	BX
0DFC 89 17                 2155 	MOV	[BX],DX
0DFE BB 08 00              2156 	MOV	BX,0
0E01 89 1E BB 19           2157 	MOV	[RETPT],BX
0E05                       2158 DORET:
0E05 58                    2159 	POP	AX
0E06 86 E0                 2160 	XCHG	AH,AL
0E08 9E                    2161 	SAHF
0E09 E9 31 FC              2162 	JMP	PUT
0E0C                       2163 
0E0C                       2164 GRP17:
0E0C E8 2E FC              2165 	CALL	PUT
0E0F E8 EF F4              2166 	CALL	GETOP
0E12 3C D7                 2167 	CMP	AL,CONST
0E14 B1 08                 2168 	MOV	CL,20
0E16 75 28                 2169 ERR9:	JNZ	ERR10
0E18 8B 1E AE 19           2170 	MOV	BX,[DATA]
0E1C 8B 16 A9 19           2171 	MOV	DX,[PC]
0E20 42                    2172 	INC	DX
0E21 2B DA                 2173 	SUB	BX,DX
0E23 89 1E AE 19           2174 	MOV	[DATA],BX
0E27 E8 57 FC              2175 	CALL	PUTBYT
0E2A 8B 1E B0 19           2176 	MOV	BX,[DLABEL]
0E2E 8A C7                 2177 	MOV	AL,BH
0E30 0A C3                 2178 	OR	AL,BL
0E32 75 10                 2179 	JNZ	ERRX_RET
0E34 8B 1E AE 19           2180 	MOV	BX,[DATA]
0E38 8A C3                 2181 	MOV	AL,BL
0E3A 98                    2182 	CBW
0E3B 3B C3                 2183 	CMP	AX,BX		;Signed 8-bit number?
0E3D 74 05                 2184 	JZ	ERRX_RET
0E3F B1                    2185 	MOV	CL,31
0E40                       2186 ERR10:	
0E40 E9 B5 F3              2187 	JMP	ERROR
0E43 C3                    2188 	RET
0E44                       2189 ERRX_RET:
0E44 C3                    2190 	RET
0E45                       2191 GRP18:
0E45 E8 B9 F4              2192 	CALL	GETOP
0E48 3C D7                 2193 	CMP	AL,CONST
0E4A                       2194 	MOV	CL,20
0E4A 75 F4                 2195 	JNZ	ERR10
0E4C 8B 1E B0 19           2196 	MOV	BX,[DLABEL]
0E50 8A C7                 2197 	MOV	AL,BH
0E52 0A C3                 2198 	OR	AL,BL
0E54 75 0D                 2199 	JNZ	GENINT
0E56 8B 1E AE 19           2200 	MOV	BX,[DATA]
0E5A                       2201 	MOV	DX,3
0E5A 1B DA                 2202 	SBB	BX,DX
0E5C 75 05                 2203 	JNZ	GENINT
0E5E B0 CC                 2204 	MOV	AL,0CCH
0E60 E9 DA FB              2205 	JMP	PUT
0E63                       2206 GENINT:
0E63 B0 CD                 2207 	MOV	AL,0CDH
0E65 E8 D5 FB              2208 	CALL	PUT
0E68 E9 16 FC              2209 	JMP	PUTBYT
0E6B                       2210 
0E6B                       2211 GRP19:	;ESC opcode
0E6B E8 93 F4              2212 	CALL	GETOP
0E6E                       2213 	MOV	CL,20
0E6E 3C D7                 2214 	CMP	AL,CONST
0E70 75 1F                 2215 	JNZ	ERRJ		;First operand must be immediate
0E72 B1 1E                 2216 	MOV	CL,1EH
0E74                       2217 	TEST	WORD[DLABEL],-1	;See if all labels have been defined
0E74 75 1B                 2218 	JNZ	ERRJ
0E76 A1 AE 19              2219 	MOV	AX,[DATA]
0E79                       2220 	CMP	AX,64		;Must only be 6 bits
0E79 B1 1F                 2221 	MOV	CL,1FH
0E7B 73 14                 2222 	JNB	ERRJ
0E7D 8A D8                 2223 	MOV	BL,AL		;Save for second byte
0E7F                       2224 	SHR	AL,1
0E7F                       2225 	SHR	AL,1
0E7F                       2226 	SHR	AL,1
0E7F 0C D8                 2227 	OR	AL,0D8H		;ESC opcode
0E81 E8 B9 FB              2228 	CALL	PUT
0E84 53                    2229 	PUSH	BX
0E85 E8 71 F4              2230 	CALL	GETOP2
0E88 5B                    2231 	POP	BX
0E89                       2232 	AND	BL,7		;Low 3 bits of first operand
0E89                       2233 	SHL	BL,1
0E89                       2234 	SHL	BL,1
0E89                       2235 	SHL	BL,1
0E89 3C FF                 2236 	CMP	AL,UNDEFID	;Check for memory operand
0E8B 74 07                 2237 	JZ	ESCMEM
0E8D 3C D7                 2238 	CMP	AL,CONST	;Check for another immediate
0E8F 74 0A                 2239 	JZ	ESCIMM
0E91                       2240 	MOV	CL,20
0E91 E9 64 F3              2241 ERRJ:	JMP	ERROR
0E94                       2242 
0E94                       2243 ESCMEM:
0E94 0A DA                 2244 	OR	BL,DL		;Combine mode with first operand
0E96 8A C3                 2245 	MOV	AL,BL
0E98 E9 51 FC              2246 	JMP	PUTADD
0E9B                       2247 
0E9B                       2248 ESCIMM:
0E9B B1 1E                 2249 	MOV	CL,1EH
0E9D                       2250 	TEST	WORD[DLABEL],-1	;See if second operand is fully defined
0E9D 75 F2                 2251 	JNZ	ERRJ
0E9F A1 AE 19              2252 	MOV	AX,[DATA]
0EA2 B1 1F                 2253 	MOV	CL,1FH
0EA4                       2254 	CMP	AX,8		;Must only be 3 bit value
0EA4 73 EB                 2255 	JNB	ERRJ
0EA6 0A C3                 2256 	OR	AL,BL		;Combine first and second operands
0EA8 0C C0                 2257 	OR	AL,0C0H		;Force "register" mode
0EAA E9 90 FB              2258 	JMP	PUT
0EAD                       2259 
0EAD                       2260 GRP20:
0EAD 8A E8                 2261 	MOV	CH,AL
0EAF                       2262 	MOV	CL,1
0EAF E8 7F F3              2263 	CALL	MROPS
0EB2 B1 F6                 2264 	MOV	CL,0F6H
0EB4 E8 45 FB              2265 	CALL	IMMED
0EB7 B5 A8                 2266 	MOV	CH,0A8H
0EB9 E9 5B FE              2267 	JMP	AIMM
0EBC                       2268 GRP21:
0EBC E8 42 F4              2269 	CALL	GETOP
0EBF 3C FF                 2270 	CMP	AL,SREG
0EC1                       2271 	MOV	CL,28
0EC1 75 CE                 2272 	JNZ	ERRJ
0EC3 B5 26                 2273 	MOV	CH,26H
0EC5                       2274 PACKREG:
0EC5 8A C2                 2275 	MOV	AL,DL
0EC7 02 C0                 2276 	ADD	AL,AL
0EC9 02 C0                 2277 	ADD	AL,AL
0ECB 02 C0                 2278 	ADD	AL,AL
0ECD 0A C5                 2279 	OR	AL,CH
0ECF E9 6B FB              2280 	JMP	PUT
0ED2                       2281 GRP22:
0ED2 E8 2C F4              2282 	CALL	GETOP
0ED5 B9 00 8F              2283 	MOV	CX,8F00H
0ED8 3C FF                 2284 	CMP	AL,UNDEFID
0EDA 75                    2285 	JNZ	$+5
0EDB E9 54 FC              2286 	JMP	PMEM
0EDE B5 58                 2287 	MOV	CH,58H
0EE0 3C D1                 2288 	CMP	AL,XREG
0EE2 75                    2289 	JNZ	$+5
0EE3 E9 58 FC              2290 	JMP	PXREG
0EE6 B5 F0                 2291 	MOV	CH,7
0EE8 3C FF                 2292 	CMP	AL,SREG
0EEA 74 D9                 2293 	JZ	PACKREG
0EEC B1                    2294 	MOV	CL,20
0EED E9 08 F3              2295 ERR11:	JMP	ERROR
0EF0                       2296 GRP23:
0EF0 A2 B4 19              2297 	MOV	[DATSIZ],AL
0EF3                       2298 GETDAT:
0EF3 E8 0E F6              2299 	CALL	GETSYM
0EF6 B0 04                 2300 	MOV	AL,2
0EF8 E8 1F F4              2301 	CALL	VAL1
0EFB A0 B0 19              2302 	MOV	AL,[SYM]
0EFE 3C 2C                 2303 	CMP	AL,','
0F00 A0 B4 19              2304 	MOV	AL,[DATSIZ]
0F03 75 06                 2305 	JNZ	ENDDAT
0F05 E8 14 00              2306 	CALL	SAVDAT
0F08 E9 E8 FF              2307 	JMP	GETDAT
0F0B                       2308 ENDDAT:
0F0B 3C 04                 2309 	CMP	AL,2
0F0D 75 0D                 2310 	JNZ	SAVDAT
0F0F 8B 1E AE 19           2311 	MOV	BX,[DATA]
0F13 9F                    2312 	LAHF
0F14                       2313 	;NOTICE: DO NOT GENERATE END FOR DM IF COMMENTED
0F14 80 CB 80              2314 	OR	BL,080H
0F17 9E                    2315 	SAHF
0F18 89 1E AE 19           2316 	MOV	[DATA],BX
0F1C                       2317 SAVDAT:
0F1C 0A C0                 2318 	OR	AL,AL
0F1E 74 DB                 2319 	JZ	$+5
0F20 E9 5E FB              2320 	JMP	PUTBYT
0F23 E9 53 FB              2321 	JMP	PUTWOR
0F26                       2322 IF:
0F26 0B DB                 2323 	OR	BX,BX
0F28 74 01                 2324 	JZ	SKIPCD
0F2A                       2325 	INC	BYTE [IFFLG]
0F2A C3                    2326 	RET
0F2B                       2327 
0F2B                       2328 SKIPCD:
0F2B                       2329 	INC	BYTE [CHKLAB]
0F2B                       2330 SKIPLP:
0F2B 32 C0                 2331 	XOR	AL,AL
0F2D E8 7A F2              2332 	CALL	NEXLIN
0F30 E8 CA F2              2333 	CALL	NEXTCHR
0F33 3C 1A                 2334 	CMP	AL,1AH
0F35 74 37                 2335 	JZ	END
0F37 E8 96 F8              2336 	CALL	GETLAB
0F3A 72 EF                 2337 	JC	SKIPLP
0F3C BF B0 19              2338 	MOV	DI,LENID
0F3F BE 99 19              2339 	MOV	SI,IFEND
0F42 B5 DA                 2340 	MOV	CH,0
0F44 8A 0D                 2341 	MOV	CL,[DI]
0F46 FE C1                 2342 	INC	CL
0F48 F3                    2343 	REPE
0F49 A6                    2344 	CMPSB
0F4A 74 11                 2345 	JZ	ENDCOND
0F4C BF B0 19              2346 	MOV	DI,LENID
0F4F BE 99 19              2347 	MOV	SI,IFNEST
0F52 8A 0D                 2348 	MOV	CL,[DI]
0F54 FE C1                 2349 	INC	CL
0F56 F3                    2350 	REPE
0F57 A6                    2351 	CMPSB
0F58 75 D1                 2352 	JNZ	SKIPLP
0F5A                       2353 	INC	BYTE [CHKLAB]
0F5A E9 CE FF              2354 	JMP	SKIPLP
0F5D                       2355 
0F5D                       2356 ENDCOND:
0F5D                       2357 	DEC	BYTE [CHKLAB]
0F5D 75 CC                 2358 	JNZ	SKIPLP
0F5F C3                    2359 	RET
0F60                       2360 
0F60                       2361 ENDIF:
0F60 A0 B8 19              2362 	MOV	AL,[IFFLG]
0F63                       2363 	MOV	CL,36
0F63 FE C8                 2364 	DEC	AL
0F65 78 04                 2365 	JS	ERRJMP
0F67 A2 B8 19              2366 	MOV	[IFFLG],AL
0F6A C3                    2367 	RET
0F6B                       2368 
0F6B E9 8A F2              2369 ERRJMP:	JMP	ERROR
0F6E                       2370 
0F6E                       2371 ;*********************************************************************
0F6E                       2372 ;
0F6E                       2373 ;	PASS 2
0F6E                       2374 ;
0F6E                       2375 ;*********************************************************************
0F6E                       2376 
0F6E                       2377 END:
0F6E                       2378 	MOV	DL,4
0F6E                       2379 WREND:
0F6E B5 FF                 2380 	MOV	CH,0FFH
0F70 8A C5                 2381 	MOV	AL,CH
0F72 E8 D2 FA              2382 	CALL	GEN
0F75 FE CA                 2383 	DEC	DL
0F77 75 F5                 2384 	JNZ	WREND
0F79                       2385 	MOV	WORD[BUFPT],SRCBUF
0F79                       2386 	MOV	BYTE [HEXCNT],-5	;FLAG HEX BUFFER AS EMPTY
0F79                       2387 	MOV	WORD[LSTPNT],LSTBUF
0F79                       2388 	MOV	WORD[HEXPNT],HEXBUF
0F79 33 C0                 2389 	XOR	AX,AX
0F7B A3 B9 19              2390 	MOV	[ERRCNT],AX
0F7E A3 A9 19              2391 	MOV	[PC],AX
0F81 A3 B7 19              2392 	MOV	[LINE],AX	;Current line number
0F84                       2393 	MOV	WORD[HEXADD],OBJECT
0F84 BA 5C 00              2394 	MOV	DX,FCB
0F87 B4 00                 2395 	MOV	AH,OPEN
0F89                       2396 	INT	33		;Re-open source file
0F89 33 C0                 2397 	XOR	AX,AX
0F8B                       2398 	MOV	[FCB+12],AX	;Set CURRENT BLOCK to zero
0F8B A2 7C 00              2399 	MOV	[FCB+20H],AL	;Set NEXT RECORD field to zero
0F8E                       2400 	MOV	WORD[FCB+14],BUFSIZ
0F8E A2 B6 19              2401 	MOV	[COUNT],AL
0F91                       2402 	MOV	CH,1
0F91 BE C2 19              2403 	MOV	SI,START
0F94                       2404 FIXLINE:
0F94 BF C2 19              2405 	MOV	DI,START	;Store code over used up intermediate code
0F97 32 C0                 2406 	XOR	AL,AL
0F99 A2 BB 19              2407 	MOV	[SPC],AL	;No "special" yet (ORG, PUT, DS)
0F9C A2 B6 19              2408 	MOV	[ERR],AL	;No second pass errors yet
0F9F                       2409 NEXBT:
0F9F                       2410 	SHL	CL,1		;Shift out last bit of previous code
0F9F FE CD                 2411 	DEC	CH		;Still have codes left?
0FA1 75 03                 2412 	JNZ	TESTTYP
0FA3 AC                    2413 	LODSB			;Get next flag byte
0FA4 8A C8                 2414 	MOV	CL,AL
0FA6                       2415 	MOV	CH,4
0FA6                       2416 TESTTYP:
0FA6                       2417 	SHL	CL,1		;Set flags based on two bits
0FA6 70 07                 2418 	JO	FIXUP
0FA8 AC                    2419 	LODSB
0FA9 72 41                 2420 	JC	EMARK
0FAB                       2421 OBJBT:
0FAB AA                    2422 	STOSB
0FAC E9 F0 FF              2423 	JMP	NEXBT
0FAF                       2424 
0FAF                       2425 FIXUP:
0FAF                       2426 ;Either a word or byte fixup is needed from a forward reference
0FAF AD                    2427 	LODSW			;Get pointer to symbol
0FB0 93                    2428 	XCHG	AX,BX
0FB1 AD                    2429 	LODSW			;Get constant part
0FB2                       2430 	ADD	AX,[BX+1]	;Add symbol value to constant part
0FB2                       2431 	CMP	BYTE [BX],0	;See if symbol got defined
0FB2 75 02                 2432 	JNZ	HAVDEF
0FB4                       2433 	MOV	BYTE [ERR],100	;Undefined - flag error
0FB4 33 C0                 2434 	XOR	AX,AX
0FB6                       2435 HAVDEF:
0FB6 0A C9                 2436 	OR	CL,CL		;See if word or byte fixup
0FB8 78 04                 2437 	JS	DEFBYT
0FBA AB                    2438 	STOSW
0FBB E9 E1 FF              2439 	JMP	NEXBT
0FBE                       2440 
0FBE                       2441 DEFBYT:
0FBE 8B D0                 2442 	MOV	DX,AX
0FC0 98                    2443 	CBW			;Extend sign
0FC1 3B C2                 2444 	CMP	AX,DX		;See if in range +127 to -128
0FC3 74 E6                 2445 	JZ	OBJBT		;If so, it's always OK
0FC5 F6 D4                 2446 	NOT	AH		;Check for range +255 to -256
0FC7 3A E6                 2447 	CMP	AH,DH
0FC9 75 1B                 2448 	JNZ	RNGERR		;Must always be in this range
0FCB                       2449 ;Check for short jump. If so, we're out of range; otherwise we're OK
0FCB 81 FF B2 1A           2450 	CMP	DI,START+1	;Only one other byte on line?
0FCF 75 DA                 2451 	JNZ	OBJBT		;Can't be short jump if not
0FD1 A0 C2 19              2452 	MOV	AL,[START]	;Get the first byte of this line
0FD4 3C EB                 2453 	CMP	AL,0EBH		;Direct short jump?
0FD6 74 0E                 2454 	JZ	RNGERR
0FD8 24 FC                 2455 	AND	AL,0FCH
0FDA 3C E0                 2456 	CMP	AL,0E0H		;LOOP or JCXZ instruction?
0FDC 74 08                 2457 	JZ	RNGERR
0FDE 24 F0                 2458 	AND	AL,0F0H
0FE0 3C 70                 2459 	CMP	AL,70H		;Conditional jump?
0FE2 8A C2                 2460 	MOV	AL,DL		;Get code byte in AL
0FE4 75 C5                 2461 	JNZ	OBJBT		;If not, we're OK
0FE6                       2462 RNGERR:
0FE6                       2463 	MOV	BYTE [ERR],101	;Value out of range
0FE6 E9 C2 FF              2464 	JMP	OBJBT
0FE9                       2465 
0FE9 E9 53 01              2466 FINIJ:	JMP	FINI
0FEC                       2467 
0FEC                       2468 EMARK:
0FEC 3C FF                 2469 	CMP	AL,-1		;End of file?
0FEE 74 F9                 2470 	JZ	FINIJ
0FF0 3C 9F                 2471 	CMP	AL,-10		;Special item?
0FF2 77 5C                 2472 	JA	SPEND
0FF4 51                    2473 	PUSH	CX
0FF5 56                    2474 	PUSH	SI
0FF6 50                    2475 	PUSH	AX		;Save error code
0FF7 8A 26 BB 19           2476 	MOV	AH,[LSTDEV]
0FFB 80 E4 FE              2477 	AND	AH,0FEH		;Reset error indicator
0FFE 0A 06 B6 19           2478 	OR	AL,[ERR]	;See if any errors on this line
1002 74 03                 2479 	JZ	NOERR
1004 80 CC 09              2480 	OR	AH,1		;Send line to console if error occured
1007                       2481 NOERR:
1007 88 26 BB 19           2482 	MOV	[LSTDEV],AH
100B 8B CF                 2483 	MOV	CX,DI
100D E8 E0 00              2484 	CALL	STRTLIN		;Print address of line
1010 BE C2 19              2485 	MOV	SI,START
1013 2B CE                 2486 	SUB	CX,SI		;Get count of bytes of code
1015 74 06                 2487 	JZ	SHOLIN
1017                       2488 CODLP:
1017 AC                    2489 	LODSB
1018 E8 04 02              2490 	CALL	SAVCD		;Ouput code to HEX and PRN files
101B E2 FA                 2491 	LOOP	CODLP
101D                       2492 SHOLIN:
101D B0 FD                 2493 	MOV	AL,0
101F 86 06 B6 19           2494 	XCHG	AL,[COUNT]
1023 B9 01 00              2495 	MOV	CX,7		;Allow 7 bytes of code per line
1026 2A C8                 2496 	SUB	CL,AL
1028 B0 20                 2497 	MOV	AL,' '
102A 74 0B                 2498 	JZ	NOFIL
102C                       2499 BLNK:				;Put in 3 blanks for each byte not present
102C E8 D1 00              2500 	CALL	LIST
102F E8 CE 00              2501 	CALL	LIST
1032 E8 CB 00              2502 	CALL	LIST
1035 E2 F5                 2503 	LOOP	BLNK
1037                       2504 NOFIL:
1037 E8 45 00              2505 	CALL	OUTLIN
103A 58                    2506 	POP	AX		;Restore error code
103B E8 0A 02              2507 	CALL	REPERR
103E A0 B6 19              2508 	MOV	AL,[ERR]
1041 E8 04 02              2509 	CALL	REPERR
1044 5E                    2510 	POP	SI
1045 59                    2511 	POP	CX
1046 A0 BB 19              2512 	MOV	AL,[SPC]	;Any special funtion?
1049 0A C0                 2513 	OR	AL,AL
104B 75 0D                 2514 	JNZ	SPCFUN
104D E9 44 FF              2515 	JMP	FIXLINE
1050                       2516 
1050                       2517 SPEND:
1050 A2 BB 19              2518 	MOV	[SPC],AL	;Record special function
1053 AD                    2519 	LODSW			;Get it's data
1054 A3 AE 19              2520 	MOV	[DATA],AX
1057 E9 45 FF              2521 	JMP	NEXBT
105A                       2522 
105A                       2523 SPCFUN:
105A 8B 16 AE 19           2524 	MOV	DX,[DATA]
105E 3C F7                 2525 	CMP	AL,-2
1060 74 0F                 2526 	JZ	DORG
1062 3C F8                 2527 	CMP	AL,-3
1064 74 12                 2528 	JZ	DPUT
1066                       2529 DDS:
1066                       2530 ;Handle DS pseudo-op
1066 01 16 A9 19           2531 	ADD	[PC],DX
106A 01 16 B7 19           2532 	ADD	[HEXADD],DX
106E E9 23 FF              2533 	JMP	FIXLINE
1071                       2534 
1071                       2535 DORG:
1071                       2536 ;Handle ORG pseudo-op
1071 89 16 A9 19           2537 	MOV	[PC],DX
1075 E9 1C FF              2538 	JMP	FIXLINE
1078                       2539 
1078                       2540 DPUT:
1078                       2541 ;Handle PUT pseudo-op
1078 89 16 B7 19           2542 	MOV	[HEXADD],DX
107C E9 15 FF              2543 	JMP	FIXLINE
107F                       2544 
107F                       2545 OUTLIN:
107F                       2546 ;Copy the source line to the ouput device. Line will be preceded by
107F                       2547 ;assembler-generated line number. This routine may be called several times
107F                       2548 ;on one line (once for each line of object code bytes), so it sets a flag
107F                       2549 ;so the line will only be output on the first call.
107F B0 FD                 2550 	MOV	AL,-1
1081 86 06 B8 19           2551 	XCHG	AL,[LINFLG]
1085 0A C0                 2552 	OR	AL,AL
1087 75 33                 2553 	JNZ	CRLF		;Output line only if first time
1089 A1 B7 19              2554 	MOV	AX,[LINE]
108C 40                    2555 	INC	AX
108D A3 B7 19              2556 	MOV	[LINE],AX
1090 B7 F0                 2557 	MOV	BH,0		;No leading zero suppression
1092 E8 2D 00              2558 	CALL	OUT10
1095 B0 20                 2559 	MOV	AL," "
1097 E8 66 00              2560 	CALL	LIST
109A A0 9C 19              2561 	MOV	AL,[LSTFCB]
109D 3C 5A                 2562 	CMP	AL,'Z'
109F 74 1B                 2563 	JZ	CRLF		;Don't call NEXTCHR if listing suppressed
10A1 56                    2564 	PUSH	SI		;Save the only register destroyed by NEXTCHR
10A2                       2565 OUTLN:
10A2 E8 58 F1              2566 	CALL	NEXTCHR
10A5 E8 58 00              2567 	CALL	LIST
10A8                       2568 	CMP	AL,10		;Output until linefeed found
10A8 75 F8                 2569 	JNZ	OUTLN
10AA 5E                    2570 	POP	SI
10AB C3                    2571 	RET
10AC                       2572 
10AC                       2573 PRTCNT:
10AC A1 B9 19              2574 	MOV	AX,[ERRCNT]
10AF BB 82 19              2575 	MOV	BX,ERCNTM
10B2                       2576 PRNT10:
10B2 50                    2577 	PUSH	AX
10B3 E8 C0 01              2578 	CALL	PRINT
10B6 58                    2579 	POP	AX
10B7 B7 10                 2580 	MOV	BH,"0"-" "	;Enable leading zero suppression
10B9 E8 06 00              2581 	CALL	OUT10
10BC                       2582 CRLF:
10BC                       2583 	MOV	AL,13
10BC E8 41 00              2584 	CALL	LIST
10BF                       2585 	MOV	AL,10
10BF E9 3E 00              2586 	JMP	LIST
10C2                       2587 
10C2                       2588 OUT10:
10C2 33 D2                 2589 	XOR	DX,DX
10C4                       2590 	MOV	DI,10000
10C4                       2591 	DIV	DI
10C4 0A C0                 2592 	OR	AL,AL		;>10,000?
10C6 75 02                 2593 	JNZ	LEAD
10C8 2C 10                 2594 	SUB	AL,"0"-" "	;Convert leading zero to blank
10CA                       2595 LEAD:
10CA 04 30                 2596 	ADD	AL,"0"
10CC E8 31 00              2597 	CALL	LIST
10CF 92                    2598 	XCHG	AX,DX
10D0                       2599 	MOV	BL,100
10D0                       2600 	DIV	BL
10D0 8A DC                 2601 	MOV	BL,AH
10D2 E8 0B 00              2602 	CALL	HIDIG		;Convert to decimal and print 1000s digit
10D5 E8 0D 00              2603 	CALL	DIGIT		;Print 100s digit
10D8 8A C3                 2604 	MOV	AL,BL
10DA E8 03 00              2605 	CALL	HIDIG		;Convert to decimal and print 10s digit
10DD                       2606 	MOV	BH,0		;Ensure leading zero suppression is off
10DD E9 05 00              2607 	JMP	DIGIT
10E0                       2608 
10E0                       2609 HIDIG:
10E0 D4 0A                 2610 	AAM			;Convert binary to unpacked BCD
10E2 0D 30 30              2611 	OR	AX,3030H	;Add "0" bias
10E5                       2612 DIGIT:
10E5 86 C4                 2613 	XCHG	AL,AH
10E7 3C 30                 2614 	CMP	AL,"0"
10E9 74 00                 2615 	JZ	SUPZ
10EB                       2616 	MOV	BH,0		;Turn off zero suppression if not zero
10EB                       2617 SUPZ:
10EB 2A C7                 2618 	SUB	AL,BH		;Convert leading zeros to blanks
10ED E9 10 00              2619 	JMP	LIST
10F0                       2620 
10F0                       2621 STRTLIN:
10F0                       2622 	MOV	BYTE [LINFLG],0
10F0 8B 1E A9 19           2623 	MOV	BX,[PC]
10F4 8A C7                 2624 	MOV	AL,BH
10F6 E8 38 00              2625 	CALL	PHEX
10F9 8A C3                 2626 	MOV	AL,BL
10FB                       2627 PHEXB:
10FB E8 33 00              2628 	CALL	PHEX
10FE B0 20                 2629 	MOV	AL,' '
1100                       2630 LIST:
1100 50                    2631 	PUSH	AX
1101 52                    2632 	PUSH	DX
1102 24 7F                 2633 	AND	AL,7FH
1104 8A D0                 2634 	MOV	DL,AL
1106                       2635 	TEST	BYTE [LSTDEV],3	;See if output goes to console
1106 74 00                 2636 	JZ	PRNCHK
1108                       2637 	MOV	AH,2
1108                       2638 	INT	33		;Output to console
1108                       2639 PRNCHK:
1108                       2640 	TEST	BYTE [LSTDEV],4	;See if output goes to printer
1108 74 02                 2641 	JZ	FILCHK
110A B4 F0                 2642 	MOV	AH,5
110C                       2643 	INT	33		;Output to printer
110C                       2644 FILCHK:
110C 8A C2                 2645 	MOV	AL,DL
110E 5A                    2646 	POP	DX
110F                       2647 	TEST	BYTE [LSTDEV],80H	;See if output goes to a file
110F 74 03                 2648 	JZ	LISTRET
1111 E8 02 00              2649 	CALL	WRTBUF
1114                       2650 LISTRET:
1114 58                    2651 	POP	AX
1115 C3                    2652 	RET
1116                       2653 
1116                       2654 WRTBUF:
1116 57                    2655 	PUSH	DI
1117 8B 3E BC 19           2656 	MOV	DI,[LSTPNT]
111B AA                    2657 	STOSB
111C 81 FF BF 19           2658 	CMP	DI,LSTBUF+LSTBUFSIZ
1120 75 09                 2659 	JNZ	SAVPT
1122 50                    2660 	PUSH	AX
1123 51                    2661 	PUSH	CX
1124 52                    2662 	PUSH	DX
1125 E8 18 02              2663 	CALL	FLUSHBUF
1128 5A                    2664 	POP	DX
1129 59                    2665 	POP	CX
112A 58                    2666 	POP	AX
112B                       2667 SAVPT:
112B 89 3E BC 19           2668 	MOV	[LSTPNT],DI
112F 5F                    2669 	POP	DI
1130 C3                    2670 	RET
1131                       2671 
1131                       2672 PHEX:
1131 50                    2673 	PUSH	AX
1132 E8 27 02              2674 	CALL	UHALF
1135 E8 C8 FF              2675 	CALL	LIST
1138 58                    2676 	POP	AX
1139 E8 20 02              2677 	CALL	LHALF
113C E9 C1 FF              2678 	JMP	LIST
113F                       2679 
113F                       2680 FINI:
113F                       2681 	OR	BYTE [LSTDEV],1
113F E8 6A FF              2682 	CALL	PRTCNT
1142 BB 82 19              2683 	MOV	BX,SYMSIZE
1145                       2684 	MOV	AX,[6]
1145 2B 06 B2 19           2685 	SUB	AX,[HEAP]		;Size of symbol table
1149 E8 66 FF              2686 	CALL	PRNT10
114C BB 82 19              2687 	MOV	BX,FRESIZE
114F A1 B2 19              2688 	MOV	AX,[HEAP]
1152 2B 06 B4 19           2689 	SUB	AX,[CODE]		;Free space remaining
1156 E8 59 FF              2690 	CALL	PRNT10
1159                       2691 	AND	BYTE [LSTDEV],0FEH
1159 A0 9C 19              2692 	MOV	AL,[HEXFCB]
115C 3C 5A                 2693 	CMP	AL,'Z'
115E 74 2B                 2694 	JZ	SYMDMP
1160 A0 B7 19              2695 	MOV	AL,[HEXCNT]
1163                       2696 	CMP	AL,-5
1163 74 03                 2697 	JZ	L0012
1165 E8 94 01              2698 	CALL	ENHEXL
1168                       2699 L0012:	
1168 B0 3A                 2700 	MOV	AL,':'
116A E8 C9 01              2701 	CALL	PUTCHR
116D                       2702 	MOV	CH,10
116D                       2703 HEXEND:
116D 51                    2704 	PUSH	CX
116E B0 30                 2705 	MOV	AL,'0'
1170 E8 C3 01              2706 	CALL	PUTCHR
1173 59                    2707 	POP	CX
1174 FE CD                 2708 	DEC	CH
1176 75 F5                 2709 	JNZ	HEXEND
1178                       2710 	MOV	AL,13
1178 E8 BB 01              2711 	CALL	PUTCHR
117B                       2712 	MOV	AL,10
117B E8 B8 01              2713 	CALL	PUTCHR
117E B0 1A                 2714 	MOV	AL,1AH
1180 E8 B3 01              2715 	CALL	PUTCHR
1183 E8 9A 01              2716 	CALL	WRTHEX		;Flush HEX file buffer
1186 BA 9C 19              2717 	MOV	DX,HEXFCB
1189 B4 00                 2718 	MOV	AH,CLOSE
118B                       2719 	INT	33
118B                       2720 SYMDMP:
118B A0 B4 19              2721 	MOV	AL,[SYMFLG]
118E 3C 53                 2722 	CMP	AL,'S'
1190 75 23                 2723 	JNZ	ENDSYM
1192 A0 BB 19              2724 	MOV	AL,[LSTDEV]
1195 0A C0                 2725 	OR	AL,AL		;Any output device for symbol table dump?
1197 75 03                 2726 	JNZ	DOSYMTAB
1199                       2727 	OR	AL,1		;If not, send it to console
1199 A2 BB 19              2728 	MOV	[LSTDEV],AL
119C                       2729 DOSYMTAB:
119C BB 96 19              2730 	MOV	BX,SYMMES
119F E8 D4 00              2731 	CALL	PRINT
11A2 8B 16 B0 19           2732 	MOV	DX,[BASE]
11A6 8A C6                 2733 	MOV	AL,DH
11A8 0A C2                 2734 	OR	AL,DL
11AA 74 09                 2735 	JZ	ENDSYM
11AC                       2736 	MOV	BYTE [SYMLIN],SYMWID  ;No symbols on this line yet
11AC 8B 1E B2 19           2737 	MOV	BX,[HEAP]
11B0 8B E3                 2738 	MOV	SP,BX		;Need maximum stack for recursive tree walk
11B2 E8 10 00              2739 	CALL	NODE
11B5                       2740 ENDSYM:
11B5                       2741 	TEST	BYTE [LSTDEV],80H	;Print listing to file?
11B5 74 0E                 2742 	JZ	EXIT
11B7 B0 1A                 2743 	MOV	AL,1AH
11B9 E8 5A FF              2744 	CALL	WRTBUF		;Write end-of-file mark
11BC 8B 3E BC 19           2745 	MOV	DI,[LSTPNT]
11C0 E8 7D 01              2746 	CALL	FLUSHBUF
11C3 B4 00                 2747 	MOV	AH,CLOSE
11C5                       2748 	INT	33
11C5                       2749 EXIT:	JMP	0
11C5                       2750 
11C5                       2751 NODE:
11C5 87 DA                 2752 	XCHG	DX,BX
11C7 53                    2753 	PUSH	BX
11C8 8A 17                 2754 	MOV	DL,[BX]
11CA                       2755 	MOV	DH,0
11CA 43                    2756 	INC	BX
11CB 03 DA                 2757 	ADD	BX,DX
11CD 8B 17                 2758 	MOV	DX,[BX]
11CF 0B D2                 2759 	OR	DX,DX
11D1 74 03                 2760 	JZ	L0014
11D3 E8 EF FF              2761 	CALL	NODE
11D6                       2762 L0014:	
11D6 5B                    2763 	POP	BX
11D7 8A 07                 2764 	MOV	AL,[BX]
11D9 43                    2765 	INC	BX
11DA 8A E8                 2766 	MOV	CH,AL
11DC                       2767 	ADD	AL,24
11DC                       2768 	SHR	AL,1
11DC                       2769 	SHR	AL,1
11DC                       2770 	SHR	AL,1
11DC 8A C8                 2771 	MOV	CL,AL
11DE FE C1                 2772 	INC	CL		;Invert last bit
11E0                       2773 	AND	CL,1		;Number of extra tabs needed (0 or 1)
11E0                       2774 	SHR	AL,1		;Number of positions wide this symbol needs
11E0 28 06 B4 19           2775 	SUB	[SYMLIN],AL
11E4 73 0A                 2776 	JNC	WRTSYM		;Will it fit?
11E6 2C 00                 2777 	SUB	AL,SYMWID
11E8 F6 D8                 2778 	NEG	AL
11EA A2 B4 19              2779 	MOV	[SYMLIN],AL
11ED E8 CC FE              2780 	CALL	CRLF		;Start new line if not
11F0                       2781 WRTSYM:
11F0 8A 07                 2782 	MOV	AL,[BX]
11F2 43                    2783 	INC	BX
11F3 E8 0A FF              2784 	CALL	LIST
11F6 FE CD                 2785 	DEC	CH
11F8 75 F6                 2786 	JNZ	WRTSYM
11FA FE C1                 2787 	INC	CL
11FC                       2788 TABVAL:
11FC B0 F0                 2789 	MOV	AL,9
11FE E8 FF FE              2790 	CALL	LIST
1201 E2 F9                 2791 	LOOP	TABVAL
1203 43                    2792 	INC	BX
1204 43                    2793 	INC	BX
1205 53                    2794 	PUSH	BX
1206                       2795 	MOV	AL,[BX+4]
1206 E8 28 FF              2796 	CALL	PHEX
1209                       2797 	MOV	AL,[BX+3]
1209 E8 25 FF              2798 	CALL	PHEX
120C                       2799 	CMP	BYTE [SYMLIN],0	;Will any more fit on line?
120C 74 06                 2800 	JZ	NEXSYMLIN
120E                       2801 	MOV	AL,9
120E E8 EF FE              2802 	CALL	LIST
1211 E9 03 00              2803 	JMP	RIGHTSON
1214                       2804 NEXSYMLIN:
1214 E8 A5 FE              2805 	CALL	CRLF
1217                       2806 	MOV	BYTE [SYMLIN],SYMWID
1217                       2807 RIGHTSON:
1217 5B                    2808 	POP	BX
1218 8B 17                 2809 	MOV	DX,[BX]
121A 0B D2                 2810 	OR	DX,DX
121C 75 A7                 2811 	JNZ	NODE
121E C3                    2812 	RET
121F                       2813 
121F                       2814 SAVCD:
121F A2 B8 19              2815 	MOV	[PREV],AL
1222 53                    2816 	PUSH	BX
1223 51                    2817 	PUSH	CX
1224 50                    2818 	PUSH	AX
1225 52                    2819 	PUSH	DX
1226 E8 66 00              2820 	CALL	CODBYT
1229 5A                    2821 	POP	DX
122A BB B6 19              2822 	MOV	BX,COUNT
122D                       2823 	INC	BYTE [BX]
122D 8A 07                 2824 	MOV	AL,[BX]
122F 3C FE                 2825 	CMP	AL,8
1231 75 0E                 2826 	JNZ	NOEXT
1233                       2827 	MOV	BYTE [BX],1
1233 E8 49 FE              2828 	CALL	OUTLIN
1236 B0 20                 2829 	MOV	AL,' '
1238 B5 DD                 2830 	MOV	CH,5
123A                       2831 TAB:
123A E8 C3 FE              2832 	CALL	LIST
123D FE CD                 2833 	DEC	CH
123F 75 F9                 2834 	JNZ	TAB
1241                       2835 NOEXT:
1241 58                    2836 	POP	AX
1242 E8 B6 FE              2837 	CALL	PHEXB
1245 59                    2838 	POP	CX
1246                       2839 	INC	WORD[PC]
1246                       2840 	INC	WORD[HEXADD]
1246 5B                    2841 	POP	BX
1247 C3                    2842 	RET
1248                       2843 
1248                       2844 REPERR:
1248 0A C0                 2845 	OR	AL,AL		;Did an error occur?
124A                       2846 	;FIXME:DISABLE THIS FOR NOW
124A E9 FB FF              2847 	JMP	REPERR_RET	
124D                       2848 	;JZ	REPERR_RET
124D                       2849 	INC	WORD[ERRCNT]
124D 50                    2850 	PUSH	AX
124E BB 74 19              2851 	MOV	BX,ERRMES	;Print "ERROR"
1251 E8 22 00              2852 	CALL	PRINT
1254 58                    2853 	POP	AX
1255                       2854 ;We have error number in AL. See if there's an error message for it
1255 BF CB 18              2855 	MOV	DI,ERRTAB
1258 B3 80                 2856 	MOV	BL,80H
125A                       2857 ERRLOOK:
125A AE                    2858 	SCASB			;Do we have the error message
125B 76 09                 2859 	JBE	HAVMES		;Quit looking if we have it or passed it
125D 93                    2860 	XCHG	AX,BX		;Put 80H in AL to look for end of this message
125E                       2861 NEXTMES:
125E AE                    2862 	SCASB			;Look for high bit set in message
125F                       2863 	;FIX
125F 77 FD                 2864 	JA	NEXTMES		;   which means we've reached the end
1261 93                    2865 	XCHG	AX,BX		;Restore error number to AL
1262 E9 F5 FF              2866 	JMP 	ERRLOOK		;Keep looking
1265                       2867 REPERR_RET:
1265 C3                    2868 	RET
1266                       2869 
1266                       2870 HAVMES:
1266 8B DF                 2871 	MOV	BX,DI		;Put address of message in BX
1268 74 06                 2872 	JZ	PRNERR		;Do we have a message for this error?
126A E8 C4 FE              2873 	CALL	PHEX		;If not, just print error number
126D E9 4C FE              2874 	JMP	CRLF
1270                       2875 
1270                       2876 PRNERR:
1270 E8 03 00              2877 	CALL	PRINT
1273 E9 46 FE              2878 	JMP	CRLF
1276                       2879 
1276                       2880 PRINT:
1276 8A 07                 2881 	MOV	AL,[BX]
1278 E8 85 FE              2882 	CALL	LIST
127B 0A C0                 2883 	OR	AL,AL
127D 78 F7                 2884 	JS	PRINT_RET
127F 43                    2885 	INC	BX
1280 E9 F3 FF              2886 	JMP	PRINT
1283                       2887 OUTA:
1283 8A D0                 2888 	MOV	DL,AL
1285                       2889 OUT:
1285 80 E2 7F              2890 	AND	DL,7FH
1288 B1 DA                 2891 	MOV	CL,2
128A                       2892 SYSTEM:
128A E8 50 EE              2893 	CALL	5
128D C3                    2894 	RET
128E                       2895 PRINT_RET:
128E C3                    2896 	RET
128F                       2897 CODBYT:
128F                       2898 	CMP	BYTE [HEXFCB],"Z"
128F 74 FE                 2899 	JZ	CODBYT_RET
1291 50                    2900 	PUSH	AX
1292 8B 16 B7 19           2901 	MOV	DX,[LASTAD]
1296 8B 1E B7 19           2902 	MOV	BX,[HEXADD]
129A 89 1E B7 19           2903 	MOV	[LASTAD],BX
129E 42                    2904 	INC	DX
129F A0 B7 19              2905 	MOV	AL,[HEXCNT]
12A2 3C 26                 2906 	CMP	AL,-5
12A4 74 07                 2907 	JZ	NEWLIN
12A6 3B DA                 2908 	CMP	BX,DX
12A8 74 2B                 2909 	JZ	AFHEX
12AA E8 4F 00              2910 	CALL	ENHEXL
12AD                       2911 NEWLIN:
12AD B0 3A                 2912 	MOV	AL,':'
12AF E8 84 00              2913 	CALL	PUTCHR
12B2 B0 0C                 2914 	MOV	AL,-4
12B4 A2 B7 19              2915 	MOV	[HEXCNT],AL
12B7 32 C0                 2916 	XOR	AL,AL
12B9 A2 B7 19              2917 	MOV	[CHKSUM],AL
12BC 8B 1E BC 19           2918 	MOV	BX,[HEXPNT]
12C0 89 1E B7 19           2919 	MOV	[HEXLEN],BX
12C4 E8 0F 00              2920 	CALL	HEXBYT
12C7                       2921 	MOV	AL,[HEXADD+1]
12C7 E8 0C 00              2922 	CALL	HEXBYT
12CA A0 B7 19              2923 	MOV	AL,[HEXADD]
12CD E8 06 00              2924 	CALL	HEXBYT
12D0 32 C0                 2925 	XOR	AL,AL
12D2 E8 01 00              2926 	CALL	HEXBYT
12D5                       2927 AFHEX:
12D5 58                    2928 	POP	AX
12D6                       2929 HEXBYT:
12D6 8A E8                 2930 	MOV	CH,AL
12D8 BB B7 19              2931 	MOV	BX,CHKSUM
12DB 02 07                 2932 	ADD	AL,[BX]
12DD 88 07                 2933 	MOV	[BX],AL
12DF 8A C5                 2934 	MOV	AL,CH
12E1 E8 78 00              2935 	CALL	UHALF
12E4 E8 4F 00              2936 	CALL	PUTCHR
12E7 8A C5                 2937 	MOV	AL,CH
12E9 E8 70 00              2938 	CALL	LHALF
12EC E8 47 00              2939 	CALL	PUTCHR
12EF BB B7 19              2940 	MOV	BX,HEXCNT
12F2                       2941 	INC	BYTE [BX]
12F2 8A 07                 2942 	MOV	AL,[BX]
12F4 3C                    2943 	CMP	AL,26
12F5 75 DF                 2944 	JNZ	HEXBYT_RET
12F7 E9 02 00              2945 	JMP ENHEXL
12FA                       2946 CODBYT_RET:
12FA C3                    2947 	RET
12FB                       2948 HEXBYT_RET:
12FB C3                    2949 	RET
12FC                       2950 ENHEXL:
12FC 8B 3E B7 19           2951 	MOV	DI,[HEXLEN]
1300 8A E8                 2952 	MOV	CH,AL
1302 E8 57 00              2953 	CALL	UHALF
1305 AA                    2954 	STOSB
1306 8A C5                 2955 	MOV	AL,CH
1308 E8 51 00              2956 	CALL	LHALF
130B AA                    2957 	STOSB
130C                       2958 	MOV	AL,-6
130C A2 B7 19              2959 	MOV	[HEXCNT],AL
130F A0 B7 19              2960 	MOV	AL,[CHKSUM]
1312 02 C5                 2961 	ADD	AL,CH
1314 F6 D8                 2962 	NEG	AL
1316 E8 BD FF              2963 	CALL	HEXBYT
1319 B0                    2964 	MOV	AL,13
131A E8 19 00              2965 	CALL	PUTCHR
131D                       2966 	MOV	AL,10
131D E8 16 00              2967 	CALL	PUTCHR
1320                       2968 WRTHEX:
1320                       2969 ;Write out the line
1320 BA BE 19              2970 	MOV	DX,HEXBUF
1323 89 16 BC 19           2971 	MOV	[HEXPNT],DX
1327 B4 00                 2972 	MOV	AH,SETDMA
1329                       2973 	INT	33
1329 2B FA                 2974 	SUB	DI,DX		;Length of buffer
132B 8B CF                 2975 	MOV	CX,DI
132D BA 9C 19              2976 	MOV	DX,HEXFCB
1330 B4                    2977 	MOV	AH,BLKWRT
1331                       2978 	INT	33
1331 0A C0                 2979 	OR	AL,AL
1333 75 20                 2980 	JNZ	DSKFUL
1335 C3                    2981 	RET
1336                       2982 
1336                       2983 PUTCHR:
1336 8B 3E BC 19           2984 	MOV	DI,[HEXPNT]
133A AA                    2985 	STOSB
133B 89 3E BC 19           2986 	MOV	[HEXPNT],DI
133F C3                    2987 	RET
1340                       2988 
1340                       2989 FLUSHBUF:
1340 8B CF                 2990 	MOV	CX,DI
1342 BA BF 19              2991 	MOV	DX,LSTBUF
1345 8B FA                 2992 	MOV	DI,DX
1347 2B CA                 2993 	SUB	CX,DX
1349 74 F5                 2994 	JZ	FLUSHBUF_RET		;Buffer empty?
134B B4 00                 2995 	MOV	AH,SETDMA
134D                       2996 	INT	33
134D BA 9C 19              2997 	MOV	DX,LSTFCB
1350 B4                    2998 	MOV	AH,BLKWRT
1351                       2999 	INT	33
1351 0A C0                 3000 	OR	AL,AL
1353 74 EB                 3001 	JZ	FLUSHBUF_RET
1355                       3002 DSKFUL:
1355 BB 82 19              3003 	MOV	BX,WRTERR
1358 E9 69 EE              3004 	JMP	PRERR
135B                       3005 FLUSHBUF_RET:
135B C3                    3006 	RET
135C                       3007 UHALF:
135C                       3008 	RCR	AL,1
135C                       3009 	RCR	AL,1
135C                       3010 	RCR	AL,1
135C                       3011 	RCR	AL,1
135C                       3012 LHALF:
135C 24 0F                 3013 	AND	AL,0FH
135E 0C 30                 3014 	OR	AL,30H
1360 3C                    3015 	CMP	AL,'9'+1
1361 72 F9                 3016 	JC	LHALF_RET
1363                       3017 	ADD	AL,7
1363 C3                    3018 	RET
1364                       3019 LHALF_RET:
1364 C3                    3020 	RET
1365                       3021 NONE:	DB	0
1365                       3022 
1365                       3023 ; 8086 MNEMONIC TABLE
1365                       3024 
1365                       3025 ; This table is actually a sequence of subtables, each starting with a label.
1365                       3026 ; The label signifies which mnemonics the subtable applies to--A3, for example,
1365                       3027 ; means all 3-letter mnemonics beginning with A.
1365                       3028 
1365                       3029 A3:
1365 E4                    3030 	DB	7		;Number of entries
1366                       3031 
1366 64 64                 3032 	DB	'dd'	;tail of opcode
1368 3F 0C                 3033 	DW	GRP7	;opcode handler
136A D1                    3034 	DB	2		;opcode format
136B                       3035 	
136B 6E 64                 3036 	DB	'nd'
136D 07 0D                 3037 	DW	GRP13
136F 22                    3038 	DB	22H
1370 64 63                 3039 	DB	'dc'
1372 3F 0C                 3040 	DW	GRP7
1374 12                    3041 	DB	12H
1375 61 61                 3042 	DB	'aa'
1377 3D 0A                 3043 	DW	PUT
1379 37                    3044 	DB	37H
137A 61 73                 3045 	DB	'as'
137C 3D 0A                 3046 	DW	PUT
137E 3F                    3047 	DB	3FH
137F 61 6D                 3048 	DB	'am'
1381 D7 0C                 3049 	DW	GRP11
1383 D4                    3050 	DB	0D4H
1384 61 64                 3051 	DB	'ad'
1386 D7 0C                 3052 	DW	GRP11
1388 D5                    3053 	DB	0D5H
1389                       3054 A5:
1389 D8                    3055 	DB	1
138A 6C 69 67 6E           3056 	DB	'lign'
138E                       3057 	DW	_ALIGN
138E                       3058 	DB	0
138E                       3059 C3:
138E                       3060 	DB	7
138E 6D 70                 3061 	DB	'mp'
1390 3F 0C                 3062 	DW	GRP7
1392 3A                    3063 	DB	3AH
1393 6C 63                 3064 	DB	'lc'
1395 3D 0A                 3065 	DW	PUT
1397 F8                    3066 	DB	0F8H
1398 6C 64                 3067 	DB	'ld'
139A 3D 0A                 3068 	DW	PUT
139C FC                    3069 	DB	0FCH
139D 6C 69                 3070 	DB	'li'
139F 3D 0A                 3071 	DW	PUT
13A1 FA                    3072 	DB	0FAH
13A2 6D 63                 3073 	DB	'mc'
13A4 3D 0A                 3074 	DW	PUT
13A6 F5                    3075 	DB	0F5H
13A7 62 77                 3076 	DB	'bw'
13A9 3D 0A                 3077 	DW	PUT
13AB 98                    3078 	DB	98H
13AC 77 64                 3079 	DB	'wd'
13AE 3D 0A                 3080 	DW	PUT
13B0 99                    3081 	DB	99H
13B1                       3082 C4:
13B1 D3                    3083 	DB	3
13B2 61 6C 6C              3084 	DB	'all'
13B5 2E 0D                 3085 	DW	GRP14
13B7 9A                    3086 	DB	9AH
13B8 6D 70 62              3087 	DB	'mpb'
13BB 3D 0A                 3088 	DW	PUT
13BD A6                    3089 	DB	0A6H
13BE 6D 70 77              3090 	DB	'mpw'
13C1 3D 0A                 3091 	DW	PUT
13C3 A7                    3092 	DB	0A7H
13C4                       3093 C5:
13C4                       3094 	DB	2
13C4 6D 70 73 62           3095 	DB	'mpsb'
13C8 3D 0A                 3096 	DW	PUT
13CA A6                    3097 	DB	0A6H
13CB 6D 70 73 77           3098 	DB	'mpsw'
13CF 3D 0A                 3099 	DW	PUT
13D1 A7                    3100 	DB	0A7H
13D2                       3101 D2:
13D2                       3102 	DB	5
13D2 62                    3103 	DB	'b'
13D3 F0 0E                 3104 	DW	GRP23
13D5 D0                    3105 	DB	1
13D6 77                    3106 	DB	'w'
13D7 F0 0E                 3107 	DW	GRP23
13D9                       3108 	DB	0
13D9 6D                    3109 	DB	'm'
13DA F0 0E                 3110 	DW	GRP23
13DC                       3111 	DB	2
13DC 73                    3112 	DB	's'
13DD C9 0B                 3113 	DW	GRP5
13DF                       3114 	DB	1
13DF 69                    3115 	DB	'i'
13E0 3D 0A                 3116 	DW	PUT
13E2 FA                    3117 	DB	0FAH
13E3                       3118 D3:
13E3                       3119 	DB	4
13E3 65 63                 3120 	DB	'ec'
13E5 65 0C                 3121 	DW	GRP8
13E7 49                    3122 	DB	49H
13E8 69 76                 3123 	DB	'iv'
13EA B2 0C                 3124 	DW	GRP10
13EC 30                    3125 	DB	30H
13ED 61 61                 3126 	DB	'aa'
13EF 3D 0A                 3127 	DW	PUT
13F1 27                    3128 	DB	27H
13F2 61 73                 3129 	DB	'as'
13F4 3D 0A                 3130 	DW	PUT
13F6 2F                    3131 	DB	2FH
13F7                       3132 D4:
13F7 D3                    3133 	DB	1
13F8 6F 77 6E              3134 	DB	'own'
13FB 3D 0A                 3135 	DW	PUT
13FD FD                    3136 	DB	0FDH
13FE                       3137 E2:
13FE                       3138 	DB	1
13FE 69                    3139 	DB	'i'
13FF 3D 0A                 3140 	DW	PUT
1401 FB                    3141 	DB	0FBH
1402                       3142 E3:
1402 D5                    3143 	DB	3
1403 71 75                 3144 	DB	'qu'
1405 C9 0B                 3145 	DW	GRP5
1407 D1                    3146 	DB	2
1408 73 63                 3147 	DB	'sc'
140A 6B 0E                 3148 	DW	GRP19
140C D8                    3149 	DB	0D8H
140D 6E 64                 3150 	DB	'nd'
140F 6E 0F                 3151 	DW	END
1411                       3152 	DB	0
1411                       3153 E5:
1411                       3154 	DB	1
1411 6E 64 69 66           3155 	DB	'ndif'
1415 60 0F                 3156 	DW	ENDIF
1417 F0                    3157 	DB	0
1418                       3158 H3:
1418                       3159 	DB	1
1418 6C 74                 3160 	DB	'lt'
141A 3D 0A                 3161 	DW	PUT
141C F4                    3162 	DB	0F4H
141D                       3163 H4:
141D                       3164 	DB	1
141D 61 6C 74              3165 	DB	'alt'
1420 3D 0A                 3166 	DW	PUT
1422 F4                    3167 	DB	0F4H
1423                       3168 I2:
1423 D0                    3169 	DB	2
1424 6E                    3170 	DB	'n'
1425 A4 0B                 3171 	DW	GRP4
1427 E4                    3172 	DB	0E4H
1428 66                    3173 	DB	'f'
1429 C9 0B                 3174 	DW	GRP5
142B                       3175 	DB	4
142B                       3176 I3:
142B                       3177 	DB	4
142B 6E 63                 3178 	DB	'nc'
142D 65 0C                 3179 	DW	GRP8
142F 41                    3180 	DB	41H
1430 6E 62                 3181 	DB	'nb'
1432 A4 0B                 3182 	DW	GRP4
1434 E4                    3183 	DB	0E4H
1435 6E 77                 3184 	DB	'nw'
1437 A4 0B                 3185 	DW	GRP4
1439 E5                    3186 	DB	0E5H
143A 6E 74                 3187 	DB	'nt'
143C 45 0E                 3188 	DW	GRP18
143E CC                    3189 	DB	0CCH
143F                       3190 I4:
143F                       3191 	DB	4
143F 6D 75 6C              3192 	DB	'mul'
1442 B2 0C                 3193 	DW	GRP10
1444 28                    3194 	DB	28H
1445 64 69 76              3195 	DB	'div'
1448 B2 0C                 3196 	DW	GRP10
144A 38                    3197 	DB	38H
144B 72 65 74              3198 	DB	'ret'
144E 3D 0A                 3199 	DW	PUT
1450 CF                    3200 	DB	0CFH
1451 6E 74 6F              3201 	DB	'nto'
1454 3D 0A                 3202 	DW	PUT
1456 CE                    3203 	DB	0CEH
1457                       3204 J2:
1457                       3205 	DB	10
1457 70                    3206 	DB	'p'
1458 0C 0E                 3207 	DW	GRP17
145A EB                    3208 	DB	0EBH
145B 7A                    3209 	DB	'z'
145C 0C 0E                 3210 	DW	GRP17
145E 74                    3211 	DB	74H
145F 65                    3212 	DB	'e'
1460 0C 0E                 3213 	DW	GRP17
1462 74                    3214 	DB	74H
1463 6C                    3215 	DB	'l'
1464 0C 0E                 3216 	DW	GRP17
1466 7C                    3217 	DB	7CH
1467 62                    3218 	DB	'b'
1468 0C 0E                 3219 	DW	GRP17
146A 72                    3220 	DB	72H
146B 61                    3221 	DB	'a'
146C 0C 0E                 3222 	DW	GRP17
146E 77                    3223 	DB	77H
146F 67                    3224 	DB	'g'
1470 0C 0E                 3225 	DW	GRP17
1472 7F                    3226 	DB	7FH
1473 6F                    3227 	DB	'o'
1474 0C 0E                 3228 	DW	GRP17
1476 70                    3229 	DB	70H
1477 73                    3230 	DB	's'
1478 0C 0E                 3231 	DW	GRP17
147A 78                    3232 	DB	78H
147B 63                    3233 	DB	'c'
147C 0C 0E                 3234 	DW	GRP17
147E 72                    3235 	DB	72H
147F                       3236 J3:
147F                       3237 	DB	17
147F 6D 70                 3238 	DB	'mp'
1481 2E 0D                 3239 	DW	GRP14
1483 EA                    3240 	DB	0EAH
1484 6E 7A                 3241 	DB	'nz'
1486 0C 0E                 3242 	DW	GRP17
1488 75                    3243 	DB	75H
1489 6E 65                 3244 	DB	'ne'
148B 0C 0E                 3245 	DW	GRP17
148D 75                    3246 	DB	75H
148E 6E 6C                 3247 	DB	'nl'
1490 0C 0E                 3248 	DW	GRP17
1492 7D                    3249 	DB	7DH
1493 67 65                 3250 	DB	'ge'
1495 0C 0E                 3251 	DW	GRP17
1497 7D                    3252 	DB	7DH
1498 6E 62                 3253 	DB	'nb'
149A 0C 0E                 3254 	DW	GRP17
149C 73                    3255 	DB	73H
149D 61 65                 3256 	DB	'ae'
149F 0C 0E                 3257 	DW	GRP17
14A1 73                    3258 	DB	73H
14A2 6E 63                 3259 	DB	'nc'
14A4 0C 0E                 3260 	DW	GRP17
14A6 73                    3261 	DB	73H
14A7 6E 67                 3262 	DB	'ng'
14A9 0C 0E                 3263 	DW	GRP17
14AB 7E                    3264 	DB	7EH
14AC 6C 65                 3265 	DB	'le'
14AE 0C 0E                 3266 	DW	GRP17
14B0 7E                    3267 	DB	7EH
14B1 6E 61                 3268 	DB	'na'
14B3 0C 0E                 3269 	DW	GRP17
14B5 76                    3270 	DB	76H
14B6 62 65                 3271 	DB	'be'
14B8 0C 0E                 3272 	DW	GRP17
14BA 76                    3273 	DB	76H
14BB 70 65                 3274 	DB	'pe'
14BD 0C 0E                 3275 	DW	GRP17
14BF 7A                    3276 	DB	7AH
14C0 6E 70                 3277 	DB	'np'
14C2 0C 0E                 3278 	DW	GRP17
14C4 7B                    3279 	DB	7BH
14C5 70 6F                 3280 	DB	'po'
14C7 0C 0E                 3281 	DW	GRP17
14C9 7B                    3282 	DB	7BH
14CA 6E 6F                 3283 	DB	'no'
14CC 0C 0E                 3284 	DW	GRP17
14CE 71                    3285 	DB	71H
14CF 6E 73                 3286 	DB	'ns'
14D1 0C 0E                 3287 	DW	GRP17
14D3 79                    3288 	DB	79H
14D4                       3289 J4:
14D4                       3290 	DB	6
14D4 6D 70 73              3291 	DB	'mps'
14D7 0C 0E                 3292 	DW	GRP17
14D9 EB                    3293 	DB	0EBH
14DA 63 78 7A              3294 	DB	'cxz'
14DD 0C 0E                 3295 	DW	GRP17
14DF E3                    3296 	DB	0E3H
14E0 6E 67 65              3297 	DB	'nge'
14E3 0C 0E                 3298 	DW	GRP17
14E5 7C                    3299 	DB	7CH
14E6 6E 61 65              3300 	DB	'nae'
14E9 0C 0E                 3301 	DW	GRP17
14EB 72                    3302 	DB	72H
14EC 6E 62 65              3303 	DB	'nbe'
14EF 0C 0E                 3304 	DW	GRP17
14F1 77                    3305 	DB	77H
14F2 6E 6C 65              3306 	DB	'nle'
14F5 0C 0E                 3307 	DW	GRP17
14F7 7F                    3308 	DB	7FH
14F8                       3309 L3:
14F8 E1                    3310 	DB	3
14F9 65 61                 3311 	DB	'ea'
14FB 37 0C                 3312 	DW	GRP6
14FD 8D                    3313 	DB	8DH
14FE 64 73                 3314 	DB	'ds'
1500 37 0C                 3315 	DW	GRP6
1502 C5                    3316 	DB	0C5H
1503 65 73                 3317 	DB	'es'
1505 37 0C                 3318 	DW	GRP6
1507 C4                    3319 	DB	0C4H
1508                       3320 L4:
1508                       3321 	DB	5
1508 6F 6F 70              3322 	DB	'oop'
150B 0C 0E                 3323 	DW	GRP17
150D E2                    3324 	DB	0E2H
150E 6F 64 62              3325 	DB	'odb'
1511 3D 0A                 3326 	DW	PUT
1513 AC                    3327 	DB	0ACH
1514 6F 64 77              3328 	DB	'odw'
1517 3D 0A                 3329 	DW	PUT
1519 AD                    3330 	DB	0ADH
151A 61 68 66              3331 	DB	'ahf'
151D 3D 0A                 3332 	DW	PUT
151F 9F                    3333 	DB	9FH
1520 6F 63 6B              3334 	DB	'ock'
1523 3D 0A                 3335 	DW	PUT
1525 F0                    3336 	DB	0F0H
1526                       3337 L5:
1526 D2                    3338 	DB	4
1527 6F 6F 70 65           3339 	DB	'oope'
152B 0C 0E                 3340 	DW	GRP17
152D E1                    3341 	DB	0E1H
152E 6F 6F 70 7A           3342 	DB	'oopz'
1532 0C 0E                 3343 	DW	GRP17
1534 E1                    3344 	DB	0E1H
1535 6F 64 73 62           3345 	DB	'odsb'
1539 3D 0A                 3346 	DW	PUT
153B AC                    3347 	DB	0ACH
153C 6F 64 73 77           3348 	DB	'odsw'
1540 3D 0A                 3349 	DW	PUT
1542 AD                    3350 	DB	0ADH
1543                       3351 L6:
1543                       3352 	DB	2
1543 6F 6F 70 6E 65        3353 	DB	'oopne'
1548 0C 0E                 3354 	DW	GRP17
154A E0                    3355 	DB	0E0H
154B 6F 6F 70 6E 7A        3356 	DB	'oopnz'
1550 0C 0E                 3357 	DW	GRP17
1552 E0                    3358 	DB	0E0H
1553                       3359 M3:
1553                       3360 	DB	2
1553 6F 76                 3361 	DB	'ov'
1555 D2 09                 3362 	DW	GRP1
1557 88                    3363 	DB	88H
1558 75 6C                 3364 	DB	'ul'
155A B2 0C                 3365 	DW	GRP10
155C 20                    3366 	DB	20H
155D                       3367 M4:
155D                       3368 	DB	2
155D 6F 76 62              3369 	DB	'ovb'
1560 3D 0A                 3370 	DW	PUT
1562 A4                    3371 	DB	0A4H
1563 6F 76 77              3372 	DB	'ovw'
1566 3D 0A                 3373 	DW	PUT
1568 A5                    3374 	DB	0A5H
1569                       3375 M5:
1569 DB                    3376 	DB	2
156A 6F 76 73 62           3377 	DB	'ovsb'
156E 3D 0A                 3378 	DW	PUT
1570 A4                    3379 	DB	0A4H
1571 6F 76 73 77           3380 	DB	'ovsw'
1575 3D 0A                 3381 	DW	PUT
1577 A5                    3382 	DB	0A5H
1578                       3383 N3:
1578                       3384 	DB	3
1578 6F 74                 3385 	DB	'ot'
157A 6C 0C                 3386 	DW	GRP9
157C 10                    3387 	DB	10H
157D 65 67                 3388 	DB	'eg'
157F 6C 0C                 3389 	DW	GRP9
1581 18                    3390 	DB	18H
1582 6F 70                 3391 	DB	'op'
1584 3D 0A                 3392 	DW	PUT
1586 90                    3393 	DB	90H
1587                       3394 O2:
1587 D4                    3395 	DB	1
1588 72                    3396 	DB	'r'
1589 07 0D                 3397 	DW	GRP13
158B 0A                    3398 	DB	0AH
158C                       3399 O3:
158C                       3400 	DB	2
158C 75 74                 3401 	DB	'ut'
158E A4 0B                 3402 	DW	GRP4
1590 E6                    3403 	DB	0E6H
1591 72 67                 3404 	DB	'rg'
1593 C9 0B                 3405 	DW	GRP5
1595                       3406 	DB	0
1595                       3407 O4:
1595                       3408 	DB	2
1595 75 74 62              3409 	DB	'utb'
1598 A4 0B                 3410 	DW	GRP4
159A E6                    3411 	DB	0E6H
159B 75 74 77              3412 	DB	'utw'
159E A4 0B                 3413 	DW	GRP4
15A0 E7                    3414 	DB	0E7H
15A1                       3415 P3:
15A1 D5                    3416 	DB	2
15A2 6F 70                 3417 	DB	'op'
15A4 D2 0E                 3418 	DW	GRP22
15A6 8F                    3419 	DB	8FH
15A7 75 74                 3420 	DB	'ut'
15A9 C9 0B                 3421 	DW	GRP5
15AB                       3422 	DB	3
15AB                       3423 P4:
15AB                       3424 	DB	2
15AB 75 73 68              3425 	DB	'ush'
15AE 15 0B                 3426 	DW	GRP2
15B0 FF                    3427 	DB	0FFH
15B1 6F 70 66              3428 	DB	'opf'
15B4 3D 0A                 3429 	DW	PUT
15B6 9D                    3430 	DB	9DH
15B7                       3431 P5:
15B7 D0                    3432 	DB	1
15B8 75 73 68 66           3433 	DB	'ushf'
15BC 3D 0A                 3434 	DW	PUT
15BE 9C                    3435 	DB	9CH
15BF                       3436 R3:
15BF                       3437 	DB	6
15BF 65 74                 3438 	DB	'et'
15C1 9D 0D                 3439 	DW	GRP16
15C3 C3                    3440 	DB	0C3H
15C4 65 70                 3441 	DB	'ep'
15C6 3D 0A                 3442 	DW	PUT
15C8 F3                    3443 	DB	0F3H
15C9 6F 6C                 3444 	DB	'ol'
15CB DF 0C                 3445 	DW	GRP12
15CD                       3446 	DB	0
15CD 6F 72                 3447 	DB	'or'
15CF DF 0C                 3448 	DW	GRP12
15D1                       3449 	DB	8
15D1 63 6C                 3450 	DB	'cl'
15D3 DF 0C                 3451 	DW	GRP12
15D5 10                    3452 	DB	10H
15D6 63 72                 3453 	DB	'cr'
15D8 DF 0C                 3454 	DW	GRP12
15DA 18                    3455 	DB	18H
15DB                       3456 R4:
15DB D1                    3457 	DB	2
15DC 65 70 7A              3458 	DB	'epz'
15DF 3D 0A                 3459 	DW	PUT
15E1 F3                    3460 	DB	0F3H
15E2 65 70 65              3461 	DB	'epe'
15E5 3D 0A                 3462 	DW	PUT
15E7 F3                    3463 	DB	0F3H
15E8                       3464 R5:
15E8 F1                    3465 	DB	2
15E9 65 70 6E 7A           3466 	DB	'epnz'
15ED 3D 0A                 3467 	DW	PUT
15EF F2                    3468 	DB	0F2H
15F0 65 70 6E 65           3469 	DB	'epne'
15F4 3D 0A                 3470 	DW	PUT
15F6 F2                    3471 	DB	0F2H
15F7                       3472 S3:
15F7                       3473 	DB	11
15F7 75 62                 3474 	DB	'ub'
15F9 3F 0C                 3475 	DW	GRP7
15FB 2A                    3476 	DB	2AH
15FC 62 62                 3477 	DB	'bb'
15FE 3F 0C                 3478 	DW	GRP7
1600 1A                    3479 	DB	1AH
1601 62 63                 3480 	DB	'bc'
1603 3F 0C                 3481 	DW	GRP7
1605 1A                    3482 	DB	1AH
1606 74 63                 3483 	DB	'tc'
1608 3D 0A                 3484 	DW	PUT
160A F9                    3485 	DB	0F9H
160B 74 64                 3486 	DB	'td'
160D 3D 0A                 3487 	DW	PUT
160F FD                    3488 	DB	0FDH
1610 74 69                 3489 	DB	'ti'
1612 3D 0A                 3490 	DW	PUT
1614 FB                    3491 	DB	0FBH
1615 68 6C                 3492 	DB	'hl'
1617 DF 0C                 3493 	DW	GRP12
1619 20                    3494 	DB	20H
161A 68 72                 3495 	DB	'hr'
161C DF 0C                 3496 	DW	GRP12
161E 28                    3497 	DB	28H
161F 61 6C                 3498 	DB	'al'
1621 DF 0C                 3499 	DW	GRP12
1623 20                    3500 	DB	20H
1624 61 72                 3501 	DB	'ar'
1626 DF 0C                 3502 	DW	GRP12
1628 38                    3503 	DB	38H
1629 65 67                 3504 	DB	'eg'
162B BC 0E                 3505 	DW	GRP21
162D 26                    3506 	DB	26H
162E                       3507 S4:
162E F6                    3508 	DB	5
162F 63 61 62              3509 	DB	'cab'
1632 3D 0A                 3510 	DW	PUT
1634 AE                    3511 	DB	0AEH
1635 63 61 77              3512 	DB	'caw'
1638 3D 0A                 3513 	DW	PUT
163A AF                    3514 	DB	0AFH
163B 74 6F 62              3515 	DB	'tob'
163E 3D 0A                 3516 	DW	PUT
1640 AA                    3517 	DB	0AAH
1641 74 6F 77              3518 	DB	'tow'
1644 3D 0A                 3519 	DW	PUT
1646 AB                    3520 	DB	0ABH
1647 61 68 66              3521 	DB	'ahf'
164A 3D 0A                 3522 	DW	PUT
164C 9E                    3523 	DB	9EH
164D                       3524 S5:
164D                       3525 	DB	4
164D 63 61 73 62           3526 	DB	'casb'
1651 3D 0A                 3527 	DW	PUT
1653 AE                    3528 	DB	0AEH
1654 63 61 73 77           3529 	DB	'casw'
1658 3D 0A                 3530 	DW	PUT
165A AF                    3531 	DB	0AFH
165B 74 6F 73 62           3532 	DB	'tosb'
165F 3D 0A                 3533 	DW	PUT
1661 AA                    3534 	DB	0AAH
1662 74 6F 73 77           3535 	DB	'tosw'
1666 3D 0A                 3536 	DW	PUT
1668 AB                    3537 	DB	0ABH
1669                       3538 T4:
1669 F1                    3539 	DB	1
166A 65 73 74              3540 	DB	'est'
166D AD 0E                 3541 	DW	GRP20
166F 84                    3542 	DB	84H
1670                       3543 U2:
1670                       3544 	DB	1
1670 70                    3545 	DB	'p'
1671 3D 0A                 3546 	DW	PUT
1673 FC                    3547 	DB	0FCH
1674                       3548 W4:
1674                       3549 	DB	1
1674 61 69 74              3550 	DB	'ait'
1677 3D 0A                 3551 	DW	PUT
1679 9B                    3552 	DB	9BH
167A                       3553 X3:
167A F0                    3554 	DB	1
167B 6F 72                 3555 	DB	'or'
167D 07 0D                 3556 	DW	GRP13
167F 32                    3557 	DB	32H
1680                       3558 X4:
1680                       3559 	DB	2
1680 63 68 67              3560 	DB	'chg'
1683 45 0B                 3561 	DW	GRP3
1685 86                    3562 	DB	86H
1686 6C 61 74              3563 	DB	'lat'
1689 3D 0A                 3564 	DW	PUT
168B D7                    3565 	DB	0D7H
168C                       3566 
168C                       3567 
168C                       3568 ; 8087 MNEMONIC TABLE
168C                       3569 ; Similar to 8086 table above, except NOT distinguished by opcode length
168C                       3570 
168C                       3571 XM1:	;F2XM1
168C                       3572 	DB	1		;One opcode
168C 78 6D B1              3573 	DB	"xm", '1'+ 080H
168F D0 F0                 3574 	DB	1,0F0H
1691                       3575 
1691                       3576 NDPA:
1691                       3577 	DB	3
1691 64 E4                 3578 	DB	"d", 'd'+ 080H
1693                       3579 	DB	6+ARITH,0C1H
1693 64 64 F0              3580 	DB	"dd", 'p'+ 080H
1696 90                    3581 	DB	NEEDOP+STACKOP,0
1697 62 F3                 3582 	DB	"b", 's'+ 080H
1699                       3583 	DB	1,0E1H
1699                       3584 
1699                       3585 NDPB:
1699                       3586 	DB	2
1699 6C E4                 3587 	DB	"l", 'd'+ 080H
169B                       3588 	DB	7+NEEDOP+MEMORY,20H
169B 73 74 F0              3589 	DB	"st", 'p'+ 080H
169E                       3590 	DB	7+NEEDOP+MEMORY,30H
169E                       3591 
169E                       3592 NDPC:
169E DF                    3593 	DB	5
169F 6F ED                 3594 	DB	"o", 'm'+ 080H
16A1                       3595 	DB	0+ONEREG+REAL,0D1H
16A1 6F 6D F0              3596 	DB	"om", 'p'+ 080H
16A4                       3597 	DB	0+ONEREG+REAL,0D9H
16A4 68 F3                 3598 	DB	"h", 's'+ 080H
16A6                       3599 	DB	1,0E0H
16A6 6F 6D 70 F0           3600 	DB	"omp", 'p'+ 080H
16AA                       3601 	DB	6,0D9H
16AA 6C 65 F8              3602 	DB	"le", 'x'+ 080H
16AD F0 E2                 3603 	DB	3,0E2H
16AF                       3604 
16AF                       3605 NDPD:
16AF D8                    3606 	DB	6
16B0 69 F6                 3607 	DB	"i", 'v'+ 080H
16B2                       3608 	DB	6+ARITH,0F1H
16B2 69 76 F0              3609 	DB	"iv", 'p'+ 080H
16B5 90 30                 3610 	DB	NEEDOP+STACKOP,30H
16B7 69 76 F2              3611 	DB	"iv", 'r'+ 080H
16BA                       3612 	DB	6+ARITH,0F9H
16BA 69 76 72 F0           3613 	DB	"ivr", 'p'+ 080H
16BE 90 38                 3614 	DB	NEEDOP+STACKOP,38H
16C0 65 63 73 74 F0        3615 	DB	"ecst", 'p'+ 080H
16C5 D3 F6                 3616 	DB	1,0F6H
16C7 69 73 E9              3617 	DB	"is", 'i'+ 080H
16CA                       3618 	DB	3,0E1H
16CA                       3619 
16CA                       3620 NDPE:
16CA                       3621 	DB	1
16CA 6E E9                 3622 	DB	"n", 'i'+ 080H
16CC D0 E0                 3623 	DB	3,0E0H
16CE                       3624 
16CE                       3625 NDPF:
16CE                       3626 	DB	1
16CE 72 65 E5              3627 	DB	"re", 'e'+ 080H
16D1                       3628 	DB	5+NEEDOP+ONEREG,0
16D1                       3629 
16D1                       3630 NDPI:
16D1                       3631 	DB	13
16D1 61 64 E4              3632 	DB	"ad", 'd'+ 080H
16D4                       3633 	DB	2+NEEDOP+INTEGER,0
16D4 6C E4                 3634 	DB	"l", 'd'+ 080H
16D6                       3635 	DB	3+NEEDOP+INTEGER+EXTENDED,0
16D6 73 75 E2              3636 	DB	"su", 'b'+ 080H
16D9                       3637 	DB	2+NEEDOP+INTEGER,20H
16D9 73 74 F0              3638 	DB	"st", 'p'+ 080H
16DC                       3639 	DB	3+NEEDOP+INTEGER+EXTENDED,18H
16DC 73 F4                 3640 	DB	"s", 't'+ 080H
16DE                       3641 	DB	3+NEEDOP+INTEGER,10H
16DE 6D 75 EC              3642 	DB	"mu", 'l'+ 080H
16E1                       3643 	DB	2+NEEDOP+INTEGER,8
16E1 64 69 F6              3644 	DB	"di", 'v'+ 080H
16E4                       3645 	DB	2+NEEDOP+INTEGER,30H
16E4 73 75 62 F2           3646 	DB	"sub", 'r'+ 080H
16E8                       3647 	DB	2+NEEDOP+INTEGER,28H
16E8 64 69 76 F2           3648 	DB	"div", 'r'+ 080H
16EC A1 38                 3649 	DB	2+NEEDOP+INTEGER,38H
16EE 63 6F ED              3650 	DB	"co", 'm'+ 080H
16F1                       3651 	DB	2+NEEDOP+INTEGER,10H
16F1 63 6F 6D F0           3652 	DB	"com", 'p'+ 080H
16F5                       3653 	DB	2+NEEDOP+INTEGER,18H
16F5 6E 63 73 74 F0        3654 	DB	"ncst", 'p'+ 080H
16FA                       3655 	DB	1,0F7H
16FA 6E 69 F4              3656 	DB	"ni", 't'+ 080H
16FD D0 E3                 3657 	DB	3,0E3H
16FF                       3658 
16FF                       3659 NDPL:
16FF                       3660 	DB	10
16FF                       3661 	DB	"", 'd'+ 080H
16FF                       3662 	DB	1+NEEDOP+ONEREG+REAL+EXTENDED,0
16FF 64 FA                 3663 	DB	"d", 'z'+ 080H
1701 D0 EE                 3664 	DB	1,0EEH
1703 64 B1                 3665 	DB	"d", '1'+ 080H
1705                       3666 	DB	1,0E8H
1705 64 70 E9              3667 	DB	"dp", 'i'+ 080H
1708 D6 EB                 3668 	DB	1,0EBH
170A 64 6C 32 F4           3669 	DB	"dl2", 't'+ 080H
170E                       3670 	DB	1,0E9H
170E 64 6C 32 E5           3671 	DB	"dl2", 'e'+ 080H
1712 D0 EA                 3672 	DB	1,0EAH
1714 64 6C 67 B2           3673 	DB	"dlg", '2'+ 080H
1718 D0 EC                 3674 	DB	1,0ECH
171A 64 6C 6E B2           3675 	DB	"dln", '2'+ 080H
171E D4 ED                 3676 	DB	1,0EDH
1720 64 63 F7              3677 	DB	"dc", 'w'+ 080H
1723                       3678 	DB	1+NEEDOP+MEMORY,28H
1723 64 65 6E F6           3679 	DB	"den", 'v'+ 080H
1727                       3680 	DB	1+NEEDOP+MEMORY,20H
1727                       3681 
1727                       3682 NDPM:
1727 D0                    3683 	DB	2
1728 75 EC                 3684 	DB	"u", 'l'+ 080H
172A                       3685 	DB	6+ARITH,0C9H
172A 75 6C F0              3686 	DB	"ul", 'p'+ 080H
172D 90 D2                 3687 	DB	NEEDOP+STACKOP,8
172F                       3688 
172F                       3689 NDPO:
172F F6                    3690 	DB	1
1730                       3691 	DB	"", 'p'+ 080H
1730                       3692 	DB	NEEDOP+1,0	;Flag special handling
1730                       3693 
1730                       3694 NDPN:
1730 D6                    3695 	DB	1
1731 6F F0                 3696 	DB	"o", 'p'+ 080H
1733                       3697 	DB	1,0D0H
1733                       3698 
1733                       3699 NDPP:
1733 F1                    3700 	DB	3
1734 72 65 ED              3701 	DB	"re", 'm'+ 080H
1737 D3 F8                 3702 	DB	1,0F8H
1739 74 61 EE              3703 	DB	"ta", 'n'+ 080H
173C FB F2                 3704 	DB	1,0F2H
173E 61 74 61 EE           3705 	DB	"ata", 'n'+ 080H
1742                       3706 	DB	1,0F3H
1742                       3707 
1742                       3708 NDPR:
1742 D6                    3709 	DB	2
1743 6E 64 69 6E F4        3710 	DB	"ndin", 't'+ 080H
1748                       3711 	DB	1,0FCH
1748 73 74 6F F2           3712 	DB	"sto", 'r'+ 080H
174C                       3713 	DB	5+NEEDOP+MEMORY,20H
174C                       3714 
174C                       3715 NDPS:
174C                       3716 	DB	12
174C                       3717 	DB	"", 't'+ 080H
174C E9 D0                 3718 	DB	5+NEEDOP+ONEREG+REAL,0D0H
174E 74 F0                 3719 	DB	"t", 'p'+ 080H
1750                       3720 	DB	7+NEEDOP+ONEREG+REAL+EXTENDED,0D8H
1750 75 E2                 3721 	DB	"u", 'b'+ 080H
1752                       3722 	DB	6+ARITH,0E1H
1752 75 62 F0              3723 	DB	"ub", 'p'+ 080H
1755 90 E0                 3724 	DB	NEEDOP+STACKOP,0E0H
1757 75 62 F2              3725 	DB	"ub", 'r'+ 080H
175A                       3726 	DB	6+ARITH,0E9H
175A 75 62 72 F0           3727 	DB	"ubr", 'p'+ 080H
175E 90 E8                 3728 	DB	NEEDOP+STACKOP,0E8H
1760 71 72 F4              3729 	DB	"qr", 't'+ 080H
1763 F1 FA                 3730 	DB	1,0FAH
1765 63 61 6C E5           3731 	DB	"cal", 'e'+ 080H
1769                       3732 	DB	1,0FDH
1769 61 76 E5              3733 	DB	"av", 'e'+ 080H
176C                       3734 	DB	5+NEEDOP+MEMORY,30H
176C 74 63 F7              3735 	DB	"tc", 'w'+ 080H
176F                       3736 	DB	1+NEEDOP+MEMORY,38H
176F 74 65 6E F6           3737 	DB	"ten", 'v'+ 080H
1773                       3738 	DB	1+NEEDOP+MEMORY,30H
1773 74 73 F7              3739 	DB	"ts", 'w'+ 080H
1776                       3740 	DB	5+NEEDOP+MEMORY,38H
1776                       3741 
1776                       3742 NDPT:
1776 F1                    3743 	DB	1
1777 73 F4                 3744 	DB	"s", 't'+ 080H
1779                       3745 	DB	1,0E4H
1779                       3746 
1779                       3747 NDPW:
1779                       3748 	DB	1
1779 61 69 F4              3749 	DB	"ai", 't'+ 080H
177C 80 F1                 3750 	DB	NEEDOP,0	;Flag special handling
177E                       3751 
177E                       3752 NDPX:
177E                       3753 	DB	3
177E 63 E8                 3754 	DB	"c", 'h'+ 080H
1780                       3755 	DB	1+ONEREG,0C9H
1780 61 ED                 3756 	DB	"a", 'm'+ 080H
1782 F1 E5                 3757 	DB	1,0E5H
1784 74 72 61 63 F4        3758 	DB	"trac", 't'+ 080H
1789                       3759 	DB	1,0F4H
1789                       3760 
1789                       3761 NDPY:
1789                       3762 	DB	2
1789 6C 32 F8              3763 	DB	"l2", 'x'+ 080H
178C                       3764 	DB	1,0F1H
178C 6C 32 78 70 B1        3765 	DB	"l2xp", '1'+ 080H
1791 F1 F9                 3766 	DB	1,0F9H
1793                       3767 
1793                       3768 
1793                       3769 OPTAB:
1793                       3770 ; Table of pointers  to mnemonics. For each letter of the alphabet (the
1793                       3771 ; starting letter of the mnemonic), there are 5 entries. Each entry
1793                       3772 ; corresponds to a mnemonic whose length is 2, 3, 4, 5, and 6 characters
1793                       3773 ; long, respectively. If there are no mnemonics for a given combination
1793                       3774 ; of first letter and length (such as A-2), then the corresponding entry
1793                       3775 ; points to NONE. Otherwise, it points to a place in the mnemonic table
1793                       3776 ; for that type.
1793                       3777 
1793                       3778 ; This table only needs to be modified if a mnemonic is added to a group
1793                       3779 ; previously marked NONE. Change the NONE to a label made up of the first
1793                       3780 ; letter of the mnemonic and its length, then add a new subsection to
1793                       3781 ; the mnemonic table in alphabetical order.
1793                       3782 
1793 65 13                 3783 	DW	NONE
1795 65 13                 3784 	DW	A3
1797 65 13                 3785 	DW	NONE
1799 89 13                 3786 	DW	A5
179B 65 13                 3787 	DW	NONE
179D 65 13                 3788 	DW	NONE	;B
179F 65 13                 3789 	DW	NONE
17A1 65 13                 3790 	DW	NONE
17A3 65 13                 3791 	DW	NONE
17A5 65 13                 3792 	DW	NONE
17A7 65 13                 3793 	DW	NONE	;C
17A9 8E 13                 3794 	DW	C3
17AB B1 13                 3795 	DW	C4
17AD C4 13                 3796 	DW	C5
17AF 65 13                 3797 	DW	NONE
17B1 D2 13                 3798 	DW	D2	;D
17B3 E3 13                 3799 	DW	D3
17B5 F7 13                 3800 	DW	D4
17B7 65 13                 3801 	DW	NONE
17B9 65 13                 3802 	DW	NONE
17BB FE 13                 3803 	DW	E2	;E
17BD 02 14                 3804 	DW	E3
17BF 65 13                 3805 	DW	NONE
17C1 11 14                 3806 	DW	E5
17C3 65 13                 3807 	DW	NONE
17C5 65 13                 3808 	DW	NONE	;F
17C7 65 13                 3809 	DW	NONE
17C9 65 13                 3810 	DW	NONE
17CB 65 13                 3811 	DW	NONE
17CD 65 13                 3812 	DW	NONE
17CF 65 13                 3813 	DW	NONE	;G
17D1 65 13                 3814 	DW	NONE
17D3 65 13                 3815 	DW	NONE
17D5 65 13                 3816 	DW	NONE
17D7 65 13                 3817 	DW	NONE
17D9 65 13                 3818 	DW	NONE	;H
17DB 18 14                 3819 	DW	H3
17DD 1D 14                 3820 	DW	H4
17DF 65 13                 3821 	DW	NONE
17E1 65 13                 3822 	DW	NONE
17E3 23 14                 3823 	DW	I2	;I
17E5 2B 14                 3824 	DW	I3
17E7 3F 14                 3825 	DW	I4
17E9 65 13                 3826 	DW	NONE
17EB 65 13                 3827 	DW	NONE
17ED 57 14                 3828 	DW	J2	;J
17EF 7F 14                 3829 	DW	J3
17F1 D4 14                 3830 	DW	J4
17F3 65 13                 3831 	DW	NONE
17F5 65 13                 3832 	DW	NONE
17F7 65 13                 3833 	DW	NONE	;K
17F9 65 13                 3834 	DW	NONE
17FB 65 13                 3835 	DW	NONE
17FD 65 13                 3836 	DW	NONE
17FF 65 13                 3837 	DW	NONE
1801 65 13                 3838 	DW	NONE	;L
1803 F8 14                 3839 	DW	L3
1805 08 15                 3840 	DW	L4
1807 26 15                 3841 	DW	L5
1809 43 15                 3842 	DW	L6
180B 65 13                 3843 	DW	NONE	;M
180D 53 15                 3844 	DW	M3
180F 5D 15                 3845 	DW	M4
1811 69 15                 3846 	DW	M5
1813 65 13                 3847 	DW	NONE
1815 65 13                 3848 	DW	NONE	;N
1817 78 15                 3849 	DW	N3
1819 65 13                 3850 	DW	NONE
181B 65 13                 3851 	DW	NONE
181D 65 13                 3852 	DW	NONE
181F 87 15                 3853 	DW	O2	;O
1821 8C 15                 3854 	DW	O3
1823 95 15                 3855 	DW	O4
1825 65 13                 3856 	DW	NONE
1827 65 13                 3857 	DW	NONE
1829 65 13                 3858 	DW	NONE	;P
182B A1 15                 3859 	DW	P3
182D AB 15                 3860 	DW	P4
182F B7 15                 3861 	DW	P5
1831 65 13                 3862 	DW	NONE
1833 65 13                 3863 	DW	NONE	;Q
1835 65 13                 3864 	DW	NONE
1837 65 13                 3865 	DW	NONE
1839 65 13                 3866 	DW	NONE
183B 65 13                 3867 	DW	NONE
183D 65 13                 3868 	DW	NONE	;R
183F BF 15                 3869 	DW	R3
1841 DB 15                 3870 	DW	R4
1843 E8 15                 3871 	DW	R5
1845 65 13                 3872 	DW	NONE
1847 65 13                 3873 	DW	NONE	;S
1849 F7 15                 3874 	DW	S3
184B 2E 16                 3875 	DW	S4
184D 4D 16                 3876 	DW	S5
184F 65 13                 3877 	DW	NONE
1851 65 13                 3878 	DW	NONE	;T
1853 65 13                 3879 	DW	NONE
1855 69 16                 3880 	DW	T4
1857 65 13                 3881 	DW	NONE
1859 65 13                 3882 	DW	NONE
185B 70 16                 3883 	DW	U2	;U
185D 65 13                 3884 	DW	NONE
185F 65 13                 3885 	DW	NONE
1861 65 13                 3886 	DW	NONE
1863 65 13                 3887 	DW	NONE
1865 65 13                 3888 	DW	NONE	;V
1867 65 13                 3889 	DW	NONE
1869 65 13                 3890 	DW	NONE
186B 65 13                 3891 	DW	NONE
186D 65 13                 3892 	DW	NONE
186F 65 13                 3893 	DW	NONE	;W
1871 65 13                 3894 	DW	NONE
1873 74 16                 3895 	DW	W4
1875 65 13                 3896 	DW	NONE
1877 65 13                 3897 	DW	NONE
1879 65 13                 3898 	DW	NONE	;X
187B 7A 16                 3899 	DW	X3
187D 80 16                 3900 	DW	X4
187F 65 13                 3901 	DW	NONE
1881 65 13                 3902 	DW	NONE
1883 65 13                 3903 	DW	NONE	;Y
1885 65 13                 3904 	DW	NONE
1887 65 13                 3905 	DW	NONE
1889 65 13                 3906 	DW	NONE
188B 65 13                 3907 	DW	NONE
188D 65 13                 3908 	DW	NONE	;Z
188F 65 13                 3909 	DW	NONE
1891 65 13                 3910 	DW	NONE
1893 65 13                 3911 	DW	NONE
1895 65 13                 3912 	DW	NONE
1897                       3913 
1897                       3914 NDPTAB:
1897                       3915 ;Lookup table for 8087 mnemonics. There is one entry for each letter of the
1897                       3916 ;alphabet
1897 91 16                 3917 	DW	NDPA
1899 99 16                 3918 	DW	NDPB
189B 9E 16                 3919 	DW	NDPC
189D AF 16                 3920 	DW	NDPD
189F CA 16                 3921 	DW	NDPE
18A1 CE 16                 3922 	DW	NDPF
18A3 65 13                 3923 	DW	NONE	;G
18A5 65 13                 3924 	DW	NONE	;H
18A7 D1 16                 3925 	DW	NDPI
18A9 65 13                 3926 	DW	NONE	;J
18AB 65 13                 3927 	DW	NONE	;K
18AD FF 16                 3928 	DW	NDPL
18AF 27 17                 3929 	DW	NDPM
18B1 30 17                 3930 	DW	NDPN
18B3 2F 17                 3931 	DW	NDPO
18B5 33 17                 3932 	DW	NDPP
18B7 65 13                 3933 	DW	NONE	;Q
18B9 42 17                 3934 	DW	NDPR
18BB 4C 17                 3935 	DW	NDPS
18BD 76 17                 3936 	DW	NDPT
18BF 65 13                 3937 	DW	NONE	;U
18C1 65 13                 3938 	DW	NONE	;V
18C3 79 17                 3939 	DW	NDPW
18C5 7E 17                 3940 	DW	NDPX
18C7 89 17                 3941 	DW	NDPY
18C9 65 13                 3942 	DW	NONE	;Z
18CB                       3943 
18CB                       3944 ;Error message table
18CB                       3945 
18CB                       3946 ERRTAB:
18CB                       3947 	DB	1, "Register not allowed in immediate valu", 'e'+ 080H
18CB D6 49 6E 64 65 78 20  3948 	DB	2, "Index or base register must be BP, BX, SI, or D", 'I'+ 080H
     6F 72 20 62 61 73 65 
     20 72 65 67 69 73 74 
     65 72 20 6D 75 73 74 
     20 62 65 20 42 50 2C 
     20 42 58 2C 20 53 49 
     2C 20 6F 72 20 44 C9 
18FC D0 4F 6E 6C 79 20 6F  3949 	DB	3, "Only one base register (BX, BP) allowe", 'd'+ 080H
     6E 65 20 62 61 73 65 
     20 72 65 67 69 73 74 
     65 72 20 28 42 58 2C 
     20 42 50 29 20 61 6C 
     6C 6F 77 65 E4       
1924                       3950 	DB	4, "Only one index register (SI or DI) allowe", 'd'+ 080H
1924                       3951 	DB	5, "Only addition allowed on register or undefined labe", 'l'+ 080H
1924 F1 4F 6E 6C 79 20 6F  3952 	DB	6, "Only one undefined label per expression allowe", 'd'+ 080H
     6E 65 20 75 6E 64 65 
     66 69 6E 65 64 20 6C 
     61 62 65 6C 20 70 65 
     72 20 65 78 70 72 65 
     73 73 69 6F 6E 20 61 
     6C 6C 6F 77 65 E4    
1954                       3953 	DB	7, "Illegal digit in hexadecimal numbe", 'r'+ 080H
1954 D6 49 6C 6C 65 67 61  3954 	DB	8, "Illegal digit in decimal numbe", 'r'+ 080H
     6C 20 64 69 67 69 74 
     20 69 6E 20 64 65 63 
     69 6D 61 6C 20 6E 75 
     6D 62 65 F2          
1974                       3955 	DB	10, "Illegal character in label or opcod", 'e'+ 080H
1974                       3956 	DB	11, "Label defined twic", 'e'+ 080H
1974                       3957 	DB	12, "Opcode not recognize", 'd'+ 080H
1974                       3958 	DB	20, "Invalid operan", 'd'+ 080H
1974                       3959 	DB	21, '", " and second operand expected'
1974                       3960 	DB	22, "Register mismatc", 'h'+ 080H
1974                       3961 	DB	23, "Immediate operand not allowe", 'd'+ 080H
1974                       3962 	DB	24, '"]" expecte', 'd'+ 080H
1974                       3963 	DB	25, "Two memory operands not allowe", 'd'+ 080H
1974                       3964 	DB	26, "Destination must not be immediate valu", 'e'+ 080H
1974                       3965 	DB	27, "Both operands must not be register", 's'+ 080H
1974                       3966 	DB	28, "Operand must be segment registe", 'r'+ 080H
1974                       3967 	DB	29, "First operand must be registe", 'r'+ 080H
1974                       3968 	DB	30, "Undefined label not allowe", 'd'+ 080H
1974                       3969 	DB	31, "Value out of rang", 'e'+ 080H
1974                       3970 	DB	32, "Missing or illegal operand size fla", 'g'+ 080H
1974                       3971 	DB	33, "Must have label on same lin", 'e'+ 080H
1974                       3972 	DB	35, "Zero-length string illega", 'l'+ 080H
1974                       3973 	DB	36, "ENDIF without I", 'F'+ 080H
1974                       3974 	DB	37, "One-character strings onl", 'y'+ 080H
1974                       3975 	DB	38, "Illegal expressio", 'n'+ 080H
1974                       3976 	DB	39, "End of string not foun", 'd'+ 080H
1974                       3977 	DB	100, "Undefined labe", 'l'+ 080H
1974                       3978 	DB	101, "Value out of range (forward", ')'+ 080H
1974                       3979 	DB	255
1974                       3980 
1974 2A 2A 2A 2A 2A 20 45  3981 ERRMES:	DB	'***** ERROR: ', ' '+ 080H
     52 52 4F 52 3A 20 A0 
1982                       3982 NOSPAC:	DB	13,10,'File creation error',13,10,"$"
1982                       3983 NOMEM:	DB	13,10,'Insufficient memory',13,10,'$'
1982                       3984 NOFILE:	DB	13,10,'File not found',13,10,'$'
1982                       3985 WRTERR:	DB	13,10,'Disk full',13,10,'$'
1982                       3986 BADDSK:	DB	13,10,'Bad disk specifier',13,10,'$'
1982                       3987 ERCNTM:	DB	13, 10, 13, 10, 'Error Count ', '='+ 080H
1982                       3988 SYMSIZE	DB	13, 10, 'Symbol Table size =', ' '+ 080H
1982 46 72 65 65 20 73 70  3989 FRESIZE	DB	'Free space =       ', ' '+ 080H
     61 63 65 20 3D 20 20 
     20 20 20 20 20 A0    
1996                       3990 SYMMES:	DB	13, 10, 'Symbol Tabl', 'e'+ 080H, 13, 10, 13, 10
1996 41 53 4D              3991 EXTEND:	DB	'ASM',0,0
1999                       3992 IFEND:	DB	5,'endif'
1999                       3993 IFNEST:	DB	2,'if'
1999 72 65 F4              3994 RETSTR:	DB	're', 't'+ 080H
199C                       3995 HEXFCB:	DB	0,'        HEX',0,0,0,0
199C                       3996 	DB	16 DUP(0)
199C                       3997 	DB	0,0,0,0,0
199C D9 20 20 20 20 20 20  3998 LSTFCB:	DB	0,'        PRN',0,0,0,0
     20 20 50 52 4E       
19A8                       3999 	DB	16 DUP(0)
19A8 D9                    4000 	DB	0,0,0,0,0
19A9                       4001 PC:	DW 0
19A9 F1 00                 4002 OLDPC:	DW 0
19AB                       4003 LABPT:	DW 0
19AB DA                    4004 FLAG:	DB 0
19AC                       4005 MAXFLG:	DB 0
19AC E4 00                 4006 ADDR:	DW 0
19AE                       4007 ALABEL:	DW 0
19AE EA 00                 4008 DATA:	DW 0
19B0                       4009 DLABEL:	DW 0
19B0                       4010 CON:	DW 0
19B0                       4011 UNDEF:	DW 0
19B0                       4012 LENID:	DB 0
19B0                       4013 IDTEXT:	DB	80  DUP(0)
19B0                       4014 CHR:	DB 0
19B0                       4015 SYM:	DB 0
19B0 FE 00                 4016 BASE:	DW 0
19B2 F0 00                 4017 HEAP:	DW 0
19B4                       4018 SYMFLG:	DB 0
19B4                       4019 SYMLIN:	DB 0
19B4                       4020 CODE:	DW 0
19B4 D9                    4021 DATSIZ:	DB 0
19B5                       4022 RELOC:	DB 0
19B5 F1                    4023 BCOUNT:	DB 0
19B6                       4024 COUNT:	DB 0
19B6 F0                    4025 ERR:	DB 0
19B7                       4026 LINE:	DW 0
19B7                       4027 HEXLEN:	DW 0
19B7                       4028 HEXADD:	DW 0
19B7                       4029 LASTAD:	DW 0
19B7                       4030 HEXCNT:	DB 0
19B7 F0                    4031 CHKSUM:	DB 0
19B8                       4032 LINFLG:	DB 0
19B8                       4033 PREV:	DB 0
19B8                       4034 IFFLG:	DB 0
19B8 D4                    4035 CHKLAB:	DB 0
19B9 D0 00                 4036 ERRCNT:	DW 0
19BB                       4037 LSTRET:	DW 0
19BB                       4038 RETPT:	DW 0
19BB                       4039 LSTDEV:	DW 0
19BB                       4040 SPC:	DB 0
19BB D0                    4041 NOWAIT:	DB 0
19BC                       4042 IX:	DW 0
19BC                       4043 IY:	DW 0
19BC                       4044 HEXPNT:	DW 0
19BC E6 00                 4045 LSTPNT:	DW 0
19BE 00                    4046 HEXBUF:	DB	HEXBUFSIZ DUP(0)
19BF 00                    4047 LSTBUF:	DB	LSTBUFSIZ DUP(0)
19C0                       4048 BUFPT:	DW 0
19C0 00                    4049 SRCBUF:	DB	BUFSIZ DUP(0)
19C1                       4050 	DB 100H DUP(0)
19C1                       4051 	ALIGN 2
19C2                       4052 STACK:	EQU	$
19C2                       4053 START:	EQU	$
19C2                       4054                                                                                                                                                                                                           