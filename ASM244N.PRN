0000                       0001 ; Seattle Computer Products 8086 Assembler  version 2.44
0000                       0002 ;   by Tim Paterson
0000                       0003 ; Runs on the 8086 under MS-DOS
0000                       0004 
0000                       0005 ;* * * * * * REVISION HISTORY * * * * * *
0000                       0006 ;
0000                       0007 ; 12/29/80  2.01  General release with 86-DOS version 0.34
0000                       0008 ; 02/22/81  2.10  Increased buffer size from 128 bytes to 1024 bytes
0000                       0009 ; 03/18/81  2.11  General cleanup and more documentation
0000                       0010 ; 03/24/81  2.20  Modify ESC handling for full 8087 operation
0000                       0011 ; 04/01/81  2.21  Fix date in HEX and PRN files; modify buffer handling
0000                       0012 ; 04/03/81  2.22  Fix 2.21 buffer handling
0000                       0013 ; 04/13/81  2.23  Re-open source file for listing to allow assembling CON:
0000                       0014 ; 04/28/81  2.24  Allow nested IFs
0000                       0015 ; 07/30/81  2.25  Add Intel string mnemonics; clean up a little
0000                       0016 ; 08/02/81  2.30  Re-write pass 2:
0000                       0017 ;			Always report errors to console
0000                       0018 ;			Exact byte lengths for HEX and PRN files
0000                       0019 ; 11/08/81  2.40  Add 8087 mnemonics; print full error messages;
0000                       0020 ;		  allow expressions with *, /, and ()
0000                       0021 ; 07/04/82  2.41  Fix Intel's 8087 "reverse-bit" bug; don't copy date
0000                       0022 ; 08/18/82  2.42  Increase stack from 80 to 256 (Damn! Overflowed again!)
0000                       0023 ; 01/05/83  2.43  Correct over-zealous optimization in 2.42
0000                       0024 ; 05/09/83  2.44  Add memory usage report
0000                       0025 ;
0000                       0026 ;* * * * * * * * * * * * * * * * * * * * *
0000                       0027 
0000                       0028 SYMWID:	EQU	5	;5 symbols per line in dump
0000                       0029 FCB:	EQU	5CH
0000                       0030 BUFSIZ:	EQU	1024	;Source code buffer
0000                       0031 LSTBUFSIZ:EQU	BUFSIZ	;List file buffer
0000                       0032 HEXBUFSIZ:EQU	70	;Hex file buffer (26*2 + 5*2 + 3 + EXTRA)
0000                       0033 EOL:	EQU	13	;ASCII carriage return
0000                       0034 OBJECT:	EQU	100H	;UDDEFAULT "PUT" ADDRESS
0000                       0035 
0000                       0036 ;System call function codes
0000                       0037 PRINTMES: EQU	9
0000                       0038 OPEN:	EQU	15
0000                       0039 CLOSE:	EQU	16
0000                       0040 READ:	EQU	20
0000                       0041 SETDMA:	EQU	26
0000                       0042 MAKE:	EQU	22
0000                       0043 BLKWRT:	EQU	40
0000                       0044 
0000                       0045 ;The following equates define some token values returned by GETSYM
0000                       0046 UNDEFID:EQU	0	;Undefined identifier (including no nearby RET)
0000                       0047 CONST:	EQU	1	;Constant (including $)
0000                       0048 REG:	EQU	2	;8-bit register
0000                       0049 XREG:	EQU	3	;16-bit register (except segment registers)
0000                       0050 SREG:	EQU	4	;Segment register
0000                       0051 FREG:	EQU	6	;8087 floating point register
0000                       0052 
0000                       0053 ;Bits to build 8087 opcode table entries
0000                       0054 ONEREG:	EQU	40H	;Single ST register OK as operand
0000                       0055 NEEDOP:	EQU	80H	;Must have an operand
0000                       0056 INTEGER:EQU	20H	;For integer operations
0000                       0057 REAL:	EQU	28H	;For real operations
0000                       0058 EXTENDED EQU	10H	;For Long integers or Temporary real
0000                       0059 MEMORY:	EQU	18H	;For general memory operations
0000                       0060 STACKOP:EQU	10H	;Two register arithmetic with pop
0000                       0061 ARITH:	EQU	8	;Non-pop arithmetic operations
0000                       0062 
0000                       0063 	org	0100H
0100 E9 74 00              0064 	JMP	BEGIN
0103                       0065 
0103 0D 0A 53 65 61 74 74  0066 HEADER:	DB	13,10,'Seattle Computer Products 8086 Assembler Version 2.44'
     6C 65 20 43 6F 6D 70 
     75 74 65 72 20 50 72 
     6F 64 75 63 74 73 20 
     38 30 38 36 20 41 73 
     73 65 6D 62 6C 65 72 
     20 56 65 72 73 69 6F 
     6E 20 32 2E 34 34    
013A 0D 0A 43 6F 70 79 72  0067 	DB	13,10,'Copyright 1979-1983 by Seattle Computer Products, Inc.'
     69 67 68 74 20 31 39 
     37 39 2D 31 39 38 33 
     20 62 79 20 53 65 61 
     74 74 6C 65 20 43 6F 
     6D 70 75 74 65 72 20 
     50 72 6F 64 75 63 74 
     73 2C 20 49 6E 63 2E 
0172 0D 0A 0D 0A 24        0068 	DB	13,10,13,10,'$'
0177                       0069 
0177                       0070 BEGIN:
0177 BC AE 1F              0071 	MOV	SP,STACK
017A BA 03 01              0072 	MOV	DX,HEADER
017D B4 09                 0073 	MOV	AH,PRINTMES
017F CD 21                 0074 	INT	33
0181 A0 6D 00              0075 	MOV	AL,[FCB+17]
0184 A2 AE 1F              0076 	MOV	[SYMFLG],AL	;Save symbol table request flag
0187 BE 65 00              0077 	MOV	SI,FCB+9	;Point to file extension
018A AC                    0078 	LODSB			;Get source drive letter
018B E8 F4 00              0079 	CALL	CHKDSK		;Valid drive?
018E 0A C0                 0080 	OR	AL,AL
0190 74 03                 0081 	JZ	UDDEFAULT		;If no extension, use existing drive spec
0192 A2 5C 00              0082 	MOV	[FCB],AL
0195                       0083 UDDEFAULT:
0195 AC                    0084 	LODSB			;Get HEX file drive letter
0196 3C 5A                 0085 	CMP	AL,'Z'		;Suppress HEX file?
0198 74 03                 0086 	JZ	L0000
019A E8 E5 00              0087 	CALL	CHKDSK
019D                       0088 L0000:	
019D A2 82 1F              0089 	MOV	[HEXFCB],AL
01A0 AC                    0090 	LODSB			;Get PRN file drive letter
01A1 B4 00                 0091 	MOV	AH,0		;Signal no PRN file
01A3 3C 5A                 0092 	CMP	AL,'Z'		;Suppress PRN file?
01A5 74 15                 0093 	JZ	NOPRN
01A7 3C 59                 0094 	CMP	AL,'Y'		;Print errors only on console?
01A9 74 11                 0095 	JZ	NOPRN
01AB B4 02                 0096 	MOV	AH,2
01AD 3C 58                 0097 	CMP	AL,'X'		;PRN file to console?
01AF 74 0B                 0098 	JZ	NOPRN
01B1 B4 04                 0099 	MOV	AH,4
01B3 3C 50                 0100 	CMP	AL,'P'		;PRN file to printer?
01B5 74 05                 0101 	JZ	NOPRN
01B7 E8 C8 00              0102 	CALL	CHKDSK
01BA B4 80                 0103 	MOV	AH,80H
01BC                       0104 NOPRN:
01BC A2 98 1F              0105 	MOV	[LSTFCB],AL
01BF 88 26 AE 1F           0106 	MOV	[LSTDEV],AH	;Flag device for list ouput
01C3 BE 71 1F              0107 	MOV	SI,EXTEND
01C6 BF 65 00              0108 	MOV	DI,FCB+9
01C9 A5                    0109 	MOVSW
01CA A4                    0110 	MOVSB			;Set extension to ASM
01CB A5                    0111 	MOVSW			;Zero extent field
01CC BA 5C 00              0112 	MOV	DX,FCB
01CF B4 0F                 0113 	MOV	AH,OPEN
01D1 CD 21                 0114 	INT	33
01D3 BB EC 1E              0115 	MOV	BX,NOFILE
01D6 0A C0                 0116 	OR	AL,AL
01D8 74 03                 0117 	JZ	$+5
01DA E9 7F 00              0118 	JMP	PRERR
01DD BA 82 1F              0119 	MOV	DX,HEXFCB
01E0 E8 81 00              0120 	CALL	MAKFIL
01E3 BA 98 1F              0121 	MOV	DX,LSTFCB
01E6 E8 7B 00              0122 	CALL	MAKFIL
01E9 33 C0                 0123 	XOR	AX,AX
01EB A3 68 00              0124 	MOV	[FCB+12],AX	;Zero CURRENT BLOCK field
01EE A2 7C 00              0125 	MOV	[FCB+32],AL	;Zero Next Record field
01F1                       0126 	MOV	WORD[FCB+14],BUFSIZ	;Set record size
***** ERROR:  "," and second operand expected
01F1                       0127 	MOV	WORD[BUFPT],SRCBUF	;Initialize buffer pointer
***** ERROR:  "," and second operand expected
01F1                       0128 	MOV	WORD[CODE],START+1	;POINTER TO NEXT BYTE OF INTERMEDIATE CODE
***** ERROR:  "," and second operand expected
01F1                       0129 	MOV	WORD[IY],START	;POINTER TO CURRENT RELOCATION BYTE
***** ERROR:  "," and second operand expected
01F1 33 C0                 0130 	XOR	AX,AX
01F3 A3 AE 1F              0131 	MOV	[PC],AX		;UDDEFAULT PROGRAM COUNTER
01F6 A3 AE 1F              0132 	MOV	[BASE],AX	;POINTER TO ROOT OF ID TREE=NIL
01F9 A3 AE 1F              0133 	MOV	[RETPT],AX	;Pointer to last RET record
01FC A2 AE 1F              0134 	MOV	[IFFLG],AL	;NOT WITHIN IF/ENDIF
01FF A2 AE 1F              0135 	MOV	[CHKLAB],AL	;LOOKUP ALL LABELS
0202 48                    0136 	DEC	AX
0203 A3 AE 1F              0137 	MOV	[LSTRET],AX	;Location of last RET
0206 A1 06 00              0138 	MOV	AX,[6]		;HL=END OF MEMORY
0209 A3 AE 1F              0139 	MOV	[HEAP],AX	;BACK END OF SYMBOL TABLE SPACE
020C                       0140 	MOV	WORD[BCOUNT],4	;CODE BYTES PER RELOCATION BYTE
***** ERROR:  "," and second operand expected
020C                       0141 
020C                       0142 ;Assemble each line of code
020C                       0143 
020C                       0144 LOOP:
020C E8 8A 00              0145 	CALL	NEXTCHR		;Get first character on line
020F 3C 1A                 0146 	CMP	AL,1AH
0211 74 1F                 0147 	JZ	ENDJ
0213 B0 FF                 0148 	MOV	AL,-1		;Flag that no tokens have been read yet
0215 A2 AE 1F              0149 	MOV	[SYM],AL
0218 E8 CD 06              0150 	CALL	ASMLIN		;Assemble the line
021B A0 AE 1F              0151 	MOV	AL,[SYM]
021E 3C FF                 0152 	CMP	AL,-1		;Any tokens found on line?
0220 75 03                 0153 	JNZ	L0002
0222 E8 A4 03              0154 	CALL	GETSYM		;If no tokens read yet, read first one
0225                       0155 L0002:	
0225 3C 3B                 0156 	CMP	AL,';'
0227 74 0C                 0157 	JZ	ENDLN
0229 3C 0D                 0158 	CMP	AL,EOL
022B 74 08                 0159 	JZ	ENDLN
022D B0 14                 0160 	MOV	AL,14H		;Garbage at end of line error
022F E9 00 00              0161 	JMP SHORT	ENDLIN
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0232 E9 5F 0E              0162 ENDJ:	JMP	UDEND
0235                       0163 
0235                       0164 ENDLN:
0235 32 C0                 0165 	XOR	AL,AL		;Flag no errors on line
0237                       0166 ENDLIN:
0237                       0167 ;AL = error code for line. Stack depth unknown
0237 BC AE 1F              0168 	MOV	SP,STACK
023A E8 03 00              0169 	CALL	NEXLIN
023D E9 00 00              0170 	JMP SHORT	LOOP
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0240                       0171 
0240                       0172 NEXLIN:
0240 B5 C0                 0173 	MOV	CH,0C0H		;Put end of line marker and error code (AL)
0242 E8 FB 08              0174 	CALL	PUTCD
0245 E8 D4 08              0175 	CALL	GEN1
0248 A0 AE 1F              0176 	MOV	AL,[CHR]
024B                       0177 GETEOL:
024B 3C 0A                 0178 	CMP	AL,10
024D 74 32                 0179 	JZ	GETEOLUDRET
024F 3C 1A                 0180 	CMP	AL,1AH
0251 74 DF                 0181 	JZ	ENDJ
0253 E8 43 00              0182 	CALL	NEXTCHR		;Scan over comments for linefeed
0256 E9 00 00              0183 	JMP SHORT	GETEOL
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0259                       0184 ABORT:
0259 BB D4 1E              0185 	MOV	BX,NOMEM
025C                       0186 PRERR:
025C 8B D3                 0187 	MOV	DX,BX
025E B4 09                 0188 	MOV	AH,PRINTMES
0260 CD 21                 0189 	INT	33
0262 CD 20                 0190 	INT	32
0264                       0191 
0264                       0192 MAKFIL:
0264 8B F2                 0193 	MOV	SI,DX
0266 AC                    0194 	LODSB			;Get drive select byte
0267 3C 20                 0195 	CMP	AL,20H		;If not valid, don't make file
0269 73 16                 0196 	JNC	MAKFILUDRET
026B B9 04 00              0197 	MOV	CX,4
026E 8B FE                 0198 	MOV	DI,SI
0270 BE 5D 00              0199 	MOV	SI,FCB+1
0273 F3                    0200 	REP
0274 A5                    0201 	MOVSW			;Copy source file name
0275 B4 16                 0202 	MOV	AH,MAKE
0277 CD 21                 0203 	INT	33
0279                       0204 	MOV	WORD[DI-9+14],1	;Set record length to 1 byte
***** ERROR:  "," and second operand expected
0279 BB BC 1E              0205 	MOV	BX,NOSPAC
027C 0A C0                 0206 	OR	AL,AL		;Success?
027E 75 DC                 0207 	JNZ	PRERR
0280 C3                    0208 	RET
0281                       0209 GETEOLUDRET:
0281                       0210 MAKFILUDRET:
0281                       0211 CHKDSKUDRET:
0281                       0212 MROPSUDRET:
0281 C3                    0213 	RET
0282                       0214 CHKDSK:
0282 2C 20                 0215 	SUB	AL,' '		;If not present, set zero flag
0284 74 FB                 0216 	JZ	CHKDSKUDRET
0286 2C 20                 0217 	SUB	AL,20H
0288 74 04                 0218 	JZ	DSKERR		;Must be in range A-O
028A 3C 10                 0219 	CMP	AL,'P'-'@'
028C 72 F3                 0220 	JC	CHKDSKUDRET
028E                       0221 DSKERR:
028E BB 0D 1F              0222 	MOV	BX,BADDSK
0291 E9 00 00              0223 	JMP SHORT	PRERR
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0294                       0224 ERROR:
0294 8A C1                 0225 	MOV	AL,CL
0296 E9 9E FF              0226 	JMP	ENDLIN
0299                       0227 
0299                       0228 NEXTCHR:
0299 8B 36 AE 1F           0229 	MOV	SI,[BUFPT]
029D 81 FE AE 1F           0230 	CMP	SI,SRCBUF
02A1 75 1A                 0231 	JNZ	GETCH
02A3                       0232 ;Buffer empty so refill it
02A3 52                    0233 	PUSH	DX
02A4 50                    0234 	PUSH	AX		;AH must be saved
02A5 8B D6                 0235 	MOV	DX,SI
02A7 B4 1A                 0236 	MOV	AH,SETDMA
02A9 CD 21                 0237 	INT	33
02AB BA 5C 00              0238 	MOV	DX,FCB
02AE B4 14                 0239 	MOV	AH,READ
02B0 CD 21                 0240 	INT	33
02B2 92                    0241 	XCHG	AX,DX		;Put error code in DL
02B3 58                    0242 	POP	AX		;Restore AH
02B4 8A C2                 0243 	MOV	AL,DL		;Error code back in AL
02B6 5A                    0244 	POP	DX
02B7 3C 01                 0245 	CMP	AL,1
02B9 B0 1A                 0246 	MOV	AL,1AH		;Possibly signal End of File
02BB 74 0A                 0247 	JZ	NOMOD		;If nothing read
02BD                       0248 GETCH:
02BD AC                    0249 	LODSB
02BE 81 FE AE 23           0250 	CMP	SI,SRCBUF+BUFSIZ
02C2 75 03                 0251 	JNZ	NOMOD
02C4 BE AE 1F              0252 	MOV	SI,SRCBUF
02C7                       0253 NOMOD:
02C7 89 36 AE 1F           0254 	MOV	[BUFPT],SI
02CB A2 AE 1F              0255 	MOV	[CHR],AL
02CE C3                    0256 	RET
02CF                       0257 
02CF                       0258 
02CF                       0259 MROPS:
02CF                       0260 
02CF                       0261 ; Get two operands and check for certain types, according to flag byte
02CF                       0262 ; in CL. OP code in CH. Returns only if immediate operation.
02CF                       0263 
02CF 51                    0264 	PUSH	CX		;Save type flags
02D0 E8 D9 00              0265 	CALL	GETOP
02D3 52                    0266 	PUSH	DX		;Save first operand
02D4 E8 CC 00              0267 	CALL	GETOP2
02D7 5B                    0268 	POP	BX		;First op in BX, second op in DX
02D8 B0 04                 0269 	MOV	AL,SREG		;Check for a segment register
02DA 3A C7                 0270 	CMP	AL,BH
02DC 74 41                 0271 	JZ	SEGCHK
02DE 3A C6                 0272 	CMP	AL,DH
02E0 74 3D                 0273 	JZ	SEGCHK
02E2 B0 01                 0274 	MOV	AL,CONST	;Check if the first operand is immediate
02E4 B1 1A                 0275 	MOV	CL,26
02E6 3A C7                 0276 	CMP	AL,BH
02E8 74 AA                 0277 	JZ	ERROR		;Error if so
02EA 59                    0278 	POP	CX		;Restore type flags
02EB 3A C6                 0279 	CMP	AL,DH		;If second operand is immediate, then done
02ED 74 92                 0280 	JZ	MROPSUDRET
02EF B0 00                 0281 	MOV	AL,UNDEFID	;Check for memory reference
02F1 3A C7                 0282 	CMP	AL,BH
02F3 74 50                 0283 	JZ	STORE		;Is destination memory?
02F5 3A C6                 0284 	CMP	AL,DH
02F7 74 56                 0285 	JZ	LOAD		;Is source memory?
02F9 F6 C1 01              0286 	TEST	CL,1		;Check if register-to-register operation OK
02FC B1 1B                 0287 	MOV	CL,27
02FE 74 94                 0288 	JZ	ERROR
0300 8A C6                 0289 	MOV	AL,DH
0302 3A C7                 0290 	CMP	AL,BH		;Registers must be of same length
0304                       0291 RR:
0304 B1 16                 0292 	MOV	CL,22
0306 75 8C                 0293 	JNZ	ERROR
0308                       0294 RR1:
0308 24 01                 0295 	AND	AL,1		;Get register length (1=16 bits)
030A 0A C5                 0296 	OR	AL,CH		;Or in to OP code
030C E8 00 08              0297 	CALL	PUT		;And write it
030F 59                    0298 	POP	CX		;Dump return address
0310 8A C3                 0299 	MOV	AL,BL
0312 02 C0                 0300 	ADD	AL,AL		;Rotate register number into middle position
0314 02 C0                 0301 	ADD	AL,AL
0316 02 C0                 0302 	ADD	AL,AL
0318 0C C0                 0303 	OR	AL,0C0H		;Set register-to-register mode
031A 0A C2                 0304 	OR	AL,DL		;Combine with other register number
031C E9 F0 07              0305 	JMP	PUT
031F                       0306 SEGCHK:
031F                       0307 ;Come here if at least one operand is a segment register
031F 59                    0308 	POP	CX		;Restore flags
0320 F6 C1 08              0309 	TEST	CL,8		;Check if segment register OK
0323 B1 16                 0310 	MOV	CL,22
0325 74 79                 0311 	JZ	ERR1
0327 B9 03 8E              0312 	MOV	CX,8E03H	;Segment register move OP code
032A B0 00                 0313 	MOV	AL,UNDEFID
032C 3A C6                 0314 	CMP	AL,DH		;Check if source is memory
032E 74 1F                 0315 	JZ	LOAD
0330 3A C7                 0316 	CMP	AL,BH		;Check if destination is memory
0332 74 11                 0317 	JZ	STORE
0334 B0 03                 0318 	MOV	AL,XREG
0336 2A C6                 0319 	SUB	AL,DH		;Check if source is 16-bit register
0338 74 CA                 0320 	JZ	RR		;If so, AL must be zero
033A B5 8C                 0321 	MOV	CH,8CH		;Change direction
033C 87 DA                 0322 	XCHG	DX,BX		;Flip which operand is first and second
033E B0 03                 0323 	MOV	AL,XREG
0340 2A C6                 0324 	SUB	AL,DH		;Let RR perform finish the test
0342 E9 00 00              0325 	JMP SHORT	RR
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0345                       0326 
0345                       0327 STORE:
0345 F6 C1 04              0328 	TEST	CL,004H		;Check if storing is OK
0348 75 52                 0329 	JNZ	STERR
034A 87 DA                 0330 	XCHG	DX,BX		;If so, flip operands
034C 80 E5 FD              0331 	AND	CH,0FDH		;   and zero direction bit
034F                       0332 LOAD:
034F B6 19                 0333 	MOV	DH,25
0351 3A C7                 0334 	CMP	AL,BH		;Check if memory-to-memory
0353 74 49                 0335 	JZ	MRERR
0355 8A C7                 0336 	MOV	AL,BH
0357 3C 02                 0337 	CMP	AL,REG		;Check if 8-bit operation
0359 75 07                 0338 	JNZ	XRG
035B B6 16                 0339 	MOV	DH,22
035D F6 C1 01              0340 	TEST	CL,1		;See if 8-bit operation is OK
0360 74 3C                 0341 	JZ	MRERR
0362                       0342 XRG:
0362 8A C2                 0343 	MOV	AL,DL
0364 2C 06                 0344 	SUB	AL,6		;Check for R/M mode 6 and register 0
0366 0A C3                 0345 	OR	AL,BL		;   meaning direct load/store of accumulator
0368 75 19                 0346 	JNZ	NOTAC
036A F6 C1 08              0347 	TEST	CL,8		;See if direct load/store of accumulator
036D 74 14                 0348 	JZ	NOTAC		;   means anything in this case
036F                       0349 ; Process direct load/store of accumulator
036F 8A C5                 0350 	MOV	AL,CH
0371 24 02                 0351 	AND	AL,2		;Preserve direction bit only
0373 34 02                 0352 	XOR	AL,2		;   but flip it
0375 0C A0                 0353 	OR	AL,0A0H		;Combine with OP code
0377 8A E8                 0354 	MOV	CH,AL
0379 8A C7                 0355 	MOV	AL,BH		;Check byte/word operation
037B 24 01                 0356 	AND	AL,1
037D 0A C5                 0357 	OR	AL,CH
037F 59                    0358 	POP	CX		;Dump return address
0380 E9 3B 08              0359 	JMP	PUTADD		;Write the address
0383                       0360 
0383                       0361 NOTAC:
0383 8A C7                 0362 	MOV	AL,BH
0385 24 01                 0363 	AND	AL,1		;Get byte/word bit
0387 22 C1                 0364 	AND	AL,CL		;But don't use it in word-only operations
0389 0A C5                 0365 	OR	AL,CH		;Combine with OP code
038B E8 81 07              0366 	CALL	PUT
038E 8A C3                 0367 	MOV	AL,BL
0390 02 C0                 0368 	ADD	AL,AL		;Rotate to middle position
0392 02 C0                 0369 	ADD	AL,AL
0394 02 C0                 0370 	ADD	AL,AL
0396 0A C2                 0371 	OR	AL,DL		;Combine register field
0398 59                    0372 	POP	CX		;Dump return address
0399 E9 22 08              0373 	JMP	PUTADD		;Write the address
039C                       0374 
039C                       0375 STERR:
039C B6 1D                 0376 	MOV	DH,29
039E                       0377 MRERR:
039E 8A CE                 0378 	MOV	CL,DH
03A0                       0379 
03A0 E9 F1 FE              0380 ERR1:	JMP	ERROR
03A3                       0381 
03A3                       0382 GETOP2:
03A3                       0383 ;Get the second operand: look for a comma and drop into GETOP
03A3 A0 AE 1F              0384 	MOV	AL,[SYM]
03A6 3C 2C                 0385 	CMP	AL,','
03A8 B1 15                 0386 	MOV	CL,21
03AA 75 F4                 0387 	JNZ	ERR1
03AC                       0388 
03AC                       0389 
03AC                       0390 GETOP:
03AC                       0391 
03AC                       0392 ; Get one operand. Operand may be a memory reference in brackets, a register,
03AC                       0393 ; or a constant. If a flag (such as "B" for byte operation) is encountered,
03AC                       0394 ; it is noted and processing continues to find the operand.
03AC                       0395 ;
03AC                       0396 ; On exit, AL (=DH) has the type of operand. Other information depends
03AC                       0397 ; on the actual operand:
03AC                       0398 ;
03AC                       0399 ; AL=DH=0  Memory Reference.  DL has the address mode properly prepared in
03AC                       0400 ; the 8086 R/M format (middle bits zero). The constant part of the address
03AC                       0401 ; is in ADDR. If an undefined label needs to be added to this, a pointer to
03AC                       0402 ; its information fields is in ALABEL, otherwise ALABEL is zero.
03AC                       0403 ;
03AC                       0404 ; AL=DH=1  Value. The constant part is in DATA. If an undefined label needs
03AC                       0405 ; to be added to this, a pointer to its information fields is in DLABEL,
03AC                       0406 ; otherwise DLABEL is zero. "$" and "RET" are in this class.
03AC                       0407 ;
03AC                       0408 ; AL=DH=2  8-bit Register. DL has the register number.
03AC                       0409 ;
03AC                       0410 ; AL=DH=3  16-bit Register. DL has the register number.
03AC                       0411 ;
03AC                       0412 ; AL=DH=4  Segment Register. DL has the register number.
03AC                       0413 
03AC E8 1A 02              0414 	CALL	GETSYM
03AF                       0415 GETOP1:
03AF                       0416 ;Enter here if we don't need a GETSYM first
03AF 3C 5B                 0417 	CMP	AL,'['		;Memory reference?
03B1 74 30                 0418 	JZ	MEM
03B3 3C 05                 0419 	CMP	AL,5		;Flag ("B", "W", etc.)?
03B5 74 57                 0420 	JZ	FLG
03B7 3C 02                 0421 	CMP	AL,REG		;8-Bit register?
03B9 74 20                 0422 	JZ	NREG
03BB 3C 03                 0423 	CMP	AL,XREG		;16-Bit register?
03BD 74 1C                 0424 	JZ	NREG
03BF 3C 04                 0425 	CMP	AL,SREG		;Segment register?
03C1 74 18                 0426 	JZ	NREG
03C3                       0427 VAL:				;Must be immediate
03C3 32 C0                 0428 	XOR	AL,AL		;No addressing modes allowed
03C5                       0429 VAL1:
03C5 E8 58 00              0430 	CALL	GETVAL
03C8 A1 AE 1F              0431 	MOV	AX,[CON]	;Defined part
03CB A3 AE 1F              0432 	MOV	[DATA],AX
03CE A1 AE 1F              0433 	MOV	AX,[UNDEF]	;Undefined part
03D1 A3 AE 1F              0434 	MOV	[DLABEL],AX
03D4 8A D5                 0435 	MOV	DL,CH
03D6 B6 01                 0436 	MOV	DH,CONST
03D8 8A C6                 0437 	MOV	AL,DH
03DA C3                    0438 	RET
03DB                       0439 NREG:
03DB 52                    0440 	PUSH	DX
03DC E8 EA 01              0441 	CALL	GETSYM
03DF 5A                    0442 	POP	DX
03E0 8A C6                 0443 	MOV	AL,DH
03E2 C3                    0444 	RET
03E3                       0445 MEM:
03E3 E8 E3 01              0446 	CALL	GETSYM
03E6 B0 01                 0447 	MOV	AL,1
03E8 E8 35 00              0448 	CALL	GETVAL
03EB A0 AE 1F              0449 	MOV	AL,[SYM]
03EE 3C 5D                 0450 	CMP	AL,']'
03F0 B1 18                 0451 	MOV	CL,24
03F2 75 AC                 0452 	JNZ	ERR1
03F4 E8 D2 01              0453 	CALL	GETSYM
03F7 8B 1E AE 1F           0454 	MOV	BX,[CON]
03FB 89 1E AE 1F           0455 	MOV	[ADDR],BX
03FF 8B 1E AE 1F           0456 	MOV	BX,[UNDEF]
0403 89 1E AE 1F           0457 	MOV	[ALABEL],BX
0407 8A D5                 0458 	MOV	DL,CH
0409 B6 00                 0459 	MOV	DH,UNDEFID
040B 8A C6                 0460 	MOV	AL,DH
040D C3                    0461 	RET
040E                       0462 FLG:
040E 3A 16 AE 1F           0463 	CMP	DL,[MAXFLG]	;Invalid flag for this operation?
0412 B1 27                 0464 	MOV	CL,27H
0414 7F 8A                 0465 	JG	ERR1
0416 E8 B0 01              0466 	CALL	GETSYM
0419 3C 2C                 0467 	CMP	AL,','
041B 74 8F                 0468 	JZ	GETOP
041D E9 00 00              0469 	JMP SHORT	GETOP1
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0420                       0470 
0420                       0471 
0420                       0472 GETVAL:
0420                       0473 
0420                       0474 ; Expression analyzer. On entry, if AL=0 then do not allow base or index
0420                       0475 ; registers. If AL=1, we are analyzing a memory reference, so allow base
0420                       0476 ; and index registers, and compute addressing mode when done. The constant
0420                       0477 ; part of the expression will be found in CON. If an undefined label is to
0420                       0478 ; be added to this, a pointer to its information fields will be found in
0420                       0479 ; UNDEF.
0420                       0480 
0420 8A E0                 0481 	MOV	AH,AL		;Flag is kept in AH
0422                       0482 	MOV	WORD[UNDEF],0
***** ERROR:  "," and second operand expected
0422 A0 AE 1F              0483 	MOV	AL,[SYM]
0425 E8 3E 00              0484 	CALL	EXPRESSION
0428 89 16 AE 1F           0485 	MOV	[CON],DX
042C 8A C4                 0486 	MOV	AL,AH
042E B5 00                 0487 	MOV	CH,0		;Initial mode
0430 A8 10                 0488 	TEST	AL,10H		;Test INDEX bit
0432                       0489 	RCL	AL,1		;BASE bit (zero flag not affected)
***** ERROR:  Invalid operand
0432 74 27                 0490 	JZ	NOIND		;Jump if not indexed, with BASE bit in carry
0434 F5                    0491 	CMC
0435                       0492 	RCL	CH,1		;Rotate in BASE bit
***** ERROR:  Invalid operand
0435                       0493 	RCL	AL,1		;BP bit
***** ERROR:  Invalid operand
0435                       0494 	RCL	CH,1
***** ERROR:  Invalid operand
0435                       0495 	RCL	AL,1		;DI bit
***** ERROR:  Invalid operand
0435                       0496 	RCL	CH,1		;The low 3 bits now have indexing mode
***** ERROR:  Invalid operand
0435                       0497 MODE:
0435 80 CD 80              0498 	OR	CH,080H		;If undefined label, force 16-bit displacement
0438                       0499 	TEST	WORD[UNDEF],-1
***** ERROR:  "," and second operand expected
0438 75 20                 0500 	JNZ	MODEUDRET
043A 8B 1E AE 1F           0501 	MOV	BX,[CON]
043E 8A C3                 0502 	MOV	AL,BL
0440 98                    0503 	CBW			;Extend sign
0441 3B C3                 0504 	CMP	AX,BX		;Is it a signed 8-bit number?
0443 75 15                 0505 	JNZ	MODEUDRET		;If not, use 16-bit displacement
0445 80 E5 7F              0506 	AND	CH,07FH		;Reset 16-bit displacement
0448 80 CD 40              0507 	OR	CH,040H		;Set 8-bit displacement
044B 0B DB                 0508 	OR	BX,BX
044D 75 0B                 0509 	JNZ	MODEUDRET		;Use it if not zero displacement
044F 80 E5 07              0510 	AND	CH,7		;Specify no displacement
0452 82 FD 06              0511 	CMP	CH,6		;Check for BP+0 addressing mode
0455 75 03                 0512 	JNZ	MODEUDRET
0457 80 CD 40              0513 	OR	CH,040H		;If BP+0, use 8-bit displacement
045A                       0514 MODEUDRET:
045A C3                    0515 	RET
045B                       0516 NOIND:
045B B5 06                 0517 	MOV	CH,6		;Try direct address mode
045D 73 FB                 0518 	JNC	MODEUDRET		;If no base register, that's right
045F                       0519 	RCL	AL,1		;Check BP bit
***** ERROR:  Invalid operand
045F 72 D4                 0520 	JC	MODE
0461 FE C5                 0521 	INC	CH		;If not, must be BX
0463 E9 00 00              0522 	JMP SHORT	MODE
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0466                       0523 
0466                       0524 EXPRESSION:
0466                       0525 ;Analyze arbitrary expression. Flag byte in AH.
0466                       0526 ;On exit, AL has type byte: 0=register or undefined label
0466 B5 FF                 0527 	MOV	CH,-1		;Initial type
0468 8B FA                 0528 	MOV	DI,DX
046A 33 D2                 0529 	XOR	DX,DX		;Initial value
046C 3C 2B                 0530 	CMP	AL,'+'
046E 74 0D                 0531 	JZ	PLSMNS
0470 3C 2D                 0532 	CMP	AL,'-'
0472 74 09                 0533 	JZ	PLSMNS
0474 B1 2B                 0534 	MOV	CL,'+'
0476 52                    0535 	PUSH	DX
0477 51                    0536 	PUSH	CX
0478 8B D7                 0537 	MOV	DX,DI
047A E9 00 00              0538 	JMP SHORT	OPERATE
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
047D                       0539 PLSMNS:
047D 8A C8                 0540 	MOV	CL,AL
047F 52                    0541 	PUSH	DX
0480 51                    0542 	PUSH	CX
0481 80 CC 04              0543 	OR	AH,4		;Flag that a sign was found
0484 E8 42 01              0544 	CALL	GETSYM
0487                       0545 OPERATE:
0487 E8 2B 00              0546 	CALL	TERM
048A 59                    0547 	POP	CX		;Recover operator
048B 5B                    0548 	POP	BX		;Recover current value
048C 87 DA                 0549 	XCHG	DX,BX
048E 22 E8                 0550 	AND	CH,AL
0490 0A C0                 0551 	OR	AL,AL		;Is it register or undefined label?
0492 74 17                 0552 	JZ	NOCON		;If so, then no constant part
0494 82 F9 2D              0553 	CMP	CL,"-"		;Subtract it?
0497 75 02                 0554 	JNZ	ADD
0499 F7 DB                 0555 	NEG	BX
049B                       0556 ADD:
049B 03 D3                 0557 	ADD	DX,BX
049D                       0558 NEXTERM:
049D A0 AE 1F              0559 	MOV	AL,[SYM]
04A0 3C 2B                 0560 	CMP	AL,'+'
04A2 74 D9                 0561 	JZ	PLSMNS
04A4 3C 2D                 0562 	CMP	AL,'-'
04A6 74 D5                 0563 	JZ	PLSMNS
04A8 8A C5                 0564 	MOV	AL,CH
04AA C3                    0565 	RET
04AB                       0566 NOCON:
04AB 82 F9 2D              0567 	CMP	CL,"-"
04AE 75 ED                 0568 	JNZ	NEXTERM
04B0                       0569 BADOP:
04B0 B1 05                 0570 	MOV	CL,5
04B2 E9 DF FD              0571 	JMP	ERROR
04B5                       0572 
04B5                       0573 TERM:
04B5 E8 3E 00              0574 	CALL	FACTOR
04B8                       0575 MULOP:
04B8 52                    0576 	PUSH	DX		;Save value
04B9 50                    0577 	PUSH	AX		;Save type
04BA E8 0C 01              0578 	CALL	GETSYM
04BD 59                    0579 	POP	CX
04BE 3C 2A                 0580 	CMP	AL,"*"
04C0 74 04                 0581 	JZ	GETFACT
04C2 3C 2F                 0582 	CMP	AL,"/"
04C4 75 2C                 0583 	JNZ	ENDTERM
04C6                       0584 GETFACT:
04C6 0A C9                 0585 	OR	CL,CL		;Can we operate on this type?
04C8 74 E6                 0586 	JZ	BADOP
04CA 50                    0587 	PUSH	AX		;Save operator
04CB E8 FB 00              0588 	CALL	GETSYM		;Get past operator
04CE E8 25 00              0589 	CALL	FACTOR
04D1 0A C0                 0590 	OR	AL,AL
04D3 74 DB                 0591 	JZ	BADOP
04D5 59                    0592 	POP	CX		;Recover operator
04D6 5D                    0593 	POP	BP		;And current value
04D7 95                    0594 	XCHG	AX,BP		;Save AH in BP
04D8 82 F9 2F              0595 	CMP	CL,"/"		;Do we divide?
04DB 75 0D                 0596 	JNZ	DOMUL
04DD 0B D2                 0597 	OR	DX,DX		;Dividing by zero?
04DF B1 29                 0598 	MOV	CL,29H
04E1 74 4F                 0599 	JZ	ERR2
04E3 8B DA                 0600 	MOV	BX,DX
04E5 33 D2                 0601 	XOR	DX,DX		;Make 32-bit dividend
04E7                       0602 	DIV	BX
***** ERROR:  Invalid operand
04E7 E9 00 00              0603 	JMP SHORT	NEXFACT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
04EA                       0604 DOMUL:
04EA                       0605 	MUL	DX
***** ERROR:  Invalid operand
04EA                       0606 NEXFACT:
04EA 8B D0                 0607 	MOV	DX,AX		;Result in DX
04EC 95                    0608 	XCHG	AX,BP		;Restore flags to AH
04ED B0 FF                 0609 	MOV	AL,-1		;Indicate a number
04EF E9 00 00              0610 	JMP SHORT	MULOP
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
04F2                       0611 ENDTERM:
04F2 5A                    0612 	POP	DX
04F3 8A C1                 0613 	MOV	AL,CL
04F5 C3                    0614 	RET
04F6                       0615 
04F6                       0616 FACTOR:
04F6 A0 AE 1F              0617 	MOV	AL,[SYM]
04F9 3C 01                 0618 	CMP	AL,CONST
04FB 74 43                 0619 	JZ	FACTORUDRET
04FD 3C 00                 0620 	CMP	AL,UNDEFID
04FF 74 57                 0621 	JZ	UVAL
0501 3C 28                 0622 	CMP	AL,"("
0503 74 48                 0623 	JZ	PAREN
0505 3C 22                 0624 	CMP	AL,'"'
0507 74 61                 0625 	JZ	STRING
0509 3C 27                 0626 	CMP	AL,"'"
050B 74 5D                 0627 	JZ	STRING
050D 3C 03                 0628 	CMP	AL,XREG		;Only 16-bit register may index
050F B1 14                 0629 	MOV	CL,20
0511 75 1F                 0630 	JNZ	ERR2
0513 F6 C4 01              0631 	TEST	AH,1		;Check to see if indexing is OK
0516 B1 01                 0632 	MOV	CL,1
0518 74 18                 0633 	JZ	ERR2
051A 8A C2                 0634 	MOV	AL,DL
051C B1 03                 0635 	MOV	CL,3
051E 2C 03                 0636 	SUB	AL,3		;Check for BX
0520 74 22                 0637 	JZ	BXJ
0522 2C 02                 0638 	SUB	AL,2		;Check for BP
0524 74 1B                 0639 	JZ	BPJ
0526 FE C8                 0640 	DEC	AL		;Check for SI
0528 B1 04                 0641 	MOV	CL,4
052A 74 0C                 0642 	JZ	SIJ
052C FE C8                 0643 	DEC	AL		;Check for DI
052E 74 05                 0644 	JZ	DIJ
0530 B1 02                 0645 	MOV	CL,2		;Invalid base/index register
0532 E9 5F FD              0646 ERR2:	JMP	ERROR
0535                       0647 DIJ:
0535 80 CC 20              0648 	OR	AH,20H		;Flag seeing index register DI
0538                       0649 SIJ:
0538 F6 C4 10              0650 	TEST	AH,10H		;Check if already seen index register
053B 75 F5                 0651 	JNZ	ERR2
053D 80 CC 10              0652 	OR	AH,10H		;Flag seeing index register
0540                       0653 FACTORUDRET:
0540 C3                    0654 	RET
0541                       0655 
0541                       0656 BPJ:
0541 80 CC 40              0657 	OR	AH,40H		;Flag seeing base register BP
0544                       0658 BXJ:
0544 F6 C4 80              0659 	TEST	AH,80H		;Check if already seen base register
0547 75 E9                 0660 	JNZ	ERR2
0549 80 CC 80              0661 	OR	AH,80H		;Flag seeing base register
054C C3                    0662 	RET
054D                       0663 
054D                       0664 PAREN:
054D E8 79 00              0665 	CALL	GETSYM		;Eat the "("
0550 E8 13 FF              0666 	CALL	EXPRESSION
0553                       0667 	CMP	BYTE[SYM],")"	;Better have closing paren
***** ERROR:  "," and second operand expected
0553 B1 14                 0668 	MOV	CL,20
0555 75 10                 0669 	JNZ	ERR30
0557 C3                    0670 	RET
0558                       0671 
0558                       0672 UVAL:
0558 B1 06                 0673 	MOV	CL,6
055A F6 C4 08              0674 	TEST	AH,8		;Check if undefined label has been seen
055D 75 08                 0675 	JNZ	ERR30
055F 80 CC 08              0676 	OR	AH,8		;Flag seeing undefined label
0562 89 1E AE 1F           0677 	MOV	[UNDEF],BX
0566 C3                    0678 	RET
0567                       0679 
0567 E9 2A FD              0680 ERR30:	JMP	ERROR
056A                       0681 
056A                       0682 STRING:
056A 8A E8                 0683 	MOV	CH,AL
056C A0 AE 1F              0684 	MOV	AL,[CHR]
056F 3A C5                 0685 	CMP	AL,CH
0571 B1 23                 0686 	MOV	CL,35
0573 8A D0                 0687 	MOV	DL,AL
0575 B6 00                 0688 	MOV	DH,0
0577 75 03                 0689 	JNZ	L0003
0579 E8 33 00              0690 	CALL	ZERLEN
057C                       0691 L0003:
057C E8 38 00              0692 	CALL	GETCHR
057F B1 25                 0693 	MOV	CL,37
0581 F6 C4 02              0694 	TEST	AH,2
0584 74 E1                 0695 	JZ	ERR30
0586 F6 C4 04              0696 	TEST	AH,4
0589 B1 26                 0697 	MOV	CL,38
058B 75 DA                 0698 	JNZ	ERR30
058D                       0699 STRGDAT:
058D 8A C2                 0700 	MOV	AL,DL
058F 3C 0D                 0701 	CMP	AL,EOL
0591 B1 27                 0702 	MOV	CL,39
0593 74 D2                 0703 	JZ	ERR30
0595 E8 77 05              0704 	CALL	PUT
0598 A0 AE 1F              0705 	MOV	AL,[DATSIZ]
059B 0A C0                 0706 	OR	AL,AL
059D 75 05                 0707 	JNZ	BYTSIZ
059F 8A C6                 0708 	MOV	AL,DH
05A1 E8 6B 05              0709 	CALL	PUT
05A4                       0710 BYTSIZ:
05A4 A0 AE 1F              0711 	MOV	AL,[CHR]
05A7 8A D0                 0712 	MOV	DL,AL
05A9 E8 0B 00              0713 	CALL	GETCHR
05AC E9 00 00              0714 	JMP SHORT	STRGDAT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
05AF                       0715 
05AF                       0716 ZERLEN:
05AF E8 E7 FC              0717 	CALL	NEXTCHR
05B2 3A C5                 0718 	CMP	AL,CH
05B4 75 B1                 0719 	JNZ	ERR30
05B6 C3                    0720 	RET
05B7                       0721 
05B7                       0722 GETCHR:
05B7 E8 DF FC              0723 	CALL	NEXTCHR
05BA 3A C5                 0724 	CMP	AL,CH
05BC 75 0A                 0725 	JNZ	GETCHRUDRET
05BE E8 D8 FC              0726 	CALL	NEXTCHR
05C1 3A C5                 0727 	CMP	AL,CH
05C3 74 03                 0728 	JZ	GETCHRUDRET
05C5 5B                    0729 	POP	BX		;Kill return address to STRGDAT loop
05C6 B0 FF                 0730 	MOV	AL,-1		;Flag type as constant
05C8                       0731 GETCHRUDRET:
05C8 C3                    0732 	RET
05C9                       0733 
05C9                       0734 GETSYM:
05C9                       0735 
05C9                       0736 ; The lexical scanner. Used only in the operand field. Returns with the token
05C9                       0737 ; in SYM and AL, sometimes with additional info in BX or DX.
05C9                       0738 ;
05C9                       0739 ; AL=SYM=0  Undefined label. BX has pointer to information fields.
05C9                       0740 ;
05C9                       0741 ; AL=SYM=1  Constant (or defined label). DX has value.
05C9                       0742 ;
05C9                       0743 ; AL=SYM=2,3,4  8-bit register, 16-bit register, or segment register,
05C9                       0744 ; respectively. DL has register number.
05C9                       0745 ;
05C9                       0746 ; AL=SYM=5  A mode flag (such as "B" for byte operation). Type of flag in DL
05C9                       0747 ; and also stored in FLAG: -1=no flags, 0=B, 1=W, 2=S, 3=L, 4=T.
05C9                       0748 ;
05C9                       0749 ; AL=SYM=6  8087 floating point register, ST(n) or ST. DL has register number.
05C9                       0750 ;
05C9                       0751 ; All other values are the ASCII code of the character. Note that this may
05C9                       0752 ; never be a letter or number.
05C9                       0753 
05C9 50                    0754 	PUSH	AX		;Save AH
05CA E8 22 00              0755 	CALL	GETSY
05CD 58                    0756 	POP	AX
05CE A0 AE 1F              0757 	MOV	AL,[SYM]
05D1                       0758 SCANBUDRET:
05D1 C3                    0759 	RET
05D2                       0760 
05D2                       0761 SCANB:
05D2 A0 AE 1F              0762 	MOV	AL,[CHR]
05D5                       0763 SCANT:
05D5 3C 20                 0764 	CMP	AL,' '
05D7 74 04                 0765 	JZ	NEXB
05D9 3C 09                 0766 	CMP	AL,9
05DB 75 F4                 0767 	JNZ	SCANBUDRET
05DD                       0768 NEXB:
05DD E8 B9 FC              0769 	CALL	NEXTCHR
05E0 E9 00 00              0770 	JMP SHORT	SCANT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
05E3                       0771 DOLLAR:
05E3 8B 16 AE 1F           0772 	MOV	DX,[OLDPC]
05E7 B0 01                 0773 	MOV	AL,CONST
05E9 A2 AE 1F              0774 	MOV	[SYM],AL
05EC                       0775 NEXTCHJ:
05EC E9 AA FC              0776 	JMP	NEXTCHR
05EF                       0777 
05EF                       0778 GETSY:
05EF E8 E0 FF              0779 	CALL	SCANB
05F2 3C 24                 0780 	CMP	AL,'$'
05F4 74 ED                 0781 	JZ	DOLLAR
05F6 A2 AE 1F              0782 	MOV	[SYM],AL
05F9 0C 20                 0783 	OR	AL,20H
05FB 3C 7B                 0784 	CMP	AL,'z'+1
05FD 73 ED                 0785 	JNC	NEXTCHJ
05FF 3C 61                 0786 	CMP	AL,'a'
0601 72 03                 0787 	JC	$+5
0603 E9 A4 00              0788 	JMP	LETTER
0606 3C 3A                 0789 	CMP	AL,'9'+1
0608 73 E2                 0790 	JNC	NEXTCHJ
060A 3C 30                 0791 	CMP	AL,'0'
060C 72 DE                 0792 	JC	NEXTCHJ
060E BB AE 1F              0793 	MOV	BX,SYM
0611                       0794 	MOV	BYTE[BX],CONST
***** ERROR:  "," and second operand expected
0611 E8 6B 00              0795 	CALL	READID
0614 4B                    0796 	DEC	BX
0615 8A 07                 0797 	MOV	AL,[BX]
0617 B1 07                 0798 	MOV	CL,7
0619 BB 00 00              0799 	MOV	BX,0
061C 3C 68                 0800 	CMP	AL,'h'
061E 75 03                 0801 	JNZ	$+5
0620 E9 22 00              0802 	JMP	HEX
0623 FE C1                 0803 	INC	CL
0625                       0804 	MOV	WORD[IX],ID
***** ERROR:  "," and second operand expected
0625                       0805 DEC:
0625 8B 36 AE 1F           0806 	MOV	SI,[IX]
0629 8A 04                 0807 	MOV	AL,[SI]
062B                       0808 	INC	WORD[IX]
***** ERROR:  Destination must not be immediate value
062B 3C 3A                 0809 	CMP	AL,'9'+1
062D 72 03                 0810 	JC	$+5
062F E9 62 FC              0811 	JMP	ERROR
0632 2C 30                 0812 	SUB	AL,'0'
0634 8B D3                 0813 	MOV	DX,BX
0636                       0814 	SHL	BX,1
***** ERROR:  Invalid operand
0636                       0815 	SHL	BX,1
***** ERROR:  Invalid operand
0636 03 DA                 0816 	ADD	BX,DX
0638                       0817 	SHL	BX,1
***** ERROR:  Invalid operand
0638 8A D0                 0818 	MOV	DL,AL
063A B6 00                 0819 	MOV	DH,0
063C 03 DA                 0820 	ADD	BX,DX
063E FE CD                 0821 	DEC	CH
0640 75 E3                 0822 	JNZ	DEC
0642 87 DA                 0823 	XCHG	DX,BX
0644 C3                    0824 	RET
0645                       0825 
0645                       0826 HEX:
0645 BA AE 1F              0827 	MOV	DX,ID
0648 FE CD                 0828 	DEC	CH
064A                       0829 HEX1:
064A 8B F2                 0830 	MOV	SI,DX
064C AC                    0831 	LODSB
064D 42                    0832 	INC	DX
064E 2C 30                 0833 	SUB	AL,'0'
0650 3C 0A                 0834 	CMP	AL,10
0652 72 06                 0835 	JC	GOTIT
0654 3C 37                 0836 	CMP	AL,'g'-'0'
0656 73 0B                 0837 	JNC	ERR4
0658 2C 27                 0838 	SUB	AL,'a'-10-'0'
065A                       0839 GOTIT:
065A                       0840 	SHL	BX,1
***** ERROR:  Invalid operand
065A                       0841 	SHL	BX,1
***** ERROR:  Invalid operand
065A                       0842 	SHL	BX,1
***** ERROR:  Invalid operand
065A                       0843 	SHL	BX,1
***** ERROR:  Invalid operand
065A 02 D8                 0844 	ADD	BL,AL
065C FE CD                 0845 	DEC	CH
065E 75 EA                 0846 	JNZ	HEX1
0660 87 DA                 0847 	XCHG	DX,BX
0662 C3                    0848 	RET
0663                       0849 
0663 E9 2E FC              0850 ERR4:	JMP	ERROR
0666                       0851 
0666                       0852 GETLET:
0666 E8 69 FF              0853 	CALL	SCANB
0669 3C 0D                 0854 	CMP	AL,EOL
066B F9                    0855 	STC
066C 74 3B                 0856 	JZ	GETLETUDRET
066E 3C 3B                 0857 	CMP	AL,';'
0670 F9                    0858 	STC
0671 74 36                 0859 	JZ	GETLETUDRET
0673 B1 0A                 0860 	MOV	CL,10
0675 0C 20                 0861 	OR	AL,20H
0677 3C 61                 0862 	CMP	AL,'a'
0679 72 E8                 0863 	JC	ERR4
067B 3C 7B                 0864 	CMP	AL,'z'+1
067D 73 E4                 0865 	JNC	ERR4
067F                       0866 READID:
067F BB AE 1F              0867 	MOV	BX,ID
0682 B5 00                 0868 	MOV	CH,0
0684                       0869 MOREID:
0684 88 07                 0870 	MOV	[BX],AL
0686 FE C5                 0871 	INC	CH
0688 43                    0872 	INC	BX
0689 E8 0D FC              0873 	CALL	NEXTCHR
068C 3C 30                 0874 	CMP	AL,'0'
068E 72 0E                 0875 	JC	NOMORE
0690 0C 20                 0876 	OR	AL,20H
0692 3C 7B                 0877 	CMP	AL,'z'+1
0694 73 08                 0878 	JNC	NOMORE
0696 3C 3A                 0879 	CMP	AL,'9'+1
0698 72 EA                 0880 	JC	MOREID
069A 3C 61                 0881 	CMP	AL,'a'
069C 73 E6                 0882 	JNC	MOREID
069E                       0883 NOMORE:
069E 8A C8                 0884 	MOV	CL,AL
06A0 8A C5                 0885 	MOV	AL,CH
06A2 A2 AE 1F              0886 	MOV	[LENID],AL
06A5 0A C0                 0887 	OR	AL,AL
06A7 8A C1                 0888 	MOV	AL,CL
06A9                       0889 GETLETUDRET:
06A9 C3                    0890 	RET
06AA                       0891 LETTER:
06AA E8 D2 FF              0892 	CALL	READID
06AD 8A C5                 0893 	MOV	AL,CH
06AF FE C8                 0894 	DEC	AL
06B1 75 14                 0895 	JNZ	NOFLG
06B3 A0 AE 1F              0896 	MOV	AL,[ID]
06B6 B9 05 00              0897 	MOV	CX,5
06B9 BF ED 06              0898 	MOV	DI,FLGTAB
06BC FC                    0899 	CLD
06BD F2                    0900 	REPNE
06BE AE                    0901 	SCASB			;See if one of B,W,S,L,T
06BF 74 1A                 0902 	JZ	SAVFLG		;Go save flag
06C1 32 C0                 0903 	XOR	AL,AL
06C3 8A 2E AE 1F           0904 	MOV	CH,[LENID]
06C7                       0905 NOFLG:
06C7 FE C8                 0906 	DEC	AL
06C9 53                    0907 	PUSH	BX
06CA 75 03                 0908 	JNZ	L0004
06CC E8 55 00              0909 	CALL	REGCHK
06CF                       0910 L0004:	
06CF 5B                    0911 	POP	BX
06D0 8A C6                 0912 	MOV	AL,DH
06D2 74 03                 0913 	JZ	SYMSAV
06D4 E8 ED 00              0914 	CALL	LOOKRET
06D7                       0915 SYMSAV:
06D7 A2 AE 1F              0916 	MOV	[SYM],AL
06DA C3                    0917 	RET
06DB                       0918 
06DB                       0919 SAVFLG:
06DB 8A D1                 0920 	MOV	DL,CL		;Need flag type in DL
06DD 86 0E AE 1F           0921 	XCHG	[FLAG],CL
06E1 82 F9 FF              0922 	CMP	CL,-1
06E4 B1 20                 0923 	MOV	CL,32
06E6 B0 05                 0924 	MOV	AL,5
06E8 74 ED                 0925 	JZ	SYMSAV
06EA E9 A7 FB              0926 ERRJ3:	JMP	ERROR
06ED                       0927 
06ED 74 6C 73 77 62        0928 FLGTAB:	DB	"tlswb"
06F2                       0929 
06F2                       0930 FPREG:
06F2                       0931 ;Have detected "ST" for 8087 floating point stack register
06F2 B2 00                 0932 	MOV	DL,0		;Default is ST(0)
06F4 E8 DB FE              0933 	CALL	SCANB		;Get next character
06F7 3C 28                 0934 	CMP	AL,"("		;Specifying register number?
06F9 75 24                 0935 	JNZ	HAVREG
06FB                       0936 ;Get register number
06FB E8 9B FB              0937 	CALL	NEXTCHR		;Skip over the "("
06FE E8 AB FC              0938 	CALL	GETOP		;A little recursion never hurt anybody
0701 3C 01                 0939 	CMP	AL,CONST	;Better have found a constant
0703 B1 14                 0940 	MOV	CL,20		;Operand error if not
0705 75 E3                 0941 	JNZ	ERRJ3
0707                       0942 	CMP	WORD[DLABEL],0	;Constant must be defined
***** ERROR:  "," and second operand expected
0707 B1 1E                 0943 	MOV	CL,30
0709 75 DF                 0944 	JNZ	ERRJ3
070B 8B 16 AE 1F           0945 	MOV	DX,[DATA]	;Get constant
070F 83 FA 07              0946 	CMP	DX,7		;Constant must be in range 0-7
0712 B1 1F                 0947 	MOV	CL,31
0714 77 D4                 0948 	JA	ERRJ3
0716 A0 AE 1F              0949 	MOV	AL,[SYM]
0719 3C 29                 0950 	CMP	AL,")"
071B B1 18                 0951 	MOV	CL,24
071D 75 CB                 0952 	JNZ	ERRJ3
071F                       0953 HAVREG:
071F B6 06                 0954 	MOV	DH,FREG
0721 32 C0                 0955 	XOR	AL,AL		;Zero set means register found
0723 C3                    0956 	RET
0724                       0957 
0724                       0958 REGCHK:
0724 BB AE 1F              0959 	MOV	BX,ID
0727                       0960 	CMP	WORD[BX],"s"+7400H	;"st"
***** ERROR:  "," and second operand expected
0727 74 C9                 0961 	JZ	FPREG
0729 8A 0F                 0962 	MOV	CL,[BX]
072B 43                    0963 	INC	BX
072C 8A 07                 0964 	MOV	AL,[BX]
072E BB 8B 07              0965 	MOV	BX,REGTAB
0731 B6 03                 0966 	MOV	DH,XREG
0733 B2 00                 0967 	MOV	DL,0
0735 3C 78                 0968 	CMP	AL,'x'
0737 74 3B                 0969 	JZ	SCANREG
0739 B6 02                 0970 	MOV	DH,REG
073B 3C 6C                 0971 	CMP	AL,'l'
073D 74 35                 0972 	JZ	SCANREG
073F B2 04                 0973 	MOV	DL,4
0741 3C 68                 0974 	CMP	AL,'h'
0743 74 2F                 0975 	JZ	SCANREG
0745 B6 04                 0976 	MOV	DH,SREG
0747 B2 00                 0977 	MOV	DL,0
0749 BB 8F 07              0978 	MOV	BX,SEGTAB
074C 3C 73                 0979 	CMP	AL,'s'
074E 74 24                 0980 	JZ	SCANREG
0750 B6 03                 0981 	MOV	DH,XREG
0752 3C 70                 0982 	CMP	AL,'p'
0754 74 11                 0983 	JZ	PREG
0756 3C 69                 0984 	CMP	AL,'i'
0758 75 0C                 0985 	JNZ	REGCHKUDRET
075A B2 06                 0986 	MOV	DL,6
075C 8A C1                 0987 	MOV	AL,CL
075E 3C 73                 0988 	CMP	AL,'s'
0760 74 04                 0989 	JZ	REGCHKUDRET
0762 FE C2                 0990 	INC	DL
0764 3C 64                 0991 	CMP	AL,'d'
0766                       0992 REGCHKUDRET:
0766 C3                    0993 	RET
0767                       0994 PREG:
0767 B2 04                 0995 	MOV	DL,4
0769 8A C1                 0996 	MOV	AL,CL
076B 3C 73                 0997 	CMP	AL,'s'
076D 74 04                 0998 	JZ	PREGUDRET
076F FE C2                 0999 	INC	DL
0771 3C 62                 1000 	CMP	AL,'b'
0773                       1001 PREGUDRET:
0773 C3                    1002 	RET
0774                       1003 SCANREG:
0774 8A C1                 1004 	MOV	AL,CL
0776 B9 04 00              1005 	MOV	CX,4
0779 FC                    1006 	CLD
077A 8B FB                 1007 	MOV	DI,BX
077C F2                    1008 	REPNZ
077D AE                    1009 	SCASB
077E 8B DF                 1010 	MOV	BX,DI
0780 75 08                 1011 	JNZ	SCANREGUDRET
0782 8A C1                 1012 	MOV	AL,CL
0784 02 C2                 1013 	ADD	AL,DL
0786 8A D0                 1014 	MOV	DL,AL
0788 32 C0                 1015 	XOR	AL,AL
078A                       1016 SCANREGUDRET:
078A                       1017 LOOKUDRET:
078A C3                    1018 	RET
078B 62 64 63 61           1019 REGTAB:	DB	'bdca'
078F                       1020 
078F 64 73 63 65           1021 SEGTAB:	DB	'dsce'
0793                       1022 
0793                       1023 LOOK:
0793 8A 2F                 1024 	MOV	CH,[BX]
0795 43                    1025 	INC	BX
0796 BA AE 1F              1026 	MOV	DX,ID
0799 E8 F1 00              1027 	CALL	CPSLP
079C 74 EC                 1028 	JZ	LOOKUDRET
079E 34 80                 1029 	XOR	AL,80H
07A0                       1030 	ROL	AL,1		;Make end-of-symbol bit least significant
***** ERROR:  Invalid operand
07A0 8A C8                 1031 	MOV	CL,AL
07A2 4B                    1032 	DEC	BX
07A3 8A 07                 1033 	MOV	AL,[BX]
07A5 34 80                 1034 	XOR	AL,80H
07A7                       1035 	ROL	AL,1
***** ERROR:  Invalid operand
07A7 3A C1                 1036 	CMP	AL,CL
07A9 73 04                 1037 	JNC	SMALL
07AB FE C5                 1038 	INC	CH
07AD FE C5                 1039 	INC	CH
07AF                       1040 SMALL:
07AF 8A D5                 1041 	MOV	DL,CH
07B1 B6 00                 1042 	MOV	DH,0
07B3 03 DA                 1043 	ADD	BX,DX
07B5 8B 17                 1044 	MOV	DX,[BX]
07B7 43                    1045 	INC	BX
07B8 8A C2                 1046 	MOV	AL,DL
07BA 0A C6                 1047 	OR	AL,DH
07BC F9                    1048 	STC
07BD 74 CB                 1049 	JZ	LOOKUDRET
07BF 87 DA                 1050 	XCHG	DX,BX
07C1 E9 00 00              1051 	JMP SHORT	LOOK
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
07C4                       1052 LOOKRET:
07C4 8A C5                 1053 	MOV	AL,CH
07C6 3C 03                 1054 	CMP	AL,3	;RET has 3 letters
07C8 75 4C                 1055 	JNZ	LOOKUP
07CA 4B                    1056 	DEC	BX
07CB                       1057 	OR	BYTE[BX],080H
***** ERROR:  "," and second operand expected
07CB BA 81 1F              1058 	MOV	DX,RETSTR+2
07CE                       1059 CHKRET:
07CE 8B F2                 1060 	MOV	SI,DX
07D0 AC                    1061 	LODSB
07D1 3A 07                 1062 	CMP	AL,[BX]
07D3 75 42                 1063 	JNZ	LOOKIT
07D5 4B                    1064 	DEC	BX
07D6 4A                    1065 	DEC	DX
07D7 FE CD                 1066 	DEC	CH
07D9 75 F3                 1067 	JNZ	CHKRET
07DB 8B 16 AE 1F           1068 	MOV	DX,[LSTRET]
07DF 8A C2                 1069 	MOV	AL,DL
07E1 22 C6                 1070 	AND	AL,DH
07E3 FE C0                 1071 	INC	AL
07E5 74 0F                 1072 	JZ	ALLRET
07E7 8B 1E AE 1F           1073 	MOV	BX,[PC]
07EB 2B DA                 1074 	SUB	BX,DX
07ED 8A C3                 1075 	MOV	AL,BL
07EF 98                    1076 	CBW
07F0 3B C3                 1077 	CMP	AX,BX		;Signed 8-bit number?
07F2 B0 01                 1078 	MOV	AL,1
07F4 74 1F                 1079 	JZ	CHKRETUDRET
07F6                       1080 ALLRET:
07F6 8B 1E AE 1F           1081 	MOV	BX,[RETPT]
07FA 8A C7                 1082 	MOV	AL,BH
07FC 0A C3                 1083 	OR	AL,BL
07FE B0 00                 1084 	MOV	AL,0
0800 75 13                 1085 	JNZ	CHKRETUDRET
0802 8B 1E AE 1F           1086 	MOV	BX,[HEAP]
0806 4B                    1087 	DEC	BX
0807 4B                    1088 	DEC	BX
0808 4B                    1089 	DEC	BX
0809 89 1E AE 1F           1090 	MOV	[HEAP],BX
080D 32 C0                 1091 	XOR	AL,AL
080F 88 07                 1092 	MOV	[BX],AL
0811 89 1E AE 1F           1093 	MOV	[RETPT],BX
0815                       1094 CHKRETUDRET:
0815 C3                    1095 	RET
0816                       1096 LOOKUP:
0816 4B                    1097 	DEC	BX
0817                       1098 	OR	BYTE[BX],080H
***** ERROR:  "," and second operand expected
0817                       1099 LOOKIT:
0817 8B 1E AE 1F           1100 	MOV	BX,[BASE]
081B 8A C7                 1101 	MOV	AL,BH
081D 0A C3                 1102 	OR	AL,BL
081F 74 1E                 1103 	JZ	EMPTY
0821 E8 6F FF              1104 	CALL	LOOK
0824 72 10                 1105 	JC	ENTER
0826 BA 04 00              1106 	MOV	DX,4
0829 03 DA                 1107 	ADD	BX,DX
082B 8A 07                 1108 	MOV	AL,[BX]
082D 0A C0                 1109 	OR	AL,AL
082F 74 04                 1110 	JZ	LOOKITUDRET
0831 43                    1111 	INC	BX
0832 8B 17                 1112 	MOV	DX,[BX]
0834 43                    1113 	INC	BX
0835                       1114 LOOKITUDRET:
0835 C3                    1115 	RET
0836                       1116 ENTER:
0836 53                    1117 	PUSH	BX		;Save pointer to link field
0837 E8 0D 00              1118 	CALL	CREATE		;Add the node
083A 5E                    1119 	POP	SI
083B 89 54 FF              1120 	MOV	[SI-1],DX	;Link new node
083E C3                    1121 	RET			;Zero was set by CREATE
083F                       1122 
083F                       1123 EMPTY:
083F E8 05 00              1124 	CALL	CREATE
0842 89 16 AE 1F           1125 	MOV	[BASE],DX
0846 C3                    1126 	RET
0847                       1127 
0847                       1128 
0847                       1129 CREATE:
0847                       1130 
0847                       1131 ; Add a new node to the identifier tree. The identifier is at ID with
0847                       1132 ; bit 7 of the last character set to one. The length of the identifier is
0847                       1133 ; in LENID, which is ID-1.
0847                       1134 ;
0847                       1135 ; Node format:
0847                       1136 ;	1. Length of identifier (1 byte)
0847                       1137 ;	2. Identifier (1-80 bytes)
0847                       1138 ;	3. Left link (2-byte pointer to alphabetically smaller identifiers)
0847                       1139 ;	4. Right link (0 if none larger)
0847                       1140 ;	5. Data field:
0847                       1141 ;	   a. Defined flag (0=undefined, 1=defined)
0847                       1142 ;	   b. Value (2 bytes)
0847                       1143 ;
0847                       1144 ; This routine returns with AL=zero and zero flag set (which indicates
0847                       1145 ; on return from LOOKUP that it has not yet been defined), DX points
0847                       1146 ; to start of new node, and BX points to data field of new node.
0847                       1147 
0847 A0 AE 1F              1148 	MOV	AL,[LENID]
084A 04 08                 1149 	ADD	AL,8		;Storage needed for the node
084C 8B 1E AE 1F           1150 	MOV	BX,[HEAP]
0850 8A D0                 1151 	MOV	DL,AL
0852 B6 00                 1152 	MOV	DH,0
0854 2B DA                 1153 	SUB	BX,DX		;Heap grows downward
0856 89 1E AE 1F           1154 	MOV	[HEAP],BX
085A 87 DA                 1155 	XCHG	DX,BX
085C 8B 1E AE 1F           1156 	MOV	BX,[CODE]	;Check to make sure there's enough
0860 3B DA                 1157 	CMP	BX,DX
0862 72 03                 1158 	JB	$+5
0864 E9 F2 F9              1159 	JMP	ABORT
0867 52                    1160 	PUSH	DX
0868 BB AE 1F              1161 	MOV	BX,LENID
086B 8A 0F                 1162 	MOV	CL,[BX]
086D FE C1                 1163 	INC	CL
086F B5 00                 1164 	MOV	CH,0
0871 FC                    1165 	CLD
0872 8B F3                 1166 	MOV	SI,BX
0874 8B FA                 1167 	MOV	DI,DX
0876 F3                    1168 	REP
0877 A4                    1169 	MOVSB			;Move identifier and length into node
0878 8B D7                 1170 	MOV	DX,DI
087A 8B DE                 1171 	MOV	BX,SI
087C B5 04                 1172 	MOV	CH,4
087E 87 DA                 1173 	XCHG	DX,BX
0880                       1174 NILIFY:
0880 88 0F                 1175 	MOV	[BX],CL		;Zero left and right links
0882 43                    1176 	INC	BX
0883 FE CD                 1177 	DEC	CH
0885 75 F9                 1178 	JNZ	NILIFY
0887 32 C0                 1179 	XOR	AL,AL		;Set zero flag
0889 88 07                 1180 	MOV	[BX],AL		;Zero defined flag
088B 5A                    1181 	POP	DX		;Restore pointer to node
088C C3                    1182 	RET
088D                       1183 
088D                       1184 CPSLP:
088D 8B F2                 1185 	MOV	SI,DX
088F AC                    1186 	LODSB
0890 3A 07                 1187 	CMP	AL,[BX]
0892 9F                    1188 	LAHF
0893 42                    1189 	INC	DX
0894 43                    1190 	INC	BX
0895 9E                    1191 	SAHF
0896 75 04                 1192 	JNZ	CPSLPUDRET
0898 FE CD                 1193 	DEC	CH
089A 75 F1                 1194 	JNZ	CPSLP
089C                       1195 CPSLPUDRET:
089C                       1196 GETLABUDRET:
089C C3                    1197 	RET
089D                       1198 GETLAB:
089D BB 00 00              1199 	MOV	BX,0
08A0 89 1E AE 1F           1200 	MOV	[LABPT],BX
08A4                       1201 	MOV	BYTE[FLAG],-1
***** ERROR:  "," and second operand expected
08A4 B6 00                 1202 	MOV	DH,0
08A6 A0 AE 1F              1203 	MOV	AL,[CHR]
08A9 3C 21                 1204 	CMP	AL,' '+1
08AB 72 03                 1205 	JC	NOT1
08AD 80 CE 01              1206 	OR	DH,001H
08B0                       1207 NOT1:
08B0 E8 B3 FD              1208 	CALL	GETLET
08B3 72 E7                 1209 	JC	GETLABUDRET
08B5 3C 3A                 1210 	CMP	AL,':'
08B7 75 06                 1211 	JNZ	LABCHK
08B9 E8 DD F9              1212 	CALL	NEXTCHR
08BC E9 00 00              1213 	JMP SHORT	LABEL
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
08BF                       1214 LABCHK:
08BF 0A C0                 1215 	OR	AL,AL
08C1 F6 C6 01              1216 	TEST	DH,001H
08C4 74 D6                 1217 	JZ	GETLABUDRET
08C6                       1218 LABEL:
08C6 A0 AE 1F              1219 	MOV	AL,[CHKLAB]
08C9 0A C0                 1220 	OR	AL,AL
08CB 74 03                 1221 	JZ	$+5
08CD E9 96 FD              1222 	JMP	GETLET
08D0 E8 43 FF              1223 	CALL	LOOKUP
08D3 B1 0B                 1224 	MOV	CL,11
08D5 75 0E                 1225 	JNZ	ERR5
08D7 8B 16 AE 1F           1226 	MOV	DX,[PC]
08DB                       1227 	MOV	BYTE[BX],1
***** ERROR:  "," and second operand expected
08DB 43                    1228 	INC	BX
08DC 89 17                 1229 	MOV	[BX],DX
08DE 89 1E AE 1F           1230 	MOV	[LABPT],BX
08E2 E9 81 FD              1231 	JMP	GETLET
08E5                       1232 
08E5 E9 AC F9              1233 ERR5:	JMP	ERROR
08E8                       1234 ASMLIN:
08E8                       1235 	MOV	BYTE[MAXFLG],1	;Allow only B and W flags normally
***** ERROR:  "," and second operand expected
08E8 8B 1E AE 1F           1236 	MOV	BX,[PC]
08EC 89 1E AE 1F           1237 	MOV	[OLDPC],BX
08F0 E8 AA FF              1238 	CALL	GETLAB
08F3 73 03                 1239 	JNC	$+5
08F5 E9 3D F9              1240 	JMP	ENDLN
08F8 BB AE 1F              1241 	MOV	BX,LENID
08FB 8A 07                 1242 	MOV	AL,[BX]
08FD B1 0C                 1243 	MOV	CL,12
08FF 2C 02                 1244 	SUB	AL,2
0901 8A E8                 1245 	MOV	CH,AL
0903 72 E0                 1246 	JC	ERR5
0905 43                    1247 	INC	BX
0906                       1248 	CMP	BYTE[BX],"f"	;See if an 8087 mnemonic
***** ERROR:  "," and second operand expected
0906 74 4C                 1249 	JZ	NDPOP
0908 3C 05                 1250 	CMP	AL,5
090A 73 D9                 1251 	JNC	ERR5
090C 8A 07                 1252 	MOV	AL,[BX]
090E 2C 61                 1253 	SUB	AL,'a'
0910 8A C8                 1254 	MOV	CL,AL
0912 02 C0                 1255 	ADD	AL,AL
0914 02 C0                 1256 	ADD	AL,AL
0916 02 C1                 1257 	ADD	AL,CL
0918 02 C5                 1258 	ADD	AL,CH
091A 02 C0                 1259 	ADD	AL,AL
091C BB A7 19              1260 	MOV	BX,OPTAB
091F 8A D0                 1261 	MOV	DL,AL
0921 B6 00                 1262 	MOV	DH,0
0923 03 DA                 1263 	ADD	BX,DX
0925 8B 1F                 1264 	MOV	BX,[BX]
0927 FE C5                 1265 	INC	CH
0929 8A CD                 1266 	MOV	CL,CH
092B 8A 27                 1267 	MOV	AH,[BX]
092D 43                    1268 	INC	BX
092E 0A E4                 1269 	OR	AH,AH
0930 74 18                 1270 	JZ	OPERR
0932                       1271 FINDOP:
0932 8A E9                 1272 	MOV	CH,CL
0934 BA AF 1F              1273 	MOV	DX,ID+1
0937 95                    1274 	XCHG	AX,BP		;Save count of opcodes in BP
0938 E8 52 FF              1275 	CALL	CPSLP
093B 74 12                 1276 	JZ	HAVOP
093D 95                    1277 	XCHG	AX,BP
093E B6 00                 1278 	MOV	DH,0
0940 8A D5                 1279 	MOV	DL,CH
0942 42                    1280 	INC	DX
0943 42                    1281 	INC	DX
0944 03 DA                 1282 	ADD	BX,DX
0946 FE CC                 1283 	DEC	AH
0948 75 E8                 1284 	JNZ	FINDOP
094A                       1285 OPERR:
094A B1 0C                 1286 	MOV	CL,12
094C E9 45 F9              1287 	JMP	ERROR
094F                       1288 
094F                       1289 HAVOP:
094F 8A 47 02              1290 	MOV	AL,[BX+2]	;Get opcode
0952 FF 27                 1291 	JMP	[BX]
0954                       1292 
0954                       1293 NDPOP:	;First letter is "F" so must be 8087 opcode ("Numeric Data Processor")
0954                       1294 	MOV	BYTE[MAXFLG],4	;Allow all type flags
***** ERROR:  "," and second operand expected
0954 43                    1295 	INC	BX
0955                       1296 	CMP	BYTE[BX],"n"	;"No-wait" form?
***** ERROR:  "," and second operand expected
0955 B4 00                 1297 	MOV	AH,0
0957 75 05                 1298 	JNZ	SAVNFLG
0959 B4 01                 1299 	MOV	AH,1
095B FE C8                 1300 	DEC	AL
095D 43                    1301 	INC	BX		;Skip over the "N"
095E                       1302 SAVNFLG:
095E 88 26 AE 1F           1303 	MOV	[NOWAIT],AH	;0 for wait, 1 for no wait
0962 3C 01                 1304 	CMP	AL,1
0964 72 E4                 1305 	JB	OPERR		;Not enough char left for valid opcode?
0966 3C 05                 1306 	CMP	AL,5
0968 77 E0                 1307 	JA	OPERR		;Too many?
096A 98                    1308 	CBW
096B 92                    1309 	XCHG	AX,DX		;Save length in DX
096C 8B F2                 1310 	MOV	SI,DX
096E                       1311 	OR	BYTE[SI+BX],80H	;Set high bit of last character
***** ERROR:  "," and second operand expected
096E 8A 07                 1312 	MOV	AL,[BX]		;Get first char of opcode
0970 43                    1313 	INC	BX
0971 2C 61                 1314 	SUB	AL,"a"
0973 72 27                 1315 	JB	TRY2XM1		;Go see if opcode starts with "2"
0975 3C 19                 1316 	CMP	AL,"z"-"a"
0977 77 D1                 1317 	JA	OPERR
0979 98                    1318 	CBW
097A                       1319 	SHL	AX,1		;Double to index into address table
***** ERROR:  Invalid operand
097A 96                    1320 	XCHG	AX,SI		;Put in index register
097B 8B BC AB 1A           1321 	MOV	DI,[SI+NDPTAB]	;Get start of opcode table for this letter
097F                       1322 LOOKNDP:
097F 8A 25                 1323 	MOV	AH,[DI]		;Number of opcodes starting with this letter
0981 0A E4                 1324 	OR	AH,AH
0983 74 C5                 1325 	JZ	OPERR		;Any start with this letter?
0985                       1326 FNDNDP:
0985 47                    1327 	INC	DI
0986 8B F3                 1328 	MOV	SI,BX		;Pointer to start of opcode
0988 8B CA                 1329 	MOV	CX,DX		;Get length of opcode
098A F3                    1330 	REPE
098B A6                    1331 	CMPSB			;Compare opcode to table entry
098C 74 30                 1332 	JZ	HAVNDP
098E 4F                    1333 	DEC	DI		;Back up in case that was last letter
098F B0 80                 1334 	MOV	AL,80H		;Look for char with high bit set
0991                       1335 ENDOP:
0991 AE                    1336 	SCASB
0992 77 FD                 1337 	JA	ENDOP
0994 47                    1338 	INC	DI		;Skip over info about opcode
0995 FE CC                 1339 	DEC	AH
0997 75 EC                 1340 	JNZ	FNDNDP
0999 E9 00 00              1341 OPERRJ:	JMP SHORT	OPERR
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
099C                       1342 
099C                       1343 TRY2XM1:
099C 3C D1                 1344 	CMP	AL,"2"-"a"
099E 75 AA                 1345 	JNZ	OPERR
09A0 BF 35 18              1346 	MOV	DI,XM1
09A3 E9 00 00              1347 	JMP SHORT	LOOKNDP
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
09A6                       1348 
09A6                       1349 SPECIALOP:
09A6 24 07                 1350 	AND	AL,7		;Mask to special op number
09A8 74 11                 1351 	JZ	FWAIT		;If zero, go handle FWAIT
09AA                       1352 ;Handle FNOP
09AA                       1353 	CMP	BYTE[NOWAIT],0	;Was "N" present (If not opcode was "FOP")
***** ERROR:  "," and second operand expected
09AA 74 9E                 1354 	JZ	OPERR
09AC B0 9B                 1355 	MOV	AL,9BH		;Need Wait opcode after all
09AE E8 5E 01              1356 	CALL	PUT
09B1 B0 D9                 1357 	MOV	AL,0D9H
09B3 E8 59 01              1358 	CALL	PUT
09B6 B0 D0                 1359 	MOV	AL,0D0H
09B8 E9 54 01              1360 	JMP	PUT
09BB                       1361 
09BB                       1362 FWAIT:
09BB                       1363 	CMP	BYTE[NOWAIT],0	;"FNWAIT" not legal
***** ERROR:  "," and second operand expected
09BB 75 DC                 1364 	JNZ	OPERRJ
09BD C3                    1365 	RET			;Nothing to do - "WAIT" already sent
09BE                       1366 
09BE                       1367 HAVNDP:
09BE 8B F7                 1368 	MOV	SI,DI
09C0                       1369 	CMP	BYTE[NOWAIT],0
***** ERROR:  "," and second operand expected
09C0 75 05                 1370 	JNZ	NWAIT
09C2 B0 9B                 1371 	MOV	AL,9BH		;Wait opcode
09C4 E8 48 01              1372 	CALL	PUT
09C7                       1373 NWAIT:
09C7 AD                    1374 	LODSW			;Get opcode info
09C8 A8 F8                 1375 	TEST	AL,0F8H		;Any operand bits set?
09CA 74 68                 1376 	JZ	NOOPS		;If no operands, output code
09CC A8 78                 1377 	TEST	AL,78H		;Special case?
09CE 74 D6                 1378 	JZ	SPECIALOP
09D0 50                    1379 	PUSH	AX
09D1 E8 F5 FB              1380 	CALL	GETSYM		;See if any operands
09D4 59                    1381 	POP	CX
09D5 3C 3B                 1382 	CMP	AL,";"
09D7 74 54                 1383 	JZ	NOOPCHK
09D9 3C 0D                 1384 	CMP	AL,EOL
09DB 74 50                 1385 	JZ	NOOPCHK
09DD 3C 06                 1386 	CMP	AL,FREG		;Is it 8087 register?
09DF 75 71                 1387 	JNZ	MEMOP
09E1 91                    1388 	XCHG	AX,CX
09E2 A8 40                 1389 	TEST	AL,ONEREG	;One register OK as operand?
09E4 75 37                 1390 	JNZ	PUTREG		;Yes - save it
09E6 A8 20                 1391 	TEST	AL,20H		;Memory-only operation?
09E8 B1 14                 1392 	MOV	CL,20
09EA 75 63                 1393 	JNZ	ERRJ4
09EC A8 18                 1394 	TEST	AL,18H		;Two-register operation?
09EE 7A 5F                 1395 	JPE	ERRJ4		;Must be exactly one bit set
09F0 52                    1396 	PUSH	DX		;Save register number
09F1 50                    1397 	PUSH	AX		;Save opcode
09F2 E8 D4 FB              1398 	CALL	GETSYM
09F5 3C 2C                 1399 	CMP	AL,","
09F7 B1 15                 1400 	MOV	CL,15H
09F9 75 54                 1401 	JNZ	ERRJ4
09FB E8 CB FB              1402 	CALL	GETSYM
09FE B1 14                 1403 	MOV	CL,20
0A00 3C 06                 1404 	CMP	AL,FREG
0A02 75 4B                 1405 	JNZ	ERRJ4
0A04 58                    1406 	POP	AX
0A05 5B                    1407 	POP	BX
0A06 34 02                 1408 	XOR	AL,2		;Flip "POP" bit
0A08 24 FB                 1409 	AND	AL,0FBH		;Reset direction bit to ST(0)
0A0A 0A DB                 1410 	OR	BL,BL		;Is first register ST(0)?
0A0C 74 0B                 1411 	JZ	ST0DEST
0A0E 87 DA                 1412 	XCHG	DX,BX
0A10 0A DB                 1413 	OR	BL,BL		;One of these must be ST(0)
0A12 75 3B                 1414 	JNZ	ERRJ4
0A14 34 04                 1415 	XOR	AL,4		;Flip direction
0A16 E9 00 00              1416 	JMP SHORT	PUTREG
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0A19                       1417 ST0DEST:
0A19 A8 02                 1418 	TEST	AL,2		;Is POP bit set?
0A1B 75 32                 1419 	JNZ	ERRJ4		;Don't allow destination ST(0) then pop
0A1D                       1420 PUTREG:
0A1D 80 E4 F8              1421 	AND	AH,0F8H		;Zero out register field
0A20 0A E2                 1422 	OR	AH,DL
0A22 80 CC C0              1423 	OR	AH,0C0H
0A25 50                    1424 	PUSH	AX
0A26 E8 A0 FB              1425 	CALL	GETSYM		;Get to next symbol
0A29 58                    1426 	POP	AX
0A2A E9 00 00              1427 	JMP SHORT	NOOPS
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0A2D                       1428 
0A2D                       1429 NOOPCHK:
0A2D 91                    1430 	XCHG	AX,CX
0A2E A8 80                 1431 	TEST	AL,80H		;Is no operands OK?
0A30 B1 14                 1432 	MOV	CL,20
0A32 75 1B                 1433 	JNZ	ERRJ4
0A34                       1434 NOOPS:
0A34                       1435 ;First test for FDIV or FSUB and reverse "R" bit if "D" bit is set
0A34 50                    1436 	PUSH	AX
0A35 25 05 E0              1437 	AND	AX,0E005H
0A38 3D 04 E0              1438 	CMP	AX,0E004H
0A3B 58                    1439 	POP	AX
0A3C 75 03                 1440 	JNZ	NOREV
0A3E 80 F4 08              1441 	XOR	AH,8		;Reverse "R" bit
0A41                       1442 NOREV:
0A41 24 07                 1443 	AND	AL,7
0A43 0C D8                 1444 	OR	AL,0D8H		;ESC hook
0A45 E8 C7 00              1445 	CALL	PUT
0A48 8A C4                 1446 	MOV	AL,AH
0A4A E9 C2 00              1447 	JMP	PUT
0A4D                       1448 
0A4D                       1449 BADFLAG:
0A4D B1 20                 1450 	MOV	CL,20H
0A4F E9 42 F8              1451 ERRJ4:	JMP	ERROR
0A52                       1452 
0A52                       1453 MEMOP:
0A52 51                    1454 	PUSH	CX		;Save opcode
0A53 E8 59 F9              1455 	CALL	GETOP1		;Get memory operand
0A56 3C 00                 1456 	CMP	AL,UNDEFID	;Is it?
0A58 B1 14                 1457 	MOV	CL,20
0A5A 75 F3                 1458 	JNZ	ERRJ4
0A5C 58                    1459 	POP	AX
0A5D A8 20                 1460 	TEST	AL,20H		;Does it have memory format field?
0A5F 75 08                 1461 	JNZ	GETFORMAT
0A61 A8 08                 1462 	TEST	AL,8		;Check if any memory operand legal
0A63 74 EA                 1463 	JZ	ERRJ4
0A65 A8 10                 1464 	TEST	AL,10H		;Check for 2-op arithmetic
0A67 75 1C                 1465 	JNZ	PUTMEM		;If not, just use as plain memory op
0A69                       1466 GETFORMAT:
0A69 24 F9                 1467 	AND	AL,0F9H		;Zero memory format bits
0A6B 8A 0E AE 1F           1468 	MOV	CL,[FLAG]
0A6F FE C9                 1469 	DEC	CL		;Must now be in range 0-3
0A71 7C DA                 1470 	JL	BADFLAG
0A73 8A E8                 1471 	MOV	CH,AL		;Save opcode byte
0A75                       1472 	SHR	AL,1		;Put format bits in bits 2 & 3
***** ERROR:  Invalid operand
0A75 24 0C                 1473 	AND	AL,0CH
0A77 0A C1                 1474 	OR	AL,CL		;Combine format bits with flag
0A79 BB 95 0A              1475 	MOV	BX,FORMATTAB
0A7C D7                    1476 	XLAT
0A7D 0A C0                 1477 	OR	AL,AL		;Valid combination?
0A7F 78 CC                 1478 	JS	BADFLAG
0A81 0A E0                 1479 	OR	AH,AL		;Possibly set new bits in second byte
0A83 0A C5                 1480 	OR	AL,CH		;Set memory format bits
0A85                       1481 PUTMEM:
0A85 24 07                 1482 	AND	AL,7
0A87 0C D8                 1483 	OR	AL,0D8H
0A89 E8 83 00              1484 	CALL	PUT
0A8C 8A C4                 1485 	MOV	AL,AH
0A8E 24 38                 1486 	AND	AL,38H
0A90 0A C2                 1487 	OR	AL,DL		;Combine addressing mode
0A92 E9 29 01              1488 	JMP	PUTADD
0A95                       1489 
0A95                       1490 FORMATTAB:
0A95                       1491 ;There are 16 entries in this table. The 4-bit index is built like this:
0A95                       1492 ;	Bit 3		0 for normal memory ops, 1 if extended is OK
0A95                       1493 ;	Bit 2		0 for integer, 1 for real
0A95                       1494 ;	Bit 0 & 1	Flag: 00=W, 01=S, 10=L, 11=T
0A95                       1495 ;
0A95                       1496 ;The entries in the table are used as two 3-bit fields. Bits 0-2 are ORed
0A95                       1497 ;into the first byte of the opcode for the Memory Format field. Bits 3-6
0A95                       1498 ;are ORed into the second byte to modify the opcode for extended operands.
0A95                       1499 ;If bit 7 is set, then that combination is illegal.
0A95                       1500 
0A95 06 02 80 80           1501 	DB	6,2,80H,80H	;Normal integers
0A99 80 00 04 80           1502 	DB	80H,0,4,80H	;Normal reals
0A9D 06 02 2E 80           1503 	DB	6,2,2EH,80H	;Extended integers
0AA1 80 00 04 2B           1504 	DB	80H,0,4,2BH	;Extended reals
0AA5                       1505 
0AA5                       1506 GRP1:
0AA5 B9 09 8A              1507 	MOV	CX,8A09H
0AA8 E8 24 F8              1508 	CALL	MROPS
0AAB B9 C6 00              1509 	MOV	CX,0C6H
0AAE 8A C7                 1510 	MOV	AL,BH
0AB0 3C 00                 1511 	CMP	AL,UNDEFID
0AB2 75 03                 1512 	JNZ	L0006
0AB4 E8 3C 00              1513 	CALL	STIMM
0AB7                       1514 L0006:	
0AB7 24 01                 1515 	AND	AL,1
0AB9 74 0A                 1516 	JZ	BYTIMM
0ABB B0 B8                 1517 	MOV	AL,0B8H
0ABD 0A C3                 1518 	OR	AL,BL
0ABF E8 4D 00              1519 	CALL	PUT
0AC2 E9 85 00              1520 	JMP	PUTWOR
0AC5                       1521 
0AC5                       1522 BYTIMM:
0AC5 B0 B0                 1523 	MOV	AL,0B0H
0AC7 0A C3                 1524 	OR	AL,BL
0AC9 E8 43 00              1525 	CALL	PUT
0ACC E9 83 00              1526 PUTBJ:	JMP	PUTBYT
0ACF                       1527 
0ACF                       1528 IMMED:
0ACF 8A C7                 1529 	MOV	AL,BH
0AD1 3C 00                 1530 	CMP	AL,UNDEFID
0AD3 74 1E                 1531 	JZ	STIMM
0AD5 8A C3                 1532 	MOV	AL,BL
0AD7 0A C0                 1533 	OR	AL,AL
0AD9 74 33                 1534 	JZ	IMMEDUDRET
0ADB 8A C7                 1535 	MOV	AL,BH
0ADD E8 1F 00              1536 	CALL	IMM
0AE0 0C C0                 1537 	OR	AL,0C0H
0AE2 E8 2A 00              1538 	CALL	PUT
0AE5                       1539 FINIMM:
0AE5 8A C1                 1540 	MOV	AL,CL
0AE7 59                    1541 	POP	CX
0AE8 A8 01                 1542 	TEST	AL,1
0AEA 74 E0                 1543 	JZ	PUTBJ
0AEC 3C 83                 1544 	CMP	AL,83H
0AEE 74 DC                 1545 	JZ	PUTBJ
0AF0 E9 57 00              1546 	JMP	PUTWOR
0AF3                       1547 STIMM:
0AF3 A0 AE 1F              1548 	MOV	AL,[FLAG]
0AF6 E8 06 00              1549 	CALL	IMM
0AF9 E8 C2 00              1550 	CALL	PUTADD
0AFC E9 00 00              1551 	JMP SHORT	FINIMM
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0AFF                       1552 
0AFF                       1553 IMM:
0AFF 24 01                 1554 	AND	AL,1
0B01 0A C1                 1555 	OR	AL,CL
0B03 8A C8                 1556 	MOV	CL,AL
0B05 E8 07 00              1557 	CALL	PUT
0B08 8A C5                 1558 	MOV	AL,CH
0B0A 24 38                 1559 	AND	AL,38H
0B0C 0A C3                 1560 	OR	AL,BL
0B0E                       1561 IMMEDUDRET:
0B0E C3                    1562 	RET
0B0F                       1563 
0B0F                       1564 PUT:
0B0F                       1565 ;Save byte in AL as pure code, with intermediate code bits 00. AL and
0B0F                       1566 ;DI destroyed, no other registers affected.
0B0F 53                    1567 	PUSH	BX
0B10 51                    1568 	PUSH	CX
0B11 B5 00                 1569 	MOV	CH,0		;Flag as pure code
0B13 E8 03 00              1570 	CALL	GEN
0B16 59                    1571 	POP	CX
0B17 5B                    1572 	POP	BX
0B18 C3                    1573 	RET
0B19                       1574 
0B19                       1575 GEN:
0B19                       1576 ;Save byte of code in AL, given intermediate code bits in bits 7&8 of CH.
0B19 E8 24 00              1577 	CALL	PUTINC		;Save it and bump code pointer
0B1C                       1578 GEN1:
0B1C A0 AE 1F              1579 	MOV	AL,[RELOC]
0B1F                       1580 	RCL	CH,1
***** ERROR:  Invalid operand
0B1F                       1581 	RCL	AL,1
***** ERROR:  Invalid operand
0B1F                       1582 	RCL	CH,1
***** ERROR:  Invalid operand
0B1F                       1583 	RCL	AL,1
***** ERROR:  Invalid operand
0B1F A2 AE 1F              1584 	MOV	[RELOC],AL
0B22 BB AE 1F              1585 	MOV	BX,BCOUNT
0B25                       1586 	DEC	BYTE[BX]
***** ERROR:  Destination must not be immediate value
0B25 75 18                 1587 	JNZ	GENUDRET
0B27                       1588 	MOV	BYTE[BX],4
***** ERROR:  "," and second operand expected
0B27 BB AE 1F              1589 	MOV	BX,RELOC
0B2A 8A 07                 1590 	MOV	AL,[BX]
0B2C                       1591 	MOV	BYTE[BX],0
***** ERROR:  "," and second operand expected
0B2C 8B 3E AE 1F           1592 	MOV	DI,[IY]
0B30 88 05                 1593 	MOV	[DI],AL
0B32 8B 1E AE 1F           1594 	MOV	BX,[CODE]
0B36 89 1E AE 1F           1595 	MOV	[IY],BX
0B3A 43                    1596 	INC	BX
0B3B 89 1E AE 1F           1597 	MOV	[CODE],BX
0B3F                       1598 GENUDRET:
0B3F C3                    1599 	RET
0B40                       1600 PUTINC:
0B40                       1601 	INC	WORD[PC]
***** ERROR:  Destination must not be immediate value
0B40                       1602 PUTCD:
0B40 8B 3E AE 1F           1603 	MOV	DI,[CODE]
0B44 AA                    1604 	STOSB
0B45 89 3E AE 1F           1605 	MOV	[CODE],DI
0B49 C3                    1606 	RET
0B4A                       1607 
0B4A                       1608 PUTWOR:
0B4A                       1609 ;Save the word value described by [DLABEL] and [DATA] as code. If defined,
0B4A                       1610 ;two bytes of pure code will be produced. Otherwise, appropriate intermediate
0B4A                       1611 ;code will be generated.
0B4A 51                    1612 	PUSH	CX
0B4B B5 80                 1613 	MOV	CH,80H
0B4D 52                    1614 	PUSH	DX
0B4E 53                    1615 	PUSH	BX
0B4F E9 00 00              1616 	JMP SHORT	PUTBW
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0B52                       1617 
0B52                       1618 PUTBYT:
0B52                       1619 ;Same as PUTWOR, above, but for byte value.
0B52 51                    1620 	PUSH	CX
0B53 B5 40                 1621 	MOV	CH,40H
0B55 52                    1622 	PUSH	DX
0B56 53                    1623 	PUSH	BX
0B57 8B 1E AE 1F           1624 	MOV	BX,[DLABEL]
0B5B 8A C7                 1625 	MOV	AL,BH
0B5D 0A C3                 1626 	OR	AL,BL
0B5F 75 11                 1627 	JNZ	PUTBW
0B61 8B 1E AE 1F           1628 	MOV	BX,[DATA]
0B65 0A C7                 1629 	OR	AL,BH
0B67 74 09                 1630 	JZ	PUTBW
0B69 FE C7                 1631 	INC	BH
0B6B 74 05                 1632 	JZ	PUTBW
0B6D B1 1F                 1633 	MOV	CL,31
0B6F E9 22 F7              1634 	JMP	ERROR
0B72                       1635 PUTBW:
0B72 8B 16 AE 1F           1636 	MOV	DX,[DLABEL]
0B76 8B 1E AE 1F           1637 	MOV	BX,[DATA]
0B7A                       1638 PUTCHK:
0B7A 0B D2                 1639 	OR	DX,DX
0B7C 74 26                 1640 	JZ	NOUNDEF
0B7E 8A C2                 1641 	MOV	AL,DL
0B80 E8 BD FF              1642 	CALL	PUTCD
0B83 8A C6                 1643 	MOV	AL,DH
0B85 E8 B8 FF              1644 	CALL	PUTCD
0B88 8A C3                 1645 	MOV	AL,BL
0B8A E8 B3 FF              1646 	CALL	PUTINC
0B8D 8A C7                 1647 	MOV	AL,BH
0B8F F6 C5 80              1648 	TEST	CH,080H
0B92 74 06                 1649 	JZ	SMPUT
0B94 E8 82 FF              1650 	CALL	GEN
0B97 E9 00 00              1651 	JMP SHORT	PRET
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0B9A                       1652 SMPUT:
0B9A E8 A3 FF              1653 	CALL	PUTCD
0B9D E8 7C FF              1654 	CALL	GEN1
0BA0                       1655 PRET:
0BA0 5B                    1656 	POP	BX
0BA1 5A                    1657 	POP	DX
0BA2 59                    1658 	POP	CX
0BA3 C3                    1659 	RET
0BA4                       1660 
0BA4                       1661 NOUNDEF:
0BA4 8A C3                 1662 	MOV	AL,BL
0BA6 8A CF                 1663 	MOV	CL,BH
0BA8 51                    1664 	PUSH	CX
0BA9 B5 00                 1665 	MOV	CH,0
0BAB E8 6B FF              1666 	CALL	GEN
0BAE 59                    1667 	POP	CX
0BAF 8A C1                 1668 	MOV	AL,CL
0BB1 F6 C5 80              1669 	TEST	CH,080H
0BB4 B5 00                 1670 	MOV	CH,0
0BB6 74 E8                 1671 	JZ	PRET
0BB8 E8 5E FF              1672 	CALL	GEN
0BBB E9 00 00              1673 	JMP SHORT	PRET
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0BBE                       1674 
0BBE                       1675 PUTADD:
0BBE                       1676 ;Save complete addressing mode. Addressing mode is in AL; if this is a register
0BBE                       1677 ;operation (>=C0), then the one byte will be saved as pure code. Otherwise,
0BBE                       1678 ;the details of the addressing mode will be investigated and the optional one-
0BBE                       1679 ;or two-byte displacement will be added, as described by [ADDR] and [ALABEL].
0BBE 51                    1680 	PUSH	CX
0BBF 52                    1681 	PUSH	DX
0BC0 53                    1682 	PUSH	BX
0BC1 B5 00                 1683 	MOV	CH,0
0BC3 8A C8                 1684 	MOV	CL,AL
0BC5 E8 51 FF              1685 	CALL	GEN		;Save the addressing mode as pure code
0BC8 8A C1                 1686 	MOV	AL,CL
0BCA B5 80                 1687 	MOV	CH,80H
0BCC 24 C7                 1688 	AND	AL,0C7H
0BCE 3C 06                 1689 	CMP	AL,6
0BD0 74 0A                 1690 	JZ	TWOBT		;Direct address?
0BD2 24 C0                 1691 	AND	AL,0C0H
0BD4 74 CA                 1692 	JZ	PRET		;Indirect through reg, no displacement?
0BD6 3C C0                 1693 	CMP	AL,0C0H
0BD8 74 C6                 1694 	JZ	PRET		;Register to register operation?
0BDA 8A E8                 1695 	MOV	CH,AL		;Save whether one- or two-byte displacement
0BDC                       1696 TWOBT:
0BDC 8B 1E AE 1F           1697 	MOV	BX,[ADDR]
0BE0 8B 16 AE 1F           1698 	MOV	DX,[ALABEL]
0BE4 E9 00 00              1699 	JMP SHORT	PUTCHK
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0BE7                       1700 
0BE7                       1701 GRP2:
0BE7 E8 C2 F7              1702 	CALL	GETOP
0BEA B9 30 FF              1703 	MOV	CX,0FF30H
0BED 3C 00                 1704 	CMP	AL,UNDEFID
0BEF 74 14                 1705 	JZ	PMEM
0BF1 B5 50                 1706 	MOV	CH,50H
0BF3 3C 03                 1707 	CMP	AL,XREG
0BF5 74 1A                 1708 	JZ	PXREG
0BF7 B5 06                 1709 	MOV	CH,6
0BF9 3C 04                 1710 	CMP	AL,SREG
0BFB 75 03                 1711 	JNZ	$+5
0BFD E9 E6 03              1712 	JMP	PACKREG
0C00 B1 14                 1713 	MOV	CL,20
0C02 E9 8F F6              1714 	JMP	ERROR
0C05                       1715 
0C05                       1716 PMEM:
0C05 8A C5                 1717 	MOV	AL,CH
0C07 E8 05 FF              1718 	CALL	PUT
0C0A 8A C1                 1719 	MOV	AL,CL
0C0C 0A C2                 1720 	OR	AL,DL
0C0E E9 AD FF              1721 	JMP	PUTADD
0C11                       1722 
0C11                       1723 PXREG:
0C11 8A C5                 1724 	MOV	AL,CH
0C13 0A C2                 1725 	OR	AL,DL
0C15 E9 F7 FE              1726 	JMP	PUT
0C18                       1727 
0C18                       1728 GRP3:
0C18 E8 91 F7              1729 	CALL	GETOP
0C1B 52                    1730 	PUSH	DX
0C1C E8 84 F7              1731 	CALL	GETOP2
0C1F 5B                    1732 	POP	BX
0C20 B9 14 86              1733 	MOV	CX,8614H
0C23 B0 04                 1734 	MOV	AL,SREG
0C25 3A C7                 1735 	CMP	AL,BH
0C27 74 4C                 1736 	JZ	ERR6
0C29 3A C6                 1737 	CMP	AL,DH
0C2B 74 48                 1738 	JZ	ERR6
0C2D B0 01                 1739 	MOV	AL,CONST
0C2F 3A C7                 1740 	CMP	AL,BH
0C31 74 42                 1741 	JZ	ERR6
0C33 3A C6                 1742 	CMP	AL,DH
0C35 74 3E                 1743 	JZ	ERR6
0C37 B0 00                 1744 	MOV	AL,UNDEFID
0C39 3A C7                 1745 	CMP	AL,BH
0C3B 74 2D                 1746 	JZ	EXMEM
0C3D 3A C6                 1747 	CMP	AL,DH
0C3F 74 2B                 1748 	JZ	EXMEM1
0C41 8A C7                 1749 	MOV	AL,BH
0C43 3A C6                 1750 	CMP	AL,DH
0C45 B1 16                 1751 	MOV	CL,22
0C47 75 2C                 1752 	JNZ	ERR6
0C49 3C 03                 1753 	CMP	AL,XREG
0C4B 74 03                 1754 	JZ	L0008
0C4D E8 B8 F6              1755 	CALL	RR1
0C50                       1756 L0008:			;RR1 never returns
0C50 8A C3                 1757 	MOV	AL,BL
0C52 0A C0                 1758 	OR	AL,AL
0C54 74 0D                 1759 	JZ	EXACC
0C56 87 DA                 1760 	XCHG	DX,BX
0C58 8A C3                 1761 	MOV	AL,BL
0C5A 0A C0                 1762 	OR	AL,AL
0C5C 8A C7                 1763 	MOV	AL,BH
0C5E 74 03                 1764 	JZ	EXACC
0C60 E8 A5 F6              1765 	CALL	RR1
0C63                       1766 EXACC:
0C63 B0 90                 1767 	MOV	AL,90H
0C65 0A C2                 1768 	OR	AL,DL
0C67 E9 A5 FE              1769 	JMP	PUT
0C6A                       1770 
0C6A                       1771 EXMEM:
0C6A 87 DA                 1772 	XCHG	DX,BX
0C6C                       1773 EXMEM1:
0C6C 3A C7                 1774 	CMP	AL,BH
0C6E 74 05                 1775 	JZ	ERR6
0C70 B1 01                 1776 	MOV	CL,1	;Flag word as OK
0C72 E8 0E F7              1777 	CALL	NOTAC	;NOTAC never returns
0C75 E9 1C F6              1778 ERR6:	JMP	ERROR
0C78                       1779 
0C78                       1780 GRP4:
0C78 50                    1781 	PUSH	AX
0C79 E8 30 F7              1782 	CALL	GETOP
0C7C 59                    1783 	POP	CX
0C7D 86 CD                 1784 	XCHG	CL,CH
0C7F 3C 01                 1785 	CMP	AL,CONST
0C81 74 13                 1786 	JZ	FIXED
0C83 2C 03                 1787 	SUB	AL,XREG
0C85 FE CA                 1788 	DEC	DL
0C87 FE CA                 1789 	DEC	DL
0C89 0A C2                 1790 	OR	AL,DL
0C8B B1 14                 1791 	MOV	CL,20
0C8D 75 E6                 1792 	JNZ	ERR6
0C8F 8A C5                 1793 	MOV	AL,CH
0C91 0C 08                 1794 	OR	AL,8
0C93 E9 79 FE              1795 	JMP	PUT
0C96                       1796 FIXED:
0C96 8A C5                 1797 	MOV	AL,CH
0C98 E8 74 FE              1798 	CALL	PUT
0C9B E9 B4 FE              1799 	JMP	PUTBYT
0C9E                       1800 
0C9E                       1801 GRP5:
0C9E 50                    1802 	PUSH	AX
0C9F E8 0A F7              1803 	CALL	GETOP
0CA2 B1 14                 1804 	MOV	CL,20
0CA4 3C 01                 1805 	CMP	AL,CONST
0CA6 75 CD                 1806 	JNZ	ERR6
0CA8 8B 1E AE 1F           1807 	MOV	BX,[DLABEL]
0CAC 8A C7                 1808 	MOV	AL,BH
0CAE 0A C3                 1809 	OR	AL,BL
0CB0 B1 1E                 1810 	MOV	CL,30
0CB2 75 C1                 1811 	JNZ	ERR6
0CB4 8B 1E AE 1F           1812 	MOV	BX,[DATA]
0CB8 58                    1813 	POP	AX
0CB9 0A C0                 1814 	OR	AL,AL
0CBB 74 45                 1815 	JZ	UDORG
0CBD FE C8                 1816 	DEC	AL
0CBF 74 1A                 1817 	JZ	DSJ
0CC1 FE C8                 1818 	DEC	AL
0CC3 74 29                 1819 	JZ	EQU
0CC5 FE C8                 1820 	DEC	AL
0CC7 74 03                 1821 	JZ	$+5
0CC9 E9 7E 03              1822 	JMP	UDIF
0CCC                       1823 PUTOP:
0CCC B0 FD                 1824 	MOV	AL,-3
0CCE E9 00 00              1825 	JMP SHORT	NEWLOC
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0CD1                       1826 UDALIGN:
0CD1 A0 AE 1F              1827 	MOV	AL,[PC]
0CD4 24 01                 1828 	AND	AL,1
0CD6 74 29                 1829 	JZ	UDALIGNUDRET
0CD8 BB 01 00              1830 	MOV	BX,1
0CDB                       1831 DSJ:
0CDB 87 DA                 1832 	XCHG	DX,BX
0CDD 8B 1E AE 1F           1833 	MOV	BX,[PC]
0CE1 03 DA                 1834 	ADD	BX,DX
0CE3 89 1E AE 1F           1835 	MOV	[PC],BX
0CE7 87 DA                 1836 	XCHG	DX,BX
0CE9 B0 FC                 1837 	MOV	AL,-4
0CEB E9 00 00              1838 	JMP SHORT	NEWLOC
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0CEE                       1839 EQU:
0CEE 87 DA                 1840 	XCHG	DX,BX
0CF0 8B 1E AE 1F           1841 	MOV	BX,[LABPT]
0CF4 8A C7                 1842 	MOV	AL,BH
0CF6 0A C3                 1843 	OR	AL,BL
0CF8 B1 22                 1844 	MOV	CL,34
0CFA 74 27                 1845 	JZ	ERR7
0CFC 88 17                 1846 	MOV	[BX],DL
0CFE 43                    1847 	INC	BX
0CFF 88 37                 1848 	MOV	[BX],DH
0D01                       1849 UDALIGNUDRET:
0D01 C3                    1850 	RET
0D02                       1851 UDORG:
0D02 89 1E AE 1F           1852 	MOV	[PC],BX
0D06 B0 FE                 1853 	MOV	AL,-2
0D08                       1854 NEWLOC:
0D08 E8 35 FE              1855 	CALL	PUTCD
0D0B 8A C3                 1856 	MOV	AL,BL
0D0D E8 30 FE              1857 	CALL	PUTCD
0D10 8A C7                 1858 	MOV	AL,BH
0D12 E8 2B FE              1859 	CALL	PUTCD
0D15 B5 C0                 1860 	MOV	CH,0C0H
0D17 E9 02 FE              1861 	JMP	GEN1
0D1A                       1862 GRP6:
0D1A 8A E8                 1863 	MOV	CH,AL
0D1C B1 04                 1864 	MOV	CL,4
0D1E E8 AE F5              1865 	CALL	MROPS
0D21 B1 17                 1866 	MOV	CL,23
0D23 E9 6E F5              1867 ERR7:	JMP	ERROR
0D26                       1868 GRP7:
0D26 8A E8                 1869 	MOV	CH,AL
0D28 B1 01                 1870 	MOV	CL,1
0D2A E8 A2 F5              1871 	CALL	MROPS
0D2D B1 80                 1872 	MOV	CL,80H
0D2F 8B 16 AE 1F           1873 	MOV	DX,[DLABEL]
0D33 8A C6                 1874 	MOV	AL,DH
0D35 0A C2                 1875 	OR	AL,DL
0D37 75 12                 1876 	JNZ	ACCJ
0D39 87 DA                 1877 	XCHG	DX,BX
0D3B 8B 1E AE 1F           1878 	MOV	BX,[DATA]
0D3F 8A C3                 1879 	MOV	AL,BL
0D41 98                    1880 	CBW
0D42 3B C3                 1881 	CMP	AX,BX
0D44 87 DA                 1882 	XCHG	DX,BX
0D46 75 03                 1883 	JNZ	ACCJ
0D48 80 C9 02              1884 	OR	CL,002H
0D4B E9 B9 00              1885 ACCJ:	JMP	ACCIMM
0D4E                       1886 GRP8:
0D4E 8A C8                 1887 	MOV	CL,AL
0D50 B5 FE                 1888 	MOV	CH,0FEH
0D52 E9 00 00              1889 	JMP SHORT	ONEOP
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0D55                       1890 GRP9:
0D55 8A C8                 1891 	MOV	CL,AL
0D57 B5 F6                 1892 	MOV	CH,0F6H
0D59                       1893 ONEOP:
0D59 51                    1894 	PUSH	CX
0D5A E8 4F F6              1895 	CALL	GETOP
0D5D                       1896 ONE:
0D5D B1 1A                 1897 	MOV	CL,26
0D5F 3C 01                 1898 	CMP	AL,CONST
0D61 74 C0                 1899 	JZ	ERR7
0D63 3C 04                 1900 	CMP	AL,SREG
0D65 B1 16                 1901 	MOV	CL,22
0D67 74 BA                 1902 	JZ	ERR7
0D69 59                    1903 	POP	CX
0D6A 3C 00                 1904 	CMP	AL,UNDEFID
0D6C 74 12                 1905 	JZ	MOP
0D6E 24 01                 1906 	AND	AL,1
0D70 74 21                 1907 	JZ	ROP
0D72 F6 C1 01              1908 	TEST	CL,001H
0D75 74 1C                 1909 	JZ	ROP
0D77 8A C1                 1910 	MOV	AL,CL
0D79 24 F8                 1911 	AND	AL,0F8H
0D7B 0A C2                 1912 	OR	AL,DL
0D7D E9 8F FD              1913 	JMP	PUT
0D80                       1914 MOP:
0D80 A0 AE 1F              1915 	MOV	AL,[FLAG]
0D83 24 01                 1916 	AND	AL,1
0D85 0A C5                 1917 	OR	AL,CH
0D87 E8 85 FD              1918 	CALL	PUT
0D8A 8A C1                 1919 	MOV	AL,CL
0D8C 24 38                 1920 	AND	AL,38H
0D8E 0A C2                 1921 	OR	AL,DL
0D90 E9 2B FE              1922 	JMP	PUTADD
0D93                       1923 ROP:
0D93 0A C5                 1924 	OR	AL,CH
0D95 E8 77 FD              1925 	CALL	PUT
0D98 8A C1                 1926 	MOV	AL,CL
0D9A 24 38                 1927 	AND	AL,38H
0D9C 0C C0                 1928 	OR	AL,0C0H
0D9E 0A C2                 1929 	OR	AL,DL
0DA0 E9 6C FD              1930 	JMP	PUT
0DA3                       1931 GRP10:
0DA3 8A C8                 1932 	MOV	CL,AL
0DA5 B5 F6                 1933 	MOV	CH,0F6H
0DA7 51                    1934 	PUSH	CX
0DA8 E8 01 F6              1935 	CALL	GETOP
0DAB B1 14                 1936 	MOV	CL,20
0DAD 8A C2                 1937 	MOV	AL,DL
0DAF 0A C0                 1938 	OR	AL,AL
0DB1 75 08                 1939 	JNZ	ERRJ1
0DB3 8A C6                 1940 	MOV	AL,DH
0DB5 3C 03                 1941 	CMP	AL,XREG
0DB7 74 04                 1942 	JZ	G10
0DB9 3C 02                 1943 	CMP	AL,REG
0DBB 75 68                 1944 ERRJ1:	JNZ	ERR8
0DBD                       1945 G10:
0DBD 50                    1946 	PUSH	AX
0DBE E8 EB F5              1947 	CALL	GETOP
0DC1 58                    1948 	POP	AX
0DC2 24 01                 1949 	AND	AL,1
0DC4 A2 AE 1F              1950 	MOV	[FLAG],AL
0DC7 8A C6                 1951 	MOV	AL,DH
0DC9 E9 00 00              1952 ONEJ:	JMP SHORT	ONE
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0DCC                       1953 GRP11:
0DCC E8 40 FD              1954 	CALL	PUT
0DCF B0 0A                 1955 	MOV	AL,0AH
0DD1 E9 3B FD              1956 	JMP	PUT
0DD4                       1957 GRP12:
0DD4 8A C8                 1958 	MOV	CL,AL
0DD6 B5 D0                 1959 	MOV	CH,0D0H
0DD8 51                    1960 	PUSH	CX
0DD9 E8 D0 F5              1961 	CALL	GETOP
0DDC A0 AE 1F              1962 	MOV	AL,[SYM]
0DDF 3C 2C                 1963 	CMP	AL,','
0DE1 8A C6                 1964 	MOV	AL,DH
0DE3 75 E4                 1965 	JNZ	ONEJ
0DE5 52                    1966 	PUSH	DX
0DE6 E8 C3 F5              1967 	CALL	GETOP
0DE9 2C 02                 1968 	SUB	AL,REG
0DEB B1 14                 1969 	MOV	CL,20
0DED FE CA                 1970 	DEC	DL
0DEF 0A C2                 1971 	OR	AL,DL
0DF1 75 32                 1972 	JNZ	ERR8
0DF3 5A                    1973 	POP	DX
0DF4 8A C6                 1974 	MOV	AL,DH
0DF6 59                    1975 	POP	CX
0DF7 80 CD 02              1976 	OR	CH,002H
0DFA 51                    1977 	PUSH	CX
0DFB E9 5F FF              1978 	JMP	ONE
0DFE                       1979 GRP13:
0DFE 8A E8                 1980 	MOV	CH,AL
0E00 B1 01                 1981 	MOV	CL,1
0E02 E8 CA F4              1982 	CALL	MROPS
0E05 B1 80                 1983 	MOV	CL,80H
0E07                       1984 ACCIMM:
0E07 E8 C5 FC              1985 	CALL	IMMED
0E0A 80 CD 04              1986 	OR	CH,004H
0E0D 80 E5 FD              1987 	AND	CH,0FDH
0E10                       1988 AIMM:
0E10 8A C7                 1989 	MOV	AL,BH
0E12 24 01                 1990 	AND	AL,1
0E14 9F                    1991 	LAHF
0E15 50                    1992 	PUSH	AX
0E16 0A C5                 1993 	OR	AL,CH
0E18 E8 F4 FC              1994 	CALL	PUT
0E1B 58                    1995 	POP	AX
0E1C 9E                    1996 	SAHF
0E1D 75 03                 1997 	JNZ	$+5
0E1F E9 30 FD              1998 	JMP	PUTBYT
0E22 E9 25 FD              1999 	JMP	PUTWOR
0E25                       2000 
0E25 E9 6C F4              2001 ERR8:	JMP	ERROR
0E28                       2002 
0E28                       2003 GRP14:
0E28                       2004 ;JMP and CALL mnemonics
0E28 9F                    2005 	LAHF
0E29 86 E0                 2006 	XCHG	AH,AL
0E2B 50                    2007 	PUSH	AX
0E2C 86 E0                 2008 	XCHG	AH,AL
0E2E                       2009 	MOV	BYTE[MAXFLG],3	;Allow "L" flag
***** ERROR:  "," and second operand expected
0E2E E8 7B F5              2010 	CALL	GETOP
0E31 3C 01                 2011 	CMP	AL,CONST
0E33 74 33                 2012 	JZ	DIRECT
0E35 B1 14                 2013 	MOV	CL,20
0E37 3C 02                 2014 	CMP	AL,REG
0E39 74 EA                 2015 	JZ	ERR8
0E3B 3C 04                 2016 	CMP	AL,SREG
0E3D 74 E6                 2017 	JZ	ERR8
0E3F 3C 03                 2018 	CMP	AL,XREG
0E41 75 03                 2019 	JNZ	NOTRG
0E43 80 CA C0              2020 	OR	DL,0C0H
0E46                       2021 NOTRG:
0E46                       2022 ;Indirect jump. DL has addressing mode.
0E46 B0 FF                 2023 	MOV	AL,0FFH
0E48 E8 C4 FC              2024 	CALL	PUT
0E4B 58                    2025 	POP	AX
0E4C 86 E0                 2026 	XCHG	AH,AL
0E4E 9E                    2027 	SAHF
0E4F 24 38                 2028 	AND	AL,38H
0E51 0A C2                 2029 	OR	AL,DL
0E53 8A 2E AE 1F           2030 	MOV	CH,[FLAG]
0E57 82 FD 03              2031 	CMP	CH,3		;Flag "L" present?
0E5A 74 09                 2032 	JZ	PUTADDJ		;If so, do inter-segment
0E5C B1 27                 2033 	MOV	CL,27H
0E5E 82 FD FF              2034 	CMP	CH,-1		;Better not be a flag
0E61 75 C2                 2035 	JNZ	ERR8
0E63 24 F7                 2036 	AND	AL,0F7H		;Convert to intra-segment
0E65                       2037 PUTADDJ:
0E65 E9 56 FD              2038 	JMP	PUTADD
0E68                       2039 DIRECT:
0E68 A0 AE 1F              2040 	MOV	AL,[SYM]
0E6B 3C 2C                 2041 	CMP	AL,','
0E6D 74 1C                 2042 	JZ	LONGJ
0E6F 58                    2043 	POP	AX
0E70 86 E0                 2044 	XCHG	AH,AL
0E72 9E                    2045 	SAHF
0E73 FE C8                 2046 	DEC	AL
0E75 3C E9                 2047 	CMP	AL,0E9H
0E77 74 02                 2048 	JZ	GOTOP
0E79 B0 E8                 2049 	MOV	AL,0E8H
0E7B                       2050 GOTOP:
0E7B E8 91 FC              2051 	CALL	PUT
0E7E 8B 16 AE 1F           2052 	MOV	DX,[PC]
0E82 42                    2053 	INC	DX
0E83 42                    2054 	INC	DX
0E84 29 16 AE 1F           2055 	SUB	[DATA],DX
0E88 E9 BF FC              2056 	JMP	PUTWOR
0E8B                       2057 LONGJ:
0E8B 58                    2058 	POP	AX
0E8C 86 E0                 2059 	XCHG	AH,AL
0E8E 9E                    2060 	SAHF
0E8F E8 7D FC              2061 	CALL	PUT
0E92 E8 B5 FC              2062 	CALL	PUTWOR
0E95 E8 14 F5              2063 	CALL	GETOP
0E98 B1 14                 2064 	MOV	CL,20
0E9A 3C 01                 2065 	CMP	AL,CONST
0E9C 75 87                 2066 	JNZ	ERR8
0E9E E9 A9 FC              2067 	JMP	PUTWOR
0EA1                       2068 
0EA1                       2069 GRP16:
0EA1                       2070 ;RET mnemonic
0EA1 9F                    2071 	LAHF
0EA2 86 E0                 2072 	XCHG	AH,AL
0EA4 50                    2073 	PUSH	AX
0EA5 86 E0                 2074 	XCHG	AH,AL
0EA7 E8 1F F7              2075 	CALL	GETSYM
0EAA 3C 05                 2076 	CMP	AL,5
0EAC 74 1C                 2077 	JZ	LONGR
0EAE 3C 0D                 2078 	CMP	AL,EOL
0EB0 74 40                 2079 	JZ	NODEC
0EB2 3C 3B                 2080 	CMP	AL,';'
0EB4 74 3C                 2081 	JZ	NODEC
0EB6                       2082 GETSP:
0EB6 E8 F6 F4              2083 	CALL	GETOP1
0EB9 59                    2084 	POP	CX
0EBA 3C 01                 2085 	CMP	AL,CONST
0EBC B1 14                 2086 	MOV	CL,20
0EBE 75 61                 2087 	JNZ	ERR9
0EC0 8A C5                 2088 	MOV	AL,CH
0EC2 24 FE                 2089 	AND	AL,0FEH
0EC4 E8 48 FC              2090 	CALL	PUT
0EC7 E9 80 FC              2091 	JMP	PUTWOR
0ECA                       2092 LONGR:
0ECA 82 FA 03              2093 	CMP	DL,3		;Is flag "L"?
0ECD B1 27                 2094 	MOV	CL,27H
0ECF 75 7B                 2095 	JNZ	ERR10		;If not, bad flag
0ED1 58                    2096 	POP	AX
0ED2 86 E0                 2097 	XCHG	AH,AL
0ED4 9E                    2098 	SAHF
0ED5 0C 08                 2099 	OR	AL,8
0ED7 9F                    2100 	LAHF
0ED8 86 E0                 2101 	XCHG	AH,AL
0EDA 50                    2102 	PUSH	AX
0EDB 86 E0                 2103 	XCHG	AH,AL
0EDD                       2104 NOTLON:
0EDD E8 E9 F6              2105 	CALL	GETSYM
0EE0 3C 0D                 2106 	CMP	AL,EOL
0EE2 74 2C                 2107 	JZ	DORET
0EE4 3C 3B                 2108 	CMP	AL,';'
0EE6 74 28                 2109 	JZ	DORET
0EE8 3C 2C                 2110 	CMP	AL,','
0EEA 75 03                 2111 	JNZ	L0011
0EEC E8 DA F6              2112 	CALL	GETSYM
0EEF                       2113 L0011:	
0EEF E9 00 00              2114 	JMP SHORT	GETSP
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
0EF2                       2115 NODEC:
0EF2                       2116 ;Return is intra-segment (short) without add to SP. 
0EF2                       2117 ;Record position for RET symbol.
0EF2 8B 1E AE 1F           2118 	MOV	BX,[PC]
0EF6 89 1E AE 1F           2119 	MOV	[LSTRET],BX
0EFA 87 DA                 2120 	XCHG	DX,BX
0EFC 8B 1E AE 1F           2121 	MOV	BX,[RETPT]
0F00 8A C7                 2122 	MOV	AL,BH
0F02 0A C3                 2123 	OR	AL,BL
0F04 74 0A                 2124 	JZ	DORET
0F06                       2125 	MOV	BYTE[BX],1
***** ERROR:  "," and second operand expected
0F06 43                    2126 	INC	BX
0F07 89 17                 2127 	MOV	[BX],DX
0F09 BB 00 00              2128 	MOV	BX,0
0F0C 89 1E AE 1F           2129 	MOV	[RETPT],BX
0F10                       2130 DORET:
0F10 58                    2131 	POP	AX
0F11 86 E0                 2132 	XCHG	AH,AL
0F13 9E                    2133 	SAHF
0F14 E9 F8 FB              2134 	JMP	PUT
0F17                       2135 
0F17                       2136 GRP17:
0F17 E8 F5 FB              2137 	CALL	PUT
0F1A E8 8F F4              2138 	CALL	GETOP
0F1D 3C 01                 2139 	CMP	AL,CONST
0F1F B1 14                 2140 	MOV	CL,20
0F21 75 29                 2141 ERR9:	JNZ	ERR10
0F23 8B 1E AE 1F           2142 	MOV	BX,[DATA]
0F27 8B 16 AE 1F           2143 	MOV	DX,[PC]
0F2B 42                    2144 	INC	DX
0F2C 2B DA                 2145 	SUB	BX,DX
0F2E 89 1E AE 1F           2146 	MOV	[DATA],BX
0F32 E8 1D FC              2147 	CALL	PUTBYT
0F35 8B 1E AE 1F           2148 	MOV	BX,[DLABEL]
0F39 8A C7                 2149 	MOV	AL,BH
0F3B 0A C3                 2150 	OR	AL,BL
0F3D 75 10                 2151 	JNZ	GRP17UDRET
0F3F 8B 1E AE 1F           2152 	MOV	BX,[DATA]
0F43 8A C3                 2153 	MOV	AL,BL
0F45 98                    2154 	CBW
0F46 3B C3                 2155 	CMP	AX,BX		;Signed 8-bit number?
0F48 74 05                 2156 	JZ	GRP17UDRET
0F4A B1 1F                 2157 	MOV	CL,31
0F4C E9 45 F3              2158 ERR10:	JMP	ERROR
0F4F                       2159 GRP17UDRET:
0F4F C3                    2160 	RET
0F50                       2161 GRP18:
0F50 E8 59 F4              2162 	CALL	GETOP
0F53 3C 01                 2163 	CMP	AL,CONST
0F55 B1 14                 2164 	MOV	CL,20
0F57 75 F3                 2165 	JNZ	ERR10
0F59 8B 1E AE 1F           2166 	MOV	BX,[DLABEL]
0F5D 8A C7                 2167 	MOV	AL,BH
0F5F 0A C3                 2168 	OR	AL,BL
0F61 75 10                 2169 	JNZ	GENINT
0F63 8B 1E AE 1F           2170 	MOV	BX,[DATA]
0F67 BA 03 00              2171 	MOV	DX,3
0F6A 1B DA                 2172 	SBB	BX,DX
0F6C 75 05                 2173 	JNZ	GENINT
0F6E B0 CC                 2174 	MOV	AL,0CCH
0F70 E9 9C FB              2175 	JMP	PUT
0F73                       2176 GENINT:
0F73 B0 CD                 2177 	MOV	AL,0CDH
0F75 E8 97 FB              2178 	CALL	PUT
0F78 E9 D7 FB              2179 	JMP	PUTBYT
0F7B                       2180 
0F7B                       2181 GRP19:	;ESC opcode
0F7B E8 2E F4              2182 	CALL	GETOP
0F7E B1 14                 2183 	MOV	CL,20
0F80 3C 01                 2184 	CMP	AL,CONST
0F82 75 27                 2185 	JNZ	ERRJ		;First operand must be immediate
0F84 B1 1E                 2186 	MOV	CL,1EH
0F86                       2187 	TEST	WORD[DLABEL],-1	;See if all labels have been defined
***** ERROR:  "," and second operand expected
0F86 75 23                 2188 	JNZ	ERRJ
0F88 A1 AE 1F              2189 	MOV	AX,[DATA]
0F8B 3D 40 00              2190 	CMP	AX,64		;Must only be 6 bits
0F8E B1 1F                 2191 	MOV	CL,1FH
0F90 73 19                 2192 	JNB	ERRJ
0F92 8A D8                 2193 	MOV	BL,AL		;Save for second byte
0F94                       2194 	SHR	AL,1
***** ERROR:  Invalid operand
0F94                       2195 	SHR	AL,1
***** ERROR:  Invalid operand
0F94                       2196 	SHR	AL,1
***** ERROR:  Invalid operand
0F94 0C D8                 2197 	OR	AL,0D8H		;ESC opcode
0F96 E8 76 FB              2198 	CALL	PUT
0F99 53                    2199 	PUSH	BX
0F9A E8 06 F4              2200 	CALL	GETOP2
0F9D 5B                    2201 	POP	BX
0F9E 80 E3 07              2202 	AND	BL,7		;Low 3 bits of first operand
0FA1                       2203 	SHL	BL,1
***** ERROR:  Invalid operand
0FA1                       2204 	SHL	BL,1
***** ERROR:  Invalid operand
0FA1                       2205 	SHL	BL,1
***** ERROR:  Invalid operand
0FA1 3C 00                 2206 	CMP	AL,UNDEFID	;Check for memory operand
0FA3 74 09                 2207 	JZ	ESCMEM
0FA5 3C 01                 2208 	CMP	AL,CONST	;Check for another immediate
0FA7 74 0C                 2209 	JZ	ESCIMM
0FA9 B1 14                 2210 	MOV	CL,20
0FAB E9 E6 F2              2211 ERRJ:	JMP	ERROR
0FAE                       2212 
0FAE                       2213 ESCMEM:
0FAE 0A DA                 2214 	OR	BL,DL		;Combine mode with first operand
0FB0 8A C3                 2215 	MOV	AL,BL
0FB2 E9 09 FC              2216 	JMP	PUTADD
0FB5                       2217 
0FB5                       2218 ESCIMM:
0FB5 B1 1E                 2219 	MOV	CL,1EH
0FB7                       2220 	TEST WORD[DLABEL],-1	;See if second operand is fully defined
***** ERROR:  "," and second operand expected
0FB7 75 F2                 2221 	JNZ	ERRJ
0FB9 A1 AE 1F              2222 	MOV	AX,[DATA]
0FBC B1 1F                 2223 	MOV	CL,1FH
0FBE 3D 08 00              2224 	CMP	AX,8		;Must only be 3 bit value
0FC1 73 E8                 2225 	JNB	ERRJ
0FC3 0A C3                 2226 	OR	AL,BL		;Combine first and second operands
0FC5 0C C0                 2227 	OR	AL,0C0H		;Force "register" mode
0FC7 E9 45 FB              2228 	JMP	PUT
0FCA                       2229 
0FCA                       2230 GRP20:
0FCA 8A E8                 2231 	MOV	CH,AL
0FCC B1 01                 2232 	MOV	CL,1
0FCE E8 FE F2              2233 	CALL	MROPS
0FD1 B1 F6                 2234 	MOV	CL,0F6H
0FD3 E8 F9 FA              2235 	CALL	IMMED
0FD6 B5 A8                 2236 	MOV	CH,0A8H
0FD8 E9 35 FE              2237 	JMP	AIMM
0FDB                       2238 GRP21:
0FDB E8 CE F3              2239 	CALL	GETOP
0FDE 3C 04                 2240 	CMP	AL,SREG
0FE0 B1 1C                 2241 	MOV	CL,28
0FE2 75 C7                 2242 	JNZ	ERRJ
0FE4 B5 26                 2243 	MOV	CH,26H
0FE6                       2244 PACKREG:
0FE6 8A C2                 2245 	MOV	AL,DL
0FE8 02 C0                 2246 	ADD	AL,AL
0FEA 02 C0                 2247 	ADD	AL,AL
0FEC 02 C0                 2248 	ADD	AL,AL
0FEE 0A C5                 2249 	OR	AL,CH
0FF0 E9 1C FB              2250 	JMP	PUT
0FF3                       2251 GRP22:
0FF3 E8 B6 F3              2252 	CALL	GETOP
0FF6 B9 00 8F              2253 	MOV	CX,8F00H
0FF9 3C 00                 2254 	CMP	AL,UNDEFID
0FFB 75 03                 2255 	JNZ	$+5
0FFD E9 05 FC              2256 	JMP	PMEM
1000 B5 58                 2257 	MOV	CH,58H
1002 3C 03                 2258 	CMP	AL,XREG
1004 75 03                 2259 	JNZ	$+5
1006 E9 08 FC              2260 	JMP	PXREG
1009 B5 07                 2261 	MOV	CH,7
100B 3C 04                 2262 	CMP	AL,SREG
100D 74 D7                 2263 	JZ	PACKREG
100F B1 14                 2264 	MOV	CL,20
1011 E9 80 F2              2265 ERR11:	JMP	ERROR
1014                       2266 GRP23:
1014 A2 AE 1F              2267 	MOV	[DATSIZ],AL
1017                       2268 GETDAT:
1017 E8 AF F5              2269 	CALL	GETSYM
101A B0 02                 2270 	MOV	AL,2
101C E8 A6 F3              2271 	CALL	VAL1
101F A0 AE 1F              2272 	MOV	AL,[SYM]
1022 3C 2C                 2273 	CMP	AL,','
1024 A0 AE 1F              2274 	MOV	AL,[DATSIZ]
1027 75 06                 2275 	JNZ	ENDDAT
1029 E8 14 00              2276 	CALL	SAVDAT
102C E9 00 00              2277 	JMP SHORT	GETDAT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
102F                       2278 ENDDAT:
102F 3C 02                 2279 	CMP	AL,2
1031 75 0D                 2280 	JNZ	SAVDAT
1033 8B 1E AE 1F           2281 	MOV	BX,[DATA]
1037 9F                    2282 	LAHF
1038 80 CB 80              2283 	OR	BL,080H
103B 9E                    2284 	SAHF
103C 89 1E AE 1F           2285 	MOV	[DATA],BX
1040                       2286 SAVDAT:
1040 0A C0                 2287 	OR	AL,AL
1042 74 03                 2288 	JZ	$+5
1044 E9 0B FB              2289 	JMP	PUTBYT
1047 E9 00 FB              2290 	JMP	PUTWOR
104A                       2291 UDIF:
104A 0B DB                 2292 	OR	BX,BX
104C 74 01                 2293 	JZ	SKIPCD
104E                       2294 	INC	BYTE[IFFLG]
***** ERROR:  Destination must not be immediate value
104E C3                    2295 	RET
104F                       2296 
104F                       2297 SKIPCD:
104F                       2298 	INC	BYTE[CHKLAB]
***** ERROR:  Destination must not be immediate value
104F                       2299 SKIPLP:
104F 32 C0                 2300 	XOR	AL,AL
1051 E8 EC F1              2301 	CALL	NEXLIN
1054 E8 42 F2              2302 	CALL	NEXTCHR
1057 3C 1A                 2303 	CMP	AL,1AH
1059 74 39                 2304 	JZ	UDEND
105B E8 3F F8              2305 	CALL	GETLAB
105E 72 EF                 2306 	JC	SKIPLP
1060 BF AE 1F              2307 	MOV	DI,LENID
1063 BE 76 1F              2308 	MOV	SI,IFEND
1066 B5 00                 2309 	MOV	CH,0
1068 8A 0D                 2310 	MOV	CL,[DI]
106A FE C1                 2311 	INC	CL
106C F3                    2312 	REPE
106D A6                    2313 	CMPSB
106E 74 11                 2314 	JZ	ENDCOND
1070 BF AE 1F              2315 	MOV	DI,LENID
1073 BE 7C 1F              2316 	MOV	SI,IFNEST
1076 8A 0D                 2317 	MOV	CL,[DI]
1078 FE C1                 2318 	INC	CL
107A F3                    2319 	REPE
107B A6                    2320 	CMPSB
107C 75 D1                 2321 	JNZ	SKIPLP
107E                       2322 	INC	BYTE[CHKLAB]
***** ERROR:  Destination must not be immediate value
107E E9 00 00              2323 	JMP SHORT	SKIPLP
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
1081                       2324 
1081                       2325 ENDCOND:
1081                       2326 	DEC	BYTE[CHKLAB]
***** ERROR:  Destination must not be immediate value
1081 75 CC                 2327 	JNZ	SKIPLP
1083 C3                    2328 	RET
1084                       2329 
1084                       2330 UDENDIF:
1084 A0 AE 1F              2331 	MOV	AL,[IFFLG]
1087 B1 24                 2332 	MOV	CL,36
1089 FE C8                 2333 	DEC	AL
108B 78 04                 2334 	JS	ERRJMP
108D A2 AE 1F              2335 	MOV	[IFFLG],AL
1090 C3                    2336 	RET
1091                       2337 
1091 E9 00 F2              2338 ERRJMP:	JMP	ERROR
1094                       2339 
1094                       2340 ;*********************************************************************
1094                       2341 ;
1094                       2342 ;	PASS 2
1094                       2343 ;
1094                       2344 ;*********************************************************************
1094                       2345 
1094                       2346 UDEND:
1094                       2347 	;DB 0CCH
1094 B2 04                 2348 	MOV	DL,4
1096                       2349 WREND:
1096 B5 FF                 2350 	MOV	CH,0FFH
1098 8A C5                 2351 	MOV	AL,CH
109A E8 7C FA              2352 	CALL	GEN
109D FE CA                 2353 	DEC	DL
109F 75 F5                 2354 	JNZ	WREND
10A1                       2355 	MOV	WORD[BUFPT],SRCBUF
***** ERROR:  "," and second operand expected
10A1                       2356 	MOV	BYTE[HEXCNT],-5	;FLAG HEX BUFFER AS EMPTY
***** ERROR:  "," and second operand expected
10A1                       2357 	MOV	WORD[LSTPNT],LSTBUF
***** ERROR:  "," and second operand expected
10A1                       2358 	MOV	WORD[HEXPNT],HEXBUF
***** ERROR:  "," and second operand expected
10A1 33 C0                 2359 	XOR	AX,AX
10A3 A3 AE 1F              2360 	MOV	[ERRCNT],AX
10A6 A3 AE 1F              2361 	MOV	[PC],AX
10A9 A3 AE 1F              2362 	MOV	[LINE],AX	;Current line number
10AC                       2363 	MOV	WORD[HEXADD],OBJECT
***** ERROR:  "," and second operand expected
10AC                       2364 	
10AC BA 5C 00              2365 	MOV	DX,FCB
10AF B4 0F                 2366 	MOV	AH,OPEN
10B1 CD 21                 2367 	INT	33		;Re-open source file
10B3 33 C0                 2368 	XOR	AX,AX
10B5 A3 68 00              2369 	MOV	[FCB+12],AX	;Set CURRENT BLOCK to zero
10B8 A2 7C 00              2370 	MOV	[FCB+20H],AL	;Set NEXT RECORD field to zero
10BB                       2371 	MOV	WORD[FCB+14],BUFSIZ
***** ERROR:  "," and second operand expected
10BB A2 AE 1F              2372 	MOV	[COUNT],AL
10BE B5 01                 2373 	MOV	CH,1
10C0 BE AE 1F              2374 	MOV	SI,START
10C3                       2375 FIXLINE:
10C3 BF AE 1F              2376 	MOV	DI,START	;Store code over used up intermediate code
10C6 32 C0                 2377 	XOR	AL,AL
10C8 A2 AE 1F              2378 	MOV	[SPC],AL	;No "special" yet (ORG, PUT, DS)
10CB A2 AE 1F              2379 	MOV	[ERR],AL	;No second pass errors yet
10CE                       2380 NEXBT:
10CE                       2381 	SHL	CL,1		;Shift out last bit of previous code
***** ERROR:  Invalid operand
10CE FE CD                 2382 	DEC	CH		;Still have codes left?
10D0 75 05                 2383 	JNZ	TESTTYP
10D2 AC                    2384 	LODSB			;Get next flag byte
10D3 8A C8                 2385 	MOV	CL,AL
10D5 B5 04                 2386 	MOV	CH,4
10D7                       2387 TESTTYP:
10D7                       2388 	SHL	CL,1		;Set flags based on two bits
***** ERROR:  Invalid operand
10D7 70 07                 2389 	JO	FIXUP
10D9 AC                    2390 	LODSB
10DA 72 44                 2391 	JC	EMARK
10DC                       2392 OBJBT:
10DC AA                    2393 	STOSB
10DD E9 00 00              2394 	JMP SHORT	NEXBT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
10E0                       2395 
10E0                       2396 FIXUP:
10E0                       2397 ;Either a word or byte fixup is needed from a forward reference
10E0 AD                    2398 	LODSW			;Get pointer to symbol
10E1 93                    2399 	XCHG	AX,BX
10E2 AD                    2400 	LODSW			;Get constant part
10E3 03 47 01              2401 	ADD	AX,[BX+1]	;Add symbol value to constant part
10E6                       2402 	CMP	BYTE[BX],0	;See if symbol got defined
***** ERROR:  "," and second operand expected
10E6 75 02                 2403 	JNZ	HAVDEF
10E8                       2404 	MOV	BYTE[ERR],100	;Undefined - flag error
***** ERROR:  "," and second operand expected
10E8 33 C0                 2405 	XOR	AX,AX
10EA                       2406 HAVDEF:
10EA 0A C9                 2407 	OR	CL,CL		;See if word or byte fixup
10EC 78 04                 2408 	JS	DEFBYT
10EE AB                    2409 	STOSW
10EF E9 00 00              2410 	JMP SHORT	NEXBT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
10F2                       2411 
10F2                       2412 DEFBYT:
10F2 8B D0                 2413 	MOV	DX,AX
10F4 98                    2414 	CBW			;Extend sign
10F5 3B C2                 2415 	CMP	AX,DX		;See if in range +127 to -128
10F7 74 E3                 2416 	JZ	OBJBT		;If so, it's always OK
10F9 F6 D4                 2417 	NOT	AH		;Check for range +255 to -256
10FB 3A E6                 2418 	CMP	AH,DH
10FD 75 1B                 2419 	JNZ	RNGERR		;Must always be in this range
10FF                       2420 ;Check for short jump. If so, we're out of range; otherwise we're OK
10FF 81 FF AF 1F           2421 	CMP	DI,START+1	;Only one other byte on line?
1103 75 D7                 2422 	JNZ	OBJBT		;Can't be short jump if not
1105 A0 AE 1F              2423 	MOV	AL,[START]	;Get the first byte of this line
1108 3C EB                 2424 	CMP	AL,0EBH		;Direct short jump?
110A 74 0E                 2425 	JZ	RNGERR
110C 24 FC                 2426 	AND	AL,0FCH
110E 3C E0                 2427 	CMP	AL,0E0H		;LOOP or JCXZ instruction?
1110 74 08                 2428 	JZ	RNGERR
1112 24 F0                 2429 	AND	AL,0F0H
1114 3C 70                 2430 	CMP	AL,70H		;Conditional jump?
1116 8A C2                 2431 	MOV	AL,DL		;Get code byte in AL
1118 75 C2                 2432 	JNZ	OBJBT		;If not, we're OK
111A                       2433 RNGERR:
111A                       2434 	MOV	BYTE[ERR],101	;Value out of range
***** ERROR:  "," and second operand expected
111A E9 00 00              2435 	JMP SHORT	OBJBT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
111D                       2436 
111D E9 68 01              2437 FINIJ:	JMP	FINI
1120                       2438 
1120                       2439 EMARK:
1120 3C FF                 2440 	CMP	AL,-1		;End of file?
1122 74 F9                 2441 	JZ	FINIJ
1124 3C F6                 2442 	CMP	AL,-10		;Special item?
1126 77 5C                 2443 	JA	SPEND
1128 51                    2444 	PUSH	CX
1129 56                    2445 	PUSH	SI
112A 50                    2446 	PUSH	AX		;Save error code
112B 8A 26 AE 1F           2447 	MOV	AH,[LSTDEV]
112F 80 E4 FE              2448 	AND	AH,0FEH		;Reset error indicator
1132 0A 06 AE 1F           2449 	OR	AL,[ERR]	;See if any errors on this line
1136 74 03                 2450 	JZ	NOERR
1138 80 CC 01              2451 	OR	AH,1		;Send line to console if error occured
113B                       2452 NOERR:
113B 88 26 AE 1F           2453 	MOV	[LSTDEV],AH
113F 8B CF                 2454 	MOV	CX,DI
1141 E8 EF 00              2455 	CALL	STRTLIN		;Print address of line
1144 BE AE 1F              2456 	MOV	SI,START
1147 2B CE                 2457 	SUB	CX,SI		;Get count of bytes of code
1149 74 06                 2458 	JZ	SHOLIN
114B                       2459 CODLP:
114B AC                    2460 	LODSB
114C E8 3C 02              2461 	CALL	SAVCD		;Ouput code to HEX and PRN files
114F E2 FA                 2462 	LOOP	CODLP
1151                       2463 SHOLIN:
1151 B0 00                 2464 	MOV	AL,0
1153 86 06 AE 1F           2465 	XCHG	AL,[COUNT]
1157 B9 07 00              2466 	MOV	CX,7		;Allow 7 bytes of code per line
115A 2A C8                 2467 	SUB	CL,AL
115C B0 20                 2468 	MOV	AL,' '
115E 74 0B                 2469 	JZ	NOFIL
1160                       2470 BLNK:				;Put in 3 blanks for each byte not present
1160 E8 E0 00              2471 	CALL	LIST
1163 E8 DD 00              2472 	CALL	LIST
1166 E8 DA 00              2473 	CALL	LIST
1169 E2 F5                 2474 	LOOP	BLNK
116B                       2475 NOFIL:
116B E8 45 00              2476 	CALL	OUTLIN
116E 58                    2477 	POP	AX		;Restore error code
116F E8 42 02              2478 	CALL	REPERR
1172 A0 AE 1F              2479 	MOV	AL,[ERR]
1175 E8 3C 02              2480 	CALL	REPERR
1178 5E                    2481 	POP	SI
1179 59                    2482 	POP	CX
117A A0 AE 1F              2483 	MOV	AL,[SPC]	;Any special funtion?
117D 0A C0                 2484 	OR	AL,AL
117F 75 0D                 2485 	JNZ	SPCFUN
1181 E9 3F FF              2486 	JMP	FIXLINE
1184                       2487 
1184                       2488 SPEND:
1184 A2 AE 1F              2489 	MOV	[SPC],AL	;Record special function
1187 AD                    2490 	LODSW			;Get it's data
1188 A3 AE 1F              2491 	MOV	[DATA],AX
118B E9 40 FF              2492 	JMP	NEXBT
118E                       2493 
118E                       2494 SPCFUN:
118E 8B 16 AE 1F           2495 	MOV	DX,[DATA]
1192 3C FE                 2496 	CMP	AL,-2
1194 74 0F                 2497 	JZ	DORG
1196 3C FD                 2498 	CMP	AL,-3
1198 74 12                 2499 	JZ	DPUT
119A                       2500 DDS:
119A                       2501 ;Handle DS pseudo-op
119A 01 16 AE 1F           2502 	ADD	[PC],DX
119E 01 16 AE 1F           2503 	ADD	[HEXADD],DX
11A2 E9 1E FF              2504 	JMP	FIXLINE
11A5                       2505 
11A5                       2506 DORG:
11A5                       2507 ;Handle ORG pseudo-op
11A5 89 16 AE 1F           2508 	MOV	[PC],DX
11A9 E9 17 FF              2509 	JMP	FIXLINE
11AC                       2510 
11AC                       2511 DPUT:
11AC                       2512 ;Handle PUT pseudo-op
11AC 89 16 AE 1F           2513 	MOV	[HEXADD],DX
11B0 E9 10 FF              2514 	JMP	FIXLINE
11B3                       2515 
11B3                       2516 OUTLIN:
11B3                       2517 ;Copy the source line to the ouput device. Line will be preceded by
11B3                       2518 ;assembler-generated line number. This routine may be called several times
11B3                       2519 ;on one line (once for each line of object code bytes), so it sets a flag
11B3                       2520 ;so the line will only be output on the first call.
11B3 B0 FF                 2521 	MOV	AL,-1
11B5 86 06 AE 1F           2522 	XCHG	AL,[LINFLG]
11B9 0A C0                 2523 	OR	AL,AL
11BB 75 35                 2524 	JNZ	CRLF		;Output line only if first time
11BD A1 AE 1F              2525 	MOV	AX,[LINE]
11C0 40                    2526 	INC	AX
11C1 A3 AE 1F              2527 	MOV	[LINE],AX
11C4 B7 00                 2528 	MOV	BH,0		;No leading zero suppression
11C6 E8 33 00              2529 	CALL	OUT10
11C9 B0 20                 2530 	MOV	AL," "
11CB E8 75 00              2531 	CALL	LIST
11CE A0 98 1F              2532 	MOV	AL,[LSTFCB]
11D1 3C 5A                 2533 	CMP	AL,'Z'
11D3 74 1D                 2534 	JZ	CRLF		;Don't call NEXTCHR if listing suppressed
11D5 56                    2535 	PUSH	SI		;Save the only register destroyed by NEXTCHR
11D6                       2536 OUTLN:
11D6 E8 C0 F0              2537 	CALL	NEXTCHR
11D9 E8 67 00              2538 	CALL	LIST
11DC 3C 0A                 2539 	CMP	AL,10		;Output until linefeed found
11DE 75 F6                 2540 	JNZ	OUTLN
11E0 5E                    2541 	POP	SI
11E1 C3                    2542 	RET
11E2                       2543 
11E2                       2544 PRTCNT:
11E2 A1 AE 1F              2545 	MOV	AX,[ERRCNT]
11E5 BB 24 1F              2546 	MOV	BX,ERCNTM
11E8                       2547 PRNT10:
11E8 50                    2548 	PUSH	AX
11E9 E8 F4 01              2549 	CALL	PRINT
11EC 58                    2550 	POP	AX
11ED B7 10                 2551 	MOV	BH,"0"-" "	;Enable leading zero suppression
11EF E8 0A 00              2552 	CALL	OUT10
11F2                       2553 CRLF:
11F2 B0 0D                 2554 	MOV	AL,13
11F4 E8 4C 00              2555 	CALL	LIST
11F7 B0 0A                 2556 	MOV	AL,10
11F9 E9 00 00              2557 	JMP SHORT	LIST
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
11FC                       2558 
11FC                       2559 OUT10:
11FC 33 D2                 2560 	XOR	DX,DX
11FE BF 10 27              2561 	MOV	DI,10000
1201                       2562 	DIV	DI
***** ERROR:  Invalid operand
1201 0A C0                 2563 	OR	AL,AL		;>10,000?
1203 75 02                 2564 	JNZ	LEAD
1205 2C 10                 2565 	SUB	AL,"0"-" "	;Convert leading zero to blank
1207                       2566 LEAD:
1207 04 30                 2567 	ADD	AL,"0"
1209 E8 37 00              2568 	CALL	LIST
120C 92                    2569 	XCHG	AX,DX
120D B3 64                 2570 	MOV	BL,100
120F                       2571 	DIV	BL
***** ERROR:  Invalid operand
120F 8A DC                 2572 	MOV	BL,AH
1211 E8 0D 00              2573 	CALL	HIDIG		;Convert to decimal and print 1000s digit
1214 E8 0F 00              2574 	CALL	DIGIT		;Print 100s digit
1217 8A C3                 2575 	MOV	AL,BL
1219 E8 05 00              2576 	CALL	HIDIG		;Convert to decimal and print 10s digit
121C B7 00                 2577 	MOV	BH,0		;Ensure leading zero suppression is off
121E E9 00 00              2578 	JMP SHORT	DIGIT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
1221                       2579 
1221                       2580 HIDIG:
1221 D4 0A                 2581 	AAM			;Convert binary to unpacked BCD
1223 0D 30 30              2582 	OR	AX,3030H	;Add "0" bias
1226                       2583 DIGIT:
1226 86 C4                 2584 	XCHG	AL,AH
1228 3C 30                 2585 	CMP	AL,"0"
122A 74 02                 2586 	JZ	SUPZ
122C B7 00                 2587 	MOV	BH,0		;Turn off zero suppression if not zero
122E                       2588 SUPZ:
122E 2A C7                 2589 	SUB	AL,BH		;Convert leading zeros to blanks
1230 E9 00 00              2590 	JMP SHORT	LIST
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
1233                       2591 
1233                       2592 STRTLIN:
1233                       2593 	MOV	BYTE[LINFLG],0
***** ERROR:  "," and second operand expected
1233 8B 1E AE 1F           2594 	MOV	BX,[PC]
1237 8A C7                 2595 	MOV	AL,BH
1239 E8 3E 00              2596 	CALL	PHEX
123C 8A C3                 2597 	MOV	AL,BL
123E                       2598 PHEXB:
123E E8 39 00              2599 	CALL	PHEX
1241 B0 20                 2600 	MOV	AL,' '
1243                       2601 LIST:
1243 50                    2602 	PUSH	AX
1244 52                    2603 	PUSH	DX
1245 24 7F                 2604 	AND	AL,7FH
1247 8A D0                 2605 	MOV	DL,AL
1249                       2606 	TEST	BYTE[LSTDEV],3	;See if output goes to console
***** ERROR:  "," and second operand expected
1249 74 04                 2607 	JZ	PRNCHK
124B B4 02                 2608 	MOV	AH,2
124D CD 21                 2609 	INT	33		;Output to console
124F                       2610 PRNCHK:
124F                       2611 	TEST	BYTE[LSTDEV],4	;See if output goes to printer
***** ERROR:  "," and second operand expected
124F 74 04                 2612 	JZ	FILCHK
1251 B4 05                 2613 	MOV	AH,5
1253 CD 21                 2614 	INT	33		;Output to printer
1255                       2615 FILCHK:
1255 8A C2                 2616 	MOV	AL,DL
1257 5A                    2617 	POP	DX
1258                       2618 	TEST	BYTE[LSTDEV],80H	;See if output goes to a file
***** ERROR:  "," and second operand expected
1258 74 03                 2619 	JZ	LISTRET
125A E8 02 00              2620 	CALL	WRTBUF
125D                       2621 LISTRET:
125D 58                    2622 	POP	AX
125E C3                    2623 	RET
125F                       2624 
125F                       2625 WRTBUF:
125F 57                    2626 	PUSH	DI
1260 8B 3E AE 1F           2627 	MOV	DI,[LSTPNT]
1264 AA                    2628 	STOSB
1265 81 FF AE 23           2629 	CMP	DI,LSTBUF+LSTBUFSIZ
1269 75 09                 2630 	JNZ	SAVPT
126B 50                    2631 	PUSH	AX
126C 51                    2632 	PUSH	CX
126D 52                    2633 	PUSH	DX
126E E8 4A 02              2634 	CALL	FLUSHBUF
1271 5A                    2635 	POP	DX
1272 59                    2636 	POP	CX
1273 58                    2637 	POP	AX
1274                       2638 SAVPT:
1274 89 3E AE 1F           2639 	MOV	[LSTPNT],DI
1278 5F                    2640 	POP	DI
1279 C3                    2641 	RET
127A                       2642 
127A                       2643 PHEX:
127A 50                    2644 	PUSH	AX
127B E8 5D 02              2645 	CALL	UHALF
127E E8 C2 FF              2646 	CALL	LIST
1281 58                    2647 	POP	AX
1282 E8 56 02              2648 	CALL	LHALF
1285 E9 00 00              2649 	JMP SHORT	LIST
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
1288                       2650 
1288                       2651 FINI:
1288                       2652 
1288                       2653 	OR	BYTE[LSTDEV],1
***** ERROR:  "," and second operand expected
1288 E8 57 FF              2654 	CALL	PRTCNT
128B BB 35 1F              2655 	MOV	BX,SYMSIZE
128E A1 06 00              2656 	MOV	AX,[6]
1291 2B 06 AE 1F           2657 	SUB	AX,[HEAP]		;Size of symbol table
1295 E8 50 FF              2658 	CALL	PRNT10
1298 BB 4B 1F              2659 	MOV	BX,FRESIZE
129B A1 AE 1F              2660 	MOV	AX,[HEAP]
129E 2B 06 AE 1F           2661 	SUB	AX,[CODE]		;Free space remaining
12A2 E8 43 FF              2662 	CALL	PRNT10
12A5                       2663 	AND	BYTE[LSTDEV],0FEH
***** ERROR:  "," and second operand expected
12A5 A0 82 1F              2664 	MOV	AL,[HEXFCB]
12A8 3C 5A                 2665 	CMP	AL,'Z'
12AA 74 35                 2666 	JZ	SYMDMP
12AC A0 AE 1F              2667 	MOV	AL,[HEXCNT]
12AF 3C FB                 2668 	CMP	AL,-5
12B1 74 03                 2669 	JZ	L0012
12B3 E8 B7 01              2670 	CALL	ENHEXL
12B6                       2671 L0012:	
12B6 B0 3A                 2672 	MOV	AL,':'
12B8 E8 F6 01              2673 	CALL	PUTCHR
12BB B5 0A                 2674 	MOV	CH,10
12BD                       2675 HEXEND:
12BD 51                    2676 	PUSH	CX
12BE B0 30                 2677 	MOV	AL,'0'
12C0 E8 EE 01              2678 	CALL	PUTCHR
12C3 59                    2679 	POP	CX
12C4 FE CD                 2680 	DEC	CH
12C6 75 F5                 2681 	JNZ	HEXEND
12C8 B0 0D                 2682 	MOV	AL,13
12CA E8 E4 01              2683 	CALL	PUTCHR
12CD B0 0A                 2684 	MOV	AL,10
12CF E8 DF 01              2685 	CALL	PUTCHR
12D2 B0 1A                 2686 	MOV	AL,1AH
12D4 E8 DA 01              2687 	CALL	PUTCHR
12D7 E8 BC 01              2688 	CALL	WRTHEX		;Flush HEX file buffer
12DA BA 82 1F              2689 	MOV	DX,HEXFCB
12DD B4 10                 2690 	MOV	AH,CLOSE
12DF CD 21                 2691 	INT	33
12E1                       2692 SYMDMP:
12E1 A0 AE 1F              2693 	MOV	AL,[SYMFLG]
12E4 3C 53                 2694 	CMP	AL,'S'
12E6 75 25                 2695 	JNZ	ENDSYM
12E8 A0 AE 1F              2696 	MOV	AL,[LSTDEV]
12EB 0A C0                 2697 	OR	AL,AL		;Any output device for symbol table dump?
12ED 75 05                 2698 	JNZ	DOSYMTAB
12EF 0C 01                 2699 	OR	AL,1		;If not, send it to console
12F1 A2 AE 1F              2700 	MOV	[LSTDEV],AL
12F4                       2701 DOSYMTAB:
12F4                       2702 
12F4 BB 5F 1F              2703 	MOV	BX,SYMMES
12F7 E8 E6 00              2704 	CALL	PRINT
12FA 8B 16 AE 1F           2705 	MOV	DX,[BASE]
12FE 8A C6                 2706 	MOV	AL,DH
1300 0A C2                 2707 	OR	AL,DL
1302 74 09                 2708 	JZ	ENDSYM
1304                       2709 	MOV	BYTE[SYMLIN],SYMWID  ;No symbols on this line yet
***** ERROR:  "," and second operand expected
1304 8B 1E AE 1F           2710 	MOV	BX,[HEAP]
1308 8B E3                 2711 	MOV	SP,BX		;Need maximum stack for recursive tree walk
130A E8 15 00              2712 	CALL	NODE
130D                       2713 ENDSYM:
130D                       2714 	TEST	BYTE[LSTDEV],80H	;Print listing to file?
***** ERROR:  "," and second operand expected
130D 74 10                 2715 	JZ	EXIT
130F B0 1A                 2716 	MOV	AL,1AH
1311 E8 4B FF              2717 	CALL	WRTBUF		;Write end-of-file mark
1314 8B 3E AE 1F           2718 	MOV	DI,[LSTPNT]
1318 E8 A0 01              2719 	CALL	FLUSHBUF
131B B4 10                 2720 	MOV	AH,CLOSE
131D CD 21                 2721 	INT	33
131F E9 DE EC              2722 EXIT:	JMP	0
1322                       2723 
1322                       2724 NODE:
1322 87 DA                 2725 	XCHG	DX,BX
1324 53                    2726 	PUSH	BX
1325 8A 17                 2727 	MOV	DL,[BX]
1327 B6 00                 2728 	MOV	DH,0
1329 43                    2729 	INC	BX
132A 03 DA                 2730 	ADD	BX,DX
132C 8B 17                 2731 	MOV	DX,[BX]
132E 0B D2                 2732 	OR	DX,DX
1330 74 03                 2733 	JZ	L0014
1332 E8 ED FF              2734 	CALL	NODE
1335                       2735 L0014:	
1335 5B                    2736 	POP	BX
1336 8A 07                 2737 	MOV	AL,[BX]
1338 43                    2738 	INC	BX
1339 8A E8                 2739 	MOV	CH,AL
133B 04 18                 2740 	ADD	AL,24
133D                       2741 	SHR	AL,1
***** ERROR:  Invalid operand
133D                       2742 	SHR	AL,1
***** ERROR:  Invalid operand
133D                       2743 	SHR	AL,1
***** ERROR:  Invalid operand
133D 8A C8                 2744 	MOV	CL,AL
133F FE C1                 2745 	INC	CL		;Invert last bit
1341 80 E1 01              2746 	AND	CL,1		;Number of extra tabs needed (0 or 1)
1344                       2747 	SHR	AL,1		;Number of positions wide this symbol needs
***** ERROR:  Invalid operand
1344 28 06 AE 1F           2748 	SUB	[SYMLIN],AL
1348 73 0A                 2749 	JNC	WRTSYM		;Will it fit?
134A 2C 05                 2750 	SUB	AL,SYMWID
134C F6 D8                 2751 	NEG	AL
134E A2 AE 1F              2752 	MOV	[SYMLIN],AL
1351 E8 9E FE              2753 	CALL	CRLF		;Start new line if not
1354                       2754 WRTSYM:
1354 8A 07                 2755 	MOV	AL,[BX]
1356 43                    2756 	INC	BX
1357 E8 E9 FE              2757 	CALL	LIST
135A FE CD                 2758 	DEC	CH
135C 75 F6                 2759 	JNZ	WRTSYM
135E FE C1                 2760 	INC	CL
1360                       2761 TABVAL:
1360 B0 09                 2762 	MOV	AL,9
1362 E8 DE FE              2763 	CALL	LIST
1365 E2 F9                 2764 	LOOP	TABVAL
1367 43                    2765 	INC	BX
1368 43                    2766 	INC	BX
1369 53                    2767 	PUSH	BX
136A 8A 47 04              2768 	MOV	AL,[BX+4]
136D E8 0A FF              2769 	CALL	PHEX
1370 8A 47 03              2770 	MOV	AL,[BX+3]
1373 E8 04 FF              2771 	CALL	PHEX
1376                       2772 	CMP	BYTE[SYMLIN],0	;Will any more fit on line?
***** ERROR:  "," and second operand expected
1376 74 08                 2773 	JZ	NEXSYMLIN
1378 B0 09                 2774 	MOV	AL,9
137A E8 C6 FE              2775 	CALL	LIST
137D E9 00 00              2776 	JMP SHORT	RIGHTSON
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
1380                       2777 NEXSYMLIN:
1380 E8 6F FE              2778 	CALL	CRLF
1383                       2779 	MOV	BYTE[SYMLIN],SYMWID
***** ERROR:  "," and second operand expected
1383                       2780 RIGHTSON:
1383 5B                    2781 	POP	BX
1384 8B 17                 2782 	MOV	DX,[BX]
1386 0B D2                 2783 	OR	DX,DX
1388 75 98                 2784 	JNZ	NODE
138A C3                    2785 	RET
138B                       2786 
138B                       2787 SAVCD:
138B A2 AE 1F              2788 	MOV	[PREV],AL
138E 53                    2789 	PUSH	BX
138F 51                    2790 	PUSH	CX
1390 50                    2791 	PUSH	AX
1391 52                    2792 	PUSH	DX
1392 E8 6C 00              2793 	CALL	CODBYT
1395 5A                    2794 	POP	DX
1396 BB AE 1F              2795 	MOV	BX,COUNT
1399                       2796 	INC	BYTE[BX]
***** ERROR:  Destination must not be immediate value
1399 8A 07                 2797 	MOV	AL,[BX]
139B 3C 08                 2798 	CMP	AL,8
139D 75 0E                 2799 	JNZ	NOEXT
139F                       2800 	MOV	BYTE[BX],1
***** ERROR:  "," and second operand expected
139F E8 11 FE              2801 	CALL	OUTLIN
13A2 B0 20                 2802 	MOV	AL,' '
13A4 B5 05                 2803 	MOV	CH,5
13A6                       2804 TAB:
13A6 E8 9A FE              2805 	CALL	LIST
13A9 FE CD                 2806 	DEC	CH
13AB 75 F9                 2807 	JNZ	TAB
13AD                       2808 NOEXT:
13AD 58                    2809 	POP	AX
13AE E8 8D FE              2810 	CALL	PHEXB
13B1 59                    2811 	POP	CX
13B2                       2812 	INC	WORD[PC]
***** ERROR:  Destination must not be immediate value
13B2                       2813 	INC	WORD[HEXADD]
***** ERROR:  Destination must not be immediate value
13B2 5B                    2814 	POP	BX
13B3                       2815 REPERRUDRET:
13B3                       2816 PRINTUDRET:
13B3 C3                    2817 	RET
13B4                       2818 
13B4                       2819 REPERR:
13B4 0A C0                 2820 	OR	AL,AL		;Did an error occur?
13B6 74 FB                 2821 	JZ	REPERRUDRET
13B8                       2822 	INC	WORD[ERRCNT]
***** ERROR:  Destination must not be immediate value
13B8 50                    2823 	PUSH	AX
13B9 BB AE 1E              2824 	MOV	BX,ERRMES	;Print "ERROR"
13BC E8 21 00              2825 	CALL	PRINT
13BF 58                    2826 	POP	AX
13C0                       2827 ;We have error number in AL. See if there's an error message for it
13C0 BF DF 1A              2828 	MOV	DI,ERRTAB
13C3 B3 80                 2829 	MOV	BL,80H
13C5                       2830 ERRLOOK:
13C5 AE                    2831 	SCASB			;Do we have the error message
13C6 76 08                 2832 	JBE	HAVMES		;Quit looking if we have it or passed it
13C8 93                    2833 	XCHG	AX,BX		;Put 80H in AL to look for end of this message
13C9                       2834 NEXTMES:
13C9 AE                    2835 	SCASB			;Look for high bit set in message
13CA 77 FD                 2836 	JA	NEXTMES		;   which means we've reached the end
13CC 93                    2837 	XCHG	AX,BX		;Restore error number to AL
13CD E9 00 00              2838 	JMP SHORT	ERRLOOK		;Keep looking
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
13D0                       2839 
13D0                       2840 HAVMES:
13D0 8B DF                 2841 	MOV	BX,DI		;Put address of message in BX
13D2 74 06                 2842 	JZ	PRNERR		;Do we have a message for this error?
13D4 E8 A3 FE              2843 	CALL	PHEX		;If not, just print error number
13D7 E9 18 FE              2844 	JMP	CRLF
13DA                       2845 
13DA                       2846 PRNERR:
13DA E8 03 00              2847 	CALL	PRINT
13DD E9 12 FE              2848 	JMP	CRLF
13E0                       2849 
13E0                       2850 PRINT:
13E0 8A 07                 2851 	MOV	AL,[BX]
13E2 E8 5E FE              2852 	CALL	LIST
13E5 0A C0                 2853 	OR	AL,AL
13E7 78 CA                 2854 	JS	PRINTUDRET
13E9 43                    2855 	INC	BX
13EA E9 00 00              2856 	JMP SHORT	PRINT
***** ERROR:  Invalid operand
***** ERROR:  Undefined label
13ED                       2857 OUTA:
13ED 8A D0                 2858 	MOV	DL,AL
13EF                       2859 OUT:
13EF 80 E2 7F              2860 	AND	DL,7FH
13F2 B1 02                 2861 	MOV	CL,2
13F4                       2862 SYSTEM:
13F4                       2863 	;CLOSE INPUT FILE
13F4 BA 5C 00              2864 	MOV	DX,FCB
13F7 B4 10                 2865 	MOV	AH,CLOSE
13F9 CD 21                 2866 	INT	33
13FB 90                    2867 	NOP
13FC B8 00 4C              2868 	MOV AX,4C00H
13FF CD 21                 2869 	INT 21H		;Terminate program
1401                       2870 	;CALL	5
1401                       2871 	;RET
1401                       2872 
1401                       2873 CODBYT:
1401                       2874 	CMP	BYTE[HEXFCB],"Z"
***** ERROR:  "," and second operand expected
1401 74 AD                 2875 	JZ	CODBYTUDRET
***** ERROR:  Value out of range (forward)
1403 50                    2876 	PUSH	AX
1404 8B 16 AE 1F           2877 	MOV	DX,[LASTAD]
1408 8B 1E AE 1F           2878 	MOV	BX,[HEXADD]
140C 89 1E AE 1F           2879 	MOV	[LASTAD],BX
1410 42                    2880 	INC	DX
1411 A0 AE 1F              2881 	MOV	AL,[HEXCNT]
1414 3C FB                 2882 	CMP	AL,-5
1416 74 07                 2883 	JZ	NEWLIN
1418 3B DA                 2884 	CMP	BX,DX
141A 74 2E                 2885 	JZ	AFHEX
141C E8 4E 00              2886 	CALL	ENHEXL
141F                       2887 NEWLIN:
141F B0 3A                 2888 	MOV	AL,':'
1421 E8 8D 00              2889 	CALL	PUTCHR
1424 B0 FC                 2890 	MOV	AL,-4
1426 A2 AE 1F              2891 	MOV	[HEXCNT],AL
1429 32 C0                 2892 	XOR	AL,AL
142B A2 AE 1F              2893 	MOV	[CHKSUM],AL
142E 8B 1E AE 1F           2894 	MOV	BX,[HEXPNT]
1432 89 1E AE 1F           2895 	MOV	[HEXLEN],BX
1436 E8 12 00              2896 	CALL	HEXBYT
1439 A0 AF 1F              2897 	MOV	AL,[HEXADD+1]
143C E8 0C 00              2898 	CALL	HEXBYT
143F A0 AE 1F              2899 	MOV	AL,[HEXADD]
1442 E8 06 00              2900 	CALL	HEXBYT
1445 32 C0                 2901 	XOR	AL,AL
1447 E8 01 00              2902 	CALL	HEXBYT
144A                       2903 AFHEX:
144A 58                    2904 	POP	AX
144B                       2905 HEXBYT:
144B 8A E8                 2906 	MOV	CH,AL
144D BB AE 1F              2907 	MOV	BX,CHKSUM
1450 02 07                 2908 	ADD	AL,[BX]
1452 88 07                 2909 	MOV	[BX],AL
1454 8A C5                 2910 	MOV	AL,CH
1456 E8 82 00              2911 	CALL	UHALF
1459 E8 55 00              2912 	CALL	PUTCHR
145C 8A C5                 2913 	MOV	AL,CH
145E E8 7A 00              2914 	CALL	LHALF
1461 E8 4D 00              2915 	CALL	PUTCHR
1464 BB AE 1F              2916 	MOV	BX,HEXCNT
1467                       2917 	INC	BYTE[BX]
***** ERROR:  Destination must not be immediate value
1467 8A 07                 2918 	MOV	AL,[BX]
1469 3C 1A                 2919 	CMP	AL,26
146B 75 43                 2920 	JNZ	CODBYTUDRET
146D                       2921 ENHEXL:
146D 8B 3E AE 1F           2922 	MOV	DI,[HEXLEN]
1471 8A E8                 2923 	MOV	CH,AL
1473 E8 65 00              2924 	CALL	UHALF
1476 AA                    2925 	STOSB
1477 8A C5                 2926 	MOV	AL,CH
1479 E8 5F 00              2927 	CALL	LHALF
147C AA                    2928 	STOSB
147D B0 FA                 2929 	MOV	AL,-6
147F A2 AE 1F              2930 	MOV	[HEXCNT],AL
1482 A0 AE 1F              2931 	MOV	AL,[CHKSUM]
1485 02 C5                 2932 	ADD	AL,CH
1487 F6 D8                 2933 	NEG	AL
1489 E8 BF FF              2934 	CALL	HEXBYT
148C B0 0D                 2935 	MOV	AL,13
148E E8 20 00              2936 	CALL	PUTCHR
1491 B0 0A                 2937 	MOV	AL,10
1493 E8 1B 00              2938 	CALL	PUTCHR
1496                       2939 WRTHEX:
1496                       2940 ;Write out the line
1496 BA AE 1F              2941 	MOV	DX,HEXBUF
1499 89 16 AE 1F           2942 	MOV	[HEXPNT],DX
149D B4 1A                 2943 	MOV	AH,SETDMA
149F CD 21                 2944 	INT	33
14A1 2B FA                 2945 	SUB	DI,DX		;Length of buffer
14A3 8B CF                 2946 	MOV	CX,DI
14A5 BA 82 1F              2947 	MOV	DX,HEXFCB
14A8 B4 28                 2948 	MOV	AH,BLKWRT
14AA CD 21                 2949 	INT	33
14AC 0A C0                 2950 	OR	AL,AL
14AE 75 25                 2951 	JNZ	DSKFUL
14B0                       2952 CODBYTUDRET:
14B0                       2953 FLUSHBUFUDRET:
14B0 C3                    2954 	RET
14B1                       2955 PUTCHR:
14B1 8B 3E AE 1F           2956 	MOV	DI,[HEXPNT]
14B5 AA                    2957 	STOSB
14B6 89 3E AE 1F           2958 	MOV	[HEXPNT],DI
14BA C3                    2959 	RET
14BB                       2960 
14BB                       2961 FLUSHBUF:
14BB 8B CF                 2962 	MOV	CX,DI
14BD BA AE 1F              2963 	MOV	DX,LSTBUF
14C0 8B FA                 2964 	MOV	DI,DX
14C2 2B CA                 2965 	SUB	CX,DX
14C4 74 EA                 2966 	JZ	FLUSHBUFUDRET		;Buffer empty?
14C6 B4 1A                 2967 	MOV	AH,SETDMA
14C8 CD 21                 2968 	INT	33
14CA BA 98 1F              2969 	MOV	DX,LSTFCB
14CD B4 28                 2970 	MOV	AH,BLKWRT
14CF CD 21                 2971 	INT	33
14D1 0A C0                 2972 	OR	AL,AL
14D3 74 DB                 2973 	JZ	FLUSHBUFUDRET
14D5                       2974 DSKFUL:
14D5 BB FF 1E              2975 	MOV	BX,WRTERR
14D8 E9 81 ED              2976 	JMP	PRERR
14DB                       2977 UHALF:
14DB                       2978 	RCR	AL,1
***** ERROR:  Invalid operand
14DB                       2979 	RCR	AL,1
***** ERROR:  Invalid operand
14DB                       2980 	RCR	AL,1
***** ERROR:  Invalid operand
14DB                       2981 	RCR	AL,1
***** ERROR:  Invalid operand
14DB                       2982 LHALF:
14DB 24 0F                 2983 	AND	AL,0FH
14DD 0C 30                 2984 	OR	AL,30H
14DF 3C 3A                 2985 	CMP	AL,'9'+1
14E1 72 02                 2986 	JC	LHALFUDRET
14E3 04 07                 2987 	ADD	AL,7
14E5                       2988 LHALFUDRET:
14E5 C3                    2989 	RET
14E6                       2990 
14E6 00                    2991 NONE:	DB	0
14E7                       2992 
14E7                       2993 ; 8086 MNEMONIC TABLE
14E7                       2994 
14E7                       2995 ; This table is actually a sequence of subtables, each starting with a label.
14E7                       2996 ; The label signifies which mnemonics the subtable applies to--A3, for example,
14E7                       2997 ; means all 3-letter mnemonics beginning with A.
14E7                       2998 
14E7                       2999 A3:
14E7 07                    3000 	DB	7
14E8 64 64                 3001 	DB	'dd'
14EA 26 0D                 3002 	DW	GRP7
14EC 02                    3003 	DB	2
14ED 6E 64                 3004 	DB	'nd'
14EF FE 0D                 3005 	DW	GRP13
14F1 22                    3006 	DB	22H
14F2 64 63                 3007 	DB	'dc'
14F4 26 0D                 3008 	DW	GRP7
14F6 12                    3009 	DB	12H
14F7 61 61                 3010 	DB	'aa'
14F9 0F 0B                 3011 	DW	PUT
14FB 37                    3012 	DB	37H
14FC 61 73                 3013 	DB	'as'
14FE 0F 0B                 3014 	DW	PUT
1500 3F                    3015 	DB	3FH
1501 61 6D                 3016 	DB	'am'
1503 CC 0D                 3017 	DW	GRP11
1505 D4                    3018 	DB	0D4H
1506 61 64                 3019 	DB	'ad'
1508 CC 0D                 3020 	DW	GRP11
150A D5                    3021 	DB	0D5H
150B                       3022 A5:
150B 01                    3023 	DB	1
150C 6C 69 67 6E           3024 	DB	'lign'
1510 D1 0C                 3025 	DW	UDALIGN
1512 00                    3026 	DB	0
1513                       3027 C3:
1513 07                    3028 	DB	7
1514 6D 70                 3029 	DB	'mp'
1516 26 0D                 3030 	DW	GRP7
1518 3A                    3031 	DB	3AH
1519 6C 63                 3032 	DB	'lc'
151B 0F 0B                 3033 	DW	PUT
151D F8                    3034 	DB	0F8H
151E 6C 64                 3035 	DB	'ld'
1520 0F 0B                 3036 	DW	PUT
1522 FC                    3037 	DB	0FCH
1523 6C 69                 3038 	DB	'li'
1525 0F 0B                 3039 	DW	PUT
1527 FA                    3040 	DB	0FAH
1528 6D 63                 3041 	DB	'mc'
152A 0F 0B                 3042 	DW	PUT
152C F5                    3043 	DB	0F5H
152D 62 77                 3044 	DB	'bw'
152F 0F 0B                 3045 	DW	PUT
1531 98                    3046 	DB	98H
1532 77 64                 3047 	DB	'wd'
1534 0F 0B                 3048 	DW	PUT
1536 99                    3049 	DB	99H
1537                       3050 C4:
1537 03                    3051 	DB	3
1538 61 6C 6C              3052 	DB	'all'
153B 28 0E                 3053 	DW	GRP14
153D 9A                    3054 	DB	9AH
153E 6D 70 62              3055 	DB	'mpb'
1541 0F 0B                 3056 	DW	PUT
1543 A6                    3057 	DB	0A6H
1544 6D 70 77              3058 	DB	'mpw'
1547 0F 0B                 3059 	DW	PUT
1549 A7                    3060 	DB	0A7H
154A                       3061 C5:
154A 02                    3062 	DB	2
154B 6D 70 73 62           3063 	DB	'mpsb'
154F 0F 0B                 3064 	DW	PUT
1551 A6                    3065 	DB	0A6H
1552 6D 70 73 77           3066 	DB	'mpsw'
1556 0F 0B                 3067 	DW	PUT
1558 A7                    3068 	DB	0A7H
1559                       3069 D2:
1559 05                    3070 	DB	5
155A 62                    3071 	DB	'b'
155B 14 10                 3072 	DW	GRP23
155D 01                    3073 	DB	1
155E 77                    3074 	DB	'w'
155F 14 10                 3075 	DW	GRP23
1561 00                    3076 	DB	0
1562 6D                    3077 	DB	'm'
1563 14 10                 3078 	DW	GRP23
1565 02                    3079 	DB	2
1566 73                    3080 	DB	's'
1567 9E 0C                 3081 	DW	GRP5
1569 01                    3082 	DB	1
156A 69                    3083 	DB	'i'
156B 0F 0B                 3084 	DW	PUT
156D FA                    3085 	DB	0FAH
156E                       3086 D3:
156E 04                    3087 	DB	4
156F 65 63                 3088 	DB	'ec'
1571 4E 0D                 3089 	DW	GRP8
1573 49                    3090 	DB	49H
1574 69 76                 3091 	DB	'iv'
1576 A3 0D                 3092 	DW	GRP10
1578 30                    3093 	DB	30H
1579 61 61                 3094 	DB	'aa'
157B 0F 0B                 3095 	DW	PUT
157D 27                    3096 	DB	27H
157E 61 73                 3097 	DB	'as'
1580 0F 0B                 3098 	DW	PUT
1582 2F                    3099 	DB	2FH
1583                       3100 D4:
1583 01                    3101 	DB	1
1584 6F 77 6E              3102 	DB	'own'
1587 0F 0B                 3103 	DW	PUT
1589 FD                    3104 	DB	0FDH
158A                       3105 E2:
158A 01                    3106 	DB	1
158B 69                    3107 	DB	'i'
158C 0F 0B                 3108 	DW	PUT
158E FB                    3109 	DB	0FBH
158F                       3110 E3:
158F 03                    3111 	DB	3
1590 71 75                 3112 	DB	'qu'
1592 9E 0C                 3113 	DW	GRP5
1594 02                    3114 	DB	2
1595 73 63                 3115 	DB	'sc'
1597 7B 0F                 3116 	DW	GRP19
1599 D8                    3117 	DB	0D8H
159A 6E 64                 3118 	DB	'nd'
159C 94 10                 3119 	DW	UDEND
159E 00                    3120 	DB	0
159F                       3121 E5:
159F 01                    3122 	DB	1
15A0 6E 64 69 66           3123 	DB	'ndif'
15A4 84 10                 3124 	DW	UDENDIF
15A6 00                    3125 	DB	0
15A7                       3126 H3:
15A7 01                    3127 	DB	1
15A8 6C 74                 3128 	DB	'lt'
15AA 0F 0B                 3129 	DW	PUT
15AC F4                    3130 	DB	0F4H
15AD                       3131 H4:
15AD 01                    3132 	DB	1
15AE 61 6C 74              3133 	DB	'alt'
15B1 0F 0B                 3134 	DW	PUT
15B3 F4                    3135 	DB	0F4H
15B4                       3136 I2:
15B4 02                    3137 	DB	2
15B5 6E                    3138 	DB	'n'
15B6 78 0C                 3139 	DW	GRP4
15B8 E4                    3140 	DB	0E4H
15B9 66                    3141 	DB	'f'
15BA 9E 0C                 3142 	DW	GRP5
15BC 04                    3143 	DB	4
15BD                       3144 I3:
15BD 04                    3145 	DB	4
15BE 6E 63                 3146 	DB	'nc'
15C0 4E 0D                 3147 	DW	GRP8
15C2 41                    3148 	DB	41H
15C3 6E 62                 3149 	DB	'nb'
15C5 78 0C                 3150 	DW	GRP4
15C7 E4                    3151 	DB	0E4H
15C8 6E 77                 3152 	DB	'nw'
15CA 78 0C                 3153 	DW	GRP4
15CC E5                    3154 	DB	0E5H
15CD 6E 74                 3155 	DB	'nt'
15CF 50 0F                 3156 	DW	GRP18
15D1 CC                    3157 	DB	0CCH
15D2                       3158 I4:
15D2 04                    3159 	DB	4
15D3 6D 75 6C              3160 	DB	'mul'
15D6 A3 0D                 3161 	DW	GRP10
15D8 28                    3162 	DB	28H
15D9 64 69 76              3163 	DB	'div'
15DC A3 0D                 3164 	DW	GRP10
15DE 38                    3165 	DB	38H
15DF 72 65 74              3166 	DB	'ret'
15E2 0F 0B                 3167 	DW	PUT
15E4 CF                    3168 	DB	0CFH
15E5 6E 74 6F              3169 	DB	'nto'
15E8 0F 0B                 3170 	DW	PUT
15EA CE                    3171 	DB	0CEH
15EB                       3172 J2:
15EB 0A                    3173 	DB	10
15EC 70                    3174 	DB	'p'
15ED 17 0F                 3175 	DW	GRP17
15EF EB                    3176 	DB	0EBH
15F0 7A                    3177 	DB	'z'
15F1 17 0F                 3178 	DW	GRP17
15F3 74                    3179 	DB	74H
15F4 65                    3180 	DB	'e'
15F5 17 0F                 3181 	DW	GRP17
15F7 74                    3182 	DB	74H
15F8 6C                    3183 	DB	'l'
15F9 17 0F                 3184 	DW	GRP17
15FB 7C                    3185 	DB	7CH
15FC 62                    3186 	DB	'b'
15FD 17 0F                 3187 	DW	GRP17
15FF 72                    3188 	DB	72H
1600 61                    3189 	DB	'a'
1601 17 0F                 3190 	DW	GRP17
1603 77                    3191 	DB	77H
1604 67                    3192 	DB	'g'
1605 17 0F                 3193 	DW	GRP17
1607 7F                    3194 	DB	7FH
1608 6F                    3195 	DB	'o'
1609 17 0F                 3196 	DW	GRP17
160B 70                    3197 	DB	70H
160C 73                    3198 	DB	's'
160D 17 0F                 3199 	DW	GRP17
160F 78                    3200 	DB	78H
1610 63                    3201 	DB	'c'
1611 17 0F                 3202 	DW	GRP17
1613 72                    3203 	DB	72H
1614                       3204 J3:
1614 11                    3205 	DB	17
1615 6D 70                 3206 	DB	'mp'
1617 28 0E                 3207 	DW	GRP14
1619 EA                    3208 	DB	0EAH
161A 6E 7A                 3209 	DB	'nz'
161C 17 0F                 3210 	DW	GRP17
161E 75                    3211 	DB	75H
161F 6E 65                 3212 	DB	'ne'
1621 17 0F                 3213 	DW	GRP17
1623 75                    3214 	DB	75H
1624 6E 6C                 3215 	DB	'nl'
1626 17 0F                 3216 	DW	GRP17
1628 7D                    3217 	DB	7DH
1629 67 65                 3218 	DB	'ge'
162B 17 0F                 3219 	DW	GRP17
162D 7D                    3220 	DB	7DH
162E 6E 62                 3221 	DB	'nb'
1630 17 0F                 3222 	DW	GRP17
1632 73                    3223 	DB	73H
1633 61 65                 3224 	DB	'ae'
1635 17 0F                 3225 	DW	GRP17
1637 73                    3226 	DB	73H
1638 6E 63                 3227 	DB	'nc'
163A 17 0F                 3228 	DW	GRP17
163C 73                    3229 	DB	73H
163D 6E 67                 3230 	DB	'ng'
163F 17 0F                 3231 	DW	GRP17
1641 7E                    3232 	DB	7EH
1642 6C 65                 3233 	DB	'le'
1644 17 0F                 3234 	DW	GRP17
1646 7E                    3235 	DB	7EH
1647 6E 61                 3236 	DB	'na'
1649 17 0F                 3237 	DW	GRP17
164B 76                    3238 	DB	76H
164C 62 65                 3239 	DB	'be'
164E 17 0F                 3240 	DW	GRP17
1650 76                    3241 	DB	76H
1651 70 65                 3242 	DB	'pe'
1653 17 0F                 3243 	DW	GRP17
1655 7A                    3244 	DB	7AH
1656 6E 70                 3245 	DB	'np'
1658 17 0F                 3246 	DW	GRP17
165A 7B                    3247 	DB	7BH
165B 70 6F                 3248 	DB	'po'
165D 17 0F                 3249 	DW	GRP17
165F 7B                    3250 	DB	7BH
1660 6E 6F                 3251 	DB	'no'
1662 17 0F                 3252 	DW	GRP17
1664 71                    3253 	DB	71H
1665 6E 73                 3254 	DB	'ns'
1667 17 0F                 3255 	DW	GRP17
1669 79                    3256 	DB	79H
166A                       3257 J4:
166A 06                    3258 	DB	6
166B 6D 70 73              3259 	DB	'mps'
166E 17 0F                 3260 	DW	GRP17
1670 EB                    3261 	DB	0EBH
1671 63 78 7A              3262 	DB	'cxz'
1674 17 0F                 3263 	DW	GRP17
1676 E3                    3264 	DB	0E3H
1677 6E 67 65              3265 	DB	'nge'
167A 17 0F                 3266 	DW	GRP17
167C 7C                    3267 	DB	7CH
167D 6E 61 65              3268 	DB	'nae'
1680 17 0F                 3269 	DW	GRP17
1682 72                    3270 	DB	72H
1683 6E 62 65              3271 	DB	'nbe'
1686 17 0F                 3272 	DW	GRP17
1688 77                    3273 	DB	77H
1689 6E 6C 65              3274 	DB	'nle'
168C 17 0F                 3275 	DW	GRP17
168E 7F                    3276 	DB	7FH
168F                       3277 L3:
168F 03                    3278 	DB	3
1690 65 61                 3279 	DB	'ea'
1692 1A 0D                 3280 	DW	GRP6
1694 8D                    3281 	DB	8DH
1695 64 73                 3282 	DB	'ds'
1697 1A 0D                 3283 	DW	GRP6
1699 C5                    3284 	DB	0C5H
169A 65 73                 3285 	DB	'es'
169C 1A 0D                 3286 	DW	GRP6
169E C4                    3287 	DB	0C4H
169F                       3288 L4:
169F 05                    3289 	DB	5
16A0 6F 6F 70              3290 	DB	'oop'
16A3 17 0F                 3291 	DW	GRP17
16A5 E2                    3292 	DB	0E2H
16A6 6F 64 62              3293 	DB	'odb'
16A9 0F 0B                 3294 	DW	PUT
16AB AC                    3295 	DB	0ACH
16AC 6F 64 77              3296 	DB	'odw'
16AF 0F 0B                 3297 	DW	PUT
16B1 AD                    3298 	DB	0ADH
16B2 61 68 66              3299 	DB	'ahf'
16B5 0F 0B                 3300 	DW	PUT
16B7 9F                    3301 	DB	9FH
16B8 6F 63 6B              3302 	DB	'ock'
16BB 0F 0B                 3303 	DW	PUT
16BD F0                    3304 	DB	0F0H
16BE                       3305 L5:
16BE 04                    3306 	DB	4
16BF 6F 6F 70 65           3307 	DB	'oope'
16C3 17 0F                 3308 	DW	GRP17
16C5 E1                    3309 	DB	0E1H
16C6 6F 6F 70 7A           3310 	DB	'oopz'
16CA 17 0F                 3311 	DW	GRP17
16CC E1                    3312 	DB	0E1H
16CD 6F 64 73 62           3313 	DB	'odsb'
16D1 0F 0B                 3314 	DW	PUT
16D3 AC                    3315 	DB	0ACH
16D4 6F 64 73 77           3316 	DB	'odsw'
16D8 0F 0B                 3317 	DW	PUT
16DA AD                    3318 	DB	0ADH
16DB                       3319 L6:
16DB 02                    3320 	DB	2
16DC 6F 6F 70 6E 65        3321 	DB	'oopne'
16E1 17 0F                 3322 	DW	GRP17
16E3 E0                    3323 	DB	0E0H
16E4 6F 6F 70 6E 7A        3324 	DB	'oopnz'
16E9 17 0F                 3325 	DW	GRP17
16EB E0                    3326 	DB	0E0H
16EC                       3327 M3:
16EC 02                    3328 	DB	2
16ED 6F 76                 3329 	DB	'ov'
16EF A5 0A                 3330 	DW	GRP1
16F1 88                    3331 	DB	88H
16F2 75 6C                 3332 	DB	'ul'
16F4 A3 0D                 3333 	DW	GRP10
16F6 20                    3334 	DB	20H
16F7                       3335 M4:
16F7 02                    3336 	DB	2
16F8 6F 76 62              3337 	DB	'ovb'
16FB 0F 0B                 3338 	DW	PUT
16FD A4                    3339 	DB	0A4H
16FE 6F 76 77              3340 	DB	'ovw'
1701 0F 0B                 3341 	DW	PUT
1703 A5                    3342 	DB	0A5H
1704                       3343 M5:
1704 02                    3344 	DB	2
1705 6F 76 73 62           3345 	DB	'ovsb'
1709 0F 0B                 3346 	DW	PUT
170B A4                    3347 	DB	0A4H
170C 6F 76 73 77           3348 	DB	'ovsw'
1710 0F 0B                 3349 	DW	PUT
1712 A5                    3350 	DB	0A5H
1713                       3351 N3:
1713 03                    3352 	DB	3
1714 6F 74                 3353 	DB	'ot'
1716 55 0D                 3354 	DW	GRP9
1718 10                    3355 	DB	10H
1719 65 67                 3356 	DB	'eg'
171B 55 0D                 3357 	DW	GRP9
171D 18                    3358 	DB	18H
171E 6F 70                 3359 	DB	'op'
1720 0F 0B                 3360 	DW	PUT
1722 90                    3361 	DB	90H
1723                       3362 O2:
1723 01                    3363 	DB	1
1724 72                    3364 	DB	'r'
1725 FE 0D                 3365 	DW	GRP13
1727 0A                    3366 	DB	0AH
1728                       3367 O3:
1728 02                    3368 	DB	2
1729 75 74                 3369 	DB	'ut'
172B 78 0C                 3370 	DW	GRP4
172D E6                    3371 	DB	0E6H
172E 72 67                 3372 	DB	'rg'
1730 9E 0C                 3373 	DW	GRP5
1732 00                    3374 	DB	0
1733                       3375 O4:
1733 02                    3376 	DB	2
1734 75 74 62              3377 	DB	'utb'
1737 78 0C                 3378 	DW	GRP4
1739 E6                    3379 	DB	0E6H
173A 75 74 77              3380 	DB	'utw'
173D 78 0C                 3381 	DW	GRP4
173F E7                    3382 	DB	0E7H
1740                       3383 P3:
1740 02                    3384 	DB	2
1741 6F 70                 3385 	DB	'op'
1743 F3 0F                 3386 	DW	GRP22
1745 8F                    3387 	DB	8FH
1746 75 74                 3388 	DB	'ut'
1748 9E 0C                 3389 	DW	GRP5
174A 03                    3390 	DB	3
174B                       3391 P4:
174B 02                    3392 	DB	2
174C 75 73 68              3393 	DB	'ush'
174F E7 0B                 3394 	DW	GRP2
1751 FF                    3395 	DB	0FFH
1752 6F 70 66              3396 	DB	'opf'
1755 0F 0B                 3397 	DW	PUT
1757 9D                    3398 	DB	9DH
1758                       3399 P5:
1758 01                    3400 	DB	1
1759 75 73 68 66           3401 	DB	'ushf'
175D 0F 0B                 3402 	DW	PUT
175F 9C                    3403 	DB	9CH
1760                       3404 R3:
1760 06                    3405 	DB	6
1761 65 74                 3406 	DB	'et'
1763 A1 0E                 3407 	DW	GRP16
1765 C3                    3408 	DB	0C3H
1766 65 70                 3409 	DB	'ep'
1768 0F 0B                 3410 	DW	PUT
176A F3                    3411 	DB	0F3H
176B 6F 6C                 3412 	DB	'ol'
176D D4 0D                 3413 	DW	GRP12
176F 00                    3414 	DB	0
1770 6F 72                 3415 	DB	'or'
1772 D4 0D                 3416 	DW	GRP12
1774 08                    3417 	DB	8
1775 63 6C                 3418 	DB	'cl'
1777 D4 0D                 3419 	DW	GRP12
1779 10                    3420 	DB	10H
177A 63 72                 3421 	DB	'cr'
177C D4 0D                 3422 	DW	GRP12
177E 18                    3423 	DB	18H
177F                       3424 R4:
177F 02                    3425 	DB	2
1780 65 70 7A              3426 	DB	'epz'
1783 0F 0B                 3427 	DW	PUT
1785 F3                    3428 	DB	0F3H
1786 65 70 65              3429 	DB	'epe'
1789 0F 0B                 3430 	DW	PUT
178B F3                    3431 	DB	0F3H
178C                       3432 R5:
178C 02                    3433 	DB	2
178D 65 70 6E 7A           3434 	DB	'epnz'
1791 0F 0B                 3435 	DW	PUT
1793 F2                    3436 	DB	0F2H
1794 65 70 6E 65           3437 	DB	'epne'
1798 0F 0B                 3438 	DW	PUT
179A F2                    3439 	DB	0F2H
179B                       3440 S3:
179B 0B                    3441 	DB	11
179C 75 62                 3442 	DB	'ub'
179E 26 0D                 3443 	DW	GRP7
17A0 2A                    3444 	DB	2AH
17A1 62 62                 3445 	DB	'bb'
17A3 26 0D                 3446 	DW	GRP7
17A5 1A                    3447 	DB	1AH
17A6 62 63                 3448 	DB	'bc'
17A8 26 0D                 3449 	DW	GRP7
17AA 1A                    3450 	DB	1AH
17AB 74 63                 3451 	DB	'tc'
17AD 0F 0B                 3452 	DW	PUT
17AF F9                    3453 	DB	0F9H
17B0 74 64                 3454 	DB	'td'
17B2 0F 0B                 3455 	DW	PUT
17B4 FD                    3456 	DB	0FDH
17B5 74 69                 3457 	DB	'ti'
17B7 0F 0B                 3458 	DW	PUT
17B9 FB                    3459 	DB	0FBH
17BA 68 6C                 3460 	DB	'hl'
17BC D4 0D                 3461 	DW	GRP12
17BE 20                    3462 	DB	20H
17BF 68 72                 3463 	DB	'hr'
17C1 D4 0D                 3464 	DW	GRP12
17C3 28                    3465 	DB	28H
17C4 61 6C                 3466 	DB	'al'
17C6 D4 0D                 3467 	DW	GRP12
17C8 20                    3468 	DB	20H
17C9 61 72                 3469 	DB	'ar'
17CB D4 0D                 3470 	DW	GRP12
17CD 38                    3471 	DB	38H
17CE 65 67                 3472 	DB	'eg'
17D0 DB 0F                 3473 	DW	GRP21
17D2 26                    3474 	DB	26H
17D3                       3475 S4:
17D3 05                    3476 	DB	5
17D4 63 61 62              3477 	DB	'cab'
17D7 0F 0B                 3478 	DW	PUT
17D9 AE                    3479 	DB	0AEH
17DA 63 61 77              3480 	DB	'caw'
17DD 0F 0B                 3481 	DW	PUT
17DF AF                    3482 	DB	0AFH
17E0 74 6F 62              3483 	DB	'tob'
17E3 0F 0B                 3484 	DW	PUT
17E5 AA                    3485 	DB	0AAH
17E6 74 6F 77              3486 	DB	'tow'
17E9 0F 0B                 3487 	DW	PUT
17EB AB                    3488 	DB	0ABH
17EC 61 68 66              3489 	DB	'ahf'
17EF 0F 0B                 3490 	DW	PUT
17F1 9E                    3491 	DB	9EH
17F2                       3492 S5:
17F2 04                    3493 	DB	4
17F3 63 61 73 62           3494 	DB	'casb'
17F7 0F 0B                 3495 	DW	PUT
17F9 AE                    3496 	DB	0AEH
17FA 63 61 73 77           3497 	DB	'casw'
17FE 0F 0B                 3498 	DW	PUT
1800 AF                    3499 	DB	0AFH
1801 74 6F 73 62           3500 	DB	'tosb'
1805 0F 0B                 3501 	DW	PUT
1807 AA                    3502 	DB	0AAH
1808 74 6F 73 77           3503 	DB	'tosw'
180C 0F 0B                 3504 	DW	PUT
180E AB                    3505 	DB	0ABH
180F                       3506 T4:
180F 01                    3507 	DB	1
1810 65 73 74              3508 	DB	'est'
1813 CA 0F                 3509 	DW	GRP20
1815 84                    3510 	DB	84H
1816                       3511 U2:
1816 01                    3512 	DB	1
1817 70                    3513 	DB	'p'
1818 0F 0B                 3514 	DW	PUT
181A FC                    3515 	DB	0FCH
181B                       3516 W4:
181B 01                    3517 	DB	1
181C 61 69 74              3518 	DB	'ait'
181F 0F 0B                 3519 	DW	PUT
1821 9B                    3520 	DB	9BH
1822                       3521 X3:
1822 01                    3522 	DB	1
1823 6F 72                 3523 	DB	'or'
1825 FE 0D                 3524 	DW	GRP13
1827 32                    3525 	DB	32H
1828                       3526 X4:
1828 02                    3527 	DB	2
1829 63 68 67              3528 	DB	'chg'
182C 18 0C                 3529 	DW	GRP3
182E 86                    3530 	DB	86H
182F 6C 61 74              3531 	DB	'lat'
1832 0F 0B                 3532 	DW	PUT
1834 D7                    3533 	DB	0D7H
1835                       3534 
1835                       3535 
1835                       3536 ; 8087 MNEMONIC TABLE
1835                       3537 ; Similar to 8086 table above, except NOT distinguished by opcode length
1835                       3538 
1835                       3539 XM1:	;F2XM1
1835 01                    3540 	DB	1		;One opcode
1836 78 6D B1              3541 	DB	"xm", '1'+ 080H
1839 01 F0                 3542 	DB	1,0F0H
183B                       3543 
183B                       3544 NDPA:
183B 03                    3545 	DB	3
183C 64 E4                 3546 	DB	"d", 'd'+ 080H
183E 0E C1                 3547 	DB	6+ARITH,0C1H
1840 64 64 F0              3548 	DB	"dd", 'p'+ 080H
1843 90 00                 3549 	DB	NEEDOP+STACKOP,0
1845 62 F3                 3550 	DB	"b", 's'+ 080H
1847 01 E1                 3551 	DB	1,0E1H
1849                       3552 
1849                       3553 NDPB:
1849 02                    3554 	DB	2
184A 6C E4                 3555 	DB	"l", 'd'+ 080H
184C 9F 20                 3556 	DB	7+NEEDOP+MEMORY,20H
184E 73 74 F0              3557 	DB	"st", 'p'+ 080H
1851 9F 30                 3558 	DB	7+NEEDOP+MEMORY,30H
1853                       3559 
1853                       3560 NDPC:
1853 05                    3561 	DB	5
1854 6F ED                 3562 	DB	"o", 'm'+ 080H
1856 68 D1                 3563 	DB	0+ONEREG+REAL,0D1H
1858 6F 6D F0              3564 	DB	"om", 'p'+ 080H
185B 68 D9                 3565 	DB	0+ONEREG+REAL,0D9H
185D 68 F3                 3566 	DB	"h", 's'+ 080H
185F 01 E0                 3567 	DB	1,0E0H
1861 6F 6D 70 F0           3568 	DB	"omp", 'p'+ 080H
1865 06 D9                 3569 	DB	6,0D9H
1867 6C 65 F8              3570 	DB	"le", 'x'+ 080H
186A 03 E2                 3571 	DB	3,0E2H
186C                       3572 
186C                       3573 NDPD:
186C 06                    3574 	DB	6
186D 69 F6                 3575 	DB	"i", 'v'+ 080H
186F 0E F1                 3576 	DB	6+ARITH,0F1H
1871 69 76 F0              3577 	DB	"iv", 'p'+ 080H
1874 90 30                 3578 	DB	NEEDOP+STACKOP,30H
1876 69 76 F2              3579 	DB	"iv", 'r'+ 080H
1879 0E F9                 3580 	DB	6+ARITH,0F9H
187B 69 76 72 F0           3581 	DB	"ivr", 'p'+ 080H
187F 90 38                 3582 	DB	NEEDOP+STACKOP,38H
1881 65 63 73 74 F0        3583 	DB	"ecst", 'p'+ 080H
1886 01 F6                 3584 	DB	1,0F6H
1888 69 73 E9              3585 	DB	"is", 'i'+ 080H
188B 03 E1                 3586 	DB	3,0E1H
188D                       3587 
188D                       3588 NDPE:
188D 01                    3589 	DB	1
188E 6E E9                 3590 	DB	"n", 'i'+ 080H
1890 03 E0                 3591 	DB	3,0E0H
1892                       3592 
1892                       3593 NDPF:
1892 01                    3594 	DB	1
1893 72 65 E5              3595 	DB	"re", 'e'+ 080H
1896 C5 00                 3596 	DB	5+NEEDOP+ONEREG,0
1898                       3597 
1898                       3598 NDPI:
1898 0D                    3599 	DB	13
1899 61 64 E4              3600 	DB	"ad", 'd'+ 080H
189C A2 00                 3601 	DB	2+NEEDOP+INTEGER,0
189E 6C E4                 3602 	DB	"l", 'd'+ 080H
18A0 B3 00                 3603 	DB	3+NEEDOP+INTEGER+EXTENDED,0
18A2 73 75 E2              3604 	DB	"su", 'b'+ 080H
18A5 A2 20                 3605 	DB	2+NEEDOP+INTEGER,20H
18A7 73 74 F0              3606 	DB	"st", 'p'+ 080H
18AA B3 18                 3607 	DB	3+NEEDOP+INTEGER+EXTENDED,18H
18AC 73 F4                 3608 	DB	"s", 't'+ 080H
18AE A3 10                 3609 	DB	3+NEEDOP+INTEGER,10H
18B0 6D 75 EC              3610 	DB	"mu", 'l'+ 080H
18B3 A2 08                 3611 	DB	2+NEEDOP+INTEGER,8
18B5 64 69 F6              3612 	DB	"di", 'v'+ 080H
18B8 A2 30                 3613 	DB	2+NEEDOP+INTEGER,30H
18BA 73 75 62 F2           3614 	DB	"sub", 'r'+ 080H
18BE A2 28                 3615 	DB	2+NEEDOP+INTEGER,28H
18C0 64 69 76 F2           3616 	DB	"div", 'r'+ 080H
18C4 A2 38                 3617 	DB	2+NEEDOP+INTEGER,38H
18C6 63 6F ED              3618 	DB	"co", 'm'+ 080H
18C9 A2 10                 3619 	DB	2+NEEDOP+INTEGER,10H
18CB 63 6F 6D F0           3620 	DB	"com", 'p'+ 080H
18CF A2 18                 3621 	DB	2+NEEDOP+INTEGER,18H
18D1 6E 63 73 74 F0        3622 	DB	"ncst", 'p'+ 080H
18D6 01 F7                 3623 	DB	1,0F7H
18D8 6E 69 F4              3624 	DB	"ni", 't'+ 080H
18DB 03 E3                 3625 	DB	3,0E3H
18DD                       3626 
18DD                       3627 NDPL:
18DD 0A                    3628 	DB	10
18DE E4                    3629 	DB	'd' + 080H
18DF F9 00                 3630 	DB	1+NEEDOP+ONEREG+REAL+EXTENDED,0
18E1 64 FA                 3631 	DB	"d", 'z'+ 080H
18E3 01 EE                 3632 	DB	1,0EEH
18E5 64 B1                 3633 	DB	"d", '1'+ 080H
18E7 01 E8                 3634 	DB	1,0E8H
18E9 64 70 E9              3635 	DB	"dp", 'i'+ 080H
18EC 01 EB                 3636 	DB	1,0EBH
18EE 64 6C 32 F4           3637 	DB	"dl2", 't'+ 080H
18F2 01 E9                 3638 	DB	1,0E9H
18F4 64 6C 32 E5           3639 	DB	"dl2", 'e'+ 080H
18F8 01 EA                 3640 	DB	1,0EAH
18FA 64 6C 67 B2           3641 	DB	"dlg", '2'+ 080H
18FE 01 EC                 3642 	DB	1,0ECH
1900 64 6C 6E B2           3643 	DB	"dln", '2'+ 080H
1904 01 ED                 3644 	DB	1,0EDH
1906 64 63 F7              3645 	DB	"dc", 'w'+ 080H
1909 99 28                 3646 	DB	1+NEEDOP+MEMORY,28H
190B 64 65 6E F6           3647 	DB	"den", 'v'+ 080H
190F 99 20                 3648 	DB	1+NEEDOP+MEMORY,20H
1911                       3649 
1911                       3650 NDPM:
1911 02                    3651 	DB	2
1912 75 EC                 3652 	DB	"u", 'l'+ 080H
1914 0E C9                 3653 	DB	6+ARITH,0C9H
1916 75 6C F0              3654 	DB	"ul", 'p'+ 080H
1919 90 08                 3655 	DB	NEEDOP+STACKOP,8
191B                       3656 
191B                       3657 NDPO:
191B 01                    3658 	DB	1
191C F0                    3659 	DB	'p' + 080H
191D 81 00                 3660 	DB	NEEDOP+1,0	;Flag special handling
191F                       3661 
191F                       3662 NDPN:
191F 01                    3663 	DB	1
1920 6F F0                 3664 	DB	"o", 'p'+ 080H
1922 01 D0                 3665 	DB	1,0D0H
1924                       3666 
1924                       3667 NDPP:
1924 03                    3668 	DB	3
1925 72 65 ED              3669 	DB	"re", 'm'+ 080H
1928 01 F8                 3670 	DB	1,0F8H
192A 74 61 EE              3671 	DB	"ta", 'n'+ 080H
192D 01 F2                 3672 	DB	1,0F2H
192F 61 74 61 EE           3673 	DB	"ata", 'n'+ 080H
1933 01 F3                 3674 	DB	1,0F3H
1935                       3675 
1935                       3676 NDPR:
1935 02                    3677 	DB	2
1936 6E 64 69 6E F4        3678 	DB	"ndin", 't'+ 080H
193B 01 FC                 3679 	DB	1,0FCH
193D 73 74 6F F2           3680 	DB	"sto", 'r'+ 080H
1941 9D 20                 3681 	DB	5+NEEDOP+MEMORY,20H
1943                       3682 
1943                       3683 NDPS:
1943 0C                    3684 	DB	12
1944 F4                    3685 	DB	't' + 080H
1945 ED D0                 3686 	DB	5+NEEDOP+ONEREG+REAL,0D0H
1947 74 F0                 3687 	DB	"t", 'p'+ 080H
1949 FF D8                 3688 	DB	7+NEEDOP+ONEREG+REAL+EXTENDED,0D8H
194B 75 E2                 3689 	DB	"u", 'b'+ 080H
194D 0E E1                 3690 	DB	6+ARITH,0E1H
194F 75 62 F0              3691 	DB	"ub", 'p'+ 080H
1952 90 E0                 3692 	DB	NEEDOP+STACKOP,0E0H
1954 75 62 F2              3693 	DB	"ub", 'r'+ 080H
1957 0E E9                 3694 	DB	6+ARITH,0E9H
1959 75 62 72 F0           3695 	DB	"ubr", 'p'+ 080H
195D 90 E8                 3696 	DB	NEEDOP+STACKOP,0E8H
195F 71 72 F4              3697 	DB	"qr", 't'+ 080H
1962 01 FA                 3698 	DB	1,0FAH
1964 63 61 6C E5           3699 	DB	"cal", 'e'+ 080H
1968 01 FD                 3700 	DB	1,0FDH
196A 61 76 E5              3701 	DB	"av", 'e'+ 080H
196D 9D 30                 3702 	DB	5+NEEDOP+MEMORY,30H
196F 74 63 F7              3703 	DB	"tc", 'w'+ 080H
1972 99 38                 3704 	DB	1+NEEDOP+MEMORY,38H
1974 74 65 6E F6           3705 	DB	"ten", 'v'+ 080H
1978 99 30                 3706 	DB	1+NEEDOP+MEMORY,30H
197A 74 73 F7              3707 	DB	"ts", 'w'+ 080H
197D 9D 38                 3708 	DB	5+NEEDOP+MEMORY,38H
197F                       3709 
197F                       3710 NDPT:
197F 01                    3711 	DB	1
1980 73 F4                 3712 	DB	"s", 't'+ 080H
1982 01 E4                 3713 	DB	1,0E4H
1984                       3714 
1984                       3715 NDPW:
1984 01                    3716 	DB	1
1985 61 69 F4              3717 	DB	"ai", 't'+ 080H
1988 80 00                 3718 	DB	NEEDOP,0	;Flag special handling
198A                       3719 
198A                       3720 NDPX:
198A 03                    3721 	DB	3
198B 63 E8                 3722 	DB	"c", 'h'+ 080H
198D 41 C9                 3723 	DB	1+ONEREG,0C9H
198F 61 ED                 3724 	DB	"a", 'm'+ 080H
1991 01 E5                 3725 	DB	1,0E5H
1993 74 72 61 63 F4        3726 	DB	"trac", 't'+ 080H
1998 01 F4                 3727 	DB	1,0F4H
199A                       3728 
199A                       3729 NDPY:
199A 02                    3730 	DB	2
199B 6C 32 F8              3731 	DB	"l2", 'x'+ 080H
199E 01 F1                 3732 	DB	1,0F1H
19A0 6C 32 78 70 B1        3733 	DB	"l2xp", '1'+ 080H
19A5 01 F9                 3734 	DB	1,0F9H
19A7                       3735 
19A7                       3736 
19A7                       3737 OPTAB:
19A7                       3738 ; Table of pointers  to mnemonics. For each letter of the alphabet (the
19A7                       3739 ; starting letter of the mnemonic), there are 5 entries. Each entry
19A7                       3740 ; corresponds to a mnemonic whose length is 2, 3, 4, 5, and 6 characters
19A7                       3741 ; long, respectively. If there are no mnemonics for a given combination
19A7                       3742 ; of first letter and length (such as A-2), then the corresponding entry
19A7                       3743 ; points to NONE. Otherwise, it points to a place in the mnemonic table
19A7                       3744 ; for that type.
19A7                       3745 
19A7                       3746 ; This table only needs to be modified if a mnemonic is added to a group
19A7                       3747 ; previously marked NONE. Change the NONE to a label made up of the first
19A7                       3748 ; letter of the mnemonic and its length, then add a new subsection to
19A7                       3749 ; the mnemonic table in alphabetical order.
19A7                       3750 
19A7 E6 14                 3751 	DW	NONE
19A9 E7 14                 3752 	DW	A3
19AB E6 14                 3753 	DW	NONE
19AD 0B 15                 3754 	DW	A5
19AF E6 14                 3755 	DW	NONE
19B1 E6 14                 3756 	DW	NONE	;B
19B3 E6 14                 3757 	DW	NONE
19B5 E6 14                 3758 	DW	NONE
19B7 E6 14                 3759 	DW	NONE
19B9 E6 14                 3760 	DW	NONE
19BB E6 14                 3761 	DW	NONE	;C
19BD 13 15                 3762 	DW	C3
19BF 37 15                 3763 	DW	C4
19C1 4A 15                 3764 	DW	C5
19C3 E6 14                 3765 	DW	NONE
19C5 59 15                 3766 	DW	D2	;D
19C7 6E 15                 3767 	DW	D3
19C9 83 15                 3768 	DW	D4
19CB E6 14                 3769 	DW	NONE
19CD E6 14                 3770 	DW	NONE
19CF 8A 15                 3771 	DW	E2	;E
19D1 8F 15                 3772 	DW	E3
19D3 E6 14                 3773 	DW	NONE
19D5 9F 15                 3774 	DW	E5
19D7 E6 14                 3775 	DW	NONE
19D9 E6 14                 3776 	DW	NONE	;F
19DB E6 14                 3777 	DW	NONE
19DD E6 14                 3778 	DW	NONE
19DF E6 14                 3779 	DW	NONE
19E1 E6 14                 3780 	DW	NONE
19E3 E6 14                 3781 	DW	NONE	;G
19E5 E6 14                 3782 	DW	NONE
19E7 E6 14                 3783 	DW	NONE
19E9 E6 14                 3784 	DW	NONE
19EB E6 14                 3785 	DW	NONE
19ED E6 14                 3786 	DW	NONE	;H
19EF A7 15                 3787 	DW	H3
19F1 AD 15                 3788 	DW	H4
19F3 E6 14                 3789 	DW	NONE
19F5 E6 14                 3790 	DW	NONE
19F7 B4 15                 3791 	DW	I2	;I
19F9 BD 15                 3792 	DW	I3
19FB D2 15                 3793 	DW	I4
19FD E6 14                 3794 	DW	NONE
19FF E6 14                 3795 	DW	NONE
1A01 EB 15                 3796 	DW	J2	;J
1A03 14 16                 3797 	DW	J3
1A05 6A 16                 3798 	DW	J4
1A07 E6 14                 3799 	DW	NONE
1A09 E6 14                 3800 	DW	NONE
1A0B E6 14                 3801 	DW	NONE	;K
1A0D E6 14                 3802 	DW	NONE
1A0F E6 14                 3803 	DW	NONE
1A11 E6 14                 3804 	DW	NONE
1A13 E6 14                 3805 	DW	NONE
1A15 E6 14                 3806 	DW	NONE	;L
1A17 8F 16                 3807 	DW	L3
1A19 9F 16                 3808 	DW	L4
1A1B BE 16                 3809 	DW	L5
1A1D DB 16                 3810 	DW	L6
1A1F E6 14                 3811 	DW	NONE	;M
1A21 EC 16                 3812 	DW	M3
1A23 F7 16                 3813 	DW	M4
1A25 04 17                 3814 	DW	M5
1A27 E6 14                 3815 	DW	NONE
1A29 E6 14                 3816 	DW	NONE	;N
1A2B 13 17                 3817 	DW	N3
1A2D E6 14                 3818 	DW	NONE
1A2F E6 14                 3819 	DW	NONE
1A31 E6 14                 3820 	DW	NONE
1A33 23 17                 3821 	DW	O2	;O
1A35 28 17                 3822 	DW	O3
1A37 33 17                 3823 	DW	O4
1A39 E6 14                 3824 	DW	NONE
1A3B E6 14                 3825 	DW	NONE
1A3D E6 14                 3826 	DW	NONE	;P
1A3F 40 17                 3827 	DW	P3
1A41 4B 17                 3828 	DW	P4
1A43 58 17                 3829 	DW	P5
1A45 E6 14                 3830 	DW	NONE
1A47 E6 14                 3831 	DW	NONE	;Q
1A49 E6 14                 3832 	DW	NONE
1A4B E6 14                 3833 	DW	NONE
1A4D E6 14                 3834 	DW	NONE
1A4F E6 14                 3835 	DW	NONE
1A51 E6 14                 3836 	DW	NONE	;R
1A53 60 17                 3837 	DW	R3
1A55 7F 17                 3838 	DW	R4
1A57 8C 17                 3839 	DW	R5
1A59 E6 14                 3840 	DW	NONE
1A5B E6 14                 3841 	DW	NONE	;S
1A5D 9B 17                 3842 	DW	S3
1A5F D3 17                 3843 	DW	S4
1A61 F2 17                 3844 	DW	S5
1A63 E6 14                 3845 	DW	NONE
1A65 E6 14                 3846 	DW	NONE	;T
1A67 E6 14                 3847 	DW	NONE
1A69 0F 18                 3848 	DW	T4
1A6B E6 14                 3849 	DW	NONE
1A6D E6 14                 3850 	DW	NONE
1A6F 16 18                 3851 	DW	U2	;U
1A71 E6 14                 3852 	DW	NONE
1A73 E6 14                 3853 	DW	NONE
1A75 E6 14                 3854 	DW	NONE
1A77 E6 14                 3855 	DW	NONE
1A79 E6 14                 3856 	DW	NONE	;V
1A7B E6 14                 3857 	DW	NONE
1A7D E6 14                 3858 	DW	NONE
1A7F E6 14                 3859 	DW	NONE
1A81 E6 14                 3860 	DW	NONE
1A83 E6 14                 3861 	DW	NONE	;W
1A85 E6 14                 3862 	DW	NONE
1A87 1B 18                 3863 	DW	W4
1A89 E6 14                 3864 	DW	NONE
1A8B E6 14                 3865 	DW	NONE
1A8D E6 14                 3866 	DW	NONE	;X
1A8F 22 18                 3867 	DW	X3
1A91 28 18                 3868 	DW	X4
1A93 E6 14                 3869 	DW	NONE
1A95 E6 14                 3870 	DW	NONE
1A97 E6 14                 3871 	DW	NONE	;Y
1A99 E6 14                 3872 	DW	NONE
1A9B E6 14                 3873 	DW	NONE
1A9D E6 14                 3874 	DW	NONE
1A9F E6 14                 3875 	DW	NONE
1AA1 E6 14                 3876 	DW	NONE	;Z
1AA3 E6 14                 3877 	DW	NONE
1AA5 E6 14                 3878 	DW	NONE
1AA7 E6 14                 3879 	DW	NONE
1AA9 E6 14                 3880 	DW	NONE
1AAB                       3881 
1AAB                       3882 NDPTAB:
1AAB                       3883 ;Lookup table for 8087 mnemonics. There is one entry for each letter of the
1AAB                       3884 ;alphabet
1AAB 3B 18                 3885 	DW	NDPA
1AAD 49 18                 3886 	DW	NDPB
1AAF 53 18                 3887 	DW	NDPC
1AB1 6C 18                 3888 	DW	NDPD
1AB3 8D 18                 3889 	DW	NDPE
1AB5 92 18                 3890 	DW	NDPF
1AB7 E6 14                 3891 	DW	NONE	;G
1AB9 E6 14                 3892 	DW	NONE	;H
1ABB 98 18                 3893 	DW	NDPI
1ABD E6 14                 3894 	DW	NONE	;J
1ABF E6 14                 3895 	DW	NONE	;K
1AC1 DD 18                 3896 	DW	NDPL
1AC3 11 19                 3897 	DW	NDPM
1AC5 1F 19                 3898 	DW	NDPN
1AC7 1B 19                 3899 	DW	NDPO
1AC9 24 19                 3900 	DW	NDPP
1ACB E6 14                 3901 	DW	NONE	;Q
1ACD 35 19                 3902 	DW	NDPR
1ACF 43 19                 3903 	DW	NDPS
1AD1 7F 19                 3904 	DW	NDPT
1AD3 E6 14                 3905 	DW	NONE	;U
1AD5 E6 14                 3906 	DW	NONE	;V
1AD7 84 19                 3907 	DW	NDPW
1AD9 8A 19                 3908 	DW	NDPX
1ADB 9A 19                 3909 	DW	NDPY
1ADD E6 14                 3910 	DW	NONE	;Z
1ADF                       3911 
1ADF                       3912 ;Error message table
1ADF                       3913 
1ADF                       3914 ERRTAB:
1ADF 01 52 65 67 69 73 74  3915 	DB	1, "Register not allowed in immediate valu", 'e'+ 080H
     65 72 20 6E 6F 74 20 
     61 6C 6C 6F 77 65 64 
     20 69 6E 20 69 6D 6D 
     65 64 69 61 74 65 20 
     76 61 6C 75 E5       
1B07 02 49 6E 64 65 78 20  3916 	DB	2, "Index or base register must be BP, BX, SI, or D", 'I'+ 080H
     6F 72 20 62 61 73 65 
     20 72 65 67 69 73 74 
     65 72 20 6D 75 73 74 
     20 62 65 20 42 50 2C 
     20 42 58 2C 20 53 49 
     2C 20 6F 72 20 44 C9 
1B38 03 4F 6E 6C 79 20 6F  3917 	DB	3, "Only one base register (BX, BP) allowe", 'd'+ 080H
     6E 65 20 62 61 73 65 
     20 72 65 67 69 73 74 
     65 72 20 28 42 58 2C 
     20 42 50 29 20 61 6C 
     6C 6F 77 65 E4       
1B60 04 4F 6E 6C 79 20 6F  3918 	DB	4, "Only one index register (SI or DI) allowe", 'd'+ 080H
     6E 65 20 69 6E 64 65 
     78 20 72 65 67 69 73 
     74 65 72 20 28 53 49 
     20 6F 72 20 44 49 29 
     20 61 6C 6C 6F 77 65 
     E4                   
1B8B 05 4F 6E 6C 79 20 61  3919 	DB	5, "Only addition allowed on register or undefined labe", 'l'+ 080H
     64 64 69 74 69 6F 6E 
     20 61 6C 6C 6F 77 65 
     64 20 6F 6E 20 72 65 
     67 69 73 74 65 72 20 
     6F 72 20 75 6E 64 65 
     66 69 6E 65 64 20 6C 
     61 62 65 EC          
1BC0 06 4F 6E 6C 79 20 6F  3920 	DB	6, "Only one undefined label per expression allowe", 'd'+ 080H
     6E 65 20 75 6E 64 65 
     66 69 6E 65 64 20 6C 
     61 62 65 6C 20 70 65 
     72 20 65 78 70 72 65 
     73 73 69 6F 6E 20 61 
     6C 6C 6F 77 65 E4    
1BF0 07 49 6C 6C 65 67 61  3921 	DB	7, "Illegal digit in hexadecimal numbe", 'r'+ 080H
     6C 20 64 69 67 69 74 
     20 69 6E 20 68 65 78 
     61 64 65 63 69 6D 61 
     6C 20 6E 75 6D 62 65 
     F2                   
1C14 08 49 6C 6C 65 67 61  3922 	DB	8, "Illegal digit in decimal numbe", 'r'+ 080H
     6C 20 64 69 67 69 74 
     20 69 6E 20 64 65 63 
     69 6D 61 6C 20 6E 75 
     6D 62 65 F2          
1C34 0A 49 6C 6C 65 67 61  3923 	DB	10, "Illegal character in label or opcod", 'e'+ 080H
     6C 20 63 68 61 72 61 
     63 74 65 72 20 69 6E 
     20 6C 61 62 65 6C 20 
     6F 72 20 6F 70 63 6F 
     64 E5                
1C59 0B 4C 61 62 65 6C 20  3924 	DB	11, "Label defined twic", 'e'+ 080H
     64 65 66 69 6E 65 64 
     20 74 77 69 63 E5    
1C6D 0C 4F 70 63 6F 64 65  3925 	DB	12, "Opcode not recognize", 'd'+ 080H
     20 6E 6F 74 20 72 65 
     63 6F 67 6E 69 7A 65 
     E4                   
1C83 14 49 6E 76 61 6C 69  3926 	DB	20, "Invalid operan", 'd'+ 080H
     64 20 6F 70 65 72 61 
     6E E4                
1C93 15 22 2C 20 22 20 61  3927 	DB	21, '", " and second operand expected'
     6E 64 20 73 65 63 6F 
     6E 64 20 6F 70 65 72 
     61 6E 64 20 65 78 70 
     65 63 74 65 64       
1CB4 16 52 65 67 69 73 74  3928 	DB	22, "Register mismatc", 'h'+ 080H
     65 72 20 6D 69 73 6D 
     61 74 63 E8          
1CC6 17 49 6D 6D 65 64 69  3929 	DB	23, "Immediate operand not allowe", 'd'+ 080H
     61 74 65 20 6F 70 65 
     72 61 6E 64 20 6E 6F 
     74 20 61 6C 6C 6F 77 
     65 E4                
1CE4 18 22 5D 22 20 65 78  3930 	DB	24, '"]" expecte', 'd'+ 080H
     70 65 63 74 65 E4    
1CF1 19 54 77 6F 20 6D 65  3931 	DB	25, "Two memory operands not allowe", 'd'+ 080H
     6D 6F 72 79 20 6F 70 
     65 72 61 6E 64 73 20 
     6E 6F 74 20 61 6C 6C 
     6F 77 65 E4          
1D11 1A 44 65 73 74 69 6E  3932 	DB	26, "Destination must not be immediate valu", 'e'+ 080H
     61 74 69 6F 6E 20 6D 
     75 73 74 20 6E 6F 74 
     20 62 65 20 69 6D 6D 
     65 64 69 61 74 65 20 
     76 61 6C 75 E5       
1D39 1B 42 6F 74 68 20 6F  3933 	DB	27, "Both operands must not be register", 's'+ 080H
     70 65 72 61 6E 64 73 
     20 6D 75 73 74 20 6E 
     6F 74 20 62 65 20 72 
     65 67 69 73 74 65 72 
     F3                   
1D5D 1C 4F 70 65 72 61 6E  3934 	DB	28, "Operand must be segment registe", 'r'+ 080H
     64 20 6D 75 73 74 20 
     62 65 20 73 65 67 6D 
     65 6E 74 20 72 65 67 
     69 73 74 65 F2       
1D7E 1D 46 69 72 73 74 20  3935 	DB	29, "First operand must be registe", 'r'+ 080H
     6F 70 65 72 61 6E 64 
     20 6D 75 73 74 20 62 
     65 20 72 65 67 69 73 
     74 65 F2             
1D9D 1E 55 6E 64 65 66 69  3936 	DB	30, "Undefined label not allowe", 'd'+ 080H
     6E 65 64 20 6C 61 62 
     65 6C 20 6E 6F 74 20 
     61 6C 6C 6F 77 65 E4 
1DB9 1F 56 61 6C 75 65 20  3937 	DB	31, "Value out of rang", 'e'+ 080H
     6F 75 74 20 6F 66 20 
     72 61 6E 67 E5       
1DCC 20 4D 69 73 73 69 6E  3938 	DB	32, "Missing or illegal operand size fla", 'g'+ 080H
     67 20 6F 72 20 69 6C 
     6C 65 67 61 6C 20 6F 
     70 65 72 61 6E 64 20 
     73 69 7A 65 20 66 6C 
     61 E7                
1DF1 21 4D 75 73 74 20 68  3939 	DB	33, "Must have label on same lin", 'e'+ 080H
     61 76 65 20 6C 61 62 
     65 6C 20 6F 6E 20 73 
     61 6D 65 20 6C 69 6E 
     E5                   
1E0E 23 5A 65 72 6F 2D 6C  3940 	DB	35, "Zero-length string illega", 'l'+ 080H
     65 6E 67 74 68 20 73 
     74 72 69 6E 67 20 69 
     6C 6C 65 67 61 EC    
1E29 24 45 4E 44 49 46 20  3941 	DB	36, "ENDIF without I", 'F'+ 080H
     77 69 74 68 6F 75 74 
     20 49 C6             
1E3A 25 4F 6E 65 2D 63 68  3942 	DB	37, "One-character strings onl", 'y'+ 080H
     61 72 61 63 74 65 72 
     20 73 74 72 69 6E 67 
     73 20 6F 6E 6C F9    
1E55 26 49 6C 6C 65 67 61  3943 	DB	38, "Illegal expressio", 'n'+ 080H
     6C 20 65 78 70 72 65 
     73 73 69 6F EE       
1E68 27 45 6E 64 20 6F 66  3944 	DB	39, "End of string not foun", 'd'+ 080H
     20 73 74 72 69 6E 67 
     20 6E 6F 74 20 66 6F 
     75 6E E4             
1E80 64 55 6E 64 65 66 69  3945 	DB	100, "Undefined labe", 'l'+ 080H
     6E 65 64 20 6C 61 62 
     65 EC                
1E90 65 56 61 6C 75 65 20  3946 	DB	101, "Value out of range (forward", ')'+ 080H
     6F 75 74 20 6F 66 20 
     72 61 6E 67 65 20 28 
     66 6F 72 77 61 72 64 
     A9                   
1EAD FF                    3947 	DB	255
1EAE                       3948 
1EAE 2A 2A 2A 2A 2A 20 45  3949 ERRMES:	DB	'***** ERROR: ', ' '+ 080H
     52 52 4F 52 3A 20 A0 
1EBC 0D 0A 46 69 6C 65 20  3950 NOSPAC:	DB	13,10,'File creation error',13,10,"$"
     63 72 65 61 74 69 6F 
     6E 20 65 72 72 6F 72 
     0D 0A 24             
1ED4 0D 0A 49 6E 73 75 66  3951 NOMEM:	DB	13,10,'Insufficient memory',13,10,'$'
     66 69 63 69 65 6E 74 
     20 6D 65 6D 6F 72 79 
     0D 0A 24             
1EEC 0D 0A 46 69 6C 65 20  3952 NOFILE:	DB	13,10,'File not found',13,10,'$'
     6E 6F 74 20 66 6F 75 
     6E 64 0D 0A 24       
1EFF 0D 0A 44 69 73 6B 20  3953 WRTERR:	DB	13,10,'Disk full',13,10,'$'
     66 75 6C 6C 0D 0A 24 
1F0D 0D 0A 42 61 64 20 64  3954 BADDSK:	DB	13,10,'Bad disk specifier',13,10,'$'
     69 73 6B 20 73 70 65 
     63 69 66 69 65 72 0D 
     0A 24                
1F24 0D 0A 0D 0A 45 72 72  3955 ERCNTM:	DB	13, 10, 13, 10, 'Error Count ', '='+ 080H
     6F 72 20 43 6F 75 6E 
     74 20 BD             
1F35 0D 0A 53 79 6D 62 6F  3956 SYMSIZE	DB	13, 10, 'Symbol Table size =', ' '+ 080H
     6C 20 54 61 62 6C 65 
     20 73 69 7A 65 20 3D 
     A0                   
1F4B 46 72 65 65 20 73 70  3957 FRESIZE	DB	'Free space =       ', ' '+ 080H
     61 63 65 20 3D 20 20 
     20 20 20 20 20 A0    
1F5F 0D 0A 53 79 6D 62 6F  3958 SYMMES:	DB	13, 10, 'Symbol Tabl', 'e'+ 080H, 13, 10, 13, 10
     6C 20 54 61 62 6C E5 
     0D 0A 0D 0A          
1F71 41 53 4D 00 00        3959 EXTEND:	DB	'ASM',0,0
1F76 05 65 6E 64 69 66     3960 IFEND:	DB	5,'endif'
1F7C 02 69 66              3961 IFNEST:	DB	2,'if'
1F7F 72 65 F4              3962 RETSTR:	DB	're', 't'+ 080H
1F82 00 20 20 20 20 20 20  3963 HEXFCB:	DB	0,'        HEX',0,0,0,0
     20 20 48 45 58 00 00 
     00 00                
1F92 10                    3964 	DB	16 DUP(0)
***** ERROR:  Invalid operand
1F93 00 00 00 00 00        3965 	DB	0,0,0,0,0
1F98 00 20 20 20 20 20 20  3966 LSTFCB:	DB	0,'        PRN',0,0,0,0
     20 20 50 52 4E 00 00 
     00 00                
1FA8 10                    3967 	DB	16 DUP(0)
***** ERROR:  Invalid operand
1FA9 00 00 00 00 00        3968 	DB	0,0,0,0,0
1FAE                       3969 PC	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3970 OLDPC	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3971 LABPT	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3972 FLAG	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3973 MAXFLG	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3974 ADDR	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3975 ALABEL	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3976 DATA	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3977 DLABEL	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3978 CON		RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3979 UNDEF	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3980 LENID	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3981 ID	RESB 80
***** ERROR:  Opcode not recognized
1FAE                       3982 CHR	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3983 SYM	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3984 BASE	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3985 HEAP	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3986 SYMFLG	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3987 SYMLIN	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3988 CODE	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3989 DATSIZ	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3990 RELOC	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3991 BCOUNT	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3992 COUNT	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3993 ERR	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3994 LINE	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3995 HEXLEN	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3996 HEXADD	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3997 LASTAD	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       3998 HEXCNT	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       3999 CHKSUM	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       4000 LINFLG	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       4001 PREV	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       4002 IFFLG	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       4003 CHKLAB	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       4004 ERRCNT	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4005 LSTRET	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4006 RETPT	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4007 LSTDEV	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4008 SPC	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       4009 NOWAIT	RESB 1
***** ERROR:  Opcode not recognized
1FAE                       4010 IX	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4011 IY	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4012 HEXPNT	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4013 LSTPNT	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4014 HEXBUF	RESB HEXBUFSIZ
***** ERROR:  Opcode not recognized
1FAE                       4015 LSTBUF	RESB LSTBUFSIZ
***** ERROR:  Opcode not recognized
1FAE                       4016 BUFPT	RESW 1
***** ERROR:  Opcode not recognized
1FAE                       4017 SRCBUF	RESB BUFSIZ
***** ERROR:  Opcode not recognized
1FAE                       4018 	RESB	100H
***** ERROR:  Opcode not recognized
1FAE                       4019 	ALIGN 2
***** ERROR:  Invalid operand
1FAE                       4020 STACK	EQU	$
1FAE                       4021 START	EQU	$


Error Count =  240

Symbol Table size =  6726
Free space =        31290
