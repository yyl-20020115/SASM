     1                                  ; Seattle Computer Products 8086 Assembler  version 2.44
     2                                  ;   by Tim Paterson
     3                                  ; Runs on the 8086 under MS-DOS
     4                                  
     5                                  ;* * * * * * REVISION HISTORY * * * * * *
     6                                  ;
     7                                  ; 12/29/80  2.01  General release with 86-DOS version 0.34
     8                                  ; 02/22/81  2.10  Increased buffer size from 128 bytes to 1024 bytes
     9                                  ; 03/18/81  2.11  General cleanup and more documentation
    10                                  ; 03/24/81  2.20  Modify ESC handling for full 8087 operation
    11                                  ; 04/01/81  2.21  Fix date in HEX and PRN files; modify buffer handling
    12                                  ; 04/03/81  2.22  Fix 2.21 buffer handling
    13                                  ; 04/13/81  2.23  Re-open source file for listing to allow assembling CON:
    14                                  ; 04/28/81  2.24  Allow nested IFs
    15                                  ; 07/30/81  2.25  Add Intel string mnemonics; clean up a little
    16                                  ; 08/02/81  2.30  Re-write pass 2:
    17                                  ;			Always report errors to console
    18                                  ;			Exact byte lengths for HEX and PRN files
    19                                  ; 11/08/81  2.40  Add 8087 mnemonics; print full error messages;
    20                                  ;		  allow expressions with *, /, and ()
    21                                  ; 07/04/82  2.41  Fix Intel's 8087 "reverse-bit" bug; don't copy date
    22                                  ; 08/18/82  2.42  Increase stack from 80 to 256 (Damn! Overflowed again!)
    23                                  ; 01/05/83  2.43  Correct over-zealous optimization in 2.42
    24                                  ; 05/09/83  2.44  Add memory usage report
    25                                  ;
    26                                  ;* * * * * * * * * * * * * * * * * * * * *
    27                                  
    28                                  SYMWID:	EQU	5	;5 symbols per line in dump
    29                                  FCB:	EQU	5CH
    30                                  BUFSIZ:	EQU	1024	;Source code buffer
    31                                  LSTBUFSIZ:EQU	BUFSIZ	;List file buffer
    32                                  HEXBUFSIZ:EQU	70	;Hex file buffer (26*2 + 5*2 + 3 + EXTRA)
    33                                  EOL:	EQU	13	;ASCII carriage return
    34                                  OBJECT:	EQU	100H	;DEFAULT "PUT" ADDRESS
    35                                  
    36                                  ;System call function codes
    37                                  PRINTMES: EQU	9
    38                                  OPEN:	EQU	15
    39                                  CLOSE:	EQU	16
    40                                  READ:	EQU	20
    41                                  SETDMA:	EQU	26
    42                                  MAKE:	EQU	22
    43                                  BLKWRT:	EQU	40
    44                                  
    45                                  ;The following equates define some token values returned by GETSYM
    46                                  UNDEFID:EQU	0	;Undefined identifier (including no nearby RET)
    47                                  CONST:	EQU	1	;Constant (including $)
    48                                  REG:	EQU	2	;8-bit register
    49                                  XREG:	EQU	3	;16-bit register (except segment registers)
    50                                  SREG:	EQU	4	;Segment register
    51                                  FREG:	EQU	6	;8087 floating point register
    52                                  
    53                                  ;Bits to build 8087 opcode table entries
    54                                  ONEREG:	EQU	40H	;Single ST register OK as operand
    55                                  NEEDOP:	EQU	80H	;Must have an operand
    56                                  INTEGER:EQU	20H	;For integer operations
    57                                  REAL:	EQU	28H	;For real operations
    58                                  EXTENDED EQU	10H	;For Long integers or Temporary real
    59                                  MEMORY:	EQU	18H	;For general memory operations
    60                                  STACKOP:EQU	10H	;Two register arithmetic with pop
    61                                  ARITH:	EQU	8	;Non-pop arithmetic operations
    62                                  
    63                                  	ORG	100H
    64                                  	
    65                                  
    66 00000000 EB74                    	JMP 	BEGIN
    67                                  
    68 00000002 0D0A53656174746C65-     HEADER:	DB	13,10,'Seattle Computer Products 8086 Assembler Version 2.44'
    68 0000000B 20436F6D7075746572-
    68 00000014 2050726F6475637473-
    68 0000001D 203830383620417373-
    68 00000026 656D626C6572205665-
    68 0000002F 7273696F6E20322E34-
    68 00000038 34                 
    69 00000039 0D0A436F7079726967-     	DB	13,10,'Copyright 1979-1983 by Seattle Computer Products, Inc.'
    69 00000042 687420313937392D31-
    69 0000004B 393833206279205365-
    69 00000054 6174746C6520436F6D-
    69 0000005D 70757465722050726F-
    69 00000066 64756374732C20496E-
    69 0000006F 632E               
    70 00000071 0D0A0D0A24              	DB	13,10,13,10,'$'
    71                                  
    72                                  BEGIN:
    73 00000076 BC[022A]                	MOV	SP,STACK
    74 00000079 BA[0200]                	MOV	DX,HEADER
    75 0000007C B409                    	MOV	AH,PRINTMES
    76 0000007E CD21                    	INT	33
    77 00000080 A06D00                  	MOV	AL,[FCB+17]
    78 00000083 A2[9120]                	MOV	[SYMFLG],AL	;Save symbol table request flag
    79 00000086 BE6500                  	MOV	SI,FCB+9	;Point to file extension
    80 00000089 AC                      	LODSB			;Get source drive letter
    81 0000008A E81401                  	CALL	CHKDSK		;Valid drive?
    82 0000008D 08C0                    	OR	AL,AL
    83 0000008F 7403                    	JZ	_DEFAULT		;If no extension, use existing drive spec
    84 00000091 A25C00                  	MOV	[FCB],AL
    85                                  _DEFAULT:
    86 00000094 AC                      	LODSB			;Get HEX file drive letter
    87 00000095 3C5A                    	CMP	AL,'Z'		;Suppress HEX file?
    88 00000097 7403                    	JZ	L0000
    89 00000099 E80501                  	CALL	CHKDSK
    90                                  L0000:	
    91 0000009C A2[DC1F]                	MOV	[HEXFCB],AL
    92 0000009F AC                      	LODSB			;Get PRN file drive letter
    93 000000A0 B400                    	MOV	AH,0		;Signal no PRN file
    94 000000A2 3C5A                    	CMP	AL,'Z'		;Suppress PRN file?
    95 000000A4 7415                    	JZ	NOPRN
    96 000000A6 3C59                    	CMP	AL,'Y'		;Print errors only on console?
    97 000000A8 7411                    	JZ	NOPRN
    98 000000AA B402                    	MOV	AH,2
    99 000000AC 3C58                    	CMP	AL,'X'		;PRN file to console?
   100 000000AE 740B                    	JZ	NOPRN
   101 000000B0 B404                    	MOV	AH,4
   102 000000B2 3C50                    	CMP	AL,'P'		;PRN file to printer?
   103 000000B4 7405                    	JZ	NOPRN
   104 000000B6 E8E800                  	CALL	CHKDSK
   105 000000B9 B480                    	MOV	AH,80H
   106                                  NOPRN:
   107 000000BB A2[0120]                	MOV	[LSTFCB],AL
   108 000000BE 8826[AE20]              	MOV	[LSTDEV],AH	;Flag device for list ouput
   109 000000C2 BE[CB1F]                	MOV	SI,EXTEND
   110 000000C5 BF6500                  	MOV	DI,FCB+9
   111 000000C8 A5                      	MOVSW
   112 000000C9 A4                      	MOVSB			;Set extension to ASM
   113 000000CA A5                      	MOVSW			;Zero extent field
   114 000000CB BA5C00                  	MOV	DX,FCB
   115 000000CE B40F                    	MOV	AH,OPEN
   116 000000D0 CD21                    	INT	33
   117 000000D2 BB[461F]                	MOV	BX,NOFILE
   118 000000D5 08C0                    	OR	AL,AL
   119 000000D7 7403                    	JZ	$+5
   120 000000D9 E99900                  	JMP	PRERR
   121 000000DC BA[DC1F]                	MOV	DX,HEXFCB
   122 000000DF E89C00                  	CALL	MAKFIL
   123 000000E2 BA[0120]                	MOV	DX,LSTFCB
   124 000000E5 E89600                  	CALL	MAKFIL
   125 000000E8 31C0                    	XOR	AX,AX
   126 000000EA A36800                  	MOV	[FCB+12],AX	;Zero CURRENT BLOCK field
   127 000000ED A27C00                  	MOV	[FCB+32],AL	;Zero Next Record field
   128 000000F0 C7066A000004            	MOV	WORD[FCB+14],BUFSIZ	;Set record size
   129 000000F6 C706[0025][0225]        	MOV	WORD[BUFPT],SRCBUF	;Initialize buffer pointer
   130 000000FC C706[9320][032A]        	MOV	WORD[CODE],START+1	;POINTER TO NEXT BYTE OF INTERMEDIATE CODE
   131 00000102 C706[B420][022A]        	MOV	WORD[IY],START	;POINTER TO CURRENT RELOCATION BYTE
   132 00000108 31C0                    	XOR	AX,AX
   133 0000010A A3[2620]                	MOV	[PC],AX		;DEFAULT PROGRAM COUNTER
   134 0000010D A3[8D20]                	MOV	[BASE],AX	;POINTER TO ROOT OF ID TREE=NIL
   135 00000110 A3[AC20]                	MOV	[RETPT],AX	;Pointer to last RET record
   136 00000113 A2[A620]                	MOV	[IFFLG],AL	;NOT WITHIN IF/ENDIF
   137 00000116 A2[A720]                	MOV	[CHKLAB],AL	;LOOKUP ALL LABELS
   138 00000119 48                      	DEC	AX
   139 0000011A A3[AA20]                	MOV	[LSTRET],AX	;Location of last RET
   140 0000011D A10600                  	MOV	AX,[6]		;HL=END OF MEMORY
   141 00000120 A3[8F20]                	MOV	[HEAP],AX	;BACK END OF SYMBOL TABLE SPACE
   142 00000123 C606[9720]04            	MOV	BYTE[BCOUNT],4	;CODE BYTES PER RELOCATION BYTE
   143                                  
   144                                  ;Assemble each line of code
   145                                  
   146                                  LOOP:
   147 00000128 E88B00                  	CALL	NEXTCHR		;Get first character on line
   148 0000012B 3C1A                    	CMP	AL,1AH
   149 0000012D 741E                    	JZ	ENDJ
   150 0000012F B0FF                    	MOV	AL,-1		;Flag that no tokens have been read yet
   151 00000131 A2[8C20]                	MOV	[SYM],AL
   152 00000134 E82807                  	CALL	ASMLIN		;Assemble the line
   153 00000137 A0[8C20]                	MOV	AL,[SYM]
   154 0000013A 3CFF                    	CMP	AL,-1		;Any tokens found on line?
   155 0000013C 7503                    	JNZ	L0002
   156 0000013E E8C503                  	CALL	GETSYM		;If no tokens read yet, read first one
   157                                  L0002:	
   158 00000141 3C3B                    	CMP	AL,';'
   159 00000143 740B                    	JZ	ENDLN
   160 00000145 3C0D                    	CMP	AL,EOL
   161 00000147 7407                    	JZ	ENDLN
   162 00000149 B014                    	MOV	AL,14H		;Garbage at end of line error
   163 0000014B EB05                    	JMP	ENDLIN
   164 0000014D E9170F                  ENDJ:	JMP	END
   165                                  
   166                                  ENDLN:
   167 00000150 30C0                    	XOR	AL,AL		;Flag no errors on line
   168                                  ENDLIN:
   169                                  ;AL = error code for line. Stack depth unknown
   170 00000152 BC[022A]                	MOV	SP,STACK
   171 00000155 E80200                  	CALL	NEXLIN
   172 00000158 EBCE                    	JMP	LOOP
   173                                  
   174                                  NEXLIN:
   175 0000015A B5C0                    	MOV	CH,0C0H		;Put end of line marker and error code (AL)
   176 0000015C E88E09                  	CALL	PUTCD
   177 0000015F E85209                  	CALL	GEN1
   178 00000162 A0[8B20]                	MOV	AL,[CHR]
   179                                  GETEOL:
   180 00000165 3C0A                    	CMP	AL,10
   181 00000167 7414                    	JZ	MAKFIL_RET
   182 00000169 3C1A                    	CMP	AL,1AH
   183 0000016B 74E0                    	JZ	ENDJ
   184 0000016D E84600                  	CALL	NEXTCHR		;Scan over comments for linefeed
   185 00000170 EBF3                    	JMP	GETEOL
   186                                  
   187                                  ABORT:
   188 00000172 BB[2E1F]                	MOV	BX,NOMEM
   189                                  PRERR:
   190 00000175 89DA                    	MOV	DX,BX
   191 00000177 B409                    	MOV	AH,PRINTMES
   192 00000179 CD21                    	INT	33
   193 0000017B CD20                    	INT	32 ;RET TO DOS
   194                                  
   195                                  MAKFIL_RET:
   196 0000017D C3                      	RET
   197                                  MAKFIL:
   198 0000017E 89D6                    	MOV	SI,DX
   199 00000180 AC                      	LODSB			;Get drive select byte
   200 00000181 3C20                    	CMP	AL,20H		;If not valid, don't make file
   201 00000183 73F8                    	JNC	MAKFIL_RET
   202 00000185 B90400                  	MOV	CX,4
   203 00000188 89F7                    	MOV	DI,SI
   204 0000018A BE5D00                  	MOV	SI,FCB+1
   205 0000018D F3                      	REP
   206 0000018E A5                      	MOVSW			;Copy source file name
   207 0000018F B416                    	MOV	AH,MAKE
   208 00000191 CD21                    	INT	33
   209 00000193 C745050100              	MOV	WORD[DI-9+14],1	;Set record length to 1 byte
   210 00000198 BB[161F]                	MOV	BX,NOSPAC
   211 0000019B 08C0                    	OR	AL,AL		;Success?
   212 0000019D 75D6                    	JNZ	PRERR
   213 0000019F C3                      	RET
   214                                  CHKDSK_RET:
   215 000001A0 C3                      	RET
   216                                  CHKDSK:
   217 000001A1 2C20                    	SUB	AL,' '		;If not present, set zero flag
   218 000001A3 74FB                    	JZ	CHKDSK_RET
   219 000001A5 2C20                    	SUB	AL,20H
   220 000001A7 7404                    	JZ	DSKERR		;Must be in range A-O
   221 000001A9 3C10                    	CMP	AL,'P'-'@'
   222 000001AB 72F3                    	JC	CHKDSK_RET
   223                                  DSKERR:
   224 000001AD BB[671F]                	MOV	BX,BADDSK
   225 000001B0 EBC3                    	JMP	PRERR
   226                                  
   227                                  ERROR:
   228 000001B2 88C8                    	MOV	AL,CL
   229 000001B4 EB9C                    	JMP	ENDLIN
   230                                  
   231                                  NEXTCHR:
   232 000001B6 8B36[0025]              	MOV	SI,[BUFPT]
   233 000001BA 81FE[0225]              	CMP	SI,SRCBUF
   234 000001BE 751A                    	JNZ	GETCH
   235                                  ;Buffer empty so refill it
   236 000001C0 52                      	PUSH	DX
   237 000001C1 50                      	PUSH	AX		;AH must be saved
   238 000001C2 89F2                    	MOV	DX,SI
   239 000001C4 B41A                    	MOV	AH,SETDMA
   240 000001C6 CD21                    	INT	33
   241 000001C8 BA5C00                  	MOV	DX,FCB
   242 000001CB B414                    	MOV	AH,READ
   243 000001CD CD21                    	INT	33
   244 000001CF 92                      	XCHG	AX,DX		;Put error code in DL
   245 000001D0 58                      	POP	AX		;Restore AH
   246 000001D1 88D0                    	MOV	AL,DL		;Error code back in AL
   247 000001D3 5A                      	POP	DX
   248 000001D4 3C01                    	CMP	AL,1
   249 000001D6 B01A                    	MOV	AL,1AH		;Possibly signal End of File
   250 000001D8 740A                    	JZ	NOMOD		;If nothing read
   251                                  GETCH:
   252 000001DA AC                      	LODSB
   253 000001DB 81FE[0229]              	CMP	SI,SRCBUF+BUFSIZ
   254 000001DF 7503                    	JNZ	NOMOD
   255 000001E1 BE[0225]                	MOV	SI,SRCBUF
   256                                  NOMOD:
   257 000001E4 8936[0025]              	MOV	[BUFPT],SI
   258 000001E8 A2[8B20]                	MOV	[CHR],AL
   259 000001EB C3                      	RET
   260                                  MROPS_RET:
   261 000001EC C3                      	RET
   262                                  
   263                                  MROPS:
   264                                  
   265                                  ; Get two operands and check for certain types, according to flag byte
   266                                  ; in CL. OP code in CH. Returns only if immediate operation.
   267                                  
   268 000001ED 51                      	PUSH	CX		;Save type flags
   269 000001EE E8D800                  	CALL	GETOP
   270 000001F1 52                      	PUSH	DX		;Save first operand
   271 000001F2 E8CB00                  	CALL	GETOP2
   272 000001F5 5B                      	POP	BX		;First op in BX, second op in DX
   273 000001F6 B004                    	MOV	AL,SREG		;Check for a segment register
   274 000001F8 38F8                    	CMP	AL,BH
   275 000001FA 7441                    	JZ	SEGCHK
   276 000001FC 38F0                    	CMP	AL,DH
   277 000001FE 743D                    	JZ	SEGCHK
   278 00000200 B001                    	MOV	AL,CONST	;Check if the first operand is immediate
   279 00000202 B11A                    	MOV	CL,26
   280 00000204 38F8                    	CMP	AL,BH
   281 00000206 74AA                    	JZ	ERROR		;Error if so
   282 00000208 59                      	POP	CX		;Restore type flags
   283 00000209 38F0                    	CMP	AL,DH		;If second operand is immediate, then done
   284 0000020B 74DF                    	JZ	MROPS_RET
   285 0000020D B000                    	MOV	AL,UNDEFID	;Check for memory reference
   286 0000020F 38F8                    	CMP	AL,BH
   287 00000211 744F                    	JZ	STORE		;Is destination memory?
   288 00000213 38F0                    	CMP	AL,DH
   289 00000215 7455                    	JZ	LOAD		;Is source memory?
   290 00000217 F6C101                  	TEST	CL,1		;Check if register-to-register operation OK
   291 0000021A B11B                    	MOV	CL,27
   292 0000021C 7494                    	JZ	ERROR
   293 0000021E 88F0                    	MOV	AL,DH
   294 00000220 38F8                    	CMP	AL,BH		;Registers must be of same length
   295                                  RR:
   296 00000222 B116                    	MOV	CL,22
   297 00000224 758C                    	JNZ	ERROR
   298                                  RR1:
   299 00000226 2401                    	AND	AL,1		;Get register length (1=16 bits)
   300 00000228 08E8                    	OR	AL,CH		;Or in to OP code
   301 0000022A E87A08                  	CALL	PUT		;And write it
   302 0000022D 59                      	POP	CX		;Dump return address
   303 0000022E 88D8                    	MOV	AL,BL
   304 00000230 00C0                    	ADD	AL,AL		;Rotate register number into middle position
   305 00000232 00C0                    	ADD	AL,AL
   306 00000234 00C0                    	ADD	AL,AL
   307 00000236 0CC0                    	OR	AL,0C0H		;Set register-to-register mode
   308 00000238 08D0                    	OR	AL,DL		;Combine with other register number
   309 0000023A E96A08                  	JMP	PUT
   310                                  
   311                                  SEGCHK:
   312                                  ;Come here if at least one operand is a segment register
   313 0000023D 59                      	POP	CX		;Restore flags
   314 0000023E F6C108                  	TEST	CL,8		;Check if segment register OK
   315 00000241 B116                    	MOV	CL,22
   316 00000243 7478                    	JZ	ERR1
   317 00000245 B9038E                  	MOV	CX,8E03H	;Segment register move OP code
   318 00000248 B000                    	MOV	AL,UNDEFID
   319 0000024A 38F0                    	CMP	AL,DH		;Check if source is memory
   320 0000024C 741E                    	JZ	LOAD
   321 0000024E 38F8                    	CMP	AL,BH		;Check if destination is memory
   322 00000250 7410                    	JZ	STORE
   323 00000252 B003                    	MOV	AL,XREG
   324 00000254 28F0                    	SUB	AL,DH		;Check if source is 16-bit register
   325 00000256 74CA                    	JZ	RR		;If so, AL must be zero
   326 00000258 B58C                    	MOV	CH,8CH		;Change direction
   327 0000025A 87DA                    	XCHG	DX,BX		;Flip which operand is first and second
   328 0000025C B003                    	MOV	AL,XREG
   329 0000025E 28F0                    	SUB	AL,DH		;Let RR perform finish the test
   330 00000260 EBC0                    	JMP	RR
   331                                  
   332                                  STORE:
   333 00000262 F6C104                  	TEST	CL,004H		;Check if storing is OK
   334 00000265 7552                    	JNZ	STERR
   335 00000267 87DA                    	XCHG	DX,BX		;If so, flip operands
   336 00000269 80E5FD                  	AND	CH,0FDH		;   and zero direction bit
   337                                  LOAD:
   338 0000026C B619                    	MOV	DH,25
   339 0000026E 38F8                    	CMP	AL,BH		;Check if memory-to-memory
   340 00000270 7449                    	JZ	MRERR
   341 00000272 88F8                    	MOV	AL,BH
   342 00000274 3C02                    	CMP	AL,REG		;Check if 8-bit operation
   343 00000276 7507                    	JNZ	XRG
   344 00000278 B616                    	MOV	DH,22
   345 0000027A F6C101                  	TEST	CL,1		;See if 8-bit operation is OK
   346 0000027D 743C                    	JZ	MRERR
   347                                  XRG:
   348 0000027F 88D0                    	MOV	AL,DL
   349 00000281 2C06                    	SUB	AL,6		;Check for R/M mode 6 and register 0
   350 00000283 08D8                    	OR	AL,BL		;   meaning direct load/store of accumulator
   351 00000285 7519                    	JNZ	NOTAC
   352 00000287 F6C108                  	TEST	CL,8		;See if direct load/store of accumulator
   353 0000028A 7414                    	JZ	NOTAC		;   means anything in this case
   354                                  ; Process direct load/store of accumulator
   355 0000028C 88E8                    	MOV	AL,CH
   356 0000028E 2402                    	AND	AL,2		;Preserve direction bit only
   357 00000290 3402                    	XOR	AL,2		;   but flip it
   358 00000292 0CA0                    	OR	AL,0A0H		;Combine with OP code
   359 00000294 88C5                    	MOV	CH,AL
   360 00000296 88F8                    	MOV	AL,BH		;Check byte/word operation
   361 00000298 2401                    	AND	AL,1
   362 0000029A 08E8                    	OR	AL,CH
   363 0000029C 59                      	POP	CX		;Dump return address
   364 0000029D E9C808                  	JMP	PUTADD		;Write the address
   365                                  
   366                                  NOTAC:
   367 000002A0 88F8                    	MOV	AL,BH
   368 000002A2 2401                    	AND	AL,1		;Get byte/word bit
   369 000002A4 20C8                    	AND	AL,CL		;But don't use it in word-only operations
   370 000002A6 08E8                    	OR	AL,CH		;Combine with OP code
   371 000002A8 E8FC07                  	CALL	PUT
   372 000002AB 88D8                    	MOV	AL,BL
   373 000002AD 00C0                    	ADD	AL,AL		;Rotate to middle position
   374 000002AF 00C0                    	ADD	AL,AL
   375 000002B1 00C0                    	ADD	AL,AL
   376 000002B3 08D0                    	OR	AL,DL		;Combine register field
   377 000002B5 59                      	POP	CX		;Dump return address
   378 000002B6 E9AF08                  	JMP	PUTADD		;Write the address
   379                                  
   380                                  STERR:
   381 000002B9 B61D                    	MOV	DH,29
   382                                  MRERR:
   383 000002BB 88F1                    	MOV	CL,DH
   384                                  
   385 000002BD E9F2FE                  ERR1:	JMP	ERROR
   386                                  
   387                                  GETOP2:
   388                                  ;Get the second operand: look for a comma and drop into GETOP
   389 000002C0 A0[8C20]                	MOV	AL,[SYM]
   390 000002C3 3C2C                    	CMP	AL,','
   391 000002C5 B115                    	MOV	CL,21
   392 000002C7 75F4                    	JNZ	ERR1
   393                                  
   394                                  
   395                                  GETOP:
   396                                  
   397                                  ; Get one operand. Operand may be a memory reference in brackets, a register,
   398                                  ; or a constant. If a flag (such as "B" for byte operation) is encountered,
   399                                  ; it is noted and processing continues to find the operand.
   400                                  ;
   401                                  ; On exit, AL (=DH) has the type of operand. Other information depends
   402                                  ; on the actual operand:
   403                                  ;
   404                                  ; AL=DH=0  Memory Reference.  DL has the address mode properly prepared in
   405                                  ; the 8086 R/M format (middle bits zero). The constant part of the address
   406                                  ; is in ADDR. If an undefined label needs to be added to this, a pointer to
   407                                  ; its information fields is in ALABEL, otherwise ALABEL is zero.
   408                                  ;
   409                                  ; AL=DH=1  Value. The constant part is in DATA. If an undefined label needs
   410                                  ; to be added to this, a pointer to its information fields is in DLABEL,
   411                                  ; otherwise DLABEL is zero. "$" and "RET" are in this class.
   412                                  ;
   413                                  ; AL=DH=2  8-bit Register. DL has the register number.
   414                                  ;
   415                                  ; AL=DH=3  16-bit Register. DL has the register number.
   416                                  ;
   417                                  ; AL=DH=4  Segment Register. DL has the register number.
   418                                  
   419 000002C9 E83A02                  	CALL	GETSYM
   420                                  GETOP1:
   421                                  ;Enter here if we don't need a GETSYM first
   422 000002CC 3C5B                    	CMP	AL,'['		;Memory reference?
   423 000002CE 7430                    	JZ	MEM
   424 000002D0 3C05                    	CMP	AL,5		;Flag ("B", "W", etc.)?
   425 000002D2 7457                    	JZ	FLG
   426 000002D4 3C02                    	CMP	AL,REG		;8-Bit register?
   427 000002D6 7420                    	JZ	NREG
   428 000002D8 3C03                    	CMP	AL,XREG		;16-Bit register?
   429 000002DA 741C                    	JZ	NREG
   430 000002DC 3C04                    	CMP	AL,SREG		;Segment register?
   431 000002DE 7418                    	JZ	NREG
   432                                  VAL:				;Must be immediate
   433 000002E0 30C0                    	XOR	AL,AL		;No addressing modes allowed
   434                                  VAL1:
   435 000002E2 E85700                  	CALL	GETVAL
   436 000002E5 A1[3620]                	MOV	AX,[CON]	;Defined part
   437 000002E8 A3[3220]                	MOV	[DATA],AX
   438 000002EB A1[3820]                	MOV	AX,[UNDEF]	;Undefined part
   439 000002EE A3[3420]                	MOV	[DLABEL],AX
   440 000002F1 88EA                    	MOV	DL,CH
   441 000002F3 B601                    	MOV	DH,CONST
   442 000002F5 88F0                    	MOV	AL,DH
   443 000002F7 C3                      	RET
   444                                  NREG:
   445 000002F8 52                      	PUSH	DX
   446 000002F9 E80A02                  	CALL	GETSYM
   447 000002FC 5A                      	POP	DX
   448 000002FD 88F0                    	MOV	AL,DH
   449 000002FF C3                      	RET
   450                                  MEM:
   451 00000300 E80302                  	CALL	GETSYM
   452 00000303 B001                    	MOV	AL,1
   453 00000305 E83400                  	CALL	GETVAL
   454 00000308 A0[8C20]                	MOV	AL,[SYM]
   455 0000030B 3C5D                    	CMP	AL,']'
   456 0000030D B118                    	MOV	CL,24
   457 0000030F 75AC                    	JNZ	ERR1
   458 00000311 E8F201                  	CALL	GETSYM
   459 00000314 8B1E[3620]              	MOV	BX,[CON]
   460 00000318 891E[2E20]              	MOV	[ADDR],BX
   461 0000031C 8B1E[3820]              	MOV	BX,[UNDEF]
   462 00000320 891E[3020]              	MOV	[ALABEL],BX
   463 00000324 88EA                    	MOV	DL,CH
   464 00000326 B600                    	MOV	DH,UNDEFID
   465 00000328 88F0                    	MOV	AL,DH
   466 0000032A C3                      	RET
   467                                  FLG:
   468 0000032B 3A16[2D20]              	CMP	DL,[MAXFLG]	;Invalid flag for this operation?
   469 0000032F B127                    	MOV	CL,27H
   470 00000331 7F8A                    	JG	ERR1
   471 00000333 E8D001                  	CALL	GETSYM
   472 00000336 3C2C                    	CMP	AL,','
   473 00000338 748F                    	JZ	GETOP
   474 0000033A EB90                    	JMP	GETOP1
   475                                  
   476                                  
   477                                  GETVAL:
   478                                  
   479                                  ; Expression analyzer. On entry, if AL=0 then do not allow base or index
   480                                  ; registers. If AL=1, we are analyzing a memory reference, so allow base
   481                                  ; and index registers, and compute addressing mode when done. The constant
   482                                  ; part of the expression will be found in CON. If an undefined label is to
   483                                  ; be added to this, a pointer to its information fields will be found in
   484                                  ; UNDEF.
   485                                  
   486 0000033C 88C4                    	MOV	AH,AL		;Flag is kept in AH
   487 0000033E C706[3820]0000          	MOV	WORD[UNDEF],0
   488 00000344 A0[8C20]                	MOV	AL,[SYM]
   489 00000347 E85200                  	CALL	EXPRESSION
   490 0000034A 8916[3620]              	MOV	[CON],DX
   491 0000034E 88E0                    	MOV	AL,AH
   492 00000350 B500                    	MOV	CH,0		;Initial mode
   493 00000352 A810                    	TEST	AL,10H		;Test INDEX bit
   494 00000354 D0D0                    	RCL	AL,1		;BASE bit (zero flag not affected)
   495 00000356 7438                    	JZ	NOIND		;Jump if not indexed, with BASE bit in carry
   496 00000358 F5                      	CMC
   497 00000359 D0D5                    	RCL	CH,1		;Rotate in BASE bit
   498 0000035B D0D0                    	RCL	AL,1		;BP bit
   499 0000035D D0D5                    	RCL	CH,1
   500 0000035F D0D0                    	RCL	AL,1		;DI bit
   501 00000361 D0D5                    	RCL	CH,1		;The low 3 bits now have indexing mode
   502                                  MODE:
   503 00000363 80CD80                  	OR	CH,080H		;If undefined label, force 16-bit displacement
   504 00000366 F706[3820]FFFF          	TEST	WORD[UNDEF],-1
   505 0000036C 7521                    	JNZ	GETVAL_RET
   506 0000036E 8B1E[3620]              	MOV	BX,[CON]
   507 00000372 88D8                    	MOV	AL,BL
   508 00000374 98                      	CBW			;Extend sign
   509 00000375 39D8                    	CMP	AX,BX		;Is it a signed 8-bit number?
   510 00000377 7516                    	JNZ	GETVAL_RET		;If not, use 16-bit displacement
   511 00000379 80E57F                  	AND	CH,07FH		;Reset 16-bit displacement
   512 0000037C 80CD40                  	OR	CH,040H		;Set 8-bit displacement
   513 0000037F 09DB                    	OR	BX,BX
   514 00000381 750C                    	JNZ	GETVAL_RET		;Use it if not zero displacement
   515 00000383 80E507                  	AND	CH,7		;Specify no displacement
   516 00000386 80FD06                  	CMP	CH,6		;Check for BP+0 addressing mode
   517 00000389 7504                    	JNZ	GETVAL_RET
   518 0000038B 80CD40                  	OR	CH,040H		;If BP+0, use 8-bit displacement
   519 0000038E C3                      	RET
   520                                  GETVAL_RET:
   521 0000038F C3                      	RET
   522                                  NOIND:
   523 00000390 B506                    	MOV	CH,6		;Try direct address mode
   524 00000392 73FB                    	JNC	GETVAL_RET		;If no base register, that's right
   525 00000394 D0D0                    	RCL	AL,1		;Check BP bit
   526 00000396 72CB                    	JC	MODE
   527 00000398 FEC5                    	INC	CH		;If not, must be BX
   528 0000039A EBC7                    	JMP	MODE
   529                                  
   530                                  EXPRESSION:
   531                                  ;Analyze arbitrary expression. Flag byte in AH.
   532                                  ;On exit, AL has type byte: 0=register or undefined label
   533 0000039C B5FF                    	MOV	CH,-1		;Initial type
   534 0000039E 89D7                    	MOV	DI,DX
   535 000003A0 31D2                    	XOR	DX,DX		;Initial value
   536 000003A2 3C2B                    	CMP	AL,'+'
   537 000003A4 740C                    	JZ	PLSMNS
   538 000003A6 3C2D                    	CMP	AL,'-'
   539 000003A8 7408                    	JZ	PLSMNS
   540 000003AA B12B                    	MOV	CL,'+'
   541 000003AC 52                      	PUSH	DX
   542 000003AD 51                      	PUSH	CX
   543 000003AE 89FA                    	MOV	DX,DI
   544 000003B0 EB0A                    	JMP	OPERATE
   545                                  PLSMNS:
   546 000003B2 88C1                    	MOV	CL,AL
   547 000003B4 52                      	PUSH	DX
   548 000003B5 51                      	PUSH	CX
   549 000003B6 80CC04                  	OR	AH,4		;Flag that a sign was found
   550 000003B9 E84A01                  	CALL	GETSYM
   551                                  OPERATE:
   552 000003BC E82B00                  	CALL	TERM
   553 000003BF 59                      	POP	CX		;Recover operator
   554 000003C0 5B                      	POP	BX		;Recover current value
   555 000003C1 87DA                    	XCHG	DX,BX
   556 000003C3 20C5                    	AND	CH,AL
   557 000003C5 08C0                    	OR	AL,AL		;Is it register or undefined label?
   558 000003C7 7417                    	JZ	NOCON		;If so, then no constant part
   559 000003C9 80F92D                  	CMP	CL,"-"		;Subtract it?
   560 000003CC 7502                    	JNZ	ADD
   561 000003CE F7DB                    	NEG	BX
   562                                  ADD:
   563 000003D0 01DA                    	ADD	DX,BX
   564                                  NEXTERM:
   565 000003D2 A0[8C20]                	MOV	AL,[SYM]
   566 000003D5 3C2B                    	CMP	AL,'+'
   567 000003D7 74D9                    	JZ	PLSMNS
   568 000003D9 3C2D                    	CMP	AL,'-'
   569 000003DB 74D5                    	JZ	PLSMNS
   570 000003DD 88E8                    	MOV	AL,CH
   571 000003DF C3                      	RET
   572                                  NOCON:
   573 000003E0 80F92D                  	CMP	CL,"-"
   574 000003E3 75ED                    	JNZ	NEXTERM
   575                                  BADOP:
   576 000003E5 B105                    	MOV	CL,5
   577 000003E7 E9C8FD                  	JMP	ERROR
   578                                  
   579                                  TERM:
   580 000003EA E84000                  	CALL	FACTOR
   581                                  MULOP:
   582 000003ED 52                      	PUSH	DX		;Save value
   583 000003EE 50                      	PUSH	AX		;Save type
   584 000003EF E81401                  	CALL	GETSYM
   585 000003F2 59                      	POP	CX
   586 000003F3 3C2A                    	CMP	AL,"*"
   587 000003F5 7404                    	JZ	GETFACT
   588 000003F7 3C2F                    	CMP	AL,"/"
   589 000003F9 752E                    	JNZ	ENDTERM
   590                                  GETFACT:
   591 000003FB 08C9                    	OR	CL,CL		;Can we operate on this type?
   592 000003FD 74E6                    	JZ	BADOP
   593 000003FF 50                      	PUSH	AX		;Save operator
   594 00000400 E80301                  	CALL	GETSYM		;Get past operator
   595 00000403 E82700                  	CALL	FACTOR
   596 00000406 08C0                    	OR	AL,AL
   597 00000408 74DB                    	JZ	BADOP
   598 0000040A 59                      	POP	CX		;Recover operator
   599 0000040B 5D                      	POP	BP		;And current value
   600 0000040C 95                      	XCHG	AX,BP		;Save AH in BP
   601 0000040D 80F92F                  	CMP	CL,"/"		;Do we divide?
   602 00000410 750E                    	JNZ	DOMUL
   603 00000412 09D2                    	OR	DX,DX		;Dividing by zero?
   604 00000414 B129                    	MOV	CL,29H
   605 00000416 7451                    	JZ	ERR2
   606 00000418 89D3                    	MOV	BX,DX
   607 0000041A 31D2                    	XOR	DX,DX		;Make 32-bit dividend
   608 0000041C F7F3                    	DIV	BX
   609 0000041E EB02                    	JMP 	NEXFACT
   610                                  DOMUL:
   611 00000420 F7E2                    	MUL	DX
   612                                  NEXFACT:
   613 00000422 89C2                    	MOV	DX,AX		;Result in DX
   614 00000424 95                      	XCHG	AX,BP		;Restore flags to AH
   615 00000425 B0FF                    	MOV	AL,-1		;Indicate a number
   616 00000427 EBC4                    	JMP 	MULOP
   617                                  ENDTERM:
   618 00000429 5A                      	POP	DX
   619 0000042A 88C8                    	MOV	AL,CL
   620 0000042C C3                      	RET
   621                                  
   622                                  FACTOR:
   623 0000042D A0[8C20]                	MOV	AL,[SYM]
   624 00000430 3C01                    	CMP	AL,CONST
   625 00000432 7438                    	JZ	FACTOR_RET
   626 00000434 3C00                    	CMP	AL,UNDEFID
   627 00000436 745D                    	JZ	UVAL
   628 00000438 3C28                    	CMP	AL,"("
   629 0000043A 7449                    	JZ	PAREN
   630 0000043C 3C22                    	CMP	AL,'"'
   631 0000043E 7467                    	JZ	STRING
   632 00000440 3C27                    	CMP	AL,"'"
   633 00000442 7463                    	JZ	STRING
   634 00000444 3C03                    	CMP	AL,XREG		;Only 16-bit register may index
   635 00000446 B114                    	MOV	CL,20
   636 00000448 751F                    	JNZ	ERR2
   637 0000044A F6C401                  	TEST	AH,1		;Check to see if indexing is OK
   638 0000044D B101                    	MOV	CL,1
   639 0000044F 7418                    	JZ	ERR2
   640 00000451 88D0                    	MOV	AL,DL
   641 00000453 B103                    	MOV	CL,3
   642 00000455 2C03                    	SUB	AL,3		;Check for BX
   643 00000457 7423                    	JZ	BXJ
   644 00000459 2C02                    	SUB	AL,2		;Check for BP
   645 0000045B 741C                    	JZ	BPJ
   646 0000045D FEC8                    	DEC	AL		;Check for SI
   647 0000045F B104                    	MOV	CL,4
   648 00000461 740D                    	JZ	SIJ
   649 00000463 FEC8                    	DEC	AL		;Check for DI
   650 00000465 7406                    	JZ	DIJ
   651 00000467 B102                    	MOV	CL,2		;Invalid base/index register
   652 00000469 E946FD                  ERR2:	JMP	ERROR
   653                                  FACTOR_RET:
   654 0000046C C3                      	RET
   655                                  DIJ:
   656 0000046D 80CC20                  	OR	AH,20H		;Flag seeing index register DI
   657                                  SIJ:
   658 00000470 F6C410                  	TEST	AH,10H		;Check if already seen index register
   659 00000473 75F4                    	JNZ	ERR2
   660 00000475 80CC10                  	OR	AH,10H		;Flag seeing index register
   661 00000478 C3                      	RET
   662                                  
   663                                  BPJ:
   664 00000479 80CC40                  	OR	AH,40H		;Flag seeing base register BP
   665                                  BXJ:
   666 0000047C F6C480                  	TEST	AH,80H		;Check if already seen base register
   667 0000047F 75E8                    	JNZ	ERR2
   668 00000481 80CC80                  	OR	AH,80H		;Flag seeing base register
   669 00000484 C3                      	RET
   670                                  
   671                                  PAREN:
   672 00000485 E87E00                  	CALL	GETSYM		;Eat the "("
   673 00000488 E811FF                  	CALL	EXPRESSION
   674 0000048B 803E[8C20]29            	CMP	BYTE [SYM],")"	;Better have closing paren
   675 00000490 B114                    	MOV	CL,20
   676 00000492 7510                    	JNZ	ERR30
   677 00000494 C3                      	RET
   678                                  
   679                                  UVAL:
   680 00000495 B106                    	MOV	CL,6
   681 00000497 F6C408                  	TEST	AH,8		;Check if undefined label has been seen
   682 0000049A 7508                    	JNZ	ERR30
   683 0000049C 80CC08                  	OR	AH,8		;Flag seeing undefined label
   684 0000049F 891E[3820]              	MOV	[UNDEF],BX
   685 000004A3 C3                      	RET
   686                                  
   687 000004A4 E90BFD                  ERR30:	JMP	ERROR
   688                                  
   689                                  STRING:
   690 000004A7 88C5                    	MOV	CH,AL
   691 000004A9 A0[8B20]                	MOV	AL,[CHR]
   692 000004AC 38E8                    	CMP	AL,CH
   693 000004AE B123                    	MOV	CL,35
   694 000004B0 88C2                    	MOV	DL,AL
   695 000004B2 B600                    	MOV	DH,0
   696 000004B4 7503                    	JNZ	L0003
   697 000004B6 E83200                  	CALL	ZERLEN
   698                                  L0003:
   699 000004B9 E83700                  	CALL	GETCHR
   700 000004BC B125                    	MOV	CL,37
   701 000004BE F6C402                  	TEST	AH,2
   702 000004C1 74E1                    	JZ	ERR30
   703 000004C3 F6C404                  	TEST	AH,4
   704 000004C6 B126                    	MOV	CL,38
   705 000004C8 75DA                    	JNZ	ERR30
   706                                  STRGDAT:
   707 000004CA 88D0                    	MOV	AL,DL
   708 000004CC 3C0D                    	CMP	AL,EOL
   709 000004CE B127                    	MOV	CL,39
   710 000004D0 74D2                    	JZ	ERR30
   711 000004D2 E8D205                  	CALL	PUT
   712 000004D5 A0[9520]                	MOV	AL,[DATSIZ]
   713 000004D8 08C0                    	OR	AL,AL
   714 000004DA 7505                    	JNZ	BYTSIZ
   715 000004DC 88F0                    	MOV	AL,DH
   716 000004DE E8C605                  	CALL	PUT
   717                                  BYTSIZ:
   718 000004E1 A0[8B20]                	MOV	AL,[CHR]
   719 000004E4 88C2                    	MOV	DL,AL
   720 000004E6 E80A00                  	CALL	GETCHR
   721 000004E9 EBDF                    	JMP	STRGDAT
   722                                  
   723                                  ZERLEN:
   724 000004EB E8C8FC                  	CALL	NEXTCHR
   725 000004EE 38E8                    	CMP	AL,CH
   726 000004F0 75B2                    	JNZ	ERR30
   727 000004F2 C3                      	RET
   728                                  
   729                                  GETCHR:
   730 000004F3 E8C0FC                  	CALL	NEXTCHR
   731 000004F6 38E8                    	CMP	AL,CH
   732 000004F8 750B                    	JNZ	GETCHR_RET
   733 000004FA E8B9FC                  	CALL	NEXTCHR
   734 000004FD 38E8                    	CMP	AL,CH
   735 000004FF 7404                    	JZ	GETCHR_RET
   736 00000501 5B                      	POP	BX		;Kill return address to STRGDAT loop
   737 00000502 B0FF                    	MOV	AL,-1		;Flag type as constant
   738 00000504 C3                      	RET
   739                                  GETCHR_RET:
   740 00000505 C3                      	RET
   741                                  
   742                                  GETSYM:
   743                                  
   744                                  ; The lexical scanner. Used only in the operand field. Returns with the token
   745                                  ; in SYM and AL, sometimes with additional info in BX or DX.
   746                                  ;
   747                                  ; AL=SYM=0  Undefined label. BX has pointer to information fields.
   748                                  ;
   749                                  ; AL=SYM=1  Constant (or defined label). DX has value.
   750                                  ;
   751                                  ; AL=SYM=2,3,4  8-bit register, 16-bit register, or segment register,
   752                                  ; respectively. DL has register number.
   753                                  ;
   754                                  ; AL=SYM=5  A mode flag (such as "B" for byte operation). Type of flag in DL
   755                                  ; and also stored in FLAG: -1=no flags, 0=B, 1=W, 2=S, 3=L, 4=T.
   756                                  ;
   757                                  ; AL=SYM=6  8087 floating point register, ST(n) or ST. DL has register number.
   758                                  ;
   759                                  ; All other values are the ASCII code of the character. Note that this may
   760                                  ; never be a letter or number.
   761                                  
   762 00000506 50                      	PUSH	AX		;Save AH
   763 00000507 E82200                  	CALL	GETSY
   764 0000050A 58                      	POP	AX
   765 0000050B A0[8C20]                	MOV	AL,[SYM]
   766 0000050E C3                      	RET
   767                                  
   768                                  SCANB:
   769 0000050F A0[8B20]                	MOV	AL,[CHR]
   770                                  SCANT:
   771 00000512 3C20                    	CMP	AL,' '
   772 00000514 7404                    	JZ	NEXB
   773 00000516 3C09                    	CMP	AL,9
   774 00000518 7505                    	JNZ	SCANT_RET
   775                                  NEXB:
   776 0000051A E899FC                  	CALL	NEXTCHR
   777 0000051D EBF3                    	JMP	SCANT
   778                                  SCANT_RET:
   779 0000051F C3                      	RET
   780                                  
   781                                  DOLLAR:
   782 00000520 8B16[2820]              	MOV	DX,[OLDPC]
   783 00000524 B001                    	MOV	AL,CONST
   784 00000526 A2[8C20]                	MOV	[SYM],AL
   785                                  NEXTCHJ:
   786 00000529 E98AFC                  	JMP	NEXTCHR
   787                                  
   788                                  GETSY:
   789 0000052C E8E0FF                  	CALL	SCANB
   790 0000052F 3C24                    	CMP	AL,'$'
   791 00000531 74ED                    	JZ	DOLLAR
   792 00000533 A2[8C20]                	MOV	[SYM],AL
   793 00000536 0C20                    	OR	AL,20H
   794 00000538 3C7B                    	CMP	AL,'z'+1
   795 0000053A 73ED                    	JNC	NEXTCHJ
   796 0000053C 3C61                    	CMP	AL,'a'
   797 0000053E 7203                    	JC	$+5
   798 00000540 E9BF00                  	JMP	LETTER
   799 00000543 3C3A                    	CMP	AL,'9'+1
   800 00000545 73E2                    	JNC	NEXTCHJ
   801 00000547 3C30                    	CMP	AL,'0'
   802 00000549 72DE                    	JC	NEXTCHJ
   803 0000054B BB[8C20]                	MOV	BX,SYM
   804 0000054E C60701                  	MOV	BYTE [BX],CONST
   805 00000551 E88200                  	CALL	READID
   806 00000554 4B                      	DEC	BX
   807 00000555 8A07                    	MOV	AL,[BX]
   808 00000557 B107                    	MOV	CL,7
   809 00000559 BB0000                  	MOV	BX,0
   810 0000055C 3C68                    	CMP	AL,'h'
   811 0000055E 7503                    	JNZ	$+5
   812 00000560 EB32                    	JMP	HEX
   813 00000562 FEC1                    	INC	CL
   814 00000564 C706[B220][3B20]        	MOV	WORD[IX],IDTEXT
   815                                  DEC:
   816 0000056A 8B36[B220]              	MOV	SI,[IX]
   817 0000056E 8A04                    	MOV	AL,[SI]
   818 00000570 FF06[B220]              	INC	WORD[IX]
   819 00000574 3C3A                    	CMP	AL,'9'+1
   820 00000576 7203                    	JC	$+5
   821 00000578 E937FC                  	JMP	ERROR
   822 0000057B 2C30                    	SUB	AL,'0'
   823 0000057D 89DA                    	MOV	DX,BX
   824 0000057F D1E3                    	SHL	BX,1
   825 00000581 D1E3                    	SHL	BX,1
   826 00000583 01D3                    	ADD	BX,DX
   827 00000585 D1E3                    	SHL	BX,1
   828 00000587 88C2                    	MOV	DL,AL
   829 00000589 B600                    	MOV	DH,0
   830 0000058B 01D3                    	ADD	BX,DX
   831 0000058D FECD                    	DEC	CH
   832 0000058F 75D9                    	JNZ	DEC
   833 00000591 87DA                    	XCHG	DX,BX
   834 00000593 C3                      	RET
   835                                  
   836                                  HEX:
   837 00000594 BA[3B20]                	MOV	DX,IDTEXT
   838 00000597 FECD                    	DEC	CH
   839                                  HEX1:
   840 00000599 89D6                    	MOV	SI,DX
   841 0000059B AC                      	LODSB
   842 0000059C 42                      	INC	DX
   843 0000059D 2C30                    	SUB	AL,'0'
   844 0000059F 3C0A                    	CMP	AL,10
   845 000005A1 7206                    	JC	GOTIT
   846 000005A3 3C37                    	CMP	AL,'g'-'0'
   847 000005A5 7313                    	JNC	ERR4
   848 000005A7 2C27                    	SUB	AL,'a'-10-'0'
   849                                  GOTIT:
   850 000005A9 D1E3                    	SHL	BX,1
   851 000005AB D1E3                    	SHL	BX,1
   852 000005AD D1E3                    	SHL	BX,1
   853 000005AF D1E3                    	SHL	BX,1
   854 000005B1 00C3                    	ADD	BL,AL
   855 000005B3 FECD                    	DEC	CH
   856 000005B5 75E2                    	JNZ	HEX1
   857 000005B7 87DA                    	XCHG	DX,BX
   858 000005B9 C3                      	RET
   859                                  
   860 000005BA E9F5FB                  ERR4:	JMP	ERROR
   861                                  
   862                                  GETLET:
   863 000005BD E84FFF                  	CALL	SCANB
   864 000005C0 3C0D                    	CMP	AL,EOL
   865 000005C2 F9                      	STC
   866 000005C3 743C                    	JZ	GETLET_RET
   867 000005C5 3C3B                    	CMP	AL,';'
   868 000005C7 F9                      	STC
   869 000005C8 7437                    	JZ	GETLET_RET
   870 000005CA B10A                    	MOV	CL,10
   871 000005CC 0C20                    	OR	AL,20H
   872 000005CE 3C61                    	CMP	AL,'a'
   873 000005D0 72E8                    	JC	ERR4
   874 000005D2 3C7B                    	CMP	AL,'z'+1
   875 000005D4 73E4                    	JNC	ERR4
   876                                  READID:
   877 000005D6 BB[3B20]                	MOV	BX,IDTEXT
   878 000005D9 B500                    	MOV	CH,0
   879                                  MOREID:
   880 000005DB 8807                    	MOV	[BX],AL	;WRITE AL TO IDTEXT
   881 000005DD FEC5                    	INC	CH
   882 000005DF 43                      	INC	BX
   883 000005E0 E8D3FB                  	CALL	NEXTCHR
   884 000005E3 3C30                    	CMP	AL,'0'
   885 000005E5 720E                    	JC	NOMORE
   886 000005E7 0C20                    	OR	AL,20H
   887 000005E9 3C7B                    	CMP	AL,'z'+1
   888 000005EB 7308                    	JNC	NOMORE
   889 000005ED 3C3A                    	CMP	AL,'9'+1
   890 000005EF 72EA                    	JC	MOREID
   891 000005F1 3C61                    	CMP	AL,'a'
   892 000005F3 73E6                    	JNC	MOREID
   893                                  NOMORE:
   894 000005F5 88C1                    	MOV	CL,AL
   895 000005F7 88E8                    	MOV	AL,CH
   896 000005F9 A2[3A20]                	MOV	[LENID],AL
   897 000005FC 08C0                    	OR	AL,AL
   898 000005FE 88C8                    	MOV	AL,CL
   899 00000600 C3                      	RET
   900                                  GETLET_RET:
   901 00000601 C3                      	RET
   902                                  
   903                                  LETTER:
   904 00000602 E8D1FF                  	CALL	READID	;BX=IDTEXT, CH=length
   905 00000605 88E8                    	MOV	AL,CH
   906 00000607 FEC8                    	DEC	AL
   907 00000609 7514                    	JNZ	NOFLG
   908 0000060B A0[3B20]                	MOV	AL,[IDTEXT]
   909 0000060E B90500                  	MOV	CX,5
   910 00000611 BF[4506]                	MOV	DI,FLGTAB
   911 00000614 FC                      	CLD
   912 00000615 F2                      	REPNE
   913 00000616 AE                      	SCASB			;See if one of B,W,S,L,T
   914 00000617 741A                    	JZ	SAVFLG		;Go save flag
   915 00000619 30C0                    	XOR	AL,AL
   916 0000061B 8A2E[3A20]              	MOV	CH,[LENID]
   917                                  NOFLG:
   918 0000061F FEC8                    	DEC	AL
   919 00000621 53                      	PUSH	BX
   920 00000622 7503                    	JNZ	L0004
   921 00000624 E85A00                  	CALL	REGCHK
   922                                  L0004:	
   923 00000627 5B                      	POP	BX
   924 00000628 88F0                    	MOV	AL,DH
   925 0000062A 7403                    	JZ	SYMSAV
   926 0000062C E8FC00                  	CALL	LOOKRET
   927                                  SYMSAV:
   928 0000062F A2[8C20]                	MOV	[SYM],AL
   929 00000632 C3                      	RET
   930                                  
   931                                  SAVFLG:
   932 00000633 88CA                    	MOV	DL,CL		;Need flag type in DL
   933 00000635 860E[2C20]              	XCHG	[FLAG],CL
   934 00000639 80F9FF                  	CMP	CL,-1
   935 0000063C B120                    	MOV	CL,32
   936 0000063E B005                    	MOV	AL,5
   937 00000640 74ED                    	JZ	SYMSAV
   938 00000642 E96DFB                  ERRJ3:	JMP	ERROR
   939                                  
   940 00000645 746C737762              FLGTAB:	DB	"tlswb"
   941                                  
   942                                  FPREG:
   943                                  ;Have detected "ST" for 8087 floating point stack register
   944 0000064A B200                    	MOV	DL,0		;Default is ST(0)
   945 0000064C E8C0FE                  	CALL	SCANB		;Get next character
   946 0000064F 3C28                    	CMP	AL,"("		;Specifying register number?
   947 00000651 7529                    	JNZ	HAVREG
   948                                  ;Get register number
   949 00000653 E860FB                  	CALL	NEXTCHR		;Skip over the "("
   950 00000656 E870FC                  	CALL	GETOP		;A little recursion never hurt anybody
   951 00000659 3C01                    	CMP	AL,CONST	;Better have found a constant
   952 0000065B B114                    	MOV	CL,20		;Operand error if not
   953 0000065D 75E3                    	JNZ	ERRJ3
   954 0000065F 833E[3420]00            	CMP	WORD[DLABEL],0	;Constant must be defined
   955 00000664 B11E                    	MOV	CL,30
   956 00000666 75DA                    	JNZ	ERRJ3
   957 00000668 8B16[3220]              	MOV	DX,[DATA]	;Get constant
   958 0000066C 83FA07                  	CMP	DX,7		;Constant must be in range 0-7
   959 0000066F B11F                    	MOV	CL,31
   960 00000671 77CF                    	JA	ERRJ3
   961 00000673 A0[8C20]                	MOV	AL,[SYM]
   962 00000676 3C29                    	CMP	AL,")"
   963 00000678 B118                    	MOV	CL,24
   964 0000067A 75C6                    	JNZ	ERRJ3
   965                                  HAVREG:
   966 0000067C B606                    	MOV	DH,FREG
   967 0000067E 30C0                    	XOR	AL,AL		;Zero set means register found
   968 00000680 C3                      	RET
   969                                  
   970                                  REGCHK:
   971 00000681 BB[3B20]                	MOV	BX,IDTEXT
   972 00000684 813F7374                	CMP	WORD[BX],"s"+7400H	;"st"
   973 00000688 74C0                    	JZ	FPREG
   974 0000068A 8A0F                    	MOV	CL,[BX]
   975 0000068C 43                      	INC	BX
   976 0000068D 8A07                    	MOV	AL,[BX]
   977 0000068F BB[EE06]                	MOV	BX,REGTAB
   978 00000692 B603                    	MOV	DH,XREG
   979 00000694 B200                    	MOV	DL,0
   980 00000696 3C78                    	CMP	AL,'x'
   981 00000698 743C                    	JZ	SCANREG
   982 0000069A B602                    	MOV	DH,REG
   983 0000069C 3C6C                    	CMP	AL,'l'
   984 0000069E 7436                    	JZ	SCANREG
   985 000006A0 B204                    	MOV	DL,4
   986 000006A2 3C68                    	CMP	AL,'h'
   987 000006A4 7430                    	JZ	SCANREG
   988 000006A6 B604                    	MOV	DH,SREG
   989 000006A8 B200                    	MOV	DL,0
   990 000006AA BB[F206]                	MOV	BX,SEGTAB
   991 000006AD 3C73                    	CMP	AL,'s'
   992 000006AF 7425                    	JZ	SCANREG
   993 000006B1 B603                    	MOV	DH,XREG
   994 000006B3 3C70                    	CMP	AL,'p'
   995 000006B5 7411                    	JZ	PREG
   996 000006B7 3C69                    	CMP	AL,'i'
   997 000006B9 7532                    	JNZ	REGCHK_RET
   998 000006BB B206                    	MOV	DL,6
   999 000006BD 88C8                    	MOV	AL,CL
  1000 000006BF 3C73                    	CMP	AL,'s'
  1001 000006C1 742A                    	JZ	REGCHK_RET
  1002 000006C3 FEC2                    	INC	DL
  1003 000006C5 3C64                    	CMP	AL,'d'
  1004 000006C7 C3                      	RET
  1005                                  PREG:
  1006 000006C8 B204                    	MOV	DL,4
  1007 000006CA 88C8                    	MOV	AL,CL
  1008 000006CC 3C73                    	CMP	AL,'s'
  1009 000006CE 7405                    	JZ	PREG_RET
  1010 000006D0 FEC2                    	INC	DL
  1011 000006D2 3C62                    	CMP	AL,'b'
  1012 000006D4 C3                      	RET
  1013                                  PREG_RET:
  1014 000006D5 C3                      	RET
  1015                                  SCANREG:
  1016 000006D6 88C8                    	MOV	AL,CL
  1017 000006D8 B90400                  	MOV	CX,4
  1018 000006DB FC                      	CLD
  1019 000006DC 89DF                    	MOV	DI,BX
  1020 000006DE F2                      	REPNZ
  1021 000006DF AE                      	SCASB
  1022 000006E0 89FB                    	MOV	BX,DI
  1023 000006E2 7509                    	JNZ	REGCHK_RET
  1024 000006E4 88C8                    	MOV	AL,CL
  1025 000006E6 00D0                    	ADD	AL,DL
  1026 000006E8 88C2                    	MOV	DL,AL
  1027 000006EA 30C0                    	XOR	AL,AL
  1028 000006EC C3                      	RET
  1029                                  REGCHK_RET:
  1030 000006ED C3                      	RET
  1031                                  
  1032 000006EE 62646361                REGTAB:	DB	'bdca'
  1033                                  
  1034 000006F2 64736365                SEGTAB:	DB	'dsce'
  1035                                  
  1036                                  LOOK:
  1037 000006F6 8A2F                    	MOV	CH,[BX]		;BX=HEAP,CH=LENGTH
  1038 000006F8 43                      	INC	BX			;BX=POINTS TO FIRST CHARACTER
  1039 000006F9 BA[3B20]                	MOV	DX,IDTEXT	;DX=IDTEXT
  1040 000006FC E8FD00                  	CALL	CPSLP 	;DX=SOURCE, CH=LENGTH
  1041 000006FF 7429                    	JZ	LOOK_RET	;FOUND LENGTH MATCH
  1042                                  	;FIX
  1043 00000701 3480                    	XOR	AL,80H
  1044 00000703 D0C0                    	ROL	AL,1		;Make end-of-symbol bit least significant
  1045 00000705 88C1                    	MOV	CL,AL
  1046 00000707 4B                      	DEC	BX
  1047 00000708 8A07                    	MOV	AL,[BX]
  1048                                  	;FIX
  1049 0000070A 3480                    	XOR	AL,80H
  1050 0000070C D0C0                    	ROL	AL,1
  1051 0000070E 38C8                    	CMP	AL,CL
  1052 00000710 7304                    	JNC	SMALL
  1053 00000712 FEC5                    	INC	CH
  1054 00000714 FEC5                    	INC	CH
  1055                                  SMALL:
  1056 00000716 88EA                    	MOV	DL,CH
  1057 00000718 B600                    	MOV	DH,0
  1058 0000071A 01D3                    	ADD	BX,DX
  1059 0000071C 8B17                    	MOV	DX,[BX]
  1060 0000071E 43                      	INC	BX
  1061 0000071F 88D0                    	MOV	AL,DL
  1062 00000721 08F0                    	OR	AL,DH
  1063 00000723 F9                      	STC
  1064 00000724 7404                    	JZ	LOOK_RET
  1065 00000726 87DA                    	XCHG	DX,BX
  1066 00000728 EBCC                    	JMP	LOOK
  1067                                  
  1068                                  LOOK_RET:
  1069 0000072A C3                      	RET
  1070                                  LOOKRET:		;BX=IDTEXT, CH=length
  1071 0000072B 88E8                    	MOV	AL,CH	;CH=[LENID]
  1072 0000072D 3C03                    	CMP	AL,3	;RET has 3 letters
  1073 0000072F 7550                    	JNZ	LOOKUP
  1074 00000731 4B                      	DEC	BX
  1075                                  	;FIX: REMOVE THIS END OF SYMBOL BIT SETTING
  1076 00000732 800F80                  	OR	BYTE [BX],080H	;Set end-of-symbol bit
  1077 00000735 BA[DB1F]                	MOV	DX,RETSTR+2
  1078                                  CHKRET:
  1079 00000738 89D6                    	MOV	SI,DX
  1080 0000073A AC                      	LODSB
  1081 0000073B 3A07                    	CMP	AL,[BX]
  1082 0000073D 7546                    	JNZ	LOOKIT
  1083 0000073F 4B                      	DEC	BX
  1084 00000740 4A                      	DEC	DX
  1085 00000741 FECD                    	DEC	CH
  1086 00000743 75F3                    	JNZ	CHKRET
  1087 00000745 8B16[AA20]              	MOV	DX,[LSTRET]
  1088 00000749 88D0                    	MOV	AL,DL
  1089 0000074B 20F0                    	AND	AL,DH
  1090 0000074D FEC0                    	INC	AL
  1091 0000074F 740F                    	JZ	ALLRET
  1092 00000751 8B1E[2620]              	MOV	BX,[PC]
  1093 00000755 29D3                    	SUB	BX,DX
  1094 00000757 88D8                    	MOV	AL,BL
  1095 00000759 98                      	CBW
  1096 0000075A 39D8                    	CMP	AX,BX		;Signed 8-bit number?
  1097 0000075C B001                    	MOV	AL,1
  1098 0000075E 7420                    	JZ	ALLRET_RET
  1099                                  ALLRET:
  1100 00000760 8B1E[AC20]              	MOV	BX,[RETPT]
  1101 00000764 88F8                    	MOV	AL,BH
  1102 00000766 08D8                    	OR	AL,BL
  1103 00000768 B000                    	MOV	AL,0
  1104 0000076A 7514                    	JNZ	ALLRET_RET
  1105 0000076C 8B1E[8F20]              	MOV	BX,[HEAP]
  1106 00000770 4B                      	DEC	BX
  1107 00000771 4B                      	DEC	BX
  1108 00000772 4B                      	DEC	BX
  1109 00000773 891E[8F20]              	MOV	[HEAP],BX
  1110 00000777 30C0                    	XOR	AL,AL
  1111 00000779 8807                    	MOV	[BX],AL
  1112 0000077B 891E[AC20]              	MOV	[RETPT],BX
  1113 0000077F C3                      	RET
  1114                                  ALLRET_RET:
  1115 00000780 C3                      	RET
  1116                                  LOOKUP:	;BX=IDTEXT, CH=length
  1117 00000781 4B                      	DEC	BX
  1118                                  	;FIX: REMOVE THIS END OF SYMBOL BIT SETTING
  1119 00000782 800F80                  	OR	BYTE [BX],080H
  1120                                  LOOKIT:
  1121 00000785 8B1E[8D20]              	MOV	BX,[BASE]	;BX points to root of ID tree
  1122 00000789 88F8                    	MOV	AL,BH
  1123 0000078B 08D8                    	OR	AL,BL
  1124 0000078D 741F                    	JZ	EMPTY
  1125 0000078F E864FF                  	CALL	LOOK
  1126 00000792 7211                    	JC	ENTER	;Not found, enter new node
  1127 00000794 BA0400                  	MOV	DX,4	;Offset to right link
  1128 00000797 01D3                    	ADD	BX,DX
  1129 00000799 8A07                    	MOV	AL,[BX]	;Get right link
  1130 0000079B 08C0                    	OR	AL,AL	;AL==0
  1131 0000079D 7405                    	JZ	LOOKIT_RET ;If zero, then not found
  1132 0000079F 43                      	INC	BX
  1133 000007A0 8B17                    	MOV	DX,[BX] ;Get pointer to right link
  1134 000007A2 43                      	INC	BX	;Point to defined flag
  1135 000007A3 C3                      	RET
  1136                                  LOOKIT_RET:
  1137 000007A4 C3                      	RET
  1138                                  ENTER:
  1139 000007A5 53                      	PUSH	BX		;Save pointer to link field
  1140 000007A6 E80D00                  	CALL	CREATE		;Add the node
  1141 000007A9 5E                      	POP	SI
  1142 000007AA 8954FF                  	MOV	[SI-1],DX	;Link new node
  1143 000007AD C3                      	RET			;Zero was set by CREATE
  1144                                  
  1145                                  EMPTY:
  1146 000007AE E80500                  	CALL	CREATE
  1147 000007B1 8916[8D20]              	MOV	[BASE],DX
  1148 000007B5 C3                      	RET
  1149                                  
  1150                                  
  1151                                  CREATE:
  1152                                  
  1153                                  ; Add a new node to the identifier tree. The identifier is at IDTEXT with
  1154                                  ; bit 7 of the last character set to one. The length of the identifier is
  1155                                  ; in LENID, which is IDTEXT-1.
  1156                                  ;
  1157                                  ; Node format:
  1158                                  ;	1. Length of identifier (1 byte)
  1159                                  ;	2. Identifier (1-80 bytes)
  1160                                  ;	3. Left link (2-byte pointer to alphabetically smaller identifiers)
  1161                                  ;	4. Right link (2-byte pointer, 0 if none larger)
  1162                                  ;	5. Data field:
  1163                                  ;	   a. Defined flag (0=undefined, 1=defined) (1 byte)
  1164                                  ;	   b. Value (2 bytes)
  1165                                  ;
  1166                                  ; This routine returns with AL=zero and zero flag set (which indicates
  1167                                  ; on return from LOOKUP that it has not yet been defined), DX points
  1168                                  ; to start of new node, and BX points to data field of new node.
  1169                                  
  1170 000007B6 A0[3A20]                	MOV	AL,[LENID]
  1171 000007B9 0408                    	ADD	AL,8		;Storage needed for the node
  1172 000007BB 8B1E[8F20]              	MOV	BX,[HEAP]
  1173 000007BF 88C2                    	MOV	DL,AL
  1174 000007C1 B600                    	MOV	DH,0
  1175 000007C3 29D3                    	SUB	BX,DX		;Heap grows downward
  1176 000007C5 891E[8F20]              	MOV	[HEAP],BX	;Adjust heap pointer
  1177 000007C9 87DA                    	XCHG	DX,BX	;DX=pointer to new node,BX=bytes needed
  1178 000007CB 8B1E[9320]              	MOV	BX,[CODE]	;Check to make sure there's enough
  1179 000007CF 39D3                    	CMP	BX,DX		;DX=pointer to new node
  1180 000007D1 7203                    	JB	SKIP_ABORT
  1181 000007D3 E99CF9                  	JMP	ABORT
  1182                                  SKIP_ABORT:
  1183 000007D6 52                      	PUSH	DX
  1184 000007D7 BB[3A20]                	MOV	BX,LENID
  1185 000007DA 8A0F                    	MOV	CL,[BX]
  1186 000007DC FEC1                    	INC	CL
  1187 000007DE B500                    	MOV	CH,0
  1188 000007E0 FC                      	CLD
  1189 000007E1 89DE                    	MOV	SI,BX
  1190 000007E3 89D7                    	MOV	DI,DX
  1191 000007E5 F3                      	REP
  1192 000007E6 A4                      	MOVSB			;Move identifier and length into node
  1193 000007E7 89FA                    	MOV	DX,DI
  1194 000007E9 89F3                    	MOV	BX,SI
  1195 000007EB B504                    	MOV	CH,4
  1196 000007ED 87DA                    	XCHG	DX,BX
  1197                                  NILIFY:				;ZERO 4 bytes of left/right links and defined flag
  1198 000007EF 880F                    	MOV	[BX],CL		;Zero left and right links
  1199 000007F1 43                      	INC	BX
  1200 000007F2 FECD                    	DEC	CH
  1201 000007F4 75F9                    	JNZ	NILIFY
  1202 000007F6 30C0                    	XOR	AL,AL		;Set zero flag
  1203 000007F8 8807                    	MOV	[BX],AL		;Zero defined flag
  1204 000007FA 5A                      	POP	DX		;Restore pointer to node
  1205 000007FB C3                      	RET
  1206                                  
  1207                                  CPSLP:	;DX=SOURCE, CH=LENGTH
  1208 000007FC 89D6                    	MOV	SI,DX
  1209 000007FE AC                      	LODSB
  1210 000007FF 3A07                    	CMP	AL,[BX]
  1211 00000801 9F                      	LAHF
  1212 00000802 42                      	INC	DX
  1213 00000803 43                      	INC	BX
  1214 00000804 9E                      	SAHF
  1215 00000805 7505                    	JNZ	CPSLP_RET
  1216 00000807 FECD                    	DEC	CH
  1217 00000809 75F1                    	JNZ	CPSLP
  1218 0000080B C3                      	RET
  1219                                  CPSLP_RET:
  1220 0000080C C3                      	RET
  1221                                  GETLAB:
  1222 0000080D BB0000                  	MOV	BX,0
  1223 00000810 891E[2A20]              	MOV	[LABPT],BX
  1224 00000814 C606[2C20]FF            	MOV	BYTE [FLAG],-1
  1225 00000819 B600                    	MOV	DH,0
  1226 0000081B A0[8B20]                	MOV	AL,[CHR]
  1227 0000081E 3C21                    	CMP	AL,' '+1
  1228 00000820 7203                    	JC	NOT1
  1229 00000822 80CE01                  	OR	DH,001H
  1230                                  NOT1:
  1231 00000825 E895FD                  	CALL	GETLET
  1232 00000828 72E2                    	JC	CPSLP_RET
  1233 0000082A 3C3A                    	CMP	AL,':'
  1234 0000082C 7505                    	JNZ	LABCHK
  1235 0000082E E885F9                  	CALL	NEXTCHR
  1236 00000831 EB07                    	JMP	LABEL
  1237                                  LABCHK:
  1238 00000833 08C0                    	OR	AL,AL
  1239 00000835 F6C601                  	TEST	DH,001H
  1240 00000838 74D2                    	JZ	CPSLP_RET
  1241                                  LABEL:
  1242 0000083A A0[A720]                	MOV	AL,[CHKLAB]	;ALL LABELS COUNT
  1243 0000083D 08C0                    	OR	AL,AL
  1244 0000083F 7403                    	JZ	$+5
  1245 00000841 E979FD                  	JMP	GETLET
  1246 00000844 E83AFF                  	CALL	LOOKUP
  1247 00000847 B10B                    	MOV	CL,11
  1248 00000849 7511                    	JNZ	ERR5
  1249 0000084B 8B16[2620]              	MOV	DX,[PC]
  1250 0000084F C60701                  	MOV	BYTE [BX],1	;SET DEFINED FLAG
  1251 00000852 43                      	INC	BX		;POINT TO VALUE FIELD
  1252 00000853 8917                    	MOV	[BX],DX ;SET VALUE
  1253 00000855 891E[2A20]              	MOV	[LABPT],BX ;POINT TO DATA FIELD
  1254 00000859 E961FD                  	JMP	GETLET
  1255                                  
  1256 0000085C E953F9                  ERR5:	JMP	ERROR
  1257                                  
  1258                                  ASMLIN:
  1259 0000085F C606[2D20]01            	MOV	BYTE [MAXFLG],1	;Allow only B and W flags normally
  1260 00000864 8B1E[2620]              	MOV	BX,[PC]
  1261 00000868 891E[2820]              	MOV	[OLDPC],BX
  1262 0000086C E89EFF                  	CALL	GETLAB
  1263 0000086F 7303                    	JNC	$+5
  1264 00000871 E9DCF8                  	JMP	ENDLN
  1265 00000874 BB[3A20]                	MOV	BX,LENID
  1266 00000877 8A07                    	MOV	AL,[BX]	;AL=length of label
  1267 00000879 B10C                    	MOV	CL,12
  1268 0000087B 2C02                    	SUB	AL,2	;At least 2 chars for opcode
  1269 0000087D 88C5                    	MOV	CH,AL	;CH=length of opcode
  1270 0000087F 72DB                    	JC	ERR5
  1271 00000881 43                      	INC	BX
  1272 00000882 803F66                  	CMP	BYTE [BX],"f"	;See if an 8087 mnemonic
  1273 00000885 744C                    	JZ	NDPOP
  1274 00000887 3C05                    	CMP	AL,5
  1275 00000889 73D1                    	JNC	ERR5
  1276 0000088B 8A07                    	MOV	AL,[BX]
  1277 0000088D 2C61                    	SUB	AL,'a'
  1278 0000088F 88C1                    	MOV	CL,AL
  1279 00000891 00C0                    	ADD	AL,AL
  1280 00000893 00C0                    	ADD	AL,AL
  1281 00000895 00C8                    	ADD	AL,CL
  1282 00000897 00E8                    	ADD	AL,CH
  1283 00000899 00C0                    	ADD	AL,AL
  1284 0000089B BB[011A]                	MOV	BX,OPTAB ;Base of opcode table
  1285 0000089E 88C2                    	MOV	DL,AL
  1286 000008A0 B600                    	MOV	DH,0
  1287 000008A2 01D3                    	ADD	BX,DX	;Point to opcode info
  1288 000008A4 8B1F                    	MOV	BX,[BX] ;BX points to start of opcode info
  1289 000008A6 FEC5                    	INC	CH		;length of opcode + 1
  1290 000008A8 88E9                    	MOV	CL,CH	;CL=CH
  1291 000008AA 8A27                    	MOV	AH,[BX] ;AH=COuNT OF OPERANDS
  1292 000008AC 43                      	INC	BX		;Point to first opcode entry
  1293 000008AD 08E4                    	OR	AH,AH	;Test if any opcodes with this length
  1294 000008AF 7418                    	JZ	OPERR
  1295                                  FINDOP:
  1296 000008B1 88CD                    	MOV	CH,CL	;CH=CL
  1297 000008B3 BA[3C20]                	MOV	DX,IDTEXT+1
  1298 000008B6 95                      	XCHG	AX,BP		;Save count of opcodes in BP
  1299 000008B7 E842FF                  	CALL	CPSLP		;DX=SOURCE, CH=LENGTH 
  1300 000008BA 7412                    	JZ	HAVOP
  1301 000008BC 95                      	XCHG	AX,BP
  1302 000008BD B600                    	MOV	DH,0
  1303 000008BF 88EA                    	MOV	DL,CH
  1304 000008C1 42                      	INC	DX
  1305 000008C2 42                      	INC	DX
  1306 000008C3 01D3                    	ADD	BX,DX			;Point to next opcode entry
  1307 000008C5 FECC                    	DEC	AH
  1308 000008C7 75E8                    	JNZ	FINDOP
  1309                                  OPERR:
  1310 000008C9 B10C                    	MOV	CL,12
  1311 000008CB E9E4F8                  	JMP	ERROR
  1312                                  
  1313                                  HAVOP:
  1314 000008CE 8A4702                  	MOV	AL,[BX+2]	;Get opcode
  1315 000008D1 FF27                    	JMP	[BX]		;Jump to opcode handler
  1316                                  
  1317                                  NDPOP:	;First letter is "F" so must be 8087 opcode ("Numeric Data Processor")
  1318 000008D3 C606[2D20]04            	MOV	BYTE [MAXFLG],4	;Allow all type flags
  1319 000008D8 43                      	INC	BX
  1320 000008D9 803F6E                  	CMP	BYTE [BX],"n"	;"No-wait" form?
  1321 000008DC B400                    	MOV	AH,0
  1322 000008DE 7505                    	JNZ	SAVNFLG
  1323 000008E0 B401                    	MOV	AH,1
  1324 000008E2 FEC8                    	DEC	AL
  1325 000008E4 43                      	INC	BX		;Skip over the "N"
  1326                                  SAVNFLG:
  1327 000008E5 8826[B120]              	MOV	[NOWAIT],AH	;0 for wait, 1 for no wait
  1328 000008E9 3C01                    	CMP	AL,1
  1329 000008EB 72DC                    	JB	OPERR		;Not enough char left for valid opcode?
  1330 000008ED 3C05                    	CMP	AL,5
  1331 000008EF 77D8                    	JA	OPERR		;Too many?
  1332 000008F1 98                      	CBW
  1333 000008F2 92                      	XCHG	AX,DX		;Save length in DX
  1334 000008F3 89D6                    	MOV	SI,DX
  1335 000008F5 800880                  	OR	BYTE [SI+BX],80H	;Set high bit of last character
  1336 000008F8 8A07                    	MOV	AL,[BX]		;Get first char of opcode
  1337 000008FA 43                      	INC	BX
  1338 000008FB 2C61                    	SUB	AL,"a"
  1339 000008FD 7228                    	JB	TRY2XM1		;Go see if opcode starts with "2"
  1340 000008FF 3C19                    	CMP	AL,"z"-"a"
  1341 00000901 77C6                    	JA	OPERR
  1342 00000903 98                      	CBW
  1343 00000904 D1E0                    	SHL	AX,1		;Double to index into address table
  1344 00000906 96                      	XCHG	AX,SI		;Put in index register
  1345 00000907 8BBC[051B]              	MOV	DI,[SI+NDPTAB]	;Get start of opcode table for this letter
  1346                                  LOOKNDP:
  1347 0000090B 8A25                    	MOV	AH,[DI]		;Number of opcodes starting with this letter
  1348 0000090D 08E4                    	OR	AH,AH
  1349 0000090F 74B8                    	JZ	OPERR		;Any start with this letter?
  1350                                  FNDNDP:
  1351 00000911 47                      	INC	DI
  1352 00000912 89DE                    	MOV	SI,BX		;Pointer to start of opcode
  1353 00000914 89D1                    	MOV	CX,DX		;Get length of opcode
  1354 00000916 F3                      	REPE
  1355 00000917 A6                      	CMPSB			;Compare opcode to table entry
  1356 00000918 7438                    	JZ	HAVNDP
  1357 0000091A 4F                      	DEC	DI		;Back up in case that was last letter
  1358 0000091B B080                    	MOV	AL,80H		;Look for char with high bit set
  1359                                  ENDOP:
  1360 0000091D AE                      	SCASB
  1361 0000091E 77FD                    	JA	ENDOP
  1362 00000920 47                      	INC	DI		;Skip over info about opcode
  1363 00000921 FECC                    	DEC	AH
  1364 00000923 75EC                    	JNZ	FNDNDP
  1365 00000925 EBA2                    OPERRJ:	JMP	OPERR
  1366                                  
  1367                                  TRY2XM1:
  1368 00000927 3CD1                    	CMP	AL,"2"-"a"
  1369 00000929 759E                    	JNZ	OPERR
  1370 0000092B BF[8F18]                	MOV	DI,XM1
  1371 0000092E EBDB                    	JMP	LOOKNDP
  1372                                  
  1373                                  SPECIALOP:
  1374 00000930 2407                    	AND	AL,7		;Mask to special op number
  1375 00000932 7416                    	JZ	FWAIT		;If zero, go handle FWAIT
  1376                                  ;Handle FNOP
  1377 00000934 803E[B120]00            	CMP	BYTE [NOWAIT],0	;Was "N" present (If not opcode was "FOP")
  1378 00000939 748E                    	JZ	OPERR
  1379 0000093B B09B                    	MOV	AL,9BH		;Need Wait opcode after all
  1380 0000093D E86701                  	CALL	PUT
  1381 00000940 B0D9                    	MOV	AL,0D9H
  1382 00000942 E86201                  	CALL	PUT
  1383 00000945 B0D0                    	MOV	AL,0D0H
  1384 00000947 E95D01                  	JMP	PUT
  1385                                  
  1386                                  FWAIT:
  1387 0000094A 803E[B120]00            	CMP	BYTE [NOWAIT],0	;"FNWAIT" not legal
  1388 0000094F 75D4                    	JNZ	OPERRJ
  1389 00000951 C3                      	RET			;Nothing to do - "WAIT" already sent
  1390                                  
  1391                                  HAVNDP:
  1392 00000952 89FE                    	MOV	SI,DI
  1393 00000954 803E[B120]00            	CMP	BYTE [NOWAIT],0
  1394 00000959 7505                    	JNZ	NWAIT
  1395 0000095B B09B                    	MOV	AL,9BH		;Wait opcode
  1396 0000095D E84701                  	CALL	PUT
  1397                                  NWAIT:
  1398 00000960 AD                      	LODSW			;Get opcode info
  1399 00000961 A8F8                    	TEST	AL,0F8H		;Any operand bits set?
  1400 00000963 7466                    	JZ	NOOPS		;If no operands, output code
  1401 00000965 A878                    	TEST	AL,78H		;Special case?
  1402 00000967 74C7                    	JZ	SPECIALOP
  1403 00000969 50                      	PUSH	AX
  1404 0000096A E899FB                  	CALL	GETSYM		;See if any operands
  1405 0000096D 59                      	POP	CX
  1406 0000096E 3C3B                    	CMP	AL,";"
  1407 00000970 7452                    	JZ	NOOPCHK
  1408 00000972 3C0D                    	CMP	AL,EOL
  1409 00000974 744E                    	JZ	NOOPCHK
  1410 00000976 3C06                    	CMP	AL,FREG		;Is it 8087 register?
  1411 00000978 756F                    	JNZ	MEMOP
  1412 0000097A 91                      	XCHG	AX,CX
  1413 0000097B A840                    	TEST	AL,ONEREG	;One register OK as operand?
  1414 0000097D 7536                    	JNZ	PUTREG		;Yes - save it
  1415 0000097F A820                    	TEST	AL,20H		;Memory-only operation?
  1416 00000981 B114                    	MOV	CL,20
  1417 00000983 7561                    	JNZ	ERRJ4
  1418 00000985 A818                    	TEST	AL,18H		;Two-register operation?
  1419 00000987 7A5D                    	JPE	ERRJ4		;Must be exactly one bit set
  1420 00000989 52                      	PUSH	DX		;Save register number
  1421 0000098A 50                      	PUSH	AX		;Save opcode
  1422 0000098B E878FB                  	CALL	GETSYM
  1423 0000098E 3C2C                    	CMP	AL,","
  1424 00000990 B115                    	MOV	CL,15H
  1425 00000992 7552                    	JNZ	ERRJ4
  1426 00000994 E86FFB                  	CALL	GETSYM
  1427 00000997 B114                    	MOV	CL,20
  1428 00000999 3C06                    	CMP	AL,FREG
  1429 0000099B 7549                    	JNZ	ERRJ4
  1430 0000099D 58                      	POP	AX
  1431 0000099E 5B                      	POP	BX
  1432 0000099F 3402                    	XOR	AL,2		;Flip "POP" bit
  1433 000009A1 24FB                    	AND	AL,0FBH		;Reset direction bit to ST(0)
  1434 000009A3 08DB                    	OR	BL,BL		;Is first register ST(0)?
  1435 000009A5 740A                    	JZ	ST0DEST
  1436 000009A7 87DA                    	XCHG	DX,BX
  1437 000009A9 08DB                    	OR	BL,BL		;One of these must be ST(0)
  1438 000009AB 7539                    	JNZ	ERRJ4
  1439 000009AD 3404                    	XOR	AL,4		;Flip direction
  1440 000009AF EB04                    	JMP 	PUTREG
  1441                                  ST0DEST:
  1442 000009B1 A802                    	TEST	AL,2		;Is POP bit set?
  1443 000009B3 7531                    	JNZ	ERRJ4		;Don't allow destination ST(0) then pop
  1444                                  PUTREG:
  1445 000009B5 80E4F8                  	AND	AH,0F8H		;Zero out register field
  1446 000009B8 08D4                    	OR	AH,DL
  1447 000009BA 80CCC0                  	OR	AH,0C0H
  1448 000009BD 50                      	PUSH	AX
  1449 000009BE E845FB                  	CALL	GETSYM		;Get to next symbol
  1450 000009C1 58                      	POP	AX
  1451 000009C2 EB07                    	JMP 	NOOPS
  1452                                  
  1453                                  NOOPCHK:
  1454 000009C4 91                      	XCHG	AX,CX
  1455 000009C5 A880                    	TEST	AL,80H		;Is no operands OK?
  1456 000009C7 B114                    	MOV	CL,20
  1457 000009C9 751B                    	JNZ	ERRJ4
  1458                                  NOOPS:
  1459                                  ;First test for FDIV or FSUB and reverse "R" bit if "D" bit is set
  1460 000009CB 50                      	PUSH	AX
  1461 000009CC 2505E0                  	AND	AX,0E005H
  1462 000009CF 3D04E0                  	CMP	AX,0E004H
  1463 000009D2 58                      	POP	AX
  1464 000009D3 7503                    	JNZ	NOREV
  1465 000009D5 80F408                  	XOR	AH,8		;Reverse "R" bit
  1466                                  NOREV:
  1467 000009D8 2407                    	AND	AL,7
  1468 000009DA 0CD8                    	OR	AL,0D8H		;ESC hook
  1469 000009DC E8C800                  	CALL	PUT
  1470 000009DF 88E0                    	MOV	AL,AH
  1471 000009E1 E9C300                  	JMP	PUT
  1472                                  
  1473                                  BADFLAG:
  1474 000009E4 B120                    	MOV	CL,20H
  1475 000009E6 E9C9F7                  ERRJ4:	JMP	ERROR
  1476                                  
  1477                                  MEMOP:
  1478 000009E9 51                      	PUSH	CX		;Save opcode
  1479 000009EA E8DFF8                  	CALL	GETOP1		;Get memory operand
  1480 000009ED 3C00                    	CMP	AL,UNDEFID	;Is it?
  1481 000009EF B114                    	MOV	CL,20
  1482 000009F1 75F3                    	JNZ	ERRJ4
  1483 000009F3 58                      	POP	AX
  1484 000009F4 A820                    	TEST	AL,20H		;Does it have memory format field?
  1485 000009F6 7508                    	JNZ	GETFORMAT
  1486 000009F8 A808                    	TEST	AL,8		;Check if any memory operand legal
  1487 000009FA 74EA                    	JZ	ERRJ4
  1488 000009FC A810                    	TEST	AL,10H		;Check for 2-op arithmetic
  1489 000009FE 751E                    	JNZ	PUTMEM		;If not, just use as plain memory op
  1490                                  GETFORMAT:
  1491 00000A00 24F9                    	AND	AL,0F9H		;Zero memory format bits
  1492 00000A02 8A0E[2C20]              	MOV	CL,[FLAG]
  1493 00000A06 FEC9                    	DEC	CL		;Must now be in range 0-3
  1494 00000A08 7CDA                    	JL	BADFLAG
  1495 00000A0A 88C5                    	MOV	CH,AL		;Save opcode byte
  1496 00000A0C D0E8                    	SHR	AL,1		;Put format bits in bits 2 & 3
  1497 00000A0E 240C                    	AND	AL,0CH
  1498 00000A10 08C8                    	OR	AL,CL		;Combine format bits with flag
  1499 00000A12 BB[2E0A]                	MOV	BX,FORMATTAB
  1500 00000A15 D7                      	XLAT
  1501 00000A16 08C0                    	OR	AL,AL		;Valid combination?
  1502 00000A18 78CA                    	JS	BADFLAG
  1503 00000A1A 08C4                    	OR	AH,AL		;Possibly set new bits in second byte
  1504 00000A1C 08E8                    	OR	AL,CH		;Set memory format bits
  1505                                  PUTMEM:
  1506 00000A1E 2407                    	AND	AL,7
  1507 00000A20 0CD8                    	OR	AL,0D8H
  1508 00000A22 E88200                  	CALL	PUT
  1509 00000A25 88E0                    	MOV	AL,AH
  1510 00000A27 2438                    	AND	AL,38H
  1511 00000A29 08D0                    	OR	AL,DL		;Combine addressing mode
  1512 00000A2B E93A01                  	JMP	PUTADD
  1513                                  
  1514                                  FORMATTAB:
  1515                                  ;There are 16 entries in this table. The 4-bit index is built like this:
  1516                                  ;	Bit 3		0 for normal memory ops, 1 if extended is OK
  1517                                  ;	Bit 2		0 for integer, 1 for real
  1518                                  ;	Bit 0 & 1	Flag: 00=W, 01=S, 10=L, 11=T
  1519                                  ;
  1520                                  ;The entries in the table are used as two 3-bit fields. Bits 0-2 are ORed
  1521                                  ;into the first byte of the opcode for the Memory Format field. Bits 3-6
  1522                                  ;are ORed into the second byte to modify the opcode for extended operands.
  1523                                  ;If bit 7 is set, then that combination is illegal.
  1524                                  
  1525 00000A2E 06028080                	DB	6,2,80H,80H	;Normal integers
  1526 00000A32 80000480                	DB	80H,0,4,80H	;Normal reals
  1527 00000A36 06022E80                	DB	6,2,2EH,80H	;Extended integers
  1528 00000A3A 8000042B                	DB	80H,0,4,2BH	;Extended reals
  1529                                  
  1530                                  GRP1:
  1531 00000A3E B9098A                  	MOV	CX,8A09H
  1532 00000A41 E8A9F7                  	CALL	MROPS
  1533 00000A44 B9C600                  	MOV	CX,0C6H
  1534 00000A47 88F8                    	MOV	AL,BH
  1535 00000A49 3C00                    	CMP	AL,UNDEFID
  1536 00000A4B 7503                    	JNZ	L0006
  1537 00000A4D E83B00                  	CALL	STIMM
  1538                                  L0006:	
  1539 00000A50 2401                    	AND	AL,1
  1540 00000A52 740A                    	JZ	BYTIMM
  1541 00000A54 B0B8                    	MOV	AL,0B8H
  1542 00000A56 08D8                    	OR	AL,BL
  1543 00000A58 E84C00                  	CALL	PUT
  1544 00000A5B E99900                  	JMP	PUTWOR
  1545                                  
  1546                                  BYTIMM:
  1547 00000A5E B0B0                    	MOV	AL,0B0H
  1548 00000A60 08D8                    	OR	AL,BL
  1549 00000A62 E84200                  	CALL	PUT
  1550 00000A65 E99600                  PUTBJ:	JMP	PUTBYT
  1551                                  
  1552                                  IMMED:
  1553 00000A68 88F8                    	MOV	AL,BH
  1554 00000A6A 3C00                    	CMP	AL,UNDEFID
  1555 00000A6C 741D                    	JZ	STIMM
  1556 00000A6E 88D8                    	MOV	AL,BL
  1557 00000A70 08C0                    	OR	AL,AL
  1558 00000A72 7432                    	JZ	IMMED_RET
  1559 00000A74 88F8                    	MOV	AL,BH
  1560 00000A76 E81D00                  	CALL	IMM
  1561 00000A79 0CC0                    	OR	AL,0C0H
  1562 00000A7B E82900                  	CALL	PUT
  1563                                  FINIMM:
  1564 00000A7E 88C8                    	MOV	AL,CL
  1565 00000A80 59                      	POP	CX
  1566 00000A81 A801                    	TEST	AL,1
  1567 00000A83 74E0                    	JZ	PUTBJ
  1568 00000A85 3C83                    	CMP	AL,83H
  1569 00000A87 74DC                    	JZ	PUTBJ
  1570 00000A89 EB6C                    	JMP	PUTWOR
  1571                                  
  1572                                  STIMM:
  1573 00000A8B A0[2C20]                	MOV	AL,[FLAG]
  1574 00000A8E E80500                  	CALL	IMM
  1575 00000A91 E8D400                  	CALL	PUTADD
  1576 00000A94 EBE8                    	JMP	FINIMM
  1577                                  
  1578                                  IMM:
  1579 00000A96 2401                    	AND	AL,1
  1580 00000A98 08C8                    	OR	AL,CL
  1581 00000A9A 88C1                    	MOV	CL,AL
  1582 00000A9C E80800                  	CALL	PUT
  1583 00000A9F 88E8                    	MOV	AL,CH
  1584 00000AA1 2438                    	AND	AL,38H
  1585 00000AA3 08D8                    	OR	AL,BL
  1586 00000AA5 C3                      	RET
  1587                                  IMMED_RET:
  1588 00000AA6 C3                      	RET
  1589                                  
  1590                                  PUT:
  1591                                  ;Save byte in AL as pure code, with intermediate code bits 00. AL and
  1592                                  ;DI destroyed, no other registers affected.
  1593 00000AA7 53                      	PUSH	BX
  1594 00000AA8 51                      	PUSH	CX
  1595 00000AA9 B500                    	MOV	CH,0		;Flag as pure code
  1596 00000AAB E80300                  	CALL	GEN
  1597 00000AAE 59                      	POP	CX
  1598 00000AAF 5B                      	POP	BX
  1599 00000AB0 C3                      	RET
  1600                                  
  1601                                  GEN:
  1602                                  ;Save byte of code in AL, given intermediate code bits in bits 7&8 of CH.
  1603 00000AB1 E83500                  	CALL	PUTINC		;Save it and bump code pointer
  1604                                  GEN1:
  1605 00000AB4 A0[9620]                	MOV	AL,[RELOC]
  1606 00000AB7 D0D5                    	RCL	CH,1
  1607 00000AB9 D0D0                    	RCL	AL,1
  1608 00000ABB D0D5                    	RCL	CH,1
  1609 00000ABD D0D0                    	RCL	AL,1
  1610 00000ABF A2[9620]                	MOV	[RELOC],AL
  1611 00000AC2 BB[9720]                	MOV	BX,BCOUNT
  1612 00000AC5 FE0F                    	DEC	BYTE [BX]
  1613 00000AC7 751F                    	JNZ	GEN1_RET
  1614 00000AC9 C60704                  	MOV	BYTE [BX],4
  1615 00000ACC BB[9620]                	MOV	BX,RELOC
  1616 00000ACF 8A07                    	MOV	AL,[BX]
  1617 00000AD1 C60700                  	MOV	BYTE [BX],0
  1618 00000AD4 8B3E[B420]              	MOV	DI,[IY]
  1619 00000AD8 8805                    	MOV	[DI],AL
  1620 00000ADA 8B1E[9320]              	MOV	BX,[CODE]
  1621 00000ADE 891E[B420]              	MOV	[IY],BX
  1622 00000AE2 43                      	INC	BX
  1623 00000AE3 891E[9320]              	MOV	[CODE],BX
  1624 00000AE7 C3                      	RET
  1625                                  GEN1_RET:
  1626 00000AE8 C3                      	RET
  1627                                  PUTINC:
  1628 00000AE9 FF06[2620]              	INC	WORD[PC]
  1629                                  PUTCD:
  1630 00000AED 8B3E[9320]              	MOV	DI,[CODE]
  1631 00000AF1 AA                      	STOSB
  1632 00000AF2 893E[9320]              	MOV	[CODE],DI
  1633 00000AF6 C3                      	RET
  1634                                  
  1635                                  PUTWOR:
  1636                                  ;Save the word value described by [DLABEL] and [DATA] as code. If defined,
  1637                                  ;two bytes of pure code will be produced. Otherwise, appropriate intermediate
  1638                                  ;code will be generated.
  1639 00000AF7 51                      	PUSH	CX
  1640 00000AF8 B580                    	MOV	CH,80H
  1641 00000AFA 52                      	PUSH	DX
  1642 00000AFB 53                      	PUSH	BX
  1643 00000AFC EB20                    	JMP	PUTBW
  1644                                  
  1645                                  PUTBYT:
  1646                                  ;Same as PUTWOR, above, but for byte value.
  1647 00000AFE 51                      	PUSH	CX
  1648 00000AFF B540                    	MOV	CH,40H
  1649 00000B01 52                      	PUSH	DX
  1650 00000B02 53                      	PUSH	BX
  1651 00000B03 8B1E[3420]              	MOV	BX,[DLABEL]
  1652 00000B07 88F8                    	MOV	AL,BH
  1653 00000B09 08D8                    	OR	AL,BL
  1654 00000B0B 7511                    	JNZ	PUTBW
  1655 00000B0D 8B1E[3220]              	MOV	BX,[DATA]
  1656 00000B11 08F8                    	OR	AL,BH
  1657 00000B13 7409                    	JZ	PUTBW
  1658 00000B15 FEC7                    	INC	BH
  1659 00000B17 7405                    	JZ	PUTBW
  1660 00000B19 B11F                    	MOV	CL,31
  1661 00000B1B E994F6                  	JMP	ERROR
  1662                                  PUTBW:
  1663 00000B1E 8B16[3420]              	MOV	DX,[DLABEL]
  1664 00000B22 8B1E[3220]              	MOV	BX,[DATA]
  1665                                  PUTCHK:
  1666 00000B26 09D2                    	OR	DX,DX
  1667 00000B28 7425                    	JZ	NOUNDEF
  1668 00000B2A 88D0                    	MOV	AL,DL
  1669 00000B2C E8BEFF                  	CALL	PUTCD
  1670 00000B2F 88F0                    	MOV	AL,DH
  1671 00000B31 E8B9FF                  	CALL	PUTCD
  1672 00000B34 88D8                    	MOV	AL,BL
  1673 00000B36 E8B0FF                  	CALL	PUTINC
  1674 00000B39 88F8                    	MOV	AL,BH
  1675 00000B3B F6C580                  	TEST	CH,080H
  1676 00000B3E 7405                    	JZ	SMPUT
  1677 00000B40 E86EFF                  	CALL	GEN
  1678 00000B43 EB06                    	JMP	PRET
  1679                                  SMPUT:
  1680 00000B45 E8A5FF                  	CALL	PUTCD
  1681 00000B48 E869FF                  	CALL	GEN1
  1682                                  PRET:
  1683 00000B4B 5B                      	POP	BX
  1684 00000B4C 5A                      	POP	DX
  1685 00000B4D 59                      	POP	CX
  1686 00000B4E C3                      	RET
  1687                                  
  1688                                  NOUNDEF:
  1689 00000B4F 88D8                    	MOV	AL,BL
  1690 00000B51 88F9                    	MOV	CL,BH
  1691 00000B53 51                      	PUSH	CX
  1692 00000B54 B500                    	MOV	CH,0
  1693 00000B56 E858FF                  	CALL	GEN
  1694 00000B59 59                      	POP	CX
  1695 00000B5A 88C8                    	MOV	AL,CL
  1696 00000B5C F6C580                  	TEST	CH,080H
  1697 00000B5F B500                    	MOV	CH,0
  1698 00000B61 74E8                    	JZ	PRET
  1699 00000B63 E84BFF                  	CALL	GEN
  1700 00000B66 EBE3                    	JMP	PRET
  1701                                  
  1702                                  PUTADD:
  1703                                  ;Save complete addressing mode. Addressing mode is in AL; if this is a register
  1704                                  ;operation (>=C0), then the one byte will be saved as pure code. Otherwise,
  1705                                  ;the details of the addressing mode will be investigated and the optional one-
  1706                                  ;or two-byte displacement will be added, as described by [ADDR] and [ALABEL].
  1707 00000B68 51                      	PUSH	CX
  1708 00000B69 52                      	PUSH	DX
  1709 00000B6A 53                      	PUSH	BX
  1710 00000B6B B500                    	MOV	CH,0
  1711 00000B6D 88C1                    	MOV	CL,AL
  1712 00000B6F E83FFF                  	CALL	GEN		;Save the addressing mode as pure code
  1713 00000B72 88C8                    	MOV	AL,CL
  1714 00000B74 B580                    	MOV	CH,80H
  1715 00000B76 24C7                    	AND	AL,0C7H
  1716 00000B78 3C06                    	CMP	AL,6
  1717 00000B7A 740A                    	JZ	TWOBT		;Direct address?
  1718 00000B7C 24C0                    	AND	AL,0C0H
  1719 00000B7E 74CB                    	JZ	PRET		;Indirect through reg, no displacement?
  1720 00000B80 3CC0                    	CMP	AL,0C0H
  1721 00000B82 74C7                    	JZ	PRET		;Register to register operation?
  1722 00000B84 88C5                    	MOV	CH,AL		;Save whether one- or two-byte displacement
  1723                                  TWOBT:
  1724 00000B86 8B1E[2E20]              	MOV	BX,[ADDR]
  1725 00000B8A 8B16[3020]              	MOV	DX,[ALABEL]
  1726 00000B8E EB96                    	JMP	PUTCHK
  1727                                  
  1728                                  GRP2:
  1729 00000B90 E836F7                  	CALL	GETOP
  1730 00000B93 B930FF                  	MOV	CX,0FF30H
  1731 00000B96 3C00                    	CMP	AL,UNDEFID
  1732 00000B98 7414                    	JZ	PMEM
  1733 00000B9A B550                    	MOV	CH,50H
  1734 00000B9C 3C03                    	CMP	AL,XREG
  1735 00000B9E 7419                    	JZ	PXREG
  1736 00000BA0 B506                    	MOV	CH,6
  1737 00000BA2 3C04                    	CMP	AL,SREG
  1738 00000BA4 7503                    	JNZ	$+5
  1739 00000BA6 E90204                  	JMP	PACKREG
  1740 00000BA9 B114                    	MOV	CL,20
  1741 00000BAB E904F6                  	JMP	ERROR
  1742                                  
  1743                                  PMEM:
  1744 00000BAE 88E8                    	MOV	AL,CH
  1745 00000BB0 E8F4FE                  	CALL	PUT
  1746 00000BB3 88C8                    	MOV	AL,CL
  1747 00000BB5 08D0                    	OR	AL,DL
  1748 00000BB7 EBAF                    	JMP	PUTADD
  1749                                  
  1750                                  PXREG:
  1751 00000BB9 88E8                    	MOV	AL,CH
  1752 00000BBB 08D0                    	OR	AL,DL
  1753 00000BBD E9E7FE                  	JMP	PUT
  1754                                  
  1755                                  GRP3:
  1756 00000BC0 E806F7                  	CALL	GETOP
  1757 00000BC3 52                      	PUSH	DX
  1758 00000BC4 E8F9F6                  	CALL	GETOP2
  1759 00000BC7 5B                      	POP	BX
  1760 00000BC8 B91486                  	MOV	CX,8614H
  1761 00000BCB B004                    	MOV	AL,SREG
  1762 00000BCD 38F8                    	CMP	AL,BH
  1763 00000BCF 744C                    	JZ	ERR6
  1764 00000BD1 38F0                    	CMP	AL,DH
  1765 00000BD3 7448                    	JZ	ERR6
  1766 00000BD5 B001                    	MOV	AL,CONST
  1767 00000BD7 38F8                    	CMP	AL,BH
  1768 00000BD9 7442                    	JZ	ERR6
  1769 00000BDB 38F0                    	CMP	AL,DH
  1770 00000BDD 743E                    	JZ	ERR6
  1771 00000BDF B000                    	MOV	AL,UNDEFID
  1772 00000BE1 38F8                    	CMP	AL,BH
  1773 00000BE3 742D                    	JZ	EXMEM
  1774 00000BE5 38F0                    	CMP	AL,DH
  1775 00000BE7 742B                    	JZ	EXMEM1
  1776 00000BE9 88F8                    	MOV	AL,BH
  1777 00000BEB 38F0                    	CMP	AL,DH
  1778 00000BED B116                    	MOV	CL,22
  1779 00000BEF 752C                    	JNZ	ERR6
  1780 00000BF1 3C03                    	CMP	AL,XREG
  1781 00000BF3 7403                    	JZ	L0008
  1782 00000BF5 E82EF6                  	CALL	RR1
  1783                                  L0008:			;RR1 never returns
  1784 00000BF8 88D8                    	MOV	AL,BL
  1785 00000BFA 08C0                    	OR	AL,AL
  1786 00000BFC 740D                    	JZ	EXACC
  1787 00000BFE 87DA                    	XCHG	DX,BX
  1788 00000C00 88D8                    	MOV	AL,BL
  1789 00000C02 08C0                    	OR	AL,AL
  1790 00000C04 88F8                    	MOV	AL,BH
  1791 00000C06 7403                    	JZ	EXACC
  1792 00000C08 E81BF6                  	CALL	RR1
  1793                                  EXACC:
  1794 00000C0B B090                    	MOV	AL,90H
  1795 00000C0D 08D0                    	OR	AL,DL
  1796 00000C0F E995FE                  	JMP	PUT
  1797                                  
  1798                                  EXMEM:
  1799 00000C12 87DA                    	XCHG	DX,BX
  1800                                  EXMEM1:
  1801 00000C14 38F8                    	CMP	AL,BH
  1802 00000C16 7405                    	JZ	ERR6
  1803 00000C18 B101                    	MOV	CL,1	;Flag word as OK
  1804 00000C1A E883F6                  	CALL	NOTAC	;NOTAC never returns
  1805 00000C1D E992F5                  ERR6:	JMP	ERROR
  1806                                  
  1807                                  GRP4:
  1808 00000C20 50                      	PUSH	AX
  1809 00000C21 E8A5F6                  	CALL	GETOP
  1810 00000C24 59                      	POP	CX
  1811 00000C25 86E9                    	XCHG	CL,CH
  1812 00000C27 3C01                    	CMP	AL,CONST
  1813 00000C29 7413                    	JZ	FIXED
  1814 00000C2B 2C03                    	SUB	AL,XREG
  1815 00000C2D FECA                    	DEC	DL
  1816 00000C2F FECA                    	DEC	DL
  1817 00000C31 08D0                    	OR	AL,DL
  1818 00000C33 B114                    	MOV	CL,20
  1819 00000C35 75E6                    	JNZ	ERR6
  1820 00000C37 88E8                    	MOV	AL,CH
  1821 00000C39 0C08                    	OR	AL,8
  1822 00000C3B E969FE                  	JMP	PUT
  1823                                  FIXED:
  1824 00000C3E 88E8                    	MOV	AL,CH
  1825 00000C40 E864FE                  	CALL	PUT
  1826 00000C43 E9B8FE                  	JMP	PUTBYT
  1827                                  
  1828                                  GRP5:
  1829 00000C46 50                      	PUSH	AX
  1830 00000C47 E87FF6                  	CALL	GETOP
  1831 00000C4A B114                    	MOV	CL,20
  1832 00000C4C 3C01                    	CMP	AL,CONST
  1833 00000C4E 75CD                    	JNZ	ERR6
  1834 00000C50 8B1E[3420]              	MOV	BX,[DLABEL]
  1835 00000C54 88F8                    	MOV	AL,BH
  1836 00000C56 08D8                    	OR	AL,BL
  1837 00000C58 B11E                    	MOV	CL,30
  1838 00000C5A 75C1                    	JNZ	ERR6
  1839 00000C5C 8B1E[3220]              	MOV	BX,[DATA]
  1840 00000C60 58                      	POP	AX
  1841 00000C61 08C0                    	OR	AL,AL
  1842 00000C63 7444                    	JZ	_ORG
  1843 00000C65 FEC8                    	DEC	AL
  1844 00000C67 7419                    	JZ	DSJ
  1845 00000C69 FEC8                    	DEC	AL
  1846 00000C6B 7427                    	JZ	EQU
  1847 00000C6D FEC8                    	DEC	AL
  1848 00000C6F 7403                    	JZ	$+5
  1849 00000C71 E99A03                  	JMP	IF
  1850                                  PUTOP:
  1851 00000C74 B0FD                    	MOV	AL,-3
  1852 00000C76 EB37                    	JMP	NEWLOC
  1853                                  _ALIGN:
  1854 00000C78 A0[2620]                	MOV	AL,[PC]
  1855 00000C7B 2401                    	AND	AL,1
  1856 00000C7D 7429                    	JZ	_ALIGN_RET
  1857 00000C7F BB0100                  	MOV	BX,1
  1858                                  DSJ:
  1859 00000C82 87DA                    	XCHG	DX,BX
  1860 00000C84 8B1E[2620]              	MOV	BX,[PC]
  1861 00000C88 01D3                    	ADD	BX,DX
  1862 00000C8A 891E[2620]              	MOV	[PC],BX
  1863 00000C8E 87DA                    	XCHG	DX,BX
  1864 00000C90 B0FC                    	MOV	AL,-4
  1865 00000C92 EB1B                    	JMP	NEWLOC
  1866                                  EQU:
  1867 00000C94 87DA                    	XCHG	DX,BX
  1868 00000C96 8B1E[2A20]              	MOV	BX,[LABPT]
  1869 00000C9A 88F8                    	MOV	AL,BH
  1870 00000C9C 08D8                    	OR	AL,BL
  1871 00000C9E B122                    	MOV	CL,34
  1872 00000CA0 7428                    	JZ	ERR7
  1873 00000CA2 8817                    	MOV	[BX],DL
  1874 00000CA4 43                      	INC	BX
  1875 00000CA5 8837                    	MOV	[BX],DH
  1876 00000CA7 C3                      	RET
  1877                                  _ALIGN_RET:
  1878 00000CA8 C3                      	RET
  1879                                  _ORG:
  1880 00000CA9 891E[2620]              	MOV	[PC],BX
  1881 00000CAD B0FE                    	MOV	AL,-2
  1882                                  NEWLOC:
  1883 00000CAF E83BFE                  	CALL	PUTCD
  1884 00000CB2 88D8                    	MOV	AL,BL
  1885 00000CB4 E836FE                  	CALL	PUTCD
  1886 00000CB7 88F8                    	MOV	AL,BH
  1887 00000CB9 E831FE                  	CALL	PUTCD
  1888 00000CBC B5C0                    	MOV	CH,0C0H
  1889 00000CBE E9F3FD                  	JMP	GEN1
  1890                                  GRP6:
  1891 00000CC1 88C5                    	MOV	CH,AL
  1892 00000CC3 B104                    	MOV	CL,4
  1893 00000CC5 E825F5                  	CALL	MROPS
  1894 00000CC8 B117                    	MOV	CL,23
  1895 00000CCA E9E5F4                  ERR7:	JMP	ERROR
  1896                                  GRP7:
  1897 00000CCD 88C5                    	MOV	CH,AL
  1898 00000CCF B101                    	MOV	CL,1
  1899 00000CD1 E819F5                  	CALL	MROPS
  1900 00000CD4 B180                    	MOV	CL,80H
  1901 00000CD6 8B16[3420]              	MOV	DX,[DLABEL]
  1902 00000CDA 88F0                    	MOV	AL,DH
  1903 00000CDC 08D0                    	OR	AL,DL
  1904 00000CDE 7512                    	JNZ	ACCJ
  1905 00000CE0 87DA                    	XCHG	DX,BX
  1906 00000CE2 8B1E[3220]              	MOV	BX,[DATA]
  1907 00000CE6 88D8                    	MOV	AL,BL
  1908 00000CE8 98                      	CBW
  1909 00000CE9 39D8                    	CMP	AX,BX
  1910 00000CEB 87DA                    	XCHG	DX,BX
  1911 00000CED 7503                    	JNZ	ACCJ
  1912 00000CEF 80C902                  	OR	CL,002H
  1913 00000CF2 E9B700                  ACCJ:	JMP	ACCIMM
  1914                                  GRP8:
  1915 00000CF5 88C1                    	MOV	CL,AL
  1916 00000CF7 B5FE                    	MOV	CH,0FEH
  1917 00000CF9 EB04                    	JMP	ONEOP
  1918                                  GRP9:
  1919 00000CFB 88C1                    	MOV	CL,AL
  1920 00000CFD B5F6                    	MOV	CH,0F6H
  1921                                  ONEOP:
  1922 00000CFF 51                      	PUSH	CX
  1923 00000D00 E8C6F5                  	CALL	GETOP
  1924                                  ONE:
  1925 00000D03 B11A                    	MOV	CL,26
  1926 00000D05 3C01                    	CMP	AL,CONST
  1927 00000D07 74C1                    	JZ	ERR7
  1928 00000D09 3C04                    	CMP	AL,SREG
  1929 00000D0B B116                    	MOV	CL,22
  1930 00000D0D 74BB                    	JZ	ERR7
  1931 00000D0F 59                      	POP	CX
  1932 00000D10 3C00                    	CMP	AL,UNDEFID
  1933 00000D12 7412                    	JZ	MOP
  1934 00000D14 2401                    	AND	AL,1
  1935 00000D16 7421                    	JZ	ROP
  1936 00000D18 F6C101                  	TEST	CL,001H
  1937 00000D1B 741C                    	JZ	ROP
  1938 00000D1D 88C8                    	MOV	AL,CL
  1939 00000D1F 24F8                    	AND	AL,0F8H
  1940 00000D21 08D0                    	OR	AL,DL
  1941 00000D23 E981FD                  	JMP	PUT
  1942                                  MOP:
  1943 00000D26 A0[2C20]                	MOV	AL,[FLAG]
  1944 00000D29 2401                    	AND	AL,1
  1945 00000D2B 08E8                    	OR	AL,CH
  1946 00000D2D E877FD                  	CALL	PUT
  1947 00000D30 88C8                    	MOV	AL,CL
  1948 00000D32 2438                    	AND	AL,38H
  1949 00000D34 08D0                    	OR	AL,DL
  1950 00000D36 E92FFE                  	JMP	PUTADD
  1951                                  ROP:
  1952 00000D39 08E8                    	OR	AL,CH
  1953 00000D3B E869FD                  	CALL	PUT
  1954 00000D3E 88C8                    	MOV	AL,CL
  1955 00000D40 2438                    	AND	AL,38H
  1956 00000D42 0CC0                    	OR	AL,0C0H
  1957 00000D44 08D0                    	OR	AL,DL
  1958 00000D46 E95EFD                  	JMP	PUT
  1959                                  GRP10:
  1960 00000D49 88C1                    	MOV	CL,AL
  1961 00000D4B B5F6                    	MOV	CH,0F6H
  1962 00000D4D 51                      	PUSH	CX
  1963 00000D4E E878F5                  	CALL	GETOP
  1964 00000D51 B114                    	MOV	CL,20
  1965 00000D53 88D0                    	MOV	AL,DL
  1966 00000D55 08C0                    	OR	AL,AL
  1967 00000D57 7508                    	JNZ	ERRJ1
  1968 00000D59 88F0                    	MOV	AL,DH
  1969 00000D5B 3C03                    	CMP	AL,XREG
  1970 00000D5D 7404                    	JZ	G10
  1971 00000D5F 3C02                    	CMP	AL,REG
  1972 00000D61 7567                    ERRJ1:	JNZ	ERR8
  1973                                  G10:
  1974 00000D63 50                      	PUSH	AX
  1975 00000D64 E862F5                  	CALL	GETOP
  1976 00000D67 58                      	POP	AX
  1977 00000D68 2401                    	AND	AL,1
  1978 00000D6A A2[2C20]                	MOV	[FLAG],AL
  1979 00000D6D 88F0                    	MOV	AL,DH
  1980 00000D6F EB92                    ONEJ:	JMP	ONE
  1981                                  GRP11:
  1982 00000D71 E833FD                  	CALL	PUT
  1983 00000D74 B00A                    	MOV	AL,0AH
  1984 00000D76 E92EFD                  	JMP	PUT
  1985                                  GRP12:
  1986 00000D79 88C1                    	MOV	CL,AL
  1987 00000D7B B5D0                    	MOV	CH,0D0H
  1988 00000D7D 51                      	PUSH	CX
  1989 00000D7E E848F5                  	CALL	GETOP
  1990 00000D81 A0[8C20]                	MOV	AL,[SYM]
  1991 00000D84 3C2C                    	CMP	AL,','
  1992 00000D86 88F0                    	MOV	AL,DH
  1993 00000D88 75E5                    	JNZ	ONEJ
  1994 00000D8A 52                      	PUSH	DX
  1995 00000D8B E83BF5                  	CALL	GETOP
  1996 00000D8E 2C02                    	SUB	AL,REG
  1997 00000D90 B114                    	MOV	CL,20
  1998 00000D92 FECA                    	DEC	DL
  1999 00000D94 08D0                    	OR	AL,DL
  2000 00000D96 7532                    	JNZ	ERR8
  2001 00000D98 5A                      	POP	DX
  2002 00000D99 88F0                    	MOV	AL,DH
  2003 00000D9B 59                      	POP	CX
  2004 00000D9C 80CD02                  	OR	CH,002H
  2005 00000D9F 51                      	PUSH	CX
  2006 00000DA0 E960FF                  	JMP	ONE
  2007                                  GRP13:
  2008 00000DA3 88C5                    	MOV	CH,AL
  2009 00000DA5 B101                    	MOV	CL,1
  2010 00000DA7 E843F4                  	CALL	MROPS
  2011 00000DAA B180                    	MOV	CL,80H
  2012                                  ACCIMM:
  2013 00000DAC E8B9FC                  	CALL	IMMED
  2014 00000DAF 80CD04                  	OR	CH,004H
  2015 00000DB2 80E5FD                  	AND	CH,0FDH
  2016                                  AIMM:
  2017 00000DB5 88F8                    	MOV	AL,BH
  2018 00000DB7 2401                    	AND	AL,1
  2019 00000DB9 9F                      	LAHF
  2020 00000DBA 50                      	PUSH	AX
  2021 00000DBB 08E8                    	OR	AL,CH
  2022 00000DBD E8E7FC                  	CALL	PUT
  2023 00000DC0 58                      	POP	AX
  2024 00000DC1 9E                      	SAHF
  2025 00000DC2 7503                    	JNZ	$+5
  2026 00000DC4 E937FD                  	JMP	PUTBYT
  2027 00000DC7 E92DFD                  	JMP	PUTWOR
  2028                                  
  2029 00000DCA E9E5F3                  ERR8:	JMP	ERROR
  2030                                  
  2031                                  GRP14:
  2032                                  ;JMP and CALL mnemonics
  2033 00000DCD 9F                      	LAHF
  2034 00000DCE 86C4                    	XCHG	AH,AL
  2035 00000DD0 50                      	PUSH	AX
  2036 00000DD1 86C4                    	XCHG	AH,AL
  2037 00000DD3 C606[2D20]03            	MOV	BYTE [MAXFLG],3	;Allow "L" flag
  2038 00000DD8 E8EEF4                  	CALL	GETOP
  2039 00000DDB 3C01                    	CMP	AL,CONST
  2040 00000DDD 7433                    	JZ	DIRECT
  2041 00000DDF B114                    	MOV	CL,20
  2042 00000DE1 3C02                    	CMP	AL,REG
  2043 00000DE3 74E5                    	JZ	ERR8
  2044 00000DE5 3C04                    	CMP	AL,SREG
  2045 00000DE7 74E1                    	JZ	ERR8
  2046 00000DE9 3C03                    	CMP	AL,XREG
  2047 00000DEB 7503                    	JNZ	NOTRG
  2048 00000DED 80CAC0                  	OR	DL,0C0H
  2049                                  NOTRG:
  2050                                  ;Indirect jump. DL has addressing mode.
  2051 00000DF0 B0FF                    	MOV	AL,0FFH
  2052 00000DF2 E8B2FC                  	CALL	PUT
  2053 00000DF5 58                      	POP	AX
  2054 00000DF6 86C4                    	XCHG	AH,AL
  2055 00000DF8 9E                      	SAHF
  2056 00000DF9 2438                    	AND	AL,38H
  2057 00000DFB 08D0                    	OR	AL,DL
  2058 00000DFD 8A2E[2C20]              	MOV	CH,[FLAG]
  2059 00000E01 80FD03                  	CMP	CH,3		;Flag "L" present?
  2060 00000E04 7409                    	JZ	PUTADDJ		;If so, do inter-segment
  2061 00000E06 B127                    	MOV	CL,27H
  2062 00000E08 80FDFF                  	CMP	CH,-1		;Better not be a flag
  2063 00000E0B 75BD                    	JNZ	ERR8
  2064 00000E0D 24F7                    	AND	AL,0F7H		;Convert to intra-segment
  2065                                  PUTADDJ:
  2066 00000E0F E956FD                  	JMP	PUTADD
  2067                                  DIRECT:
  2068 00000E12 A0[8C20]                	MOV	AL,[SYM]
  2069 00000E15 3C2C                    	CMP	AL,','
  2070 00000E17 741C                    	JZ	LONGJ
  2071 00000E19 58                      	POP	AX
  2072 00000E1A 86C4                    	XCHG	AH,AL
  2073 00000E1C 9E                      	SAHF
  2074 00000E1D FEC8                    	DEC	AL
  2075 00000E1F 3CE9                    	CMP	AL,0E9H
  2076 00000E21 7402                    	JZ	GOTOP
  2077 00000E23 B0E8                    	MOV	AL,0E8H
  2078                                  GOTOP:
  2079 00000E25 E87FFC                  	CALL	PUT
  2080 00000E28 8B16[2620]              	MOV	DX,[PC]
  2081 00000E2C 42                      	INC	DX
  2082 00000E2D 42                      	INC	DX
  2083 00000E2E 2916[3220]              	SUB	[DATA],DX
  2084 00000E32 E9C2FC                  	JMP	PUTWOR
  2085                                  LONGJ:
  2086 00000E35 58                      	POP	AX
  2087 00000E36 86C4                    	XCHG	AH,AL
  2088 00000E38 9E                      	SAHF
  2089 00000E39 E86BFC                  	CALL	PUT
  2090 00000E3C E8B8FC                  	CALL	PUTWOR
  2091 00000E3F E887F4                  	CALL	GETOP
  2092 00000E42 B114                    	MOV	CL,20
  2093 00000E44 3C01                    	CMP	AL,CONST
  2094 00000E46 7582                    	JNZ	ERR8
  2095 00000E48 E9ACFC                  	JMP	PUTWOR
  2096                                  
  2097                                  GRP16:
  2098                                  ;RET mnemonic
  2099 00000E4B 9F                      	LAHF
  2100 00000E4C 86C4                    	XCHG	AH,AL
  2101 00000E4E 50                      	PUSH	AX
  2102 00000E4F 86C4                    	XCHG	AH,AL
  2103 00000E51 E8B2F6                  	CALL	GETSYM
  2104 00000E54 3C05                    	CMP	AL,5
  2105 00000E56 741C                    	JZ	LONGR
  2106 00000E58 3C0D                    	CMP	AL,EOL
  2107 00000E5A 743F                    	JZ	NODEC
  2108 00000E5C 3C3B                    	CMP	AL,';'
  2109 00000E5E 743B                    	JZ	NODEC
  2110                                  GETSP:
  2111 00000E60 E869F4                  	CALL	GETOP1
  2112 00000E63 59                      	POP	CX
  2113 00000E64 3C01                    	CMP	AL,CONST
  2114 00000E66 B114                    	MOV	CL,20
  2115 00000E68 7563                    	JNZ	ERR9
  2116 00000E6A 88E8                    	MOV	AL,CH
  2117 00000E6C 24FE                    	AND	AL,0FEH
  2118 00000E6E E836FC                  	CALL	PUT
  2119 00000E71 E983FC                  	JMP	PUTWOR
  2120                                  LONGR:
  2121 00000E74 80FA03                  	CMP	DL,3		;Is flag "L"?
  2122 00000E77 B127                    	MOV	CL,27H
  2123 00000E79 757D                    	JNZ	ERR10		;If not, bad flag
  2124 00000E7B 58                      	POP	AX
  2125 00000E7C 86C4                    	XCHG	AH,AL
  2126 00000E7E 9E                      	SAHF
  2127 00000E7F 0C08                    	OR	AL,8
  2128 00000E81 9F                      	LAHF
  2129 00000E82 86C4                    	XCHG	AH,AL
  2130 00000E84 50                      	PUSH	AX
  2131 00000E85 86C4                    	XCHG	AH,AL
  2132                                  NOTLON:
  2133 00000E87 E87CF6                  	CALL	GETSYM
  2134 00000E8A 3C0D                    	CMP	AL,EOL
  2135 00000E8C 742E                    	JZ	DORET
  2136 00000E8E 3C3B                    	CMP	AL,';'
  2137 00000E90 742A                    	JZ	DORET
  2138 00000E92 3C2C                    	CMP	AL,','
  2139 00000E94 7503                    	JNZ	L0011
  2140 00000E96 E86DF6                  	CALL	GETSYM
  2141                                  L0011:	
  2142 00000E99 EBC5                    	JMP	GETSP
  2143                                  NODEC:
  2144                                  ;Return is intra-segment (short) without add to SP. 
  2145                                  ;Record position for RET symbol.
  2146 00000E9B 8B1E[2620]              	MOV	BX,[PC]
  2147 00000E9F 891E[AA20]              	MOV	[LSTRET],BX
  2148 00000EA3 87DA                    	XCHG	DX,BX
  2149 00000EA5 8B1E[AC20]              	MOV	BX,[RETPT]
  2150 00000EA9 88F8                    	MOV	AL,BH
  2151 00000EAB 08D8                    	OR	AL,BL
  2152 00000EAD 740D                    	JZ	DORET
  2153 00000EAF C60701                  	MOV	BYTE [BX],1
  2154 00000EB2 43                      	INC	BX
  2155 00000EB3 8917                    	MOV	[BX],DX
  2156 00000EB5 BB0000                  	MOV	BX,0
  2157 00000EB8 891E[AC20]              	MOV	[RETPT],BX
  2158                                  DORET:
  2159 00000EBC 58                      	POP	AX
  2160 00000EBD 86C4                    	XCHG	AH,AL
  2161 00000EBF 9E                      	SAHF
  2162 00000EC0 E9E4FB                  	JMP	PUT
  2163                                  
  2164                                  GRP17:
  2165 00000EC3 E8E1FB                  	CALL	PUT
  2166 00000EC6 E800F4                  	CALL	GETOP
  2167 00000EC9 3C01                    	CMP	AL,CONST
  2168 00000ECB B114                    	MOV	CL,20
  2169 00000ECD 7529                    ERR9:	JNZ	ERR10
  2170 00000ECF 8B1E[3220]              	MOV	BX,[DATA]
  2171 00000ED3 8B16[2620]              	MOV	DX,[PC]
  2172 00000ED7 42                      	INC	DX
  2173 00000ED8 29D3                    	SUB	BX,DX
  2174 00000EDA 891E[3220]              	MOV	[DATA],BX
  2175 00000EDE E81DFC                  	CALL	PUTBYT
  2176 00000EE1 8B1E[3420]              	MOV	BX,[DLABEL]
  2177 00000EE5 88F8                    	MOV	AL,BH
  2178 00000EE7 08D8                    	OR	AL,BL
  2179 00000EE9 7511                    	JNZ	ERRX_RET
  2180 00000EEB 8B1E[3220]              	MOV	BX,[DATA]
  2181 00000EEF 88D8                    	MOV	AL,BL
  2182 00000EF1 98                      	CBW
  2183 00000EF2 39D8                    	CMP	AX,BX		;Signed 8-bit number?
  2184 00000EF4 7406                    	JZ	ERRX_RET
  2185 00000EF6 B11F                    	MOV	CL,31
  2186                                  ERR10:	
  2187 00000EF8 E9B7F2                  	JMP	ERROR
  2188 00000EFB C3                      	RET
  2189                                  ERRX_RET:
  2190 00000EFC C3                      	RET
  2191                                  GRP18:
  2192 00000EFD E8C9F3                  	CALL	GETOP
  2193 00000F00 3C01                    	CMP	AL,CONST
  2194 00000F02 B114                    	MOV	CL,20
  2195 00000F04 75F2                    	JNZ	ERR10
  2196 00000F06 8B1E[3420]              	MOV	BX,[DLABEL]
  2197 00000F0A 88F8                    	MOV	AL,BH
  2198 00000F0C 08D8                    	OR	AL,BL
  2199 00000F0E 7510                    	JNZ	GENINT
  2200 00000F10 8B1E[3220]              	MOV	BX,[DATA]
  2201 00000F14 BA0300                  	MOV	DX,3
  2202 00000F17 19D3                    	SBB	BX,DX
  2203 00000F19 7505                    	JNZ	GENINT
  2204 00000F1B B0CC                    	MOV	AL,0CCH
  2205 00000F1D E987FB                  	JMP	PUT
  2206                                  GENINT:
  2207 00000F20 B0CD                    	MOV	AL,0CDH
  2208 00000F22 E882FB                  	CALL	PUT
  2209 00000F25 E9D6FB                  	JMP	PUTBYT
  2210                                  
  2211                                  GRP19:	;ESC opcode
  2212 00000F28 E89EF3                  	CALL	GETOP
  2213 00000F2B B114                    	MOV	CL,20
  2214 00000F2D 3C01                    	CMP	AL,CONST
  2215 00000F2F 7539                    	JNZ	ERRJ		;First operand must be immediate
  2216 00000F31 B11E                    	MOV	CL,1EH
  2217 00000F33 F706[3420]FFFF          	TEST	WORD[DLABEL],-1	;See if all labels have been defined
  2218 00000F39 752F                    	JNZ	ERRJ
  2219 00000F3B A1[3220]                	MOV	AX,[DATA]
  2220 00000F3E 83F840                  	CMP	AX,64		;Must only be 6 bits
  2221 00000F41 B11F                    	MOV	CL,1FH
  2222 00000F43 7325                    	JNB	ERRJ
  2223 00000F45 88C3                    	MOV	BL,AL		;Save for second byte
  2224 00000F47 D0E8                    	SHR	AL,1
  2225 00000F49 D0E8                    	SHR	AL,1
  2226 00000F4B D0E8                    	SHR	AL,1
  2227 00000F4D 0CD8                    	OR	AL,0D8H		;ESC opcode
  2228 00000F4F E855FB                  	CALL	PUT
  2229 00000F52 53                      	PUSH	BX
  2230 00000F53 E86AF3                  	CALL	GETOP2
  2231 00000F56 5B                      	POP	BX
  2232 00000F57 80E307                  	AND	BL,7		;Low 3 bits of first operand
  2233 00000F5A D0E3                    	SHL	BL,1
  2234 00000F5C D0E3                    	SHL	BL,1
  2235 00000F5E D0E3                    	SHL	BL,1
  2236 00000F60 3C00                    	CMP	AL,UNDEFID	;Check for memory operand
  2237 00000F62 7409                    	JZ	ESCMEM
  2238 00000F64 3C01                    	CMP	AL,CONST	;Check for another immediate
  2239 00000F66 740C                    	JZ	ESCIMM
  2240 00000F68 B114                    	MOV	CL,20
  2241 00000F6A E945F2                  ERRJ:	JMP	ERROR
  2242                                  
  2243                                  ESCMEM:
  2244 00000F6D 08D3                    	OR	BL,DL		;Combine mode with first operand
  2245 00000F6F 88D8                    	MOV	AL,BL
  2246 00000F71 E9F4FB                  	JMP	PUTADD
  2247                                  
  2248                                  ESCIMM:
  2249 00000F74 B11E                    	MOV	CL,1EH
  2250 00000F76 F706[3420]FFFF          	TEST	WORD[DLABEL],-1	;See if second operand is fully defined
  2251 00000F7C 75EC                    	JNZ	ERRJ
  2252 00000F7E A1[3220]                	MOV	AX,[DATA]
  2253 00000F81 B11F                    	MOV	CL,1FH
  2254 00000F83 83F808                  	CMP	AX,8		;Must only be 3 bit value
  2255 00000F86 73E2                    	JNB	ERRJ
  2256 00000F88 08D8                    	OR	AL,BL		;Combine first and second operands
  2257 00000F8A 0CC0                    	OR	AL,0C0H		;Force "register" mode
  2258 00000F8C E918FB                  	JMP	PUT
  2259                                  
  2260                                  GRP20:
  2261 00000F8F 88C5                    	MOV	CH,AL
  2262 00000F91 B101                    	MOV	CL,1
  2263 00000F93 E857F2                  	CALL	MROPS
  2264 00000F96 B1F6                    	MOV	CL,0F6H
  2265 00000F98 E8CDFA                  	CALL	IMMED
  2266 00000F9B B5A8                    	MOV	CH,0A8H
  2267 00000F9D E915FE                  	JMP	AIMM
  2268                                  GRP21:
  2269 00000FA0 E826F3                  	CALL	GETOP
  2270 00000FA3 3C04                    	CMP	AL,SREG
  2271 00000FA5 B11C                    	MOV	CL,28
  2272 00000FA7 75C1                    	JNZ	ERRJ
  2273 00000FA9 B526                    	MOV	CH,26H
  2274                                  PACKREG:
  2275 00000FAB 88D0                    	MOV	AL,DL
  2276 00000FAD 00C0                    	ADD	AL,AL
  2277 00000FAF 00C0                    	ADD	AL,AL
  2278 00000FB1 00C0                    	ADD	AL,AL
  2279 00000FB3 08E8                    	OR	AL,CH
  2280 00000FB5 E9EFFA                  	JMP	PUT
  2281                                  GRP22:
  2282 00000FB8 E80EF3                  	CALL	GETOP
  2283 00000FBB B9008F                  	MOV	CX,8F00H
  2284 00000FBE 3C00                    	CMP	AL,UNDEFID
  2285 00000FC0 7503                    	JNZ	$+5
  2286 00000FC2 E9E9FB                  	JMP	PMEM
  2287 00000FC5 B558                    	MOV	CH,58H
  2288 00000FC7 3C03                    	CMP	AL,XREG
  2289 00000FC9 7503                    	JNZ	$+5
  2290 00000FCB E9EBFB                  	JMP	PXREG
  2291 00000FCE B507                    	MOV	CH,7
  2292 00000FD0 3C04                    	CMP	AL,SREG
  2293 00000FD2 74D7                    	JZ	PACKREG
  2294 00000FD4 B114                    	MOV	CL,20
  2295 00000FD6 E9D9F1                  ERR11:	JMP	ERROR
  2296                                  GRP23:
  2297 00000FD9 A2[9520]                	MOV	[DATSIZ],AL
  2298                                  GETDAT:
  2299 00000FDC E827F5                  	CALL	GETSYM
  2300 00000FDF B002                    	MOV	AL,2
  2301 00000FE1 E8FEF2                  	CALL	VAL1
  2302 00000FE4 A0[8C20]                	MOV	AL,[SYM]
  2303 00000FE7 3C2C                    	CMP	AL,','
  2304 00000FE9 A0[9520]                	MOV	AL,[DATSIZ]
  2305 00000FEC 7505                    	JNZ	ENDDAT
  2306 00000FEE E81300                  	CALL	SAVDAT
  2307 00000FF1 EBE9                    	JMP	GETDAT
  2308                                  ENDDAT:
  2309 00000FF3 3C02                    	CMP	AL,2
  2310 00000FF5 750D                    	JNZ	SAVDAT
  2311 00000FF7 8B1E[3220]              	MOV	BX,[DATA]
  2312 00000FFB 9F                      	LAHF
  2313                                  	;NOTICE: DO NOT GENERATE END FOR DM IF COMMENTED
  2314 00000FFC 80CB80                  	OR	BL,080H
  2315 00000FFF 9E                      	SAHF
  2316 00001000 891E[3220]              	MOV	[DATA],BX
  2317                                  SAVDAT:
  2318 00001004 08C0                    	OR	AL,AL
  2319 00001006 7403                    	JZ	$+5
  2320 00001008 E9F3FA                  	JMP	PUTBYT
  2321 0000100B E9E9FA                  	JMP	PUTWOR
  2322                                  IF:
  2323 0000100E 09DB                    	OR	BX,BX
  2324 00001010 7405                    	JZ	SKIPCD
  2325 00001012 FE06[A620]              	INC	BYTE [IFFLG]
  2326 00001016 C3                      	RET
  2327                                  
  2328                                  SKIPCD:
  2329 00001017 FE06[A720]              	INC	BYTE [CHKLAB]
  2330                                  SKIPLP:
  2331 0000101B 30C0                    	XOR	AL,AL
  2332 0000101D E83AF1                  	CALL	NEXLIN
  2333 00001020 E893F1                  	CALL	NEXTCHR
  2334 00001023 3C1A                    	CMP	AL,1AH
  2335 00001025 7440                    	JZ	END
  2336 00001027 E8E3F7                  	CALL	GETLAB
  2337 0000102A 72EF                    	JC	SKIPLP
  2338 0000102C BF[3A20]                	MOV	DI,LENID
  2339 0000102F BE[D01F]                	MOV	SI,IFEND
  2340 00001032 B500                    	MOV	CH,0
  2341 00001034 8A0D                    	MOV	CL,[DI]
  2342 00001036 FEC1                    	INC	CL
  2343 00001038 F3                      	REPE
  2344 00001039 A6                      	CMPSB
  2345 0000103A 7414                    	JZ	ENDCOND
  2346 0000103C BF[3A20]                	MOV	DI,LENID
  2347 0000103F BE[D61F]                	MOV	SI,IFNEST
  2348 00001042 8A0D                    	MOV	CL,[DI]
  2349 00001044 FEC1                    	INC	CL
  2350 00001046 F3                      	REPE
  2351 00001047 A6                      	CMPSB
  2352 00001048 75D1                    	JNZ	SKIPLP
  2353 0000104A FE06[A720]              	INC	BYTE [CHKLAB]
  2354 0000104E EBCB                    	JMP	SKIPLP
  2355                                  
  2356                                  ENDCOND:
  2357 00001050 FE0E[A720]              	DEC	BYTE [CHKLAB]
  2358 00001054 75C5                    	JNZ	SKIPLP
  2359 00001056 C3                      	RET
  2360                                  
  2361                                  ENDIF:
  2362 00001057 A0[A620]                	MOV	AL,[IFFLG]
  2363 0000105A B124                    	MOV	CL,36
  2364 0000105C FEC8                    	DEC	AL
  2365 0000105E 7804                    	JS	ERRJMP
  2366 00001060 A2[A620]                	MOV	[IFFLG],AL
  2367 00001063 C3                      	RET
  2368                                  
  2369 00001064 E94BF1                  ERRJMP:	JMP	ERROR
  2370                                  
  2371                                  ;*********************************************************************
  2372                                  ;
  2373                                  ;	PASS 2
  2374                                  ;
  2375                                  ;*********************************************************************
  2376                                  
  2377                                  END:
  2378 00001067 B204                    	MOV	DL,4
  2379                                  WREND:
  2380 00001069 B5FF                    	MOV	CH,0FFH
  2381 0000106B 88E8                    	MOV	AL,CH
  2382 0000106D E841FA                  	CALL	GEN
  2383 00001070 FECA                    	DEC	DL
  2384 00001072 75F5                    	JNZ	WREND
  2385 00001074 C706[0025][0225]        	MOV	WORD[BUFPT],SRCBUF
  2386 0000107A C606[A220]FB            	MOV	BYTE [HEXCNT],-5	;FLAG HEX BUFFER AS EMPTY
  2387 0000107F C706[B820][0021]        	MOV	WORD[LSTPNT],LSTBUF
  2388 00001085 C706[B620][BA20]        	MOV	WORD[HEXPNT],HEXBUF
  2389 0000108B 31C0                    	XOR	AX,AX
  2390 0000108D A3[A820]                	MOV	[ERRCNT],AX
  2391 00001090 A3[2620]                	MOV	[PC],AX
  2392 00001093 A3[9A20]                	MOV	[LINE],AX	;Current line number
  2393 00001096 C706[9E20]0001          	MOV	WORD[HEXADD],OBJECT
  2394 0000109C BA5C00                  	MOV	DX,FCB
  2395 0000109F B40F                    	MOV	AH,OPEN
  2396 000010A1 CD21                    	INT	33		;Re-open source file
  2397 000010A3 31C0                    	XOR	AX,AX
  2398 000010A5 A36800                  	MOV	[FCB+12],AX	;Set CURRENT BLOCK to zero
  2399 000010A8 A27C00                  	MOV	[FCB+20H],AL	;Set NEXT RECORD field to zero
  2400 000010AB C7066A000004            	MOV	WORD[FCB+14],BUFSIZ
  2401 000010B1 A2[9820]                	MOV	[COUNT],AL
  2402 000010B4 B501                    	MOV	CH,1
  2403 000010B6 BE[022A]                	MOV	SI,START
  2404                                  FIXLINE:
  2405 000010B9 BF[022A]                	MOV	DI,START	;Store code over used up intermediate code
  2406 000010BC 30C0                    	XOR	AL,AL
  2407 000010BE A2[B020]                	MOV	[SPC],AL	;No "special" yet (ORG, PUT, DS)
  2408 000010C1 A2[9920]                	MOV	[ERR],AL	;No second pass errors yet
  2409                                  NEXBT:
  2410 000010C4 D0E1                    	SHL	CL,1		;Shift out last bit of previous code
  2411 000010C6 FECD                    	DEC	CH		;Still have codes left?
  2412 000010C8 7505                    	JNZ	TESTTYP
  2413 000010CA AC                      	LODSB			;Get next flag byte
  2414 000010CB 88C1                    	MOV	CL,AL
  2415 000010CD B504                    	MOV	CH,4
  2416                                  TESTTYP:
  2417 000010CF D0E1                    	SHL	CL,1		;Set flags based on two bits
  2418 000010D1 7006                    	JO	FIXUP
  2419 000010D3 AC                      	LODSB
  2420 000010D4 724E                    	JC	EMARK
  2421                                  OBJBT:
  2422 000010D6 AA                      	STOSB
  2423 000010D7 EBEB                    	JMP	NEXBT
  2424                                  
  2425                                  FIXUP:
  2426                                  ;Either a word or byte fixup is needed from a forward reference
  2427 000010D9 AD                      	LODSW			;Get pointer to symbol
  2428 000010DA 93                      	XCHG	AX,BX
  2429 000010DB AD                      	LODSW			;Get constant part
  2430 000010DC 034701                  	ADD	AX,[BX+1]	;Add symbol value to constant part
  2431 000010DF 803F00                  	CMP	BYTE [BX],0	;See if symbol got defined
  2432 000010E2 7507                    	JNZ	HAVDEF
  2433 000010E4 C606[9920]64            	MOV	BYTE [ERR],100	;Undefined - flag error
  2434 000010E9 31C0                    	XOR	AX,AX
  2435                                  HAVDEF:
  2436 000010EB 08C9                    	OR	CL,CL		;See if word or byte fixup
  2437 000010ED 7803                    	JS	DEFBYT
  2438 000010EF AB                      	STOSW
  2439 000010F0 EBD2                    	JMP	NEXBT
  2440                                  
  2441                                  DEFBYT:
  2442 000010F2 89C2                    	MOV	DX,AX
  2443 000010F4 98                      	CBW			;Extend sign
  2444 000010F5 39D0                    	CMP	AX,DX		;See if in range +127 to -128
  2445 000010F7 74DD                    	JZ	OBJBT		;If so, it's always OK
  2446 000010F9 F6D4                    	NOT	AH		;Check for range +255 to -256
  2447 000010FB 38F4                    	CMP	AH,DH
  2448 000010FD 751B                    	JNZ	RNGERR		;Must always be in this range
  2449                                  ;Check for short jump. If so, we're out of range; otherwise we're OK
  2450 000010FF 81FF[032A]              	CMP	DI,START+1	;Only one other byte on line?
  2451 00001103 75D1                    	JNZ	OBJBT		;Can't be short jump if not
  2452 00001105 A0[022A]                	MOV	AL,[START]	;Get the first byte of this line
  2453 00001108 3CEB                    	CMP	AL,0EBH		;Direct short jump?
  2454 0000110A 740E                    	JZ	RNGERR
  2455 0000110C 24FC                    	AND	AL,0FCH
  2456 0000110E 3CE0                    	CMP	AL,0E0H		;LOOP or JCXZ instruction?
  2457 00001110 7408                    	JZ	RNGERR
  2458 00001112 24F0                    	AND	AL,0F0H
  2459 00001114 3C70                    	CMP	AL,70H		;Conditional jump?
  2460 00001116 88D0                    	MOV	AL,DL		;Get code byte in AL
  2461 00001118 75BC                    	JNZ	OBJBT		;If not, we're OK
  2462                                  RNGERR:
  2463 0000111A C606[9920]65            	MOV	BYTE [ERR],101	;Value out of range
  2464 0000111F EBB5                    	JMP	OBJBT
  2465                                  
  2466 00001121 E97C01                  FINIJ:	JMP	FINI
  2467                                  
  2468                                  EMARK:
  2469 00001124 3CFF                    	CMP	AL,-1		;End of file?
  2470 00001126 74F9                    	JZ	FINIJ
  2471 00001128 3CF6                    	CMP	AL,-10		;Special item?
  2472 0000112A 775C                    	JA	SPEND
  2473 0000112C 51                      	PUSH	CX
  2474 0000112D 56                      	PUSH	SI
  2475 0000112E 50                      	PUSH	AX		;Save error code
  2476 0000112F 8A26[AE20]              	MOV	AH,[LSTDEV]
  2477 00001133 80E4FE                  	AND	AH,0FEH		;Reset error indicator
  2478 00001136 0A06[9920]              	OR	AL,[ERR]	;See if any errors on this line
  2479 0000113A 7403                    	JZ	NOERR
  2480 0000113C 80CC01                  	OR	AH,1		;Send line to console if error occured
  2481                                  NOERR:
  2482 0000113F 8826[AE20]              	MOV	[LSTDEV],AH
  2483 00001143 89F9                    	MOV	CX,DI
  2484 00001145 E8F000                  	CALL	STRTLIN		;Print address of line
  2485 00001148 BE[022A]                	MOV	SI,START
  2486 0000114B 29F1                    	SUB	CX,SI		;Get count of bytes of code
  2487 0000114D 7406                    	JZ	SHOLIN
  2488                                  CODLP:
  2489 0000114F AC                      	LODSB
  2490 00001150 E87502                  	CALL	SAVCD		;Ouput code to HEX and PRN files
  2491 00001153 E2FA                    	LOOP	CODLP
  2492                                  SHOLIN:
  2493 00001155 B000                    	MOV	AL,0
  2494 00001157 8606[9820]              	XCHG	AL,[COUNT]
  2495 0000115B B90700                  	MOV	CX,7		;Allow 7 bytes of code per line
  2496 0000115E 28C1                    	SUB	CL,AL
  2497 00001160 B020                    	MOV	AL,' '
  2498 00001162 740B                    	JZ	NOFIL
  2499                                  BLNK:				;Put in 3 blanks for each byte not present
  2500 00001164 E8E600                  	CALL	LIST
  2501 00001167 E8E300                  	CALL	LIST
  2502 0000116A E8E000                  	CALL	LIST
  2503 0000116D E2F5                    	LOOP	BLNK
  2504                                  NOFIL:
  2505 0000116F E84500                  	CALL	OUTLIN
  2506 00001172 58                      	POP	AX		;Restore error code
  2507 00001173 E88802                  	CALL	REPERR
  2508 00001176 A0[9920]                	MOV	AL,[ERR]
  2509 00001179 E88202                  	CALL	REPERR
  2510 0000117C 5E                      	POP	SI
  2511 0000117D 59                      	POP	CX
  2512 0000117E A0[B020]                	MOV	AL,[SPC]	;Any special funtion?
  2513 00001181 08C0                    	OR	AL,AL
  2514 00001183 750D                    	JNZ	SPCFUN
  2515 00001185 E931FF                  	JMP	FIXLINE
  2516                                  
  2517                                  SPEND:
  2518 00001188 A2[B020]                	MOV	[SPC],AL	;Record special function
  2519 0000118B AD                      	LODSW			;Get it's data
  2520 0000118C A3[3220]                	MOV	[DATA],AX
  2521 0000118F E932FF                  	JMP	NEXBT
  2522                                  
  2523                                  SPCFUN:
  2524 00001192 8B16[3220]              	MOV	DX,[DATA]
  2525 00001196 3CFE                    	CMP	AL,-2
  2526 00001198 740F                    	JZ	DORG
  2527 0000119A 3CFD                    	CMP	AL,-3
  2528 0000119C 7412                    	JZ	DPUT
  2529                                  DDS:
  2530                                  ;Handle DS pseudo-op
  2531 0000119E 0116[2620]              	ADD	[PC],DX
  2532 000011A2 0116[9E20]              	ADD	[HEXADD],DX
  2533 000011A6 E910FF                  	JMP	FIXLINE
  2534                                  
  2535                                  DORG:
  2536                                  ;Handle ORG pseudo-op
  2537 000011A9 8916[2620]              	MOV	[PC],DX
  2538 000011AD E909FF                  	JMP	FIXLINE
  2539                                  
  2540                                  DPUT:
  2541                                  ;Handle PUT pseudo-op
  2542 000011B0 8916[9E20]              	MOV	[HEXADD],DX
  2543 000011B4 E902FF                  	JMP	FIXLINE
  2544                                  
  2545                                  OUTLIN:
  2546                                  ;Copy the source line to the ouput device. Line will be preceded by
  2547                                  ;assembler-generated line number. This routine may be called several times
  2548                                  ;on one line (once for each line of object code bytes), so it sets a flag
  2549                                  ;so the line will only be output on the first call.
  2550 000011B7 B0FF                    	MOV	AL,-1
  2551 000011B9 8606[A420]              	XCHG	AL,[LINFLG]
  2552 000011BD 08C0                    	OR	AL,AL
  2553 000011BF 7535                    	JNZ	CRLF		;Output line only if first time
  2554 000011C1 A1[9A20]                	MOV	AX,[LINE]
  2555 000011C4 40                      	INC	AX
  2556 000011C5 A3[9A20]                	MOV	[LINE],AX
  2557 000011C8 B700                    	MOV	BH,0		;No leading zero suppression
  2558 000011CA E83200                  	CALL	OUT10
  2559 000011CD B020                    	MOV	AL," "
  2560 000011CF E87B00                  	CALL	LIST
  2561 000011D2 A0[0120]                	MOV	AL,[LSTFCB]
  2562 000011D5 3C5A                    	CMP	AL,'Z'
  2563 000011D7 741D                    	JZ	CRLF		;Don't call NEXTCHR if listing suppressed
  2564 000011D9 56                      	PUSH	SI		;Save the only register destroyed by NEXTCHR
  2565                                  OUTLN:
  2566 000011DA E8D9EF                  	CALL	NEXTCHR
  2567 000011DD E86D00                  	CALL	LIST
  2568 000011E0 3C0A                    	CMP	AL,10		;Output until linefeed found
  2569 000011E2 75F6                    	JNZ	OUTLN
  2570 000011E4 5E                      	POP	SI
  2571 000011E5 C3                      	RET
  2572                                  
  2573                                  PRTCNT:
  2574 000011E6 A1[A820]                	MOV	AX,[ERRCNT]
  2575 000011E9 BB[7E1F]                	MOV	BX,ERCNTM
  2576                                  PRNT10:
  2577 000011EC 50                      	PUSH	AX
  2578 000011ED E83E02                  	CALL	PRINT
  2579 000011F0 58                      	POP	AX
  2580 000011F1 B710                    	MOV	BH,"0"-" "	;Enable leading zero suppression
  2581 000011F3 E80900                  	CALL	OUT10
  2582                                  CRLF:
  2583 000011F6 B00D                    	MOV	AL,13
  2584 000011F8 E85200                  	CALL	LIST
  2585 000011FB B00A                    	MOV	AL,10
  2586 000011FD EB4E                    	JMP	LIST
  2587                                  
  2588                                  OUT10:
  2589 000011FF 31D2                    	XOR	DX,DX
  2590 00001201 BF1027                  	MOV	DI,10000
  2591 00001204 F7F7                    	DIV	DI
  2592 00001206 08C0                    	OR	AL,AL		;>10,000?
  2593 00001208 7502                    	JNZ	LEAD
  2594 0000120A 2C10                    	SUB	AL,"0"-" "	;Convert leading zero to blank
  2595                                  LEAD:
  2596 0000120C 0430                    	ADD	AL,"0"
  2597 0000120E E83C00                  	CALL	LIST
  2598 00001211 92                      	XCHG	AX,DX
  2599 00001212 B364                    	MOV	BL,100
  2600 00001214 F6F3                    	DIV	BL
  2601 00001216 88E3                    	MOV	BL,AH
  2602 00001218 E80C00                  	CALL	HIDIG		;Convert to decimal and print 1000s digit
  2603 0000121B E80E00                  	CALL	DIGIT		;Print 100s digit
  2604 0000121E 88D8                    	MOV	AL,BL
  2605 00001220 E80400                  	CALL	HIDIG		;Convert to decimal and print 10s digit
  2606 00001223 B700                    	MOV	BH,0		;Ensure leading zero suppression is off
  2607 00001225 EB05                    	JMP	DIGIT
  2608                                  
  2609                                  HIDIG:
  2610 00001227 D40A                    	AAM			;Convert binary to unpacked BCD
  2611 00001229 0D3030                  	OR	AX,3030H	;Add "0" bias
  2612                                  DIGIT:
  2613 0000122C 86E0                    	XCHG	AL,AH
  2614 0000122E 3C30                    	CMP	AL,"0"
  2615 00001230 7402                    	JZ	SUPZ
  2616 00001232 B700                    	MOV	BH,0		;Turn off zero suppression if not zero
  2617                                  SUPZ:
  2618 00001234 28F8                    	SUB	AL,BH		;Convert leading zeros to blanks
  2619 00001236 EB15                    	JMP	LIST
  2620                                  
  2621                                  STRTLIN:
  2622 00001238 C606[A420]00            	MOV	BYTE [LINFLG],0
  2623 0000123D 8B1E[2620]              	MOV	BX,[PC]
  2624 00001241 88F8                    	MOV	AL,BH
  2625 00001243 E84D00                  	CALL	PHEX
  2626 00001246 88D8                    	MOV	AL,BL
  2627                                  PHEXB:
  2628 00001248 E84800                  	CALL	PHEX
  2629 0000124B B020                    	MOV	AL,' '
  2630                                  LIST:
  2631 0000124D 50                      	PUSH	AX
  2632 0000124E 52                      	PUSH	DX
  2633 0000124F 247F                    	AND	AL,7FH
  2634 00001251 88C2                    	MOV	DL,AL
  2635 00001253 F606[AE20]03            	TEST	BYTE [LSTDEV],3	;See if output goes to console
  2636 00001258 7404                    	JZ	PRNCHK
  2637 0000125A B402                    	MOV	AH,2
  2638 0000125C CD21                    	INT	33		;Output to console
  2639                                  PRNCHK:
  2640 0000125E F606[AE20]04            	TEST	BYTE [LSTDEV],4	;See if output goes to printer
  2641 00001263 7404                    	JZ	FILCHK
  2642 00001265 B405                    	MOV	AH,5
  2643 00001267 CD21                    	INT	33		;Output to printer
  2644                                  FILCHK:
  2645 00001269 88D0                    	MOV	AL,DL
  2646 0000126B 5A                      	POP	DX
  2647 0000126C F606[AE20]80            	TEST	BYTE [LSTDEV],80H	;See if output goes to a file
  2648 00001271 7403                    	JZ	LISTRET
  2649 00001273 E80200                  	CALL	WRTBUF
  2650                                  LISTRET:
  2651 00001276 58                      	POP	AX
  2652 00001277 C3                      	RET
  2653                                  
  2654                                  WRTBUF:
  2655 00001278 57                      	PUSH	DI
  2656 00001279 8B3E[B820]              	MOV	DI,[LSTPNT]
  2657 0000127D AA                      	STOSB
  2658 0000127E 81FF[0025]              	CMP	DI,LSTBUF+LSTBUFSIZ
  2659 00001282 7509                    	JNZ	SAVPT
  2660 00001284 50                      	PUSH	AX
  2661 00001285 51                      	PUSH	CX
  2662 00001286 52                      	PUSH	DX
  2663 00001287 E88102                  	CALL	FLUSHBUF
  2664 0000128A 5A                      	POP	DX
  2665 0000128B 59                      	POP	CX
  2666 0000128C 58                      	POP	AX
  2667                                  SAVPT:
  2668 0000128D 893E[B820]              	MOV	[LSTPNT],DI
  2669 00001291 5F                      	POP	DI
  2670 00001292 C3                      	RET
  2671                                  
  2672                                  PHEX:
  2673 00001293 50                      	PUSH	AX
  2674 00001294 E89502                  	CALL	UHALF
  2675 00001297 E8B3FF                  	CALL	LIST
  2676 0000129A 58                      	POP	AX
  2677 0000129B E89602                  	CALL	LHALF
  2678 0000129E EBAD                    	JMP	LIST
  2679                                  
  2680                                  FINI:
  2681 000012A0 800E[AE20]01            	OR	BYTE [LSTDEV],1
  2682 000012A5 E83EFF                  	CALL	PRTCNT
  2683 000012A8 BB[8F1F]                	MOV	BX,SYMSIZE
  2684 000012AB A10600                  	MOV	AX,[6]
  2685 000012AE 2B06[8F20]              	SUB	AX,[HEAP]		;Size of symbol table
  2686 000012B2 E837FF                  	CALL	PRNT10
  2687 000012B5 BB[A51F]                	MOV	BX,FRESIZE
  2688 000012B8 A1[8F20]                	MOV	AX,[HEAP]
  2689 000012BB 2B06[9320]              	SUB	AX,[CODE]		;Free space remaining
  2690 000012BF E82AFF                  	CALL	PRNT10
  2691 000012C2 8026[AE20]FE            	AND	BYTE [LSTDEV],0FEH
  2692 000012C7 A0[DC1F]                	MOV	AL,[HEXFCB]
  2693 000012CA 3C5A                    	CMP	AL,'Z'
  2694 000012CC 7435                    	JZ	SYMDMP
  2695 000012CE A0[A220]                	MOV	AL,[HEXCNT]
  2696 000012D1 3CFB                    	CMP	AL,-5
  2697 000012D3 7403                    	JZ	L0012
  2698 000012D5 E8E501                  	CALL	ENHEXL
  2699                                  L0012:	
  2700 000012D8 B03A                    	MOV	AL,':'
  2701 000012DA E82402                  	CALL	PUTCHR
  2702 000012DD B50A                    	MOV	CH,10
  2703                                  HEXEND:
  2704 000012DF 51                      	PUSH	CX
  2705 000012E0 B030                    	MOV	AL,'0'
  2706 000012E2 E81C02                  	CALL	PUTCHR
  2707 000012E5 59                      	POP	CX
  2708 000012E6 FECD                    	DEC	CH
  2709 000012E8 75F5                    	JNZ	HEXEND
  2710 000012EA B00D                    	MOV	AL,13
  2711 000012EC E81202                  	CALL	PUTCHR
  2712 000012EF B00A                    	MOV	AL,10
  2713 000012F1 E80D02                  	CALL	PUTCHR
  2714 000012F4 B01A                    	MOV	AL,1AH
  2715 000012F6 E80802                  	CALL	PUTCHR
  2716 000012F9 E8EA01                  	CALL	WRTHEX		;Flush HEX file buffer
  2717 000012FC BA[DC1F]                	MOV	DX,HEXFCB
  2718 000012FF B410                    	MOV	AH,CLOSE
  2719 00001301 CD21                    	INT	33
  2720                                  SYMDMP:
  2721 00001303 A0[9120]                	MOV	AL,[SYMFLG]
  2722 00001306 3C53                    	CMP	AL,'S'
  2723 00001308 752A                    	JNZ	ENDSYM
  2724 0000130A A0[AE20]                	MOV	AL,[LSTDEV]
  2725 0000130D 08C0                    	OR	AL,AL		;Any output device for symbol table dump?
  2726 0000130F 7505                    	JNZ	DOSYMTAB
  2727 00001311 0C01                    	OR	AL,1		;If not, send it to console
  2728 00001313 A2[AE20]                	MOV	[LSTDEV],AL
  2729                                  DOSYMTAB:
  2730 00001316 BB[B91F]                	MOV	BX,SYMMES
  2731 00001319 E81201                  	CALL	PRINT
  2732 0000131C 8B16[8D20]              	MOV	DX,[BASE]
  2733 00001320 88F0                    	MOV	AL,DH
  2734 00001322 08D0                    	OR	AL,DL
  2735 00001324 740E                    	JZ	ENDSYM
  2736 00001326 C606[9220]05            	MOV	BYTE [SYMLIN],SYMWID  ;No symbols on this line yet
  2737 0000132B 8B1E[8F20]              	MOV	BX,[HEAP]
  2738 0000132F 89DC                    	MOV	SP,BX		;Need maximum stack for recursive tree walk
  2739 00001331 E81A00                  	CALL	NODE
  2740                                  ENDSYM:
  2741 00001334 F606[AE20]80            	TEST	BYTE [LSTDEV],80H	;Print listing to file?
  2742 00001339 7410                    	JZ	EXIT
  2743 0000133B B01A                    	MOV	AL,1AH
  2744 0000133D E838FF                  	CALL	WRTBUF		;Write end-of-file mark
  2745 00001340 8B3E[B820]              	MOV	DI,[LSTPNT]
  2746 00001344 E8C401                  	CALL	FLUSHBUF
  2747 00001347 B410                    	MOV	AH,CLOSE
  2748 00001349 CD21                    	INT	33
  2749 0000134B E9(0000)                EXIT:	JMP	0
  2750                                  
  2751                                  NODE:
  2752 0000134E 87DA                    	XCHG	DX,BX
  2753 00001350 53                      	PUSH	BX
  2754 00001351 8A17                    	MOV	DL,[BX]
  2755 00001353 B600                    	MOV	DH,0
  2756 00001355 43                      	INC	BX
  2757 00001356 01D3                    	ADD	BX,DX
  2758 00001358 8B17                    	MOV	DX,[BX]
  2759 0000135A 09D2                    	OR	DX,DX
  2760 0000135C 7403                    	JZ	L0014
  2761 0000135E E8EDFF                  	CALL	NODE
  2762                                  L0014:	
  2763 00001361 5B                      	POP	BX
  2764 00001362 8A07                    	MOV	AL,[BX]
  2765 00001364 43                      	INC	BX
  2766 00001365 88C5                    	MOV	CH,AL
  2767 00001367 0418                    	ADD	AL,24
  2768 00001369 D0E8                    	SHR	AL,1
  2769 0000136B D0E8                    	SHR	AL,1
  2770 0000136D D0E8                    	SHR	AL,1
  2771 0000136F 88C1                    	MOV	CL,AL
  2772 00001371 FEC1                    	INC	CL		;Invert last bit
  2773 00001373 80E101                  	AND	CL,1		;Number of extra tabs needed (0 or 1)
  2774 00001376 D0E8                    	SHR	AL,1		;Number of positions wide this symbol needs
  2775 00001378 2806[9220]              	SUB	[SYMLIN],AL
  2776 0000137C 730A                    	JNC	WRTSYM		;Will it fit?
  2777 0000137E 2C05                    	SUB	AL,SYMWID
  2778 00001380 F6D8                    	NEG	AL
  2779 00001382 A2[9220]                	MOV	[SYMLIN],AL
  2780 00001385 E86EFE                  	CALL	CRLF		;Start new line if not
  2781                                  WRTSYM:
  2782 00001388 8A07                    	MOV	AL,[BX]
  2783 0000138A 43                      	INC	BX
  2784 0000138B E8BFFE                  	CALL	LIST
  2785 0000138E FECD                    	DEC	CH
  2786 00001390 75F6                    	JNZ	WRTSYM
  2787 00001392 FEC1                    	INC	CL
  2788                                  TABVAL:
  2789 00001394 B009                    	MOV	AL,9
  2790 00001396 E8B4FE                  	CALL	LIST
  2791 00001399 E2F9                    	LOOP	TABVAL
  2792 0000139B 43                      	INC	BX
  2793 0000139C 43                      	INC	BX
  2794 0000139D 53                      	PUSH	BX
  2795 0000139E 8A4704                  	MOV	AL,[BX+4]
  2796 000013A1 E8EFFE                  	CALL	PHEX
  2797 000013A4 8A4703                  	MOV	AL,[BX+3]
  2798 000013A7 E8E9FE                  	CALL	PHEX
  2799 000013AA 803E[9220]00            	CMP	BYTE [SYMLIN],0	;Will any more fit on line?
  2800 000013AF 7407                    	JZ	NEXSYMLIN
  2801 000013B1 B009                    	MOV	AL,9
  2802 000013B3 E897FE                  	CALL	LIST
  2803 000013B6 EB08                    	JMP	RIGHTSON
  2804                                  NEXSYMLIN:
  2805 000013B8 E83BFE                  	CALL	CRLF
  2806 000013BB C606[9220]05            	MOV	BYTE [SYMLIN],SYMWID
  2807                                  RIGHTSON:
  2808 000013C0 5B                      	POP	BX
  2809 000013C1 8B17                    	MOV	DX,[BX]
  2810 000013C3 09D2                    	OR	DX,DX
  2811 000013C5 7587                    	JNZ	NODE
  2812 000013C7 C3                      	RET
  2813                                  
  2814                                  SAVCD:
  2815 000013C8 A2[A520]                	MOV	[PREV],AL
  2816 000013CB 53                      	PUSH	BX
  2817 000013CC 51                      	PUSH	CX
  2818 000013CD 50                      	PUSH	AX
  2819 000013CE 52                      	PUSH	DX
  2820 000013CF E87400                  	CALL	CODBYT
  2821 000013D2 5A                      	POP	DX
  2822 000013D3 BB[9820]                	MOV	BX,COUNT
  2823 000013D6 FE07                    	INC	BYTE [BX]
  2824 000013D8 8A07                    	MOV	AL,[BX]
  2825 000013DA 3C08                    	CMP	AL,8
  2826 000013DC 7511                    	JNZ	NOEXT
  2827 000013DE C60701                  	MOV	BYTE [BX],1
  2828 000013E1 E8D3FD                  	CALL	OUTLIN
  2829 000013E4 B020                    	MOV	AL,' '
  2830 000013E6 B505                    	MOV	CH,5
  2831                                  TAB:
  2832 000013E8 E862FE                  	CALL	LIST
  2833 000013EB FECD                    	DEC	CH
  2834 000013ED 75F9                    	JNZ	TAB
  2835                                  NOEXT:
  2836 000013EF 58                      	POP	AX
  2837 000013F0 E855FE                  	CALL	PHEXB
  2838 000013F3 59                      	POP	CX
  2839 000013F4 FF06[2620]              	INC	WORD[PC]
  2840 000013F8 FF06[9E20]              	INC	WORD[HEXADD]
  2841 000013FC 5B                      	POP	BX
  2842 000013FD C3                      	RET
  2843                                  
  2844                                  REPERR:
  2845 000013FE 08C0                    	OR	AL,AL		;Did an error occur?
  2846                                  	;FIXME:DISABLE THIS FOR NOW
  2847 00001400 EB1B                    	JMP	REPERR_RET	
  2848                                  	;JZ	REPERR_RET
  2849 00001402 FF06[A820]              	INC	WORD[ERRCNT]
  2850 00001406 50                      	PUSH	AX
  2851 00001407 BB[081F]                	MOV	BX,ERRMES	;Print "ERROR"
  2852 0000140A E82100                  	CALL	PRINT
  2853 0000140D 58                      	POP	AX
  2854                                  ;We have error number in AL. See if there's an error message for it
  2855 0000140E BF[391B]                	MOV	DI,ERRTAB
  2856 00001411 B380                    	MOV	BL,80H
  2857                                  ERRLOOK:
  2858 00001413 AE                      	SCASB			;Do we have the error message
  2859 00001414 7608                    	JBE	HAVMES		;Quit looking if we have it or passed it
  2860 00001416 93                      	XCHG	AX,BX		;Put 80H in AL to look for end of this message
  2861                                  NEXTMES:
  2862 00001417 AE                      	SCASB			;Look for high bit set in message
  2863                                  	;FIX
  2864 00001418 77FD                    	JA	NEXTMES		;   which means we've reached the end
  2865 0000141A 93                      	XCHG	AX,BX		;Restore error number to AL
  2866 0000141B EBF6                    	JMP 	ERRLOOK		;Keep looking
  2867                                  REPERR_RET:
  2868 0000141D C3                      	RET
  2869                                  
  2870                                  HAVMES:
  2871 0000141E 89FB                    	MOV	BX,DI		;Put address of message in BX
  2872 00001420 7406                    	JZ	PRNERR		;Do we have a message for this error?
  2873 00001422 E86EFE                  	CALL	PHEX		;If not, just print error number
  2874 00001425 E9CEFD                  	JMP	CRLF
  2875                                  
  2876                                  PRNERR:
  2877 00001428 E80300                  	CALL	PRINT
  2878 0000142B E9C8FD                  	JMP	CRLF
  2879                                  
  2880                                  PRINT:
  2881 0000142E 8A07                    	MOV	AL,[BX]
  2882 00001430 E81AFE                  	CALL	LIST
  2883 00001433 08C0                    	OR	AL,AL
  2884 00001435 780E                    	JS	PRINT_RET
  2885 00001437 43                      	INC	BX
  2886 00001438 EBF4                    	JMP	PRINT
  2887                                  OUTA:
  2888 0000143A 88C2                    	MOV	DL,AL
  2889                                  OUT:
  2890 0000143C 80E27F                  	AND	DL,7FH
  2891 0000143F B102                    	MOV	CL,2
  2892                                  SYSTEM:
  2893 00001441 E8(0500)                	CALL	5
  2894 00001444 C3                      	RET
  2895                                  PRINT_RET:
  2896 00001445 C3                      	RET
  2897                                  CODBYT:
  2898 00001446 803E[DC1F]5A            	CMP	BYTE [HEXFCB],"Z"
  2899 0000144B 746E                    	JZ	CODBYT_RET
  2900 0000144D 50                      	PUSH	AX
  2901 0000144E 8B16[A020]              	MOV	DX,[LASTAD]
  2902 00001452 8B1E[9E20]              	MOV	BX,[HEXADD]
  2903 00001456 891E[A020]              	MOV	[LASTAD],BX
  2904 0000145A 42                      	INC	DX
  2905 0000145B A0[A220]                	MOV	AL,[HEXCNT]
  2906 0000145E 3CFB                    	CMP	AL,-5
  2907 00001460 7407                    	JZ	NEWLIN
  2908 00001462 39D3                    	CMP	BX,DX
  2909 00001464 742E                    	JZ	AFHEX
  2910 00001466 E85400                  	CALL	ENHEXL
  2911                                  NEWLIN:
  2912 00001469 B03A                    	MOV	AL,':'
  2913 0000146B E89300                  	CALL	PUTCHR
  2914 0000146E B0FC                    	MOV	AL,-4
  2915 00001470 A2[A220]                	MOV	[HEXCNT],AL
  2916 00001473 30C0                    	XOR	AL,AL
  2917 00001475 A2[A320]                	MOV	[CHKSUM],AL
  2918 00001478 8B1E[B620]              	MOV	BX,[HEXPNT]
  2919 0000147C 891E[9C20]              	MOV	[HEXLEN],BX
  2920 00001480 E81200                  	CALL	HEXBYT
  2921 00001483 A0[9F20]                	MOV	AL,[HEXADD+1]
  2922 00001486 E80C00                  	CALL	HEXBYT
  2923 00001489 A0[9E20]                	MOV	AL,[HEXADD]
  2924 0000148C E80600                  	CALL	HEXBYT
  2925 0000148F 30C0                    	XOR	AL,AL
  2926 00001491 E80100                  	CALL	HEXBYT
  2927                                  AFHEX:
  2928 00001494 58                      	POP	AX
  2929                                  HEXBYT:
  2930 00001495 88C5                    	MOV	CH,AL
  2931 00001497 BB[A320]                	MOV	BX,CHKSUM
  2932 0000149A 0207                    	ADD	AL,[BX]
  2933 0000149C 8807                    	MOV	[BX],AL
  2934 0000149E 88E8                    	MOV	AL,CH
  2935 000014A0 E88900                  	CALL	UHALF
  2936 000014A3 E85B00                  	CALL	PUTCHR
  2937 000014A6 88E8                    	MOV	AL,CH
  2938 000014A8 E88900                  	CALL	LHALF
  2939 000014AB E85300                  	CALL	PUTCHR
  2940 000014AE BB[A220]                	MOV	BX,HEXCNT
  2941 000014B1 FE07                    	INC	BYTE [BX]
  2942 000014B3 8A07                    	MOV	AL,[BX]
  2943 000014B5 3C1A                    	CMP	AL,26
  2944 000014B7 7503                    	JNZ	HEXBYT_RET
  2945 000014B9 EB02                    	JMP ENHEXL
  2946                                  CODBYT_RET:
  2947 000014BB C3                      	RET
  2948                                  HEXBYT_RET:
  2949 000014BC C3                      	RET
  2950                                  ENHEXL:
  2951 000014BD 8B3E[9C20]              	MOV	DI,[HEXLEN]
  2952 000014C1 88C5                    	MOV	CH,AL
  2953 000014C3 E86600                  	CALL	UHALF
  2954 000014C6 AA                      	STOSB
  2955 000014C7 88E8                    	MOV	AL,CH
  2956 000014C9 E86800                  	CALL	LHALF
  2957 000014CC AA                      	STOSB
  2958 000014CD B0FA                    	MOV	AL,-6
  2959 000014CF A2[A220]                	MOV	[HEXCNT],AL
  2960 000014D2 A0[A320]                	MOV	AL,[CHKSUM]
  2961 000014D5 00E8                    	ADD	AL,CH
  2962 000014D7 F6D8                    	NEG	AL
  2963 000014D9 E8B9FF                  	CALL	HEXBYT
  2964 000014DC B00D                    	MOV	AL,13
  2965 000014DE E82000                  	CALL	PUTCHR
  2966 000014E1 B00A                    	MOV	AL,10
  2967 000014E3 E81B00                  	CALL	PUTCHR
  2968                                  WRTHEX:
  2969                                  ;Write out the line
  2970 000014E6 BA[BA20]                	MOV	DX,HEXBUF
  2971 000014E9 8916[B620]              	MOV	[HEXPNT],DX
  2972 000014ED B41A                    	MOV	AH,SETDMA
  2973 000014EF CD21                    	INT	33
  2974 000014F1 29D7                    	SUB	DI,DX		;Length of buffer
  2975 000014F3 89F9                    	MOV	CX,DI
  2976 000014F5 BA[DC1F]                	MOV	DX,HEXFCB
  2977 000014F8 B428                    	MOV	AH,BLKWRT
  2978 000014FA CD21                    	INT	33
  2979 000014FC 08C0                    	OR	AL,AL
  2980 000014FE 7525                    	JNZ	DSKFUL
  2981 00001500 C3                      	RET
  2982                                  
  2983                                  PUTCHR:
  2984 00001501 8B3E[B620]              	MOV	DI,[HEXPNT]
  2985 00001505 AA                      	STOSB
  2986 00001506 893E[B620]              	MOV	[HEXPNT],DI
  2987 0000150A C3                      	RET
  2988                                  
  2989                                  FLUSHBUF:
  2990 0000150B 89F9                    	MOV	CX,DI
  2991 0000150D BA[0021]                	MOV	DX,LSTBUF
  2992 00001510 89D7                    	MOV	DI,DX
  2993 00001512 29D1                    	SUB	CX,DX
  2994 00001514 7415                    	JZ	FLUSHBUF_RET		;Buffer empty?
  2995 00001516 B41A                    	MOV	AH,SETDMA
  2996 00001518 CD21                    	INT	33
  2997 0000151A BA[0120]                	MOV	DX,LSTFCB
  2998 0000151D B428                    	MOV	AH,BLKWRT
  2999 0000151F CD21                    	INT	33
  3000 00001521 08C0                    	OR	AL,AL
  3001 00001523 7406                    	JZ	FLUSHBUF_RET
  3002                                  DSKFUL:
  3003 00001525 BB[591F]                	MOV	BX,WRTERR
  3004 00001528 E94AEC                  	JMP	PRERR
  3005                                  FLUSHBUF_RET:
  3006 0000152B C3                      	RET
  3007                                  UHALF:
  3008 0000152C D0D8                    	RCR	AL,1
  3009 0000152E D0D8                    	RCR	AL,1
  3010 00001530 D0D8                    	RCR	AL,1
  3011 00001532 D0D8                    	RCR	AL,1
  3012                                  LHALF:
  3013 00001534 240F                    	AND	AL,0FH
  3014 00001536 0C30                    	OR	AL,30H
  3015 00001538 3C3A                    	CMP	AL,'9'+1
  3016 0000153A 7203                    	JC	LHALF_RET
  3017 0000153C 0407                    	ADD	AL,7
  3018 0000153E C3                      	RET
  3019                                  LHALF_RET:
  3020 0000153F C3                      	RET
  3021 00001540 00                      NONE:	DB	0
  3022                                  
  3023                                  ; 8086 MNEMONIC TABLE
  3024                                  
  3025                                  ; This table is actually a sequence of subtables, each starting with a label.
  3026                                  ; The label signifies which mnemonics the subtable applies to--A3, for example,
  3027                                  ; means all 3-letter mnemonics beginning with A.
  3028                                  
  3029                                  A3:
  3030 00001541 07                      	DB	7		;Number of entries
  3031                                  
  3032 00001542 6464                    	DB	'dd'	;tail of opcode
  3033 00001544 [CD0C]                  	DW	GRP7	;opcode handler
  3034 00001546 02                      	DB	2		;opcode format
  3035                                  	
  3036 00001547 6E64                    	DB	'nd'
  3037 00001549 [A30D]                  	DW	GRP13
  3038 0000154B 22                      	DB	22H
  3039 0000154C 6463                    	DB	'dc'
  3040 0000154E [CD0C]                  	DW	GRP7
  3041 00001550 12                      	DB	12H
  3042 00001551 6161                    	DB	'aa'
  3043 00001553 [A70A]                  	DW	PUT
  3044 00001555 37                      	DB	37H
  3045 00001556 6173                    	DB	'as'
  3046 00001558 [A70A]                  	DW	PUT
  3047 0000155A 3F                      	DB	3FH
  3048 0000155B 616D                    	DB	'am'
  3049 0000155D [710D]                  	DW	GRP11
  3050 0000155F D4                      	DB	0D4H
  3051 00001560 6164                    	DB	'ad'
  3052 00001562 [710D]                  	DW	GRP11
  3053 00001564 D5                      	DB	0D5H
  3054                                  A5:
  3055 00001565 01                      	DB	1
  3056 00001566 6C69676E                	DB	'lign'
  3057 0000156A [780C]                  	DW	_ALIGN
  3058 0000156C 00                      	DB	0
  3059                                  C3:
  3060 0000156D 07                      	DB	7
  3061 0000156E 6D70                    	DB	'mp'
  3062 00001570 [CD0C]                  	DW	GRP7
  3063 00001572 3A                      	DB	3AH
  3064 00001573 6C63                    	DB	'lc'
  3065 00001575 [A70A]                  	DW	PUT
  3066 00001577 F8                      	DB	0F8H
  3067 00001578 6C64                    	DB	'ld'
  3068 0000157A [A70A]                  	DW	PUT
  3069 0000157C FC                      	DB	0FCH
  3070 0000157D 6C69                    	DB	'li'
  3071 0000157F [A70A]                  	DW	PUT
  3072 00001581 FA                      	DB	0FAH
  3073 00001582 6D63                    	DB	'mc'
  3074 00001584 [A70A]                  	DW	PUT
  3075 00001586 F5                      	DB	0F5H
  3076 00001587 6277                    	DB	'bw'
  3077 00001589 [A70A]                  	DW	PUT
  3078 0000158B 98                      	DB	98H
  3079 0000158C 7764                    	DB	'wd'
  3080 0000158E [A70A]                  	DW	PUT
  3081 00001590 99                      	DB	99H
  3082                                  C4:
  3083 00001591 03                      	DB	3
  3084 00001592 616C6C                  	DB	'all'
  3085 00001595 [CD0D]                  	DW	GRP14
  3086 00001597 9A                      	DB	9AH
  3087 00001598 6D7062                  	DB	'mpb'
  3088 0000159B [A70A]                  	DW	PUT
  3089 0000159D A6                      	DB	0A6H
  3090 0000159E 6D7077                  	DB	'mpw'
  3091 000015A1 [A70A]                  	DW	PUT
  3092 000015A3 A7                      	DB	0A7H
  3093                                  C5:
  3094 000015A4 02                      	DB	2
  3095 000015A5 6D707362                	DB	'mpsb'
  3096 000015A9 [A70A]                  	DW	PUT
  3097 000015AB A6                      	DB	0A6H
  3098 000015AC 6D707377                	DB	'mpsw'
  3099 000015B0 [A70A]                  	DW	PUT
  3100 000015B2 A7                      	DB	0A7H
  3101                                  D2:
  3102 000015B3 05                      	DB	5
  3103 000015B4 62                      	DB	'b'
  3104 000015B5 [D90F]                  	DW	GRP23
  3105 000015B7 01                      	DB	1
  3106 000015B8 77                      	DB	'w'
  3107 000015B9 [D90F]                  	DW	GRP23
  3108 000015BB 00                      	DB	0
  3109 000015BC 6D                      	DB	'm'
  3110 000015BD [D90F]                  	DW	GRP23
  3111 000015BF 02                      	DB	2
  3112 000015C0 73                      	DB	's'
  3113 000015C1 [460C]                  	DW	GRP5
  3114 000015C3 01                      	DB	1
  3115 000015C4 69                      	DB	'i'
  3116 000015C5 [A70A]                  	DW	PUT
  3117 000015C7 FA                      	DB	0FAH
  3118                                  D3:
  3119 000015C8 04                      	DB	4
  3120 000015C9 6563                    	DB	'ec'
  3121 000015CB [F50C]                  	DW	GRP8
  3122 000015CD 49                      	DB	49H
  3123 000015CE 6976                    	DB	'iv'
  3124 000015D0 [490D]                  	DW	GRP10
  3125 000015D2 30                      	DB	30H
  3126 000015D3 6161                    	DB	'aa'
  3127 000015D5 [A70A]                  	DW	PUT
  3128 000015D7 27                      	DB	27H
  3129 000015D8 6173                    	DB	'as'
  3130 000015DA [A70A]                  	DW	PUT
  3131 000015DC 2F                      	DB	2FH
  3132                                  D4:
  3133 000015DD 01                      	DB	1
  3134 000015DE 6F776E                  	DB	'own'
  3135 000015E1 [A70A]                  	DW	PUT
  3136 000015E3 FD                      	DB	0FDH
  3137                                  E2:
  3138 000015E4 01                      	DB	1
  3139 000015E5 69                      	DB	'i'
  3140 000015E6 [A70A]                  	DW	PUT
  3141 000015E8 FB                      	DB	0FBH
  3142                                  E3:
  3143 000015E9 03                      	DB	3
  3144 000015EA 7175                    	DB	'qu'
  3145 000015EC [460C]                  	DW	GRP5
  3146 000015EE 02                      	DB	2
  3147 000015EF 7363                    	DB	'sc'
  3148 000015F1 [280F]                  	DW	GRP19
  3149 000015F3 D8                      	DB	0D8H
  3150 000015F4 6E64                    	DB	'nd'
  3151 000015F6 [6710]                  	DW	END
  3152 000015F8 00                      	DB	0
  3153                                  E5:
  3154 000015F9 01                      	DB	1
  3155 000015FA 6E646966                	DB	'ndif'
  3156 000015FE [5710]                  	DW	ENDIF
  3157 00001600 00                      	DB	0
  3158                                  H3:
  3159 00001601 01                      	DB	1
  3160 00001602 6C74                    	DB	'lt'
  3161 00001604 [A70A]                  	DW	PUT
  3162 00001606 F4                      	DB	0F4H
  3163                                  H4:
  3164 00001607 01                      	DB	1
  3165 00001608 616C74                  	DB	'alt'
  3166 0000160B [A70A]                  	DW	PUT
  3167 0000160D F4                      	DB	0F4H
  3168                                  I2:
  3169 0000160E 02                      	DB	2
  3170 0000160F 6E                      	DB	'n'
  3171 00001610 [200C]                  	DW	GRP4
  3172 00001612 E4                      	DB	0E4H
  3173 00001613 66                      	DB	'f'
  3174 00001614 [460C]                  	DW	GRP5
  3175 00001616 04                      	DB	4
  3176                                  I3:
  3177 00001617 04                      	DB	4
  3178 00001618 6E63                    	DB	'nc'
  3179 0000161A [F50C]                  	DW	GRP8
  3180 0000161C 41                      	DB	41H
  3181 0000161D 6E62                    	DB	'nb'
  3182 0000161F [200C]                  	DW	GRP4
  3183 00001621 E4                      	DB	0E4H
  3184 00001622 6E77                    	DB	'nw'
  3185 00001624 [200C]                  	DW	GRP4
  3186 00001626 E5                      	DB	0E5H
  3187 00001627 6E74                    	DB	'nt'
  3188 00001629 [FD0E]                  	DW	GRP18
  3189 0000162B CC                      	DB	0CCH
  3190                                  I4:
  3191 0000162C 04                      	DB	4
  3192 0000162D 6D756C                  	DB	'mul'
  3193 00001630 [490D]                  	DW	GRP10
  3194 00001632 28                      	DB	28H
  3195 00001633 646976                  	DB	'div'
  3196 00001636 [490D]                  	DW	GRP10
  3197 00001638 38                      	DB	38H
  3198 00001639 726574                  	DB	'ret'
  3199 0000163C [A70A]                  	DW	PUT
  3200 0000163E CF                      	DB	0CFH
  3201 0000163F 6E746F                  	DB	'nto'
  3202 00001642 [A70A]                  	DW	PUT
  3203 00001644 CE                      	DB	0CEH
  3204                                  J2:
  3205 00001645 0A                      	DB	10
  3206 00001646 70                      	DB	'p'
  3207 00001647 [C30E]                  	DW	GRP17
  3208 00001649 EB                      	DB	0EBH
  3209 0000164A 7A                      	DB	'z'
  3210 0000164B [C30E]                  	DW	GRP17
  3211 0000164D 74                      	DB	74H
  3212 0000164E 65                      	DB	'e'
  3213 0000164F [C30E]                  	DW	GRP17
  3214 00001651 74                      	DB	74H
  3215 00001652 6C                      	DB	'l'
  3216 00001653 [C30E]                  	DW	GRP17
  3217 00001655 7C                      	DB	7CH
  3218 00001656 62                      	DB	'b'
  3219 00001657 [C30E]                  	DW	GRP17
  3220 00001659 72                      	DB	72H
  3221 0000165A 61                      	DB	'a'
  3222 0000165B [C30E]                  	DW	GRP17
  3223 0000165D 77                      	DB	77H
  3224 0000165E 67                      	DB	'g'
  3225 0000165F [C30E]                  	DW	GRP17
  3226 00001661 7F                      	DB	7FH
  3227 00001662 6F                      	DB	'o'
  3228 00001663 [C30E]                  	DW	GRP17
  3229 00001665 70                      	DB	70H
  3230 00001666 73                      	DB	's'
  3231 00001667 [C30E]                  	DW	GRP17
  3232 00001669 78                      	DB	78H
  3233 0000166A 63                      	DB	'c'
  3234 0000166B [C30E]                  	DW	GRP17
  3235 0000166D 72                      	DB	72H
  3236                                  J3:
  3237 0000166E 11                      	DB	17
  3238 0000166F 6D70                    	DB	'mp'
  3239 00001671 [CD0D]                  	DW	GRP14
  3240 00001673 EA                      	DB	0EAH
  3241 00001674 6E7A                    	DB	'nz'
  3242 00001676 [C30E]                  	DW	GRP17
  3243 00001678 75                      	DB	75H
  3244 00001679 6E65                    	DB	'ne'
  3245 0000167B [C30E]                  	DW	GRP17
  3246 0000167D 75                      	DB	75H
  3247 0000167E 6E6C                    	DB	'nl'
  3248 00001680 [C30E]                  	DW	GRP17
  3249 00001682 7D                      	DB	7DH
  3250 00001683 6765                    	DB	'ge'
  3251 00001685 [C30E]                  	DW	GRP17
  3252 00001687 7D                      	DB	7DH
  3253 00001688 6E62                    	DB	'nb'
  3254 0000168A [C30E]                  	DW	GRP17
  3255 0000168C 73                      	DB	73H
  3256 0000168D 6165                    	DB	'ae'
  3257 0000168F [C30E]                  	DW	GRP17
  3258 00001691 73                      	DB	73H
  3259 00001692 6E63                    	DB	'nc'
  3260 00001694 [C30E]                  	DW	GRP17
  3261 00001696 73                      	DB	73H
  3262 00001697 6E67                    	DB	'ng'
  3263 00001699 [C30E]                  	DW	GRP17
  3264 0000169B 7E                      	DB	7EH
  3265 0000169C 6C65                    	DB	'le'
  3266 0000169E [C30E]                  	DW	GRP17
  3267 000016A0 7E                      	DB	7EH
  3268 000016A1 6E61                    	DB	'na'
  3269 000016A3 [C30E]                  	DW	GRP17
  3270 000016A5 76                      	DB	76H
  3271 000016A6 6265                    	DB	'be'
  3272 000016A8 [C30E]                  	DW	GRP17
  3273 000016AA 76                      	DB	76H
  3274 000016AB 7065                    	DB	'pe'
  3275 000016AD [C30E]                  	DW	GRP17
  3276 000016AF 7A                      	DB	7AH
  3277 000016B0 6E70                    	DB	'np'
  3278 000016B2 [C30E]                  	DW	GRP17
  3279 000016B4 7B                      	DB	7BH
  3280 000016B5 706F                    	DB	'po'
  3281 000016B7 [C30E]                  	DW	GRP17
  3282 000016B9 7B                      	DB	7BH
  3283 000016BA 6E6F                    	DB	'no'
  3284 000016BC [C30E]                  	DW	GRP17
  3285 000016BE 71                      	DB	71H
  3286 000016BF 6E73                    	DB	'ns'
  3287 000016C1 [C30E]                  	DW	GRP17
  3288 000016C3 79                      	DB	79H
  3289                                  J4:
  3290 000016C4 06                      	DB	6
  3291 000016C5 6D7073                  	DB	'mps'
  3292 000016C8 [C30E]                  	DW	GRP17
  3293 000016CA EB                      	DB	0EBH
  3294 000016CB 63787A                  	DB	'cxz'
  3295 000016CE [C30E]                  	DW	GRP17
  3296 000016D0 E3                      	DB	0E3H
  3297 000016D1 6E6765                  	DB	'nge'
  3298 000016D4 [C30E]                  	DW	GRP17
  3299 000016D6 7C                      	DB	7CH
  3300 000016D7 6E6165                  	DB	'nae'
  3301 000016DA [C30E]                  	DW	GRP17
  3302 000016DC 72                      	DB	72H
  3303 000016DD 6E6265                  	DB	'nbe'
  3304 000016E0 [C30E]                  	DW	GRP17
  3305 000016E2 77                      	DB	77H
  3306 000016E3 6E6C65                  	DB	'nle'
  3307 000016E6 [C30E]                  	DW	GRP17
  3308 000016E8 7F                      	DB	7FH
  3309                                  L3:
  3310 000016E9 03                      	DB	3
  3311 000016EA 6561                    	DB	'ea'
  3312 000016EC [C10C]                  	DW	GRP6
  3313 000016EE 8D                      	DB	8DH
  3314 000016EF 6473                    	DB	'ds'
  3315 000016F1 [C10C]                  	DW	GRP6
  3316 000016F3 C5                      	DB	0C5H
  3317 000016F4 6573                    	DB	'es'
  3318 000016F6 [C10C]                  	DW	GRP6
  3319 000016F8 C4                      	DB	0C4H
  3320                                  L4:
  3321 000016F9 05                      	DB	5
  3322 000016FA 6F6F70                  	DB	'oop'
  3323 000016FD [C30E]                  	DW	GRP17
  3324 000016FF E2                      	DB	0E2H
  3325 00001700 6F6462                  	DB	'odb'
  3326 00001703 [A70A]                  	DW	PUT
  3327 00001705 AC                      	DB	0ACH
  3328 00001706 6F6477                  	DB	'odw'
  3329 00001709 [A70A]                  	DW	PUT
  3330 0000170B AD                      	DB	0ADH
  3331 0000170C 616866                  	DB	'ahf'
  3332 0000170F [A70A]                  	DW	PUT
  3333 00001711 9F                      	DB	9FH
  3334 00001712 6F636B                  	DB	'ock'
  3335 00001715 [A70A]                  	DW	PUT
  3336 00001717 F0                      	DB	0F0H
  3337                                  L5:
  3338 00001718 04                      	DB	4
  3339 00001719 6F6F7065                	DB	'oope'
  3340 0000171D [C30E]                  	DW	GRP17
  3341 0000171F E1                      	DB	0E1H
  3342 00001720 6F6F707A                	DB	'oopz'
  3343 00001724 [C30E]                  	DW	GRP17
  3344 00001726 E1                      	DB	0E1H
  3345 00001727 6F647362                	DB	'odsb'
  3346 0000172B [A70A]                  	DW	PUT
  3347 0000172D AC                      	DB	0ACH
  3348 0000172E 6F647377                	DB	'odsw'
  3349 00001732 [A70A]                  	DW	PUT
  3350 00001734 AD                      	DB	0ADH
  3351                                  L6:
  3352 00001735 02                      	DB	2
  3353 00001736 6F6F706E65              	DB	'oopne'
  3354 0000173B [C30E]                  	DW	GRP17
  3355 0000173D E0                      	DB	0E0H
  3356 0000173E 6F6F706E7A              	DB	'oopnz'
  3357 00001743 [C30E]                  	DW	GRP17
  3358 00001745 E0                      	DB	0E0H
  3359                                  M3:
  3360 00001746 02                      	DB	2
  3361 00001747 6F76                    	DB	'ov'
  3362 00001749 [3E0A]                  	DW	GRP1
  3363 0000174B 88                      	DB	88H
  3364 0000174C 756C                    	DB	'ul'
  3365 0000174E [490D]                  	DW	GRP10
  3366 00001750 20                      	DB	20H
  3367                                  M4:
  3368 00001751 02                      	DB	2
  3369 00001752 6F7662                  	DB	'ovb'
  3370 00001755 [A70A]                  	DW	PUT
  3371 00001757 A4                      	DB	0A4H
  3372 00001758 6F7677                  	DB	'ovw'
  3373 0000175B [A70A]                  	DW	PUT
  3374 0000175D A5                      	DB	0A5H
  3375                                  M5:
  3376 0000175E 02                      	DB	2
  3377 0000175F 6F767362                	DB	'ovsb'
  3378 00001763 [A70A]                  	DW	PUT
  3379 00001765 A4                      	DB	0A4H
  3380 00001766 6F767377                	DB	'ovsw'
  3381 0000176A [A70A]                  	DW	PUT
  3382 0000176C A5                      	DB	0A5H
  3383                                  N3:
  3384 0000176D 03                      	DB	3
  3385 0000176E 6F74                    	DB	'ot'
  3386 00001770 [FB0C]                  	DW	GRP9
  3387 00001772 10                      	DB	10H
  3388 00001773 6567                    	DB	'eg'
  3389 00001775 [FB0C]                  	DW	GRP9
  3390 00001777 18                      	DB	18H
  3391 00001778 6F70                    	DB	'op'
  3392 0000177A [A70A]                  	DW	PUT
  3393 0000177C 90                      	DB	90H
  3394                                  O2:
  3395 0000177D 01                      	DB	1
  3396 0000177E 72                      	DB	'r'
  3397 0000177F [A30D]                  	DW	GRP13
  3398 00001781 0A                      	DB	0AH
  3399                                  O3:
  3400 00001782 02                      	DB	2
  3401 00001783 7574                    	DB	'ut'
  3402 00001785 [200C]                  	DW	GRP4
  3403 00001787 E6                      	DB	0E6H
  3404 00001788 7267                    	DB	'rg'
  3405 0000178A [460C]                  	DW	GRP5
  3406 0000178C 00                      	DB	0
  3407                                  O4:
  3408 0000178D 02                      	DB	2
  3409 0000178E 757462                  	DB	'utb'
  3410 00001791 [200C]                  	DW	GRP4
  3411 00001793 E6                      	DB	0E6H
  3412 00001794 757477                  	DB	'utw'
  3413 00001797 [200C]                  	DW	GRP4
  3414 00001799 E7                      	DB	0E7H
  3415                                  P3:
  3416 0000179A 02                      	DB	2
  3417 0000179B 6F70                    	DB	'op'
  3418 0000179D [B80F]                  	DW	GRP22
  3419 0000179F 8F                      	DB	8FH
  3420 000017A0 7574                    	DB	'ut'
  3421 000017A2 [460C]                  	DW	GRP5
  3422 000017A4 03                      	DB	3
  3423                                  P4:
  3424 000017A5 02                      	DB	2
  3425 000017A6 757368                  	DB	'ush'
  3426 000017A9 [900B]                  	DW	GRP2
  3427 000017AB FF                      	DB	0FFH
  3428 000017AC 6F7066                  	DB	'opf'
  3429 000017AF [A70A]                  	DW	PUT
  3430 000017B1 9D                      	DB	9DH
  3431                                  P5:
  3432 000017B2 01                      	DB	1
  3433 000017B3 75736866                	DB	'ushf'
  3434 000017B7 [A70A]                  	DW	PUT
  3435 000017B9 9C                      	DB	9CH
  3436                                  R3:
  3437 000017BA 06                      	DB	6
  3438 000017BB 6574                    	DB	'et'
  3439 000017BD [4B0E]                  	DW	GRP16
  3440 000017BF C3                      	DB	0C3H
  3441 000017C0 6570                    	DB	'ep'
  3442 000017C2 [A70A]                  	DW	PUT
  3443 000017C4 F3                      	DB	0F3H
  3444 000017C5 6F6C                    	DB	'ol'
  3445 000017C7 [790D]                  	DW	GRP12
  3446 000017C9 00                      	DB	0
  3447 000017CA 6F72                    	DB	'or'
  3448 000017CC [790D]                  	DW	GRP12
  3449 000017CE 08                      	DB	8
  3450 000017CF 636C                    	DB	'cl'
  3451 000017D1 [790D]                  	DW	GRP12
  3452 000017D3 10                      	DB	10H
  3453 000017D4 6372                    	DB	'cr'
  3454 000017D6 [790D]                  	DW	GRP12
  3455 000017D8 18                      	DB	18H
  3456                                  R4:
  3457 000017D9 02                      	DB	2
  3458 000017DA 65707A                  	DB	'epz'
  3459 000017DD [A70A]                  	DW	PUT
  3460 000017DF F3                      	DB	0F3H
  3461 000017E0 657065                  	DB	'epe'
  3462 000017E3 [A70A]                  	DW	PUT
  3463 000017E5 F3                      	DB	0F3H
  3464                                  R5:
  3465 000017E6 02                      	DB	2
  3466 000017E7 65706E7A                	DB	'epnz'
  3467 000017EB [A70A]                  	DW	PUT
  3468 000017ED F2                      	DB	0F2H
  3469 000017EE 65706E65                	DB	'epne'
  3470 000017F2 [A70A]                  	DW	PUT
  3471 000017F4 F2                      	DB	0F2H
  3472                                  S3:
  3473 000017F5 0B                      	DB	11
  3474 000017F6 7562                    	DB	'ub'
  3475 000017F8 [CD0C]                  	DW	GRP7
  3476 000017FA 2A                      	DB	2AH
  3477 000017FB 6262                    	DB	'bb'
  3478 000017FD [CD0C]                  	DW	GRP7
  3479 000017FF 1A                      	DB	1AH
  3480 00001800 6263                    	DB	'bc'
  3481 00001802 [CD0C]                  	DW	GRP7
  3482 00001804 1A                      	DB	1AH
  3483 00001805 7463                    	DB	'tc'
  3484 00001807 [A70A]                  	DW	PUT
  3485 00001809 F9                      	DB	0F9H
  3486 0000180A 7464                    	DB	'td'
  3487 0000180C [A70A]                  	DW	PUT
  3488 0000180E FD                      	DB	0FDH
  3489 0000180F 7469                    	DB	'ti'
  3490 00001811 [A70A]                  	DW	PUT
  3491 00001813 FB                      	DB	0FBH
  3492 00001814 686C                    	DB	'hl'
  3493 00001816 [790D]                  	DW	GRP12
  3494 00001818 20                      	DB	20H
  3495 00001819 6872                    	DB	'hr'
  3496 0000181B [790D]                  	DW	GRP12
  3497 0000181D 28                      	DB	28H
  3498 0000181E 616C                    	DB	'al'
  3499 00001820 [790D]                  	DW	GRP12
  3500 00001822 20                      	DB	20H
  3501 00001823 6172                    	DB	'ar'
  3502 00001825 [790D]                  	DW	GRP12
  3503 00001827 38                      	DB	38H
  3504 00001828 6567                    	DB	'eg'
  3505 0000182A [A00F]                  	DW	GRP21
  3506 0000182C 26                      	DB	26H
  3507                                  S4:
  3508 0000182D 05                      	DB	5
  3509 0000182E 636162                  	DB	'cab'
  3510 00001831 [A70A]                  	DW	PUT
  3511 00001833 AE                      	DB	0AEH
  3512 00001834 636177                  	DB	'caw'
  3513 00001837 [A70A]                  	DW	PUT
  3514 00001839 AF                      	DB	0AFH
  3515 0000183A 746F62                  	DB	'tob'
  3516 0000183D [A70A]                  	DW	PUT
  3517 0000183F AA                      	DB	0AAH
  3518 00001840 746F77                  	DB	'tow'
  3519 00001843 [A70A]                  	DW	PUT
  3520 00001845 AB                      	DB	0ABH
  3521 00001846 616866                  	DB	'ahf'
  3522 00001849 [A70A]                  	DW	PUT
  3523 0000184B 9E                      	DB	9EH
  3524                                  S5:
  3525 0000184C 04                      	DB	4
  3526 0000184D 63617362                	DB	'casb'
  3527 00001851 [A70A]                  	DW	PUT
  3528 00001853 AE                      	DB	0AEH
  3529 00001854 63617377                	DB	'casw'
  3530 00001858 [A70A]                  	DW	PUT
  3531 0000185A AF                      	DB	0AFH
  3532 0000185B 746F7362                	DB	'tosb'
  3533 0000185F [A70A]                  	DW	PUT
  3534 00001861 AA                      	DB	0AAH
  3535 00001862 746F7377                	DB	'tosw'
  3536 00001866 [A70A]                  	DW	PUT
  3537 00001868 AB                      	DB	0ABH
  3538                                  T4:
  3539 00001869 01                      	DB	1
  3540 0000186A 657374                  	DB	'est'
  3541 0000186D [8F0F]                  	DW	GRP20
  3542 0000186F 84                      	DB	84H
  3543                                  U2:
  3544 00001870 01                      	DB	1
  3545 00001871 70                      	DB	'p'
  3546 00001872 [A70A]                  	DW	PUT
  3547 00001874 FC                      	DB	0FCH
  3548                                  W4:
  3549 00001875 01                      	DB	1
  3550 00001876 616974                  	DB	'ait'
  3551 00001879 [A70A]                  	DW	PUT
  3552 0000187B 9B                      	DB	9BH
  3553                                  X3:
  3554 0000187C 01                      	DB	1
  3555 0000187D 6F72                    	DB	'or'
  3556 0000187F [A30D]                  	DW	GRP13
  3557 00001881 32                      	DB	32H
  3558                                  X4:
  3559 00001882 02                      	DB	2
  3560 00001883 636867                  	DB	'chg'
  3561 00001886 [C00B]                  	DW	GRP3
  3562 00001888 86                      	DB	86H
  3563 00001889 6C6174                  	DB	'lat'
  3564 0000188C [A70A]                  	DW	PUT
  3565 0000188E D7                      	DB	0D7H
  3566                                  
  3567                                  
  3568                                  ; 8087 MNEMONIC TABLE
  3569                                  ; Similar to 8086 table above, except NOT distinguished by opcode length
  3570                                  
  3571                                  XM1:	;F2XM1
  3572 0000188F 01                      	DB	1		;One opcode
  3573 00001890 786DB1                  	DB	"xm", '1'+ 080H
  3574 00001893 01F0                    	DB	1,0F0H
  3575                                  
  3576                                  NDPA:
  3577 00001895 03                      	DB	3
  3578 00001896 64E4                    	DB	"d", 'd'+ 080H
  3579 00001898 0EC1                    	DB	6+ARITH,0C1H
  3580 0000189A 6464F0                  	DB	"dd", 'p'+ 080H
  3581 0000189D 9000                    	DB	NEEDOP+STACKOP,0
  3582 0000189F 62F3                    	DB	"b", 's'+ 080H
  3583 000018A1 01E1                    	DB	1,0E1H
  3584                                  
  3585                                  NDPB:
  3586 000018A3 02                      	DB	2
  3587 000018A4 6CE4                    	DB	"l", 'd'+ 080H
  3588 000018A6 9F20                    	DB	7+NEEDOP+MEMORY,20H
  3589 000018A8 7374F0                  	DB	"st", 'p'+ 080H
  3590 000018AB 9F30                    	DB	7+NEEDOP+MEMORY,30H
  3591                                  
  3592                                  NDPC:
  3593 000018AD 05                      	DB	5
  3594 000018AE 6FED                    	DB	"o", 'm'+ 080H
  3595 000018B0 68D1                    	DB	0+ONEREG+REAL,0D1H
  3596 000018B2 6F6DF0                  	DB	"om", 'p'+ 080H
  3597 000018B5 68D9                    	DB	0+ONEREG+REAL,0D9H
  3598 000018B7 68F3                    	DB	"h", 's'+ 080H
  3599 000018B9 01E0                    	DB	1,0E0H
  3600 000018BB 6F6D70F0                	DB	"omp", 'p'+ 080H
  3601 000018BF 06D9                    	DB	6,0D9H
  3602 000018C1 6C65F8                  	DB	"le", 'x'+ 080H
  3603 000018C4 03E2                    	DB	3,0E2H
  3604                                  
  3605                                  NDPD:
  3606 000018C6 06                      	DB	6
  3607 000018C7 69F6                    	DB	"i", 'v'+ 080H
  3608 000018C9 0EF1                    	DB	6+ARITH,0F1H
  3609 000018CB 6976F0                  	DB	"iv", 'p'+ 080H
  3610 000018CE 9030                    	DB	NEEDOP+STACKOP,30H
  3611 000018D0 6976F2                  	DB	"iv", 'r'+ 080H
  3612 000018D3 0EF9                    	DB	6+ARITH,0F9H
  3613 000018D5 697672F0                	DB	"ivr", 'p'+ 080H
  3614 000018D9 9038                    	DB	NEEDOP+STACKOP,38H
  3615 000018DB 65637374F0              	DB	"ecst", 'p'+ 080H
  3616 000018E0 01F6                    	DB	1,0F6H
  3617 000018E2 6973E9                  	DB	"is", 'i'+ 080H
  3618 000018E5 03E1                    	DB	3,0E1H
  3619                                  
  3620                                  NDPE:
  3621 000018E7 01                      	DB	1
  3622 000018E8 6EE9                    	DB	"n", 'i'+ 080H
  3623 000018EA 03E0                    	DB	3,0E0H
  3624                                  
  3625                                  NDPF:
  3626 000018EC 01                      	DB	1
  3627 000018ED 7265E5                  	DB	"re", 'e'+ 080H
  3628 000018F0 C500                    	DB	5+NEEDOP+ONEREG,0
  3629                                  
  3630                                  NDPI:
  3631 000018F2 0D                      	DB	13
  3632 000018F3 6164E4                  	DB	"ad", 'd'+ 080H
  3633 000018F6 A200                    	DB	2+NEEDOP+INTEGER,0
  3634 000018F8 6CE4                    	DB	"l", 'd'+ 080H
  3635 000018FA B300                    	DB	3+NEEDOP+INTEGER+EXTENDED,0
  3636 000018FC 7375E2                  	DB	"su", 'b'+ 080H
  3637 000018FF A220                    	DB	2+NEEDOP+INTEGER,20H
  3638 00001901 7374F0                  	DB	"st", 'p'+ 080H
  3639 00001904 B318                    	DB	3+NEEDOP+INTEGER+EXTENDED,18H
  3640 00001906 73F4                    	DB	"s", 't'+ 080H
  3641 00001908 A310                    	DB	3+NEEDOP+INTEGER,10H
  3642 0000190A 6D75EC                  	DB	"mu", 'l'+ 080H
  3643 0000190D A208                    	DB	2+NEEDOP+INTEGER,8
  3644 0000190F 6469F6                  	DB	"di", 'v'+ 080H
  3645 00001912 A230                    	DB	2+NEEDOP+INTEGER,30H
  3646 00001914 737562F2                	DB	"sub", 'r'+ 080H
  3647 00001918 A228                    	DB	2+NEEDOP+INTEGER,28H
  3648 0000191A 646976F2                	DB	"div", 'r'+ 080H
  3649 0000191E A238                    	DB	2+NEEDOP+INTEGER,38H
  3650 00001920 636FED                  	DB	"co", 'm'+ 080H
  3651 00001923 A210                    	DB	2+NEEDOP+INTEGER,10H
  3652 00001925 636F6DF0                	DB	"com", 'p'+ 080H
  3653 00001929 A218                    	DB	2+NEEDOP+INTEGER,18H
  3654 0000192B 6E637374F0              	DB	"ncst", 'p'+ 080H
  3655 00001930 01F7                    	DB	1,0F7H
  3656 00001932 6E69F4                  	DB	"ni", 't'+ 080H
  3657 00001935 03E3                    	DB	3,0E3H
  3658                                  
  3659                                  NDPL:
  3660 00001937 0A                      	DB	10
  3661 00001938 E4                      	DB	"", 'd'+ 080H
  3662 00001939 F900                    	DB	1+NEEDOP+ONEREG+REAL+EXTENDED,0
  3663 0000193B 64FA                    	DB	"d", 'z'+ 080H
  3664 0000193D 01EE                    	DB	1,0EEH
  3665 0000193F 64B1                    	DB	"d", '1'+ 080H
  3666 00001941 01E8                    	DB	1,0E8H
  3667 00001943 6470E9                  	DB	"dp", 'i'+ 080H
  3668 00001946 01EB                    	DB	1,0EBH
  3669 00001948 646C32F4                	DB	"dl2", 't'+ 080H
  3670 0000194C 01E9                    	DB	1,0E9H
  3671 0000194E 646C32E5                	DB	"dl2", 'e'+ 080H
  3672 00001952 01EA                    	DB	1,0EAH
  3673 00001954 646C67B2                	DB	"dlg", '2'+ 080H
  3674 00001958 01EC                    	DB	1,0ECH
  3675 0000195A 646C6EB2                	DB	"dln", '2'+ 080H
  3676 0000195E 01ED                    	DB	1,0EDH
  3677 00001960 6463F7                  	DB	"dc", 'w'+ 080H
  3678 00001963 9928                    	DB	1+NEEDOP+MEMORY,28H
  3679 00001965 64656EF6                	DB	"den", 'v'+ 080H
  3680 00001969 9920                    	DB	1+NEEDOP+MEMORY,20H
  3681                                  
  3682                                  NDPM:
  3683 0000196B 02                      	DB	2
  3684 0000196C 75EC                    	DB	"u", 'l'+ 080H
  3685 0000196E 0EC9                    	DB	6+ARITH,0C9H
  3686 00001970 756CF0                  	DB	"ul", 'p'+ 080H
  3687 00001973 9008                    	DB	NEEDOP+STACKOP,8
  3688                                  
  3689                                  NDPO:
  3690 00001975 01                      	DB	1
  3691 00001976 F0                      	DB	"", 'p'+ 080H
  3692 00001977 8100                    	DB	NEEDOP+1,0	;Flag special handling
  3693                                  
  3694                                  NDPN:
  3695 00001979 01                      	DB	1
  3696 0000197A 6FF0                    	DB	"o", 'p'+ 080H
  3697 0000197C 01D0                    	DB	1,0D0H
  3698                                  
  3699                                  NDPP:
  3700 0000197E 03                      	DB	3
  3701 0000197F 7265ED                  	DB	"re", 'm'+ 080H
  3702 00001982 01F8                    	DB	1,0F8H
  3703 00001984 7461EE                  	DB	"ta", 'n'+ 080H
  3704 00001987 01F2                    	DB	1,0F2H
  3705 00001989 617461EE                	DB	"ata", 'n'+ 080H
  3706 0000198D 01F3                    	DB	1,0F3H
  3707                                  
  3708                                  NDPR:
  3709 0000198F 02                      	DB	2
  3710 00001990 6E64696EF4              	DB	"ndin", 't'+ 080H
  3711 00001995 01FC                    	DB	1,0FCH
  3712 00001997 73746FF2                	DB	"sto", 'r'+ 080H
  3713 0000199B 9D20                    	DB	5+NEEDOP+MEMORY,20H
  3714                                  
  3715                                  NDPS:
  3716 0000199D 0C                      	DB	12
  3717 0000199E F4                      	DB	"", 't'+ 080H
  3718 0000199F EDD0                    	DB	5+NEEDOP+ONEREG+REAL,0D0H
  3719 000019A1 74F0                    	DB	"t", 'p'+ 080H
  3720 000019A3 FFD8                    	DB	7+NEEDOP+ONEREG+REAL+EXTENDED,0D8H
  3721 000019A5 75E2                    	DB	"u", 'b'+ 080H
  3722 000019A7 0EE1                    	DB	6+ARITH,0E1H
  3723 000019A9 7562F0                  	DB	"ub", 'p'+ 080H
  3724 000019AC 90E0                    	DB	NEEDOP+STACKOP,0E0H
  3725 000019AE 7562F2                  	DB	"ub", 'r'+ 080H
  3726 000019B1 0EE9                    	DB	6+ARITH,0E9H
  3727 000019B3 756272F0                	DB	"ubr", 'p'+ 080H
  3728 000019B7 90E8                    	DB	NEEDOP+STACKOP,0E8H
  3729 000019B9 7172F4                  	DB	"qr", 't'+ 080H
  3730 000019BC 01FA                    	DB	1,0FAH
  3731 000019BE 63616CE5                	DB	"cal", 'e'+ 080H
  3732 000019C2 01FD                    	DB	1,0FDH
  3733 000019C4 6176E5                  	DB	"av", 'e'+ 080H
  3734 000019C7 9D30                    	DB	5+NEEDOP+MEMORY,30H
  3735 000019C9 7463F7                  	DB	"tc", 'w'+ 080H
  3736 000019CC 9938                    	DB	1+NEEDOP+MEMORY,38H
  3737 000019CE 74656EF6                	DB	"ten", 'v'+ 080H
  3738 000019D2 9930                    	DB	1+NEEDOP+MEMORY,30H
  3739 000019D4 7473F7                  	DB	"ts", 'w'+ 080H
  3740 000019D7 9D38                    	DB	5+NEEDOP+MEMORY,38H
  3741                                  
  3742                                  NDPT:
  3743 000019D9 01                      	DB	1
  3744 000019DA 73F4                    	DB	"s", 't'+ 080H
  3745 000019DC 01E4                    	DB	1,0E4H
  3746                                  
  3747                                  NDPW:
  3748 000019DE 01                      	DB	1
  3749 000019DF 6169F4                  	DB	"ai", 't'+ 080H
  3750 000019E2 8000                    	DB	NEEDOP,0	;Flag special handling
  3751                                  
  3752                                  NDPX:
  3753 000019E4 03                      	DB	3
  3754 000019E5 63E8                    	DB	"c", 'h'+ 080H
  3755 000019E7 41C9                    	DB	1+ONEREG,0C9H
  3756 000019E9 61ED                    	DB	"a", 'm'+ 080H
  3757 000019EB 01E5                    	DB	1,0E5H
  3758 000019ED 74726163F4              	DB	"trac", 't'+ 080H
  3759 000019F2 01F4                    	DB	1,0F4H
  3760                                  
  3761                                  NDPY:
  3762 000019F4 02                      	DB	2
  3763 000019F5 6C32F8                  	DB	"l2", 'x'+ 080H
  3764 000019F8 01F1                    	DB	1,0F1H
  3765 000019FA 6C327870B1              	DB	"l2xp", '1'+ 080H
  3766 000019FF 01F9                    	DB	1,0F9H
  3767                                  
  3768                                  
  3769                                  OPTAB:
  3770                                  ; Table of pointers  to mnemonics. For each letter of the alphabet (the
  3771                                  ; starting letter of the mnemonic), there are 5 entries. Each entry
  3772                                  ; corresponds to a mnemonic whose length is 2, 3, 4, 5, and 6 characters
  3773                                  ; long, respectively. If there are no mnemonics for a given combination
  3774                                  ; of first letter and length (such as A-2), then the corresponding entry
  3775                                  ; points to NONE. Otherwise, it points to a place in the mnemonic table
  3776                                  ; for that type.
  3777                                  
  3778                                  ; This table only needs to be modified if a mnemonic is added to a group
  3779                                  ; previously marked NONE. Change the NONE to a label made up of the first
  3780                                  ; letter of the mnemonic and its length, then add a new subsection to
  3781                                  ; the mnemonic table in alphabetical order.
  3782                                  
  3783 00001A01 [4015]                  	DW	NONE
  3784 00001A03 [4115]                  	DW	A3
  3785 00001A05 [4015]                  	DW	NONE
  3786 00001A07 [6515]                  	DW	A5
  3787 00001A09 [4015]                  	DW	NONE
  3788 00001A0B [4015]                  	DW	NONE	;B
  3789 00001A0D [4015]                  	DW	NONE
  3790 00001A0F [4015]                  	DW	NONE
  3791 00001A11 [4015]                  	DW	NONE
  3792 00001A13 [4015]                  	DW	NONE
  3793 00001A15 [4015]                  	DW	NONE	;C
  3794 00001A17 [6D15]                  	DW	C3
  3795 00001A19 [9115]                  	DW	C4
  3796 00001A1B [A415]                  	DW	C5
  3797 00001A1D [4015]                  	DW	NONE
  3798 00001A1F [B315]                  	DW	D2	;D
  3799 00001A21 [C815]                  	DW	D3
  3800 00001A23 [DD15]                  	DW	D4
  3801 00001A25 [4015]                  	DW	NONE
  3802 00001A27 [4015]                  	DW	NONE
  3803 00001A29 [E415]                  	DW	E2	;E
  3804 00001A2B [E915]                  	DW	E3
  3805 00001A2D [4015]                  	DW	NONE
  3806 00001A2F [F915]                  	DW	E5
  3807 00001A31 [4015]                  	DW	NONE
  3808 00001A33 [4015]                  	DW	NONE	;F
  3809 00001A35 [4015]                  	DW	NONE
  3810 00001A37 [4015]                  	DW	NONE
  3811 00001A39 [4015]                  	DW	NONE
  3812 00001A3B [4015]                  	DW	NONE
  3813 00001A3D [4015]                  	DW	NONE	;G
  3814 00001A3F [4015]                  	DW	NONE
  3815 00001A41 [4015]                  	DW	NONE
  3816 00001A43 [4015]                  	DW	NONE
  3817 00001A45 [4015]                  	DW	NONE
  3818 00001A47 [4015]                  	DW	NONE	;H
  3819 00001A49 [0116]                  	DW	H3
  3820 00001A4B [0716]                  	DW	H4
  3821 00001A4D [4015]                  	DW	NONE
  3822 00001A4F [4015]                  	DW	NONE
  3823 00001A51 [0E16]                  	DW	I2	;I
  3824 00001A53 [1716]                  	DW	I3
  3825 00001A55 [2C16]                  	DW	I4
  3826 00001A57 [4015]                  	DW	NONE
  3827 00001A59 [4015]                  	DW	NONE
  3828 00001A5B [4516]                  	DW	J2	;J
  3829 00001A5D [6E16]                  	DW	J3
  3830 00001A5F [C416]                  	DW	J4
  3831 00001A61 [4015]                  	DW	NONE
  3832 00001A63 [4015]                  	DW	NONE
  3833 00001A65 [4015]                  	DW	NONE	;K
  3834 00001A67 [4015]                  	DW	NONE
  3835 00001A69 [4015]                  	DW	NONE
  3836 00001A6B [4015]                  	DW	NONE
  3837 00001A6D [4015]                  	DW	NONE
  3838 00001A6F [4015]                  	DW	NONE	;L
  3839 00001A71 [E916]                  	DW	L3
  3840 00001A73 [F916]                  	DW	L4
  3841 00001A75 [1817]                  	DW	L5
  3842 00001A77 [3517]                  	DW	L6
  3843 00001A79 [4015]                  	DW	NONE	;M
  3844 00001A7B [4617]                  	DW	M3
  3845 00001A7D [5117]                  	DW	M4
  3846 00001A7F [5E17]                  	DW	M5
  3847 00001A81 [4015]                  	DW	NONE
  3848 00001A83 [4015]                  	DW	NONE	;N
  3849 00001A85 [6D17]                  	DW	N3
  3850 00001A87 [4015]                  	DW	NONE
  3851 00001A89 [4015]                  	DW	NONE
  3852 00001A8B [4015]                  	DW	NONE
  3853 00001A8D [7D17]                  	DW	O2	;O
  3854 00001A8F [8217]                  	DW	O3
  3855 00001A91 [8D17]                  	DW	O4
  3856 00001A93 [4015]                  	DW	NONE
  3857 00001A95 [4015]                  	DW	NONE
  3858 00001A97 [4015]                  	DW	NONE	;P
  3859 00001A99 [9A17]                  	DW	P3
  3860 00001A9B [A517]                  	DW	P4
  3861 00001A9D [B217]                  	DW	P5
  3862 00001A9F [4015]                  	DW	NONE
  3863 00001AA1 [4015]                  	DW	NONE	;Q
  3864 00001AA3 [4015]                  	DW	NONE
  3865 00001AA5 [4015]                  	DW	NONE
  3866 00001AA7 [4015]                  	DW	NONE
  3867 00001AA9 [4015]                  	DW	NONE
  3868 00001AAB [4015]                  	DW	NONE	;R
  3869 00001AAD [BA17]                  	DW	R3
  3870 00001AAF [D917]                  	DW	R4
  3871 00001AB1 [E617]                  	DW	R5
  3872 00001AB3 [4015]                  	DW	NONE
  3873 00001AB5 [4015]                  	DW	NONE	;S
  3874 00001AB7 [F517]                  	DW	S3
  3875 00001AB9 [2D18]                  	DW	S4
  3876 00001ABB [4C18]                  	DW	S5
  3877 00001ABD [4015]                  	DW	NONE
  3878 00001ABF [4015]                  	DW	NONE	;T
  3879 00001AC1 [4015]                  	DW	NONE
  3880 00001AC3 [6918]                  	DW	T4
  3881 00001AC5 [4015]                  	DW	NONE
  3882 00001AC7 [4015]                  	DW	NONE
  3883 00001AC9 [7018]                  	DW	U2	;U
  3884 00001ACB [4015]                  	DW	NONE
  3885 00001ACD [4015]                  	DW	NONE
  3886 00001ACF [4015]                  	DW	NONE
  3887 00001AD1 [4015]                  	DW	NONE
  3888 00001AD3 [4015]                  	DW	NONE	;V
  3889 00001AD5 [4015]                  	DW	NONE
  3890 00001AD7 [4015]                  	DW	NONE
  3891 00001AD9 [4015]                  	DW	NONE
  3892 00001ADB [4015]                  	DW	NONE
  3893 00001ADD [4015]                  	DW	NONE	;W
  3894 00001ADF [4015]                  	DW	NONE
  3895 00001AE1 [7518]                  	DW	W4
  3896 00001AE3 [4015]                  	DW	NONE
  3897 00001AE5 [4015]                  	DW	NONE
  3898 00001AE7 [4015]                  	DW	NONE	;X
  3899 00001AE9 [7C18]                  	DW	X3
  3900 00001AEB [8218]                  	DW	X4
  3901 00001AED [4015]                  	DW	NONE
  3902 00001AEF [4015]                  	DW	NONE
  3903 00001AF1 [4015]                  	DW	NONE	;Y
  3904 00001AF3 [4015]                  	DW	NONE
  3905 00001AF5 [4015]                  	DW	NONE
  3906 00001AF7 [4015]                  	DW	NONE
  3907 00001AF9 [4015]                  	DW	NONE
  3908 00001AFB [4015]                  	DW	NONE	;Z
  3909 00001AFD [4015]                  	DW	NONE
  3910 00001AFF [4015]                  	DW	NONE
  3911 00001B01 [4015]                  	DW	NONE
  3912 00001B03 [4015]                  	DW	NONE
  3913                                  
  3914                                  NDPTAB:
  3915                                  ;Lookup table for 8087 mnemonics. There is one entry for each letter of the
  3916                                  ;alphabet
  3917 00001B05 [9518]                  	DW	NDPA
  3918 00001B07 [A318]                  	DW	NDPB
  3919 00001B09 [AD18]                  	DW	NDPC
  3920 00001B0B [C618]                  	DW	NDPD
  3921 00001B0D [E718]                  	DW	NDPE
  3922 00001B0F [EC18]                  	DW	NDPF
  3923 00001B11 [4015]                  	DW	NONE	;G
  3924 00001B13 [4015]                  	DW	NONE	;H
  3925 00001B15 [F218]                  	DW	NDPI
  3926 00001B17 [4015]                  	DW	NONE	;J
  3927 00001B19 [4015]                  	DW	NONE	;K
  3928 00001B1B [3719]                  	DW	NDPL
  3929 00001B1D [6B19]                  	DW	NDPM
  3930 00001B1F [7919]                  	DW	NDPN
  3931 00001B21 [7519]                  	DW	NDPO
  3932 00001B23 [7E19]                  	DW	NDPP
  3933 00001B25 [4015]                  	DW	NONE	;Q
  3934 00001B27 [8F19]                  	DW	NDPR
  3935 00001B29 [9D19]                  	DW	NDPS
  3936 00001B2B [D919]                  	DW	NDPT
  3937 00001B2D [4015]                  	DW	NONE	;U
  3938 00001B2F [4015]                  	DW	NONE	;V
  3939 00001B31 [DE19]                  	DW	NDPW
  3940 00001B33 [E419]                  	DW	NDPX
  3941 00001B35 [F419]                  	DW	NDPY
  3942 00001B37 [4015]                  	DW	NONE	;Z
  3943                                  
  3944                                  ;Error message table
  3945                                  
  3946                                  ERRTAB:
  3947 00001B39 015265676973746572-     	DB	1, "Register not allowed in immediate valu", 'e'+ 080H
  3947 00001B42 206E6F7420616C6C6F-
  3947 00001B4B 77656420696E20696D-
  3947 00001B54 6D6564696174652076-
  3947 00001B5D 616C75E5           
  3948 00001B61 02496E646578206F72-     	DB	2, "Index or base register must be BP, BX, SI, or D", 'I'+ 080H
  3948 00001B6A 206261736520726567-
  3948 00001B73 6973746572206D7573-
  3948 00001B7C 742062652042502C20-
  3948 00001B85 42582C2053492C206F-
  3948 00001B8E 722044C9           
  3949 00001B92 034F6E6C79206F6E65-     	DB	3, "Only one base register (BX, BP) allowe", 'd'+ 080H
  3949 00001B9B 206261736520726567-
  3949 00001BA4 697374657220284258-
  3949 00001BAD 2C2042502920616C6C-
  3949 00001BB6 6F7765E4           
  3950 00001BBA 044F6E6C79206F6E65-     	DB	4, "Only one index register (SI or DI) allowe", 'd'+ 080H
  3950 00001BC3 20696E646578207265-
  3950 00001BCC 676973746572202853-
  3950 00001BD5 49206F722044492920-
  3950 00001BDE 616C6C6F7765E4     
  3951 00001BE5 054F6E6C7920616464-     	DB	5, "Only addition allowed on register or undefined labe", 'l'+ 080H
  3951 00001BEE 6974696F6E20616C6C-
  3951 00001BF7 6F776564206F6E2072-
  3951 00001C00 65676973746572206F-
  3951 00001C09 7220756E646566696E-
  3951 00001C12 6564206C616265EC   
  3952 00001C1A 064F6E6C79206F6E65-     	DB	6, "Only one undefined label per expression allowe", 'd'+ 080H
  3952 00001C23 20756E646566696E65-
  3952 00001C2C 64206C6162656C2070-
  3952 00001C35 657220657870726573-
  3952 00001C3E 73696F6E20616C6C6F-
  3952 00001C47 7765E4             
  3953 00001C4A 07496C6C6567616C20-     	DB	7, "Illegal digit in hexadecimal numbe", 'r'+ 080H
  3953 00001C53 646967697420696E20-
  3953 00001C5C 68657861646563696D-
  3953 00001C65 616C206E756D6265F2 
  3954 00001C6E 08496C6C6567616C20-     	DB	8, "Illegal digit in decimal numbe", 'r'+ 080H
  3954 00001C77 646967697420696E20-
  3954 00001C80 646563696D616C206E-
  3954 00001C89 756D6265F2         
  3955 00001C8E 0A496C6C6567616C20-     	DB	10, "Illegal character in label or opcod", 'e'+ 080H
  3955 00001C97 636861726163746572-
  3955 00001CA0 20696E206C6162656C-
  3955 00001CA9 206F72206F70636F64-
  3955 00001CB2 E5                 
  3956 00001CB3 0B4C6162656C206465-     	DB	11, "Label defined twic", 'e'+ 080H
  3956 00001CBC 66696E656420747769-
  3956 00001CC5 63E5               
  3957 00001CC7 0C4F70636F6465206E-     	DB	12, "Opcode not recognize", 'd'+ 080H
  3957 00001CD0 6F74207265636F676E-
  3957 00001CD9 697A65E4           
  3958 00001CDD 14496E76616C696420-     	DB	20, "Invalid operan", 'd'+ 080H
  3958 00001CE6 6F706572616EE4     
  3959 00001CED 15222C202220616E64-     	DB	21, '", " and second operand expected'
  3959 00001CF6 207365636F6E64206F-
  3959 00001CFF 706572616E64206578-
  3959 00001D08 706563746564       
  3960 00001D0E 165265676973746572-     	DB	22, "Register mismatc", 'h'+ 080H
  3960 00001D17 206D69736D617463E8 
  3961 00001D20 17496D6D6564696174-     	DB	23, "Immediate operand not allowe", 'd'+ 080H
  3961 00001D29 65206F706572616E64-
  3961 00001D32 206E6F7420616C6C6F-
  3961 00001D3B 7765E4             
  3962 00001D3E 18225D222065787065-     	DB	24, '"]" expecte', 'd'+ 080H
  3962 00001D47 637465E4           
  3963 00001D4B 1954776F206D656D6F-     	DB	25, "Two memory operands not allowe", 'd'+ 080H
  3963 00001D54 7279206F706572616E-
  3963 00001D5D 6473206E6F7420616C-
  3963 00001D66 6C6F7765E4         
  3964 00001D6B 1A44657374696E6174-     	DB	26, "Destination must not be immediate valu", 'e'+ 080H
  3964 00001D74 696F6E206D75737420-
  3964 00001D7D 6E6F7420626520696D-
  3964 00001D86 6D6564696174652076-
  3964 00001D8F 616C75E5           
  3965 00001D93 1B426F7468206F7065-     	DB	27, "Both operands must not be register", 's'+ 080H
  3965 00001D9C 72616E6473206D7573-
  3965 00001DA5 74206E6F7420626520-
  3965 00001DAE 7265676973746572F3 
  3966 00001DB7 1C4F706572616E6420-     	DB	28, "Operand must be segment registe", 'r'+ 080H
  3966 00001DC0 6D7573742062652073-
  3966 00001DC9 65676D656E74207265-
  3966 00001DD2 6769737465F2       
  3967 00001DD8 1D4669727374206F70-     	DB	29, "First operand must be registe", 'r'+ 080H
  3967 00001DE1 6572616E64206D7573-
  3967 00001DEA 742062652072656769-
  3967 00001DF3 737465F2           
  3968 00001DF7 1E556E646566696E65-     	DB	30, "Undefined label not allowe", 'd'+ 080H
  3968 00001E00 64206C6162656C206E-
  3968 00001E09 6F7420616C6C6F7765-
  3968 00001E12 E4                 
  3969 00001E13 1F56616C7565206F75-     	DB	31, "Value out of rang", 'e'+ 080H
  3969 00001E1C 74206F662072616E67-
  3969 00001E25 E5                 
  3970 00001E26 204D697373696E6720-     	DB	32, "Missing or illegal operand size fla", 'g'+ 080H
  3970 00001E2F 6F7220696C6C656761-
  3970 00001E38 6C206F706572616E64-
  3970 00001E41 2073697A6520666C61-
  3970 00001E4A E7                 
  3971 00001E4B 214D75737420686176-     	DB	33, "Must have label on same lin", 'e'+ 080H
  3971 00001E54 65206C6162656C206F-
  3971 00001E5D 6E2073616D65206C69-
  3971 00001E66 6EE5               
  3972 00001E68 235A65726F2D6C656E-     	DB	35, "Zero-length string illega", 'l'+ 080H
  3972 00001E71 67746820737472696E-
  3972 00001E7A 6720696C6C656761EC 
  3973 00001E83 24454E444946207769-     	DB	36, "ENDIF without I", 'F'+ 080H
  3973 00001E8C 74686F75742049C6   
  3974 00001E94 254F6E652D63686172-     	DB	37, "One-character strings onl", 'y'+ 080H
  3974 00001E9D 616374657220737472-
  3974 00001EA6 696E6773206F6E6CF9 
  3975 00001EAF 26496C6C6567616C20-     	DB	38, "Illegal expressio", 'n'+ 080H
  3975 00001EB8 65787072657373696F-
  3975 00001EC1 EE                 
  3976 00001EC2 27456E64206F662073-     	DB	39, "End of string not foun", 'd'+ 080H
  3976 00001ECB 7472696E67206E6F74-
  3976 00001ED4 20666F756EE4       
  3977 00001EDA 64556E646566696E65-     	DB	100, "Undefined labe", 'l'+ 080H
  3977 00001EE3 64206C616265EC     
  3978 00001EEA 6556616C7565206F75-     	DB	101, "Value out of range (forward", ')'+ 080H
  3978 00001EF3 74206F662072616E67-
  3978 00001EFC 652028666F72776172-
  3978 00001F05 64A9               
  3979 00001F07 FF                      	DB	255
  3980                                  
  3981 00001F08 2A2A2A2A2A20455252-     ERRMES:	DB	'***** ERROR: ', ' '+ 080H
  3981 00001F11 4F523A20A0         
  3982 00001F16 0D0A46696C65206372-     NOSPAC:	DB	13,10,'File creation error',13,10,"$"
  3982 00001F1F 656174696F6E206572-
  3982 00001F28 726F720D0A24       
  3983 00001F2E 0D0A496E7375666669-     NOMEM:	DB	13,10,'Insufficient memory',13,10,'$'
  3983 00001F37 6369656E74206D656D-
  3983 00001F40 6F72790D0A24       
  3984 00001F46 0D0A46696C65206E6F-     NOFILE:	DB	13,10,'File not found',13,10,'$'
  3984 00001F4F 7420666F756E640D0A-
  3984 00001F58 24                 
  3985 00001F59 0D0A4469736B206675-     WRTERR:	DB	13,10,'Disk full',13,10,'$'
  3985 00001F62 6C6C0D0A24         
  3986 00001F67 0D0A42616420646973-     BADDSK:	DB	13,10,'Bad disk specifier',13,10,'$'
  3986 00001F70 6B2073706563696669-
  3986 00001F79 65720D0A24         
  3987 00001F7E 0D0A0D0A4572726F72-     ERCNTM:	DB	13, 10, 13, 10, 'Error Count ', '='+ 080H
  3987 00001F87 20436F756E7420BD   
  3988 00001F8F 0D0A53796D626F6C20-     SYMSIZE	DB	13, 10, 'Symbol Table size =', ' '+ 080H
  3988 00001F98 5461626C652073697A-
  3988 00001FA1 65203DA0           
  3989 00001FA5 467265652073706163-     FRESIZE	DB	'Free space =       ', ' '+ 080H
  3989 00001FAE 65203D202020202020-
  3989 00001FB7 20A0               
  3990 00001FB9 0D0A53796D626F6C20-     SYMMES:	DB	13, 10, 'Symbol Tabl', 'e'+ 080H, 13, 10, 13, 10
  3990 00001FC2 5461626CE50D0A0D0A 
  3991 00001FCB 41534D0000              EXTEND:	DB	'ASM',0,0
  3992 00001FD0 05656E646966            IFEND:	DB	5,'endif'
  3993 00001FD6 026966                  IFNEST:	DB	2,'if'
  3994 00001FD9 7265F4                  RETSTR:	DB	're', 't'+ 080H
  3995 00001FDC 002020202020202020-     HEXFCB:	DB	0,'        HEX',0,0,0,0
  3995 00001FE5 48455800000000     
  3996 00001FEC 000000000000000000-     	DB	16 DUP(0)
  3996 00001FF5 00000000000000     
  3997 00001FFC 0000000000              	DB	0,0,0,0,0
  3998 00002001 002020202020202020-     LSTFCB:	DB	0,'        PRN',0,0,0,0
  3998 0000200A 50524E00000000     
  3999 00002011 000000000000000000-     	DB	16 DUP(0)
  3999 0000201A 00000000000000     
  4000 00002021 0000000000              	DB	0,0,0,0,0
  4001 00002026 0000                    PC:	DW 0
  4002 00002028 0000                    OLDPC:	DW 0
  4003 0000202A 0000                    LABPT:	DW 0
  4004 0000202C 00                      FLAG:	DB 0
  4005 0000202D 00                      MAXFLG:	DB 0
  4006 0000202E 0000                    ADDR:	DW 0
  4007 00002030 0000                    ALABEL:	DW 0
  4008 00002032 0000                    DATA:	DW 0
  4009 00002034 0000                    DLABEL:	DW 0
  4010 00002036 0000                    CON:	DW 0
  4011 00002038 0000                    UNDEF:	DW 0
  4012 0000203A 00                      LENID:	DB 0
  4013 0000203B 000000000000000000-     IDTEXT:	DB	80  DUP(0)
  4013 00002044 000000000000000000-
  4013 0000204D 000000000000000000-
  4013 00002056 000000000000000000-
  4013 0000205F 000000000000000000-
  4013 00002068 000000000000000000-
  4013 00002071 000000000000000000-
  4013 0000207A 000000000000000000-
  4013 00002083 0000000000000000   
  4014 0000208B 00                      CHR:	DB 0
  4015 0000208C 00                      SYM:	DB 0
  4016 0000208D 0000                    BASE:	DW 0
  4017 0000208F 0000                    HEAP:	DW 0
  4018 00002091 00                      SYMFLG:	DB 0
  4019 00002092 00                      SYMLIN:	DB 0
  4020 00002093 0000                    CODE:	DW 0
  4021 00002095 00                      DATSIZ:	DB 0
  4022 00002096 00                      RELOC:	DB 0
  4023 00002097 00                      BCOUNT:	DB 0
  4024 00002098 00                      COUNT:	DB 0
  4025 00002099 00                      ERR:	DB 0
  4026 0000209A 0000                    LINE:	DW 0
  4027 0000209C 0000                    HEXLEN:	DW 0
  4028 0000209E 0000                    HEXADD:	DW 0
  4029 000020A0 0000                    LASTAD:	DW 0
  4030 000020A2 00                      HEXCNT:	DB 0
  4031 000020A3 00                      CHKSUM:	DB 0
  4032 000020A4 00                      LINFLG:	DB 0
  4033 000020A5 00                      PREV:	DB 0
  4034 000020A6 00                      IFFLG:	DB 0
  4035 000020A7 00                      CHKLAB:	DB 0
  4036 000020A8 0000                    ERRCNT:	DW 0
  4037 000020AA 0000                    LSTRET:	DW 0
  4038 000020AC 0000                    RETPT:	DW 0
  4039 000020AE 0000                    LSTDEV:	DW 0
  4040 000020B0 00                      SPC:	DB 0
  4041 000020B1 00                      NOWAIT:	DB 0
  4042 000020B2 0000                    IX:	DW 0
  4043 000020B4 0000                    IY:	DW 0
  4044 000020B6 0000                    HEXPNT:	DW 0
  4045 000020B8 0000                    LSTPNT:	DW 0
  4046 000020BA 000000000000000000-     HEXBUF:	DB	HEXBUFSIZ DUP(0)
  4046 000020C3 000000000000000000-
  4046 000020CC 000000000000000000-
  4046 000020D5 000000000000000000-
  4046 000020DE 000000000000000000-
  4046 000020E7 000000000000000000-
  4046 000020F0 000000000000000000-
  4046 000020F9 00000000000000     
  4047 00002100 000000000000000000-     LSTBUF:	DB	LSTBUFSIZ DUP(0)
  4047 00002109 000000000000000000-
  4047 00002112 000000000000000000-
  4047 0000211B 000000000000000000-
  4047 00002124 000000000000000000-
  4047 0000212D 000000000000000000-
  4047 00002136 000000000000000000-
  4047 0000213F 000000000000000000-
  4047 00002148 000000000000000000-
  4047 00002151 000000000000000000-
  4047 0000215A 000000000000000000-
  4047 00002163 000000000000000000-
  4047 0000216C 000000000000000000-
  4047 00002175 000000000000000000-
  4047 0000217E 000000000000000000-
  4047 00002187 000000000000000000-
  4047 00002190 000000000000000000-
  4047 00002199 000000000000000000-
  4047 000021A2 000000000000000000-
  4047 000021AB 000000000000000000-
  4047 000021B4 000000000000000000-
  4047 000021BD 000000000000000000-
  4047 000021C6 000000000000000000-
  4047 000021CF 000000000000000000-
  4047 000021D8 000000000000000000-
  4047 000021E1 000000000000000000-
  4047 000021EA 000000000000000000-
  4047 000021F3 000000000000000000-
  4047 000021FC 000000000000000000-
  4047 00002205 000000000000000000-
  4047 0000220E 000000000000000000-
  4047 00002217 000000000000000000-
  4047 00002220 000000000000000000-
  4047 00002229 000000000000000000-
  4047 00002232 000000000000000000-
  4047 0000223B 000000000000000000-
  4047 00002244 000000000000000000-
  4047 0000224D 000000000000000000-
  4047 00002256 000000000000000000-
  4047 0000225F 000000000000000000-
  4047 00002268 000000000000000000-
  4047 00002271 000000000000000000-
  4047 0000227A 000000000000000000-
  4047 00002283 000000000000000000-
  4047 0000228C 000000000000000000-
  4047 00002295 000000000000000000-
  4047 0000229E 000000000000000000-
  4047 000022A7 000000000000000000-
  4047 000022B0 000000000000000000-
  4047 000022B9 000000000000000000-
  4047 000022C2 000000000000000000-
  4047 000022CB 000000000000000000-
  4047 000022D4 000000000000000000-
  4047 000022DD 000000000000000000-
  4047 000022E6 000000000000000000-
  4047 000022EF 000000000000000000-
  4047 000022F8 000000000000000000-
  4047 00002301 000000000000000000-
  4047 0000230A 000000000000000000-
  4047 00002313 000000000000000000-
  4047 0000231C 000000000000000000-
  4047 00002325 000000000000000000-
  4047 0000232E 000000000000000000-
  4047 00002337 000000000000000000-
  4047 00002340 000000000000000000-
  4047 00002349 000000000000000000-
  4047 00002352 000000000000000000-
  4047 0000235B 000000000000000000-
  4047 00002364 000000000000000000-
  4047 0000236D 000000000000000000-
  4047 00002376 000000000000000000-
  4047 0000237F 000000000000000000-
  4047 00002388 000000000000000000-
  4047 00002391 000000000000000000-
  4047 0000239A 000000000000000000-
  4047 000023A3 000000000000000000-
  4047 000023AC 000000000000000000-
  4047 000023B5 000000000000000000-
  4047 000023BE 000000000000000000-
  4047 000023C7 000000000000000000-
  4047 000023D0 000000000000000000-
  4047 000023D9 000000000000000000-
  4047 000023E2 000000000000000000-
  4047 000023EB 000000000000000000-
  4047 000023F4 000000000000000000-
  4047 000023FD 000000000000000000-
  4047 00002406 000000000000000000-
  4047 0000240F 000000000000000000-
  4047 00002418 000000000000000000-
  4047 00002421 000000000000000000-
  4047 0000242A 000000000000000000-
  4047 00002433 000000000000000000-
  4047 0000243C 000000000000000000-
  4047 00002445 000000000000000000-
  4047 0000244E 000000000000000000-
  4047 00002457 000000000000000000-
  4047 00002460 000000000000000000-
  4047 00002469 000000000000000000-
  4047 00002472 000000000000000000-
  4047 0000247B 000000000000000000-
  4047 00002484 000000000000000000-
  4047 0000248D 000000000000000000-
  4047 00002496 000000000000000000-
  4047 0000249F 000000000000000000-
  4047 000024A8 000000000000000000-
  4047 000024B1 000000000000000000-
  4047 000024BA 000000000000000000-
  4047 000024C3 000000000000000000-
  4047 000024CC 000000000000000000-
  4047 000024D5 000000000000000000-
  4047 000024DE 000000000000000000-
  4047 000024E7 000000000000000000-
  4047 000024F0 000000000000000000-
  4047 000024F9 00000000000000     
  4048 00002500 0000                    BUFPT:	DW 0
  4049 00002502 000000000000000000-     SRCBUF:	DB	BUFSIZ DUP(0)
  4049 0000250B 000000000000000000-
  4049 00002514 000000000000000000-
  4049 0000251D 000000000000000000-
  4049 00002526 000000000000000000-
  4049 0000252F 000000000000000000-
  4049 00002538 000000000000000000-
  4049 00002541 000000000000000000-
  4049 0000254A 000000000000000000-
  4049 00002553 000000000000000000-
  4049 0000255C 000000000000000000-
  4049 00002565 000000000000000000-
  4049 0000256E 000000000000000000-
  4049 00002577 000000000000000000-
  4049 00002580 000000000000000000-
  4049 00002589 000000000000000000-
  4049 00002592 000000000000000000-
  4049 0000259B 000000000000000000-
  4049 000025A4 000000000000000000-
  4049 000025AD 000000000000000000-
  4049 000025B6 000000000000000000-
  4049 000025BF 000000000000000000-
  4049 000025C8 000000000000000000-
  4049 000025D1 000000000000000000-
  4049 000025DA 000000000000000000-
  4049 000025E3 000000000000000000-
  4049 000025EC 000000000000000000-
  4049 000025F5 000000000000000000-
  4049 000025FE 000000000000000000-
  4049 00002607 000000000000000000-
  4049 00002610 000000000000000000-
  4049 00002619 000000000000000000-
  4049 00002622 000000000000000000-
  4049 0000262B 000000000000000000-
  4049 00002634 000000000000000000-
  4049 0000263D 000000000000000000-
  4049 00002646 000000000000000000-
  4049 0000264F 000000000000000000-
  4049 00002658 000000000000000000-
  4049 00002661 000000000000000000-
  4049 0000266A 000000000000000000-
  4049 00002673 000000000000000000-
  4049 0000267C 000000000000000000-
  4049 00002685 000000000000000000-
  4049 0000268E 000000000000000000-
  4049 00002697 000000000000000000-
  4049 000026A0 000000000000000000-
  4049 000026A9 000000000000000000-
  4049 000026B2 000000000000000000-
  4049 000026BB 000000000000000000-
  4049 000026C4 000000000000000000-
  4049 000026CD 000000000000000000-
  4049 000026D6 000000000000000000-
  4049 000026DF 000000000000000000-
  4049 000026E8 000000000000000000-
  4049 000026F1 000000000000000000-
  4049 000026FA 000000000000000000-
  4049 00002703 000000000000000000-
  4049 0000270C 000000000000000000-
  4049 00002715 000000000000000000-
  4049 0000271E 000000000000000000-
  4049 00002727 000000000000000000-
  4049 00002730 000000000000000000-
  4049 00002739 000000000000000000-
  4049 00002742 000000000000000000-
  4049 0000274B 000000000000000000-
  4049 00002754 000000000000000000-
  4049 0000275D 000000000000000000-
  4049 00002766 000000000000000000-
  4049 0000276F 000000000000000000-
  4049 00002778 000000000000000000-
  4049 00002781 000000000000000000-
  4049 0000278A 000000000000000000-
  4049 00002793 000000000000000000-
  4049 0000279C 000000000000000000-
  4049 000027A5 000000000000000000-
  4049 000027AE 000000000000000000-
  4049 000027B7 000000000000000000-
  4049 000027C0 000000000000000000-
  4049 000027C9 000000000000000000-
  4049 000027D2 000000000000000000-
  4049 000027DB 000000000000000000-
  4049 000027E4 000000000000000000-
  4049 000027ED 000000000000000000-
  4049 000027F6 000000000000000000-
  4049 000027FF 000000000000000000-
  4049 00002808 000000000000000000-
  4049 00002811 000000000000000000-
  4049 0000281A 000000000000000000-
  4049 00002823 000000000000000000-
  4049 0000282C 000000000000000000-
  4049 00002835 000000000000000000-
  4049 0000283E 000000000000000000-
  4049 00002847 000000000000000000-
  4049 00002850 000000000000000000-
  4049 00002859 000000000000000000-
  4049 00002862 000000000000000000-
  4049 0000286B 000000000000000000-
  4049 00002874 000000000000000000-
  4049 0000287D 000000000000000000-
  4049 00002886 000000000000000000-
  4049 0000288F 000000000000000000-
  4049 00002898 000000000000000000-
  4049 000028A1 000000000000000000-
  4049 000028AA 000000000000000000-
  4049 000028B3 000000000000000000-
  4049 000028BC 000000000000000000-
  4049 000028C5 000000000000000000-
  4049 000028CE 000000000000000000-
  4049 000028D7 000000000000000000-
  4049 000028E0 000000000000000000-
  4049 000028E9 000000000000000000-
  4049 000028F2 000000000000000000-
  4049 000028FB 00000000000000     
  4050 00002902 000000000000000000-     	DB 100H DUP(0)
  4050 0000290B 000000000000000000-
  4050 00002914 000000000000000000-
  4050 0000291D 000000000000000000-
  4050 00002926 000000000000000000-
  4050 0000292F 000000000000000000-
  4050 00002938 000000000000000000-
  4050 00002941 000000000000000000-
  4050 0000294A 000000000000000000-
  4050 00002953 000000000000000000-
  4050 0000295C 000000000000000000-
  4050 00002965 000000000000000000-
  4050 0000296E 000000000000000000-
  4050 00002977 000000000000000000-
  4050 00002980 000000000000000000-
  4050 00002989 000000000000000000-
  4050 00002992 000000000000000000-
  4050 0000299B 000000000000000000-
  4050 000029A4 000000000000000000-
  4050 000029AD 000000000000000000-
  4050 000029B6 000000000000000000-
  4050 000029BF 000000000000000000-
  4050 000029C8 000000000000000000-
  4050 000029D1 000000000000000000-
  4050 000029DA 000000000000000000-
  4050 000029E3 000000000000000000-
  4050 000029EC 000000000000000000-
  4050 000029F5 000000000000000000-
  4050 000029FE 00000000           
  4051                                  	ALIGN 2
  4052                                  STACK:	EQU	$
  4053                                  START:	EQU	$
